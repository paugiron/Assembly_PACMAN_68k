00002192 Starting Address
Assembler used: EASy68K Editor/Assembler v5.16.01
Created On: 23/12/2022 10:39:34

00000000                             1  ; ==============================================================================
00000000                             2  ; TITLE       : PAC-MAN 68000
00000000                             3  ; DESCRIPTION : GAME IN MOTOROLA 68000 BASED ON PAC-MAN GAME
00000000                             4  ; AUTHOR      : JORDI FLORIT ENSENYAT
00000000                             5  ;               JOSEP GABRIEL FORNES REYNES
00000000                             6  ;               PAU GIRON RODRIGUEZ
00000000                             7  ; ==============================================================================
00001000                             8              ORG    $1000
00001000                             9  
00001000                            10              INCLUDE "CONST.X68"
00001000                            11  ; ==============================================================================
00001000                            12  ; GAME CONSTANTS
00001000                            13  ; ==============================================================================
00001000                            14  
00001000                            15  ; --- PAC-MAN RELATED CONTANTS ----------------------------------------------------
00001000                            16  
00001000  =0000FFFF                 17  PMPCOL      EQU     $0000FFFF               ; PAC-MAN CONTOUR COLOR
00001000  =0000FFFF                 18  PMFCOL      EQU     $0000FFFF               ; PAC-MAN FILL COLOR
00001000  =00000002                 19  PMSPEED     EQU     2                       ; MAGNITUDE OF THE X AND Y VEL.
00001000  =00000008                 20  PMRAD       EQU     8                       ; PAC-MAN RADIUS
00001000                            21  
00001000                            22  ; --- GHOST RELATED CONSTANTS ----------------------------------------------------
00001000                            23  
00001000  =00000007                 24  GSTSPEED    EQU     7                       ; MAGNITUDE OF THE NORMAL DISPLACEMENT
00001000  =00000005                 25  GSTSPEED2   EQU     5                       ; MAGNITUDE OF THE ATACKED DISPLACEMENT
00001000                            26  
00001000  =000000FF                 27  GSTCOL1     EQU     $000000FF               ; GHOST 1 CONTOUR COLOR RED
00001000  =00FFFFFF                 28  GSTFCOL1    EQU     $00FFFFFF               ; GHOST 1 FILL COLOR WHITE
00001000  =00000002                 29  GSTINX1     EQU     2                       ; GHOST 1 INITIAL X
00001000  =00000002                 30  GSTINY1     EQU     2                       ; GHOST 1 INITIAL Y
00001000                            31  
00001000  =00FF0080                 32  GSTCOL2     EQU     $00FF0080               ; GHOST 2 CONTOUR COLOR PINK
00001000  =00000000                 33  GSTFCOL2    EQU     $00000000               ; GHOST 1 FILL COLOR
00001000  =00000002                 34  GSTINX2     EQU     2                       ; GHOST 2 INITIAL X
00001000  =0000001F                 35  GSTINY2     EQU     31                      ; GHOST 2 INITIAL Y
00001000                            36  
00001000  =00FFFF00                 37  GSTCOL3     EQU     $00FFFF00               ; GHOST 3 CONTOUR COLOR CYAN
00001000  =00000000                 38  GSTFCOL3    EQU     $00000000               ; GHOST 3 FILL COLOR
00001000  =0000001F                 39  GSTINX3     EQU     31                      ; GHOST 3 INITIAL X
00001000  =00000002                 40  GSTINY3     EQU     2                       ; GHOST 3 INITIAL Y
00001000                            41  
00001000  =000080FF                 42  GSTCOL4     EQU     $000080FF               ; GHOST 4 CONTOUR COLOR ORANGE
00001000  =00000000                 43  GSTFCOL4    EQU     $00000000               ; GHOST 4 FILL COLOR
00001000  =0000001F                 44  GSTINX4     EQU     31                      ; GHOST 4 INITIAL X
00001000  =0000001F                 45  GSTINY4     EQU     31                      ; GHOST 4 INITIAL Y 
00001000                            46  
00001000  =00800000                 47  GSTCOL5     EQU     $00800000               ; CONTOUR COLOR OF ATACKED MODE
00001000  =00000000                 48  GSTFCOL5    EQU     $00000000               ; FILL COLOR OF ATACKED MODE
00001000                            49  
00001000  =00000008                 50  GSTRAD      EQU     8                       ; GHOST RADIUS
00001000  =00000010                 51  GSTRNG      EQU     16                      ; GHOST DETECTING RANGE
00001000                            52              
00001000                            53  ; --- SCOREBOARD RELATED CONSTANTS ---------------------------------------------
00001000                            54  ;MODIFICATE
00001000                            55  
00001000  =00000000                 56  SCOFCOL     EQU     $00000000               ; TEXT BACKGROUND COLOR
00001000  =00000101                 57  SCOLINE1    EQU     $0101                   ; FIRST TEXT LINE COORDINATES
00001000  =00000102                 58  SCOLINE2    EQU     $0102                   ; SECOND TEXT LINE COORDINATES
00001000                            59  
00001000                            60  ; --- MAP RELATED CONSTANTS ----------------------------------------------------
00001000                            61  
00001000= 01 01 01 01 01 01 ...     62  MAPMAT      DC.B    $1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
00001020= 01 02 02 02 02 02 ...     63              DC.B    $1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1
00001040= 01 02 01 01 01 01 ...     64              DC.B    $1,2,1,1,1,1,1,2,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,2,1,1,1,1,1,2,1
00001060= 01 03 01 01 01 01 ...     65              DC.B    $1,3,1,1,1,1,1,2,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,2,1,1,1,1,1,3,1
00001080= 01 02 02 02 02 02 ...     66              DC.B    $1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1
000010A0= 01 02 01 01 01 01 ...     67              DC.B    $1,2,1,1,1,1,1,2,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,2,1,1,1,1,1,2,1
000010C0= 01 02 01 01 01 01 ...     68              DC.B    $1,2,1,1,1,1,1,2,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,2,1,1,1,1,1,2,1
000010E0= 01 02 02 02 02 02 ...     69              DC.B    $1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1
00001100= 01 02 01 01 01 01 ...     70              DC.B    $1,2,1,1,1,1,1,2,1,1,1,2,1,1,1,1,1,1,1,1,2,1,1,1,2,1,1,1,1,1,2,1
00001120= 01 02 01 00 00 00 ...     71              DC.B    $1,2,1,0,0,0,1,2,1,0,1,2,1,1,1,1,1,1,1,1,2,1,0,1,2,1,0,0,0,1,2,1
00001140= 01 02 01 01 01 01 ...     72              DC.B    $1,2,1,1,1,1,1,2,1,0,1,2,2,2,2,1,1,2,2,2,2,1,0,1,2,1,1,1,1,1,2,1
00001160= 01 02 02 02 02 02 ...     73              DC.B    $1,2,2,2,2,2,2,2,1,0,1,1,1,1,2,1,1,2,1,1,1,1,0,1,2,2,2,2,2,2,2,1
00001180= 01 01 01 01 01 01 ...     74              DC.B    $1,1,1,1,1,1,1,2,1,0,1,1,1,1,2,1,1,2,1,1,1,1,0,1,2,1,1,1,1,1,1,1
000011A0= 01 00 00 00 00 00 ...     75              DC.B    $1,0,0,0,0,0,1,2,1,0,1,0,0,0,0,0,0,0,0,0,0,1,0,1,2,1,0,0,0,0,0,1
000011C0= 01 00 00 00 00 00 ...     76              DC.B    $1,0,0,0,0,0,1,2,1,0,1,0,1,1,1,0,0,1,1,1,0,1,0,1,2,1,0,0,0,0,0,1
000011E0= 01 01 01 01 01 01 ...     77              DC.B    $1,1,1,1,1,1,1,2,1,1,1,0,1,0,0,0,0,0,0,1,0,1,1,1,2,1,1,1,1,1,1,1
00001200= 04 00 00 00 00 00 ...     78              DC.B    $4,0,0,0,0,0,0,2,2,2,2,0,1,0,0,0,0,0,0,1,0,2,2,2,2,0,0,0,0,0,0,4
00001220= 01 01 01 01 01 01 ...     79              DC.B    $1,1,1,1,1,1,1,2,1,1,1,0,1,0,0,0,0,0,0,1,0,1,1,1,2,1,1,1,1,1,1,1
00001240= 01 00 00 00 00 00 ...     80              DC.B    $1,0,0,0,0,0,1,2,1,0,1,0,1,1,1,1,1,1,1,1,0,1,0,1,2,1,0,0,0,0,0,1
00001260= 01 00 00 00 00 00 ...     81              DC.B    $1,0,0,0,0,0,1,2,1,0,1,0,0,0,0,0,0,0,0,0,0,1,0,1,2,1,0,0,0,0,0,1
00001280= 01 01 01 01 01 01 ...     82              DC.B    $1,1,1,1,1,1,1,2,1,1,1,0,1,1,1,1,1,1,1,1,0,1,1,1,2,1,1,1,1,1,1,1
000012A0= 01 02 02 02 02 02 ...     83              DC.B    $1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1
000012C0= 01 02 01 01 01 01 ...     84              DC.B    $1,2,1,1,1,1,1,2,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,2,1,1,1,1,1,2,1
000012E0= 01 02 01 01 01 01 ...     85              DC.B    $1,2,1,1,1,1,1,2,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,2,1,1,1,1,1,2,1
00001300= 01 02 02 02 02 01 ...     86              DC.B    $1,2,2,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,2,2,2,1
00001320= 01 01 01 01 02 01 ...     87              DC.B    $1,1,1,1,2,1,1,2,1,1,1,2,1,1,1,1,1,1,1,1,2,1,1,1,2,1,1,2,1,1,1,1
00001340= 01 01 01 01 02 01 ...     88              DC.B    $1,1,1,1,2,1,1,2,1,0,1,2,1,1,1,1,1,1,1,1,2,1,0,1,2,1,1,2,1,1,1,1
00001360= 01 02 02 02 02 02 ...     89              DC.B    $1,2,2,2,2,2,2,2,1,0,1,2,2,2,2,1,1,2,2,2,2,1,0,1,2,2,2,2,2,2,2,1
00001380= 01 02 01 01 01 01 ...     90              DC.B    $1,2,1,1,1,1,1,1,1,0,1,1,1,1,2,1,1,2,1,1,1,1,0,1,1,1,1,1,1,1,2,1
000013A0= 01 03 01 01 01 01 ...     91              DC.B    $1,3,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,3,1
000013C0= 01 02 02 02 02 02 ...     92              DC.B    $1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1
000013E0= 01 01 01 01 01 01 ...     93              DC.B    $1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
00001400                            94              
00001400                            95  ; --- STATE RELATED CONSTANTS --------------------------------------------------
00001400                            96  
00001400  =FFFFFFFF                 97  STANONE     EQU     -1                      ; NON-EXISTENT STATE NUMBER
00001400                            98  
00001400                            99  
00001400                           100  
00001400                           101  
00001400                           102  
00001400                           103  
00001400                           104  
00001400                           105  
00001400                           106  
00001400                           107  
00001400                           108  
00001400                           109  
00001400                           110  
00001400                           111  
00001400                           112  
00001400                           113  
00001400                           114  
00001400                           115  
00001400                           116  
00001400                           117  
00001400                           118  
00001400                           119  
00001400                           120  
00001400                           121  -------------------- end include --------------------
00001400                           122              INCLUDE "GHOST.X68"
00001400                           123  ; ==============================================================================
00001400                           124  ; GHOST MANAGEMENT
00001400                           125  ; ==============================================================================
00001400                           126              
00001400                           127  ; ------------------------------------------------------------------------------
00001400                           128  GSTINIT
00001400                           129  ; INITIALIZE GHOST.
00001400                           130  ; INPUT    : NONE 
00001400                           131  ; OUTPUT   : NONE
00001400                           132  ; MODIFIES : NONE
00001400                           133  ; ------------------------------------------------------------------------------
00001400  33FC 0058 000025D0       134              MOVE.W  #GSTINX1*16+64-8,(GSTPOSX)
00001408  33FC 0058 000025D2       135              MOVE.W  #GSTINY1*16+64-8,(GSTPOSY)
00001410  33FC 0007 000025D4       136              MOVE.W  #GSTSPEED,(GSTVELX)
00001418  33FC 0007 000025D6       137              MOVE.W  #GSTSPEED,(GSTVELY)
00001420  4239 000025D9            138              CLR.B   (GSTLAMO)
00001426  4E75                     139              RTS
00001428                           140              
00001428                           141  ; ------------------------------------------------------------------------------
00001428                           142  GSTUPD
00001428                           143  ; UPDATES THE GHOST.
00001428                           144  ; INPUT    : NONE 
00001428                           145  ; OUTPUT   : NONE
00001428                           146  ; MODIFIES : NONE
00001428                           147  ; ------------------------------------------------------------------------------
00001428  48E7 F800                148              MOVEM.L D0-D4,-(A7)
0000142C                           149              
0000142C                           150              ;MOVE.W  (PMPOSX)/16*(PMPOSX)/16+(PMPOSY)/16*(PMPOSY)/16-#GSTRNG*#GSTRNG,D0
0000142C  6600 000E                151              BNE     .GSTINRNG
00001430                           152  .GSTNOTINRNG
00001430  13FC 0001 000025DA       153              MOVE.B  #1,(GSTINRNG)
00001438  6000 000A                154              BRA     .CHECKCRITIC
0000143C                           155  .GSTINRNG
0000143C  13FC 0000 000025DA       156              MOVE.B  #0,(GSTINRNG)
00001444                           157  .CHECKCRITIC
00001444                           158              
00001444                           159  
00001444  4CDF 001F                160              MOVEM.L (A7)+,D0-D4
00001448                           161              
00001448  4E75                     162              RTS
0000144A                           163              
0000144A                           164  ; ------------------------------------------------------------------------------
0000144A                           165  GSTPLOT
0000144A                           166  ; PLOT THE GHOST.
0000144A                           167  ; INPUT    : NONE 
0000144A                           168  ; OUTPUT   : NONE
0000144A                           169  ; MODIFIES : NONE
0000144A                           170  ; ------------------------------------------------------------------------------
0000144A  48E7 F800                171              MOVEM.L D0-D4,-(A7)
0000144E                           172              
0000144E                           173              ;SET PEN COLOR
0000144E  303C 0050                174              MOVE.W  #80,D0
00001452  223C 000000FF            175              MOVE.L  #GSTCOL1,D1
00001458  4E4F                     176              TRAP    #15
0000145A                           177              
0000145A                           178              ;SET FILL COLOR
0000145A  303C 0051                179              MOVE.W  #81,D0
0000145E  223C 00FFFFFF            180              MOVE.L  #GSTFCOL1,D1
00001464  4E4F                     181              TRAP    #15
00001466                           182              
00001466                           183              ;SET COORDS
00001466  3239 000025D0            184              MOVE.W  (GSTPOSX),D1
0000146C  5141                     185              SUB.W   #GSTRAD,D1
0000146E  3439 000025D2            186              MOVE.W  (GSTPOSY),D2
00001474  5142                     187              SUB.W   #GSTRAD,D2
00001476                           188              
00001476  3601                     189              MOVE.W  D1,D3
00001478  0643 0010                190              ADD.W   #GSTRAD*2,D3
0000147C  3802                     191              MOVE.W  D2,D4
0000147E  0644 0010                192              ADD.W   #GSTRAD*2,D4
00001482                           193              
00001482                           194              ;DRAW GHOST
00001482  303C 0058                195              MOVE.W  #88,D0
00001486  4E4F                     196              TRAP    #15
00001488                           197              
00001488                           198              ;SET RANGE COORDS
00001488  3239 000025D0            199              MOVE.W  (GSTPOSX),D1
0000148E  0441 0100                200              SUB.W   #GSTRNG*16,D1
00001492  3439 000025D2            201              MOVE.W  (GSTPOSY),D2
00001498  0442 0100                202              SUB.W   #GSTRNG*16,D2
0000149C                           203              
0000149C  3601                     204              MOVE.W  D1,D3
0000149E  0643 0200                205              ADD.W   #GSTRNG*16*2,D3
000014A2  3802                     206              MOVE.W  D2,D4
000014A4  0644 0200                207              ADD.W   #GSTRNG*16*2,D4
000014A8                           208              
000014A8                           209              ;DRAW GHOST RANGE
000014A8  303C 005B                210              MOVE.W  #91,D0
000014AC  4E4F                     211              TRAP    #15
000014AE                           212              
000014AE  4CDF 001F                213              MOVEM.L (A7)+,D0-D4
000014B2                           214              
000014B2                           215  
000014B2  4E75                     216              RTS
000014B4                           217  
000014B4                           218  
000014B4                           219  
000014B4                           220  
000014B4                           221  
000014B4                           222  -------------------- end include --------------------
000014B4                           223              INCLUDE "PAC-MAN.X68"
000014B4                           224  ; ==============================================================================
000014B4                           225  ; PAC-MAN MANAGEMENT
000014B4                           226  ; ==============================================================================
000014B4                           227              
000014B4                           228  ; ------------------------------------------------------------------------------
000014B4                           229  PMINIT
000014B4                           230  ; INITIALIZE PAC-MAN.
000014B4                           231  ; INPUT    : NONE 
000014B4                           232  ; OUTPUT   : NONE
000014B4                           233  ; MODIFIES : NONE
000014B4                           234  ; ------------------------------------------------------------------------------
000014B4                           235  
000014B4  33FC 0140 000025C6       236              MOVE.W  #SCRWIDTH/2,(PMPOSX)
000014BC  33FC 0140 000025C8       237              MOVE.W  #SCRHEIGH/2,(PMPOSY)
000014C4  5079 000025C6            238              ADDQ.W  #8,(PMPOSX)
000014CA  5079 000025C8            239              ADDQ.W  #8,(PMPOSY)
000014D0  33FC 0002 000025CA       240              MOVE.W  #PMSPEED,(PMVELX)
000014D8  33FC 0002 000025CC       241              MOVE.W  #PMSPEED,(PMVELY)
000014E0  4239 000025CF            242              CLR.B   (PMLAMO)
000014E6                           243  
000014E6  4E75                     244              RTS
000014E8                           245              
000014E8                           246  ; ------------------------------------------------------------------------------
000014E8                           247  PMUPD
000014E8                           248  ; UPDATES THE PAC-MAN.
000014E8                           249  ; INPUT    : NONE 
000014E8                           250  ; OUTPUT   : NONE
000014E8                           251  ; MODIFIES : NONE
000014E8                           252  ; ------------------------------------------------------------------------------
000014E8                           253              
000014E8  48E7 FE00                254              MOVEM.L D0-D6,-(A7)
000014EC                           255              
000014EC  303C 0002                256              MOVE.W  #PMSPEED,D0
000014F0                           257              
000014F0                           258              
000014F0  3439 000025C6            259              MOVE.W  (PMPOSX),D2
000014F6  3639 000025C8            260              MOVE.W  (PMPOSY),D3
000014FC                           261              
000014FC  5042                     262              ADDQ.W  #8,D2              
000014FE  5043                     263              ADDQ.W  #8,D3  
00001500                           264              
00001500  1839 000025CF            265              MOVE.B  (PMLAMO),D4
00001506                           266              
00001506                           267              ;MASK OF THE LAST NIBBLE        
00001506  C47C 000F                268              AND.W   #$000F,D2               ; COORDENADA X
0000150A  C67C 000F                269              AND.W   #$000F,D3               ; COORDENADA Y
0000150E                           270              
0000150E                           271              ;CHECK IF COORDS ARE MULTIPLES OF 16
0000150E  B47C 0000                272              CMP     #$0000,D2
00001512  6600 00F6                273              BNE     .NOTMULT
00001516  B67C 0000                274              CMP     #$0000,D3
0000151A  6600 00EE                275              BNE     .NOTMULT
0000151E                           276              
0000151E                           277              ;BRA     .ACTYUP
0000151E                           278  
0000151E                           279              ;CHECK THE DIRECTION
0000151E  0839 0000 000021BE       280              BTST.B  #0,(KBDVAL)             ;CHECK LEFT
00001526  6700 000C                281              BEQ     .NOTLEFT
0000152A  4204                     282              CLR.B   D4
0000152C  183C 0000                283              MOVE.B  #0,D4
00001530  6000 0074                284              BRA     .ACTXLEFT
00001534                           285  .NOTLEFT            
00001534  0839 0002 000021BE       286              BTST.B   #2,(KBDVAL)             ;CHECK RIGHT
0000153C  6700 000C                287              BEQ     .NOTRIGHT
00001540  4204                     288              CLR.B   D4
00001542  183C 0001                289              MOVE.B   #1,D4
00001546  6000 0032                290              BRA     .ACTXRIGHT
0000154A                           291  .NOTRIGHT            
0000154A  0839 0001 000021BE       292              BTST.B   #1,(KBDVAL)             ;CHECK UP
00001552  6700 000C                293              BEQ     .NOTUP
00001556  4204                     294              CLR.B   D4
00001558  183C 0002                295              MOVE.B  #2,D4
0000155C  6000 0090                296              BRA     .ACTYUP
00001560                           297  .NOTUP            
00001560  0839 0003 000021BE       298              BTST.B   #3,(KBDVAL)             ;CHECK DOWN
00001568  6700 000C                299              BEQ     .NOTDOWN
0000156C  4204                     300              CLR.B   D4
0000156E  183C 0003                301              MOVE.B   #3,D4
00001572  6000 005E                302              BRA     .ACTYDOWN
00001576                           303  .NOTDOWN
00001576  6000 00A8                304              BRA     .DONE
0000157A                           305              
0000157A                           306              
0000157A                           307              ;UPDATE COORDS
0000157A                           308              
0000157A                           309  .ACTXRIGHT  
0000157A  4EB9 00001990            310              JSR     COLWALLRIGHT
00001580  BA7C 0001                311              CMP     #1,D5
00001584  6600 0006                312              BNE     .NOTCOLISION
00001588  303C 0000                313              MOVE.W  #0,D0
0000158C                           314  .NOTCOLISION
0000158C  BA7C 0004                315              CMP     #4,D5
00001590  6600 000A                316              BNE     .NOTTP
00001594  0479 01E0 000025C6       317              SUB.W   #30*16,(PMPOSX)
0000159C                           318  .NOTTP
0000159C  D179 000025C6            319              ADD.W   D0,(PMPOSX)
000015A2  6000 007C                320              BRA     .DONE
000015A6                           321  .ACTXLEFT
000015A6  4EB9 000019D2            322              JSR     COLWALLLEFT
000015AC  BA7C 0001                323              CMP     #1,D5
000015B0  6600 0006                324              BNE     .NOTCOLISION2
000015B4  303C 0000                325              MOVE.W  #0,D0
000015B8                           326  .NOTCOLISION2
000015B8  BA7C 0004                327              CMP     #4,D5
000015BC  6600 000A                328              BNE     .NOTTP2
000015C0  0679 01E0 000025C6       329              ADD.W   #30*16,(PMPOSX)
000015C8                           330  .NOTTP2
000015C8  9179 000025C6            331              SUB.W   D0,(PMPOSX)
000015CE  6000 0050                332              BRA     .DONE
000015D2                           333      
000015D2                           334  .ACTYDOWN
000015D2  4EB9 00001A14            335              JSR     COLWALLDOWN
000015D8  BA7C 0001                336              CMP     #1,D5
000015DC  6600 0006                337              BNE     .NOTCOLISION3
000015E0  303C 0000                338              MOVE.W  #0,D0
000015E4                           339  .NOTCOLISION3
000015E4  D179 000025C8            340              ADD.W   D0,(PMPOSY)
000015EA  6000 0034                341              BRA     .DONE
000015EE                           342  .ACTYUP     
000015EE  4EB9 00001A50            343              JSR     COLWALLUP
000015F4  BA7C 0001                344              CMP     #1,D5
000015F8  6600 0006                345              BNE     .NOTCOLISION4
000015FC  303C 0000                346              MOVE.W  #0,D0
00001600                           347  .NOTCOLISION4
00001600  9179 000025C8            348              SUB.W   D0,(PMPOSY)
00001606  6000 0018                349              BRA     .DONE
0000160A                           350              
0000160A                           351              
0000160A                           352              ;IF NOT MULT DO
0000160A                           353  .NOTMULT     
0000160A  B83C 0000                354              CMP.B     #0,D4
0000160E  6796                     355              BEQ     .ACTXLEFT
00001610  B83C 0001                356              CMP.B     #1,D4
00001614  6700 FF64                357              BEQ     .ACTXRIGHT
00001618  B83C 0002                358              CMP.B     #2,D4
0000161C  67D0                     359              BEQ     .ACTYUP
0000161E  60B2                     360              BRA     .ACTYDOWN
00001620                           361  .DONE
00001620                           362              ;RESTORE
00001620  4EB9 00001A8E            363              JSR     GETPOINTS
00001626  13C4 000025CF            364              MOVE.B  D4,(PMLAMO)
0000162C                           365              
0000162C  4CDF 007F                366              MOVEM.L (A7)+,D0-D6
00001630                           367              
00001630  4E75                     368              RTS
00001632                           369                          
00001632                           370  ; ------------------------------------------------------------------------------
00001632                           371  PMPLOT
00001632                           372  ; PLOT THE BALL.
00001632                           373  ; INPUT    : NONE 
00001632                           374  ; OUTPUT   : NONE
00001632                           375  ; MODIFIES : NONE
00001632                           376  ; ------------------------------------------------------------------------------
00001632                           377  
00001632  48E7 F800                378              MOVEM.L D0-D4,-(A7)
00001636                           379  
00001636                           380              ;SET PEN COLOR
00001636  303C 0050                381              MOVE.W  #80,D0
0000163A  7200                     382              MOVE.L  #$0000,D1
0000163C  4E4F                     383              TRAP    #15
0000163E                           384              
0000163E                           385              ;SET FILL COLOR
0000163E  303C 0051                386              MOVE.W  #81,D0
00001642  223C 0000FFFF            387              MOVE.L  #PMFCOL,D1
00001648  4E4F                     388              TRAP    #15
0000164A                           389              
0000164A                           390              ;DRAW QUIET
0000164A  4EB9 000016CC            391              JSR     .FULLDRAW
00001650  1A39 000021BE            392              MOVE.B  (KBDVAL),D5
00001656  CA3C 000F                393              AND.B   #$0F,D5
0000165A                           394  
0000165A                           395              ;CHECK KBDVAL
0000165A  BA3C 0001                396              CMP.B  #$1,D5             ;LEFT
0000165E  6700 002E                397              BEQ     .DLEFT
00001662  BA3C 0002                398              CMP.B  #$2,D5             ;UP
00001666  6700 001C                399              BEQ     .DUP
0000166A  BA3C 0004                400              CMP.B  #$4,D5             ;RIGHT
0000166E  6700 000A                401              BEQ     .DRIGHT
00001672  BA3C 0008                402              CMP.B  #$8,D5             ;DOWN
00001676  6700 0020                403              BEQ     .DDOWN
0000167A                           404              
0000167A                           405              ;DRAW MOVEMENT
0000167A                           406  .DRIGHT
0000167A  4EB9 00001722            407              JSR     .RIGHTDRAW
00001680  6000 0034                408              BRA     .DRAW_MOUTH3
00001684                           409  .DUP
00001684  4EB9 00001754            410              JSR     .UPDRAW
0000168A  6000 0020                411              BRA     .DRAW_MOUTH2
0000168E                           412  
0000168E                           413  .DLEFT
0000168E  4EB9 000016F0            414              JSR     .LEFTDRAW
00001694  6000 000C                415              BRA     .DRAW_MOUTH1
00001698                           416  
00001698                           417  .DDOWN
00001698  4EB9 00001786            418              JSR     .DOWNDRAW
0000169E  6000 0020                419              BRA     .DRAW_MOUTH4
000016A2                           420              
000016A2                           421  .DRAW_MOUTH1            
000016A2  4EB9 000017B8            422              JSR     .SET_MOUTHLEFT
000016A8  6000 001C                423              BRA     .DDONE
000016AC                           424  .DRAW_MOUTH2            
000016AC  4EB9 000017F4            425              JSR     .SET_MOUTHUP
000016B2  6000 0012                426              BRA     .DDONE
000016B6                           427  .DRAW_MOUTH3            
000016B6  4EB9 000017D6            428              JSR     .SET_MOUTHRIGHT
000016BC  6000 0008                429              BRA     .DDONE
000016C0                           430  .DRAW_MOUTH4            
000016C0  4EB9 00001812            431              JSR     .SET_MOUTHDOWN
000016C6                           432  .DDONE
000016C6  4CDF 001F                433              MOVEM.L (A7)+,D0-D4
000016CA                           434              
000016CA  4E75                     435              RTS
000016CC                           436  
000016CC                           437  
000016CC                           438  ;INTERNAL SUBRUTINES FOR PACMAN PLOT-------------------------------------------------------------
000016CC                           439  
000016CC                           440  .FULLDRAW
000016CC                           441              ;SET COORDS
000016CC  3239 000025C6            442              MOVE.W  (PMPOSX),D1
000016D2  5141                     443              SUB.W   #PMRAD,D1
000016D4  3439 000025C8            444              MOVE.W  (PMPOSY),D2
000016DA  5142                     445              SUB.W   #PMRAD,D2
000016DC                           446              
000016DC  3601                     447              MOVE.W  D1,D3
000016DE  0643 0010                448              ADD.W   #PMRAD*2,D3
000016E2  3802                     449              MOVE.W  D2,D4
000016E4  0644 0010                450              ADD.W   #PMRAD*2,D4
000016E8                           451              
000016E8                           452              ;DRAW PAC-MAN
000016E8  303C 0058                453              MOVE.W  #88,D0
000016EC  4E4F                     454              TRAP    #15
000016EE                           455              
000016EE  4E75                     456              RTS
000016F0                           457  .LEFTDRAW
000016F0                           458              
000016F0                           459              
000016F0  303C 0054                460              MOVE.W  #84,D0
000016F4  3239 000025C6            461              MOVE.W  (PMPOSX),D1                   ;FINAL COORD OF THE FIRST LINE
000016FA  5141                     462              SUB.W   #PMRAD,D1
000016FC  3439 000025C8            463              MOVE.W  (PMPOSY),D2
00001702  5142                     464              SUB.W   #PMRAD,D2
00001704                           465              
00001704  3639 000025C6            466              MOVE.W  (PMPOSX),D3                   ;ORIGINAL COORD FIRST LINE
0000170A  3839 000025C8            467              MOVE.W  (PMPOSY),D4
00001710                           468              
00001710  4E4F                     469              TRAP    #15
00001712                           470             
00001712  303C 0055                471              MOVE.W  #85,D0                        ;DRAW SECOND LINE
00001716                           472              
00001716  3203                     473              MOVE.W  D3,D1
00001718  3404                     474              MOVE.W  D4,D2
0000171A  5042                     475              ADD.W   #PMRAD,D2
0000171C  5141                     476              SUB.W   #PMRAD,D1
0000171E                           477              
0000171E  4E4F                     478              TRAP    #15
00001720                           479              
00001720                           480              
00001720  4E75                     481              RTS
00001722                           482              
00001722                           483  .RIGHTDRAW
00001722                           484              
00001722                           485              
00001722  303C 0054                486              MOVE.W  #84,D0
00001726  3239 000025C6            487              MOVE.W  (PMPOSX),D1                   ;FINAL COORD OF THE FIRST LINE
0000172C  5041                     488              ADD.W   #PMRAD,D1
0000172E  3439 000025C8            489              MOVE.W  (PMPOSY),D2
00001734  5042                     490              ADD.W   #PMRAD,D2
00001736                           491              
00001736  3639 000025C6            492              MOVE.W  (PMPOSX),D3                   ;ORIGINAL COORD FIRST LINE
0000173C  3839 000025C8            493              MOVE.W  (PMPOSY),D4
00001742                           494              
00001742  4E4F                     495              TRAP    #15
00001744                           496             
00001744  303C 0055                497              MOVE.W  #85,D0                        ;DRAW SECOND LINE
00001748                           498              
00001748  3203                     499              MOVE.W  D3,D1
0000174A  3404                     500              MOVE.W  D4,D2
0000174C  5142                     501              SUB.W   #PMRAD,D2
0000174E  5041                     502              ADD.W   #PMRAD,D1
00001750                           503              
00001750  4E4F                     504              TRAP    #15
00001752                           505              
00001752                           506              
00001752  4E75                     507              RTS
00001754                           508  .UPDRAW
00001754                           509              
00001754                           510              
00001754  303C 0054                511              MOVE.W  #84,D0
00001758  3239 000025C6            512              MOVE.W  (PMPOSX),D1                   ;FINAL COORD OF THE FIRST LINE
0000175E  5141                     513              SUB.W   #PMRAD,D1
00001760  3439 000025C8            514              MOVE.W  (PMPOSY),D2
00001766  5142                     515              SUB.W   #PMRAD,D2
00001768                           516              
00001768  3639 000025C6            517              MOVE.W  (PMPOSX),D3                   ;ORIGINAL COORD FIRST LINE
0000176E  3839 000025C8            518              MOVE.W  (PMPOSY),D4
00001774                           519              
00001774  4E4F                     520              TRAP    #15
00001776                           521             
00001776  303C 0055                522              MOVE.W  #85,D0                        ;DRAW SECOND LINE
0000177A                           523              
0000177A  3203                     524              MOVE.W  D3,D1
0000177C  3404                     525              MOVE.W  D4,D2
0000177E  5142                     526              SUB.W   #PMRAD,D2
00001780  5041                     527              ADD.W   #PMRAD,D1
00001782                           528              
00001782  4E4F                     529              TRAP    #15
00001784                           530              
00001784                           531              
00001784  4E75                     532              RTS
00001786                           533              
00001786                           534  .DOWNDRAW
00001786                           535              
00001786                           536              
00001786  303C 0054                537              MOVE.W  #84,D0
0000178A  3239 000025C6            538              MOVE.W  (PMPOSX),D1                   ;FINAL COORD OF THE FIRST LINE
00001790  5141                     539              SUB.W   #PMRAD,D1
00001792  3439 000025C8            540              MOVE.W  (PMPOSY),D2
00001798  5042                     541              ADD.W   #PMRAD,D2
0000179A                           542              
0000179A  3639 000025C6            543              MOVE.W  (PMPOSX),D3                   ;ORIGINAL COORD FIRST LINE
000017A0  3839 000025C8            544              MOVE.W  (PMPOSY),D4
000017A6                           545              
000017A6  4E4F                     546              TRAP    #15
000017A8                           547             
000017A8  303C 0055                548              MOVE.W  #85,D0                        ;DRAW SECOND LINE
000017AC                           549              
000017AC  3203                     550              MOVE.W  D3,D1
000017AE  3404                     551              MOVE.W  D4,D2
000017B0  5042                     552              ADD.W   #PMRAD,D2
000017B2  5041                     553              ADD.W   #PMRAD,D1
000017B4                           554              
000017B4  4E4F                     555              TRAP    #15
000017B6                           556              
000017B6                           557              
000017B6  4E75                     558              RTS
000017B8                           559  
000017B8                           560              
000017B8                           561  .SET_MOUTHLEFT
000017B8                           562              
000017B8  303C 0051                563              MOVE.W  #81,D0                         ;SET BLACK
000017BC  7200                     564              MOVE.L  #$0000,D1
000017BE  4E4F                     565              TRAP    #15
000017C0                           566              
000017C0  303C 0059                567              MOVE.W  #89,D0                         ;FILL
000017C4  3239 000025C6            568              MOVE.W  (PMPOSX),D1
000017CA  5541                     569              SUBQ.W   #2,D1
000017CC  3439 000025C8            570              MOVE.W  (PMPOSY),D2
000017D2  4E4F                     571              TRAP    #15
000017D4                           572  
000017D4  4E75                     573              RTS
000017D6                           574              
000017D6                           575  .SET_MOUTHRIGHT
000017D6                           576              
000017D6  303C 0051                577              MOVE.W  #81,D0                         ;SET BLACK
000017DA  7200                     578              MOVE.L  #$0000,D1
000017DC  4E4F                     579              TRAP    #15
000017DE                           580              
000017DE  303C 0059                581              MOVE.W  #89,D0                         ;FILL
000017E2  3239 000025C6            582              MOVE.W  (PMPOSX),D1
000017E8  5441                     583              ADDQ.W   #2,D1
000017EA  3439 000025C8            584              MOVE.W  (PMPOSY),D2
000017F0  4E4F                     585              TRAP    #15
000017F2                           586  
000017F2  4E75                     587              RTS
000017F4                           588  
000017F4                           589  .SET_MOUTHUP
000017F4                           590              
000017F4  303C 0051                591              MOVE.W  #81,D0                         ;SET BLACK
000017F8  7200                     592              MOVE.L  #$0000,D1
000017FA  4E4F                     593              TRAP    #15
000017FC                           594              
000017FC  303C 0059                595              MOVE.W  #89,D0                         ;FILL
00001800  3239 000025C6            596              MOVE.W  (PMPOSX),D1
00001806  3439 000025C8            597              MOVE.W  (PMPOSY),D2
0000180C  5542                     598              SUBQ.W   #2,D2
0000180E  4E4F                     599              TRAP    #15
00001810                           600  
00001810  4E75                     601              RTS
00001812                           602  
00001812                           603  .SET_MOUTHDOWN
00001812                           604              
00001812  303C 0051                605              MOVE.W  #81,D0                         ;SET BLACK
00001816  7200                     606              MOVE.L  #$0000,D1
00001818  4E4F                     607              TRAP    #15
0000181A                           608              
0000181A  303C 0059                609              MOVE.W  #89,D0                         ;FILL
0000181E  3239 000025C6            610              MOVE.W  (PMPOSX),D1
00001824  3439 000025C8            611              MOVE.W  (PMPOSY),D2
0000182A  5442                     612              ADDQ.W   #2,D2
0000182C  4E4F                     613              TRAP    #15
0000182E                           614  
0000182E  4E75                     615              RTS
00001830                           616  
00001830                           617  
00001830                           618  
00001830                           619  
00001830                           620  
00001830                           621  
00001830                           622  
00001830                           623  
00001830                           624  
00001830                           625  
00001830                           626  
00001830                           627  
00001830                           628  
00001830                           629  
00001830                           630  
00001830                           631  
00001830                           632  
00001830                           633  
00001830                           634  
00001830                           635  
00001830                           636  
00001830                           637  
00001830                           638  
00001830                           639  
00001830                           640  
00001830                           641  
00001830                           642  -------------------- end include --------------------
00001830                           643              INCLUDE "SCORE.X68"
00001830                           644  ; ==============================================================================
00001830                           645  ; SCOREBOARD MANAGEMENT
00001830                           646  ; ==============================================================================
00001830                           647              
00001830                           648  ; ------------------------------------------------------------------------------
00001830                           649  SCOINIT
00001830                           650  ; INITIALIZE SCOREBOARD
00001830                           651  ; INPUT    : NONE 
00001830                           652  ; OUTPUT   : NONE
00001830                           653  ; MODIFIES : NONE
00001830                           654  ; ------------------------------------------------------------------------------
00001830  4279 000025DE            655              CLR.W   (SCOPOINTS)
00001836  33FC 0003 000025DC       656              MOVE.W  #3,(SCOLIFE)
0000183E  4E75                     657              RTS
00001840                           658              
00001840                           659  ; ------------------------------------------------------------------------------
00001840                           660  SCOPLOT
00001840                           661  ; PLOT THE SCOREBOARD
00001840                           662  ; INPUT    : NONE 
00001840                           663  ; OUTPUT   : NONE
00001840                           664  ; MODIFIES : NONE
00001840                           665  ; ------------------------------------------------------------------------------
00001840                           666              
00001840  48E7 C040                667               MOVEM.L D0-D1/A1,-(A7)
00001844                           668  
00001844                           669              ; SET BACKGROUND COLOR
00001844  103C 0051                670              MOVE.B  #81,D0
00001848  7200                     671              MOVE.L  #SCOFCOL,D1
0000184A  4E4F                     672              TRAP    #15
0000184C                           673              
0000184C                           674              ; SET FIRST LINE POSITION
0000184C  103C 000B                675              MOVE.B  #11,D0
00001850  323C 0101                676              MOVE.W  #SCOLINE1,D1
00001854  4E4F                     677              TRAP    #15
00001856                           678  
00001856                           679              ; PRINT FIRST LINE
00001856  43F9 0000188E            680              LEA     .TXT1,A1            ;PUT FIRST STRING IN A1
0000185C  4281                     681              CLR.L   D1
0000185E  3239 000025DE            682              MOVE.W  (SCOPOINTS),D1
00001864  103C 0011                683              MOVE.B  #17,D0
00001868  4E4F                     684              TRAP    #15
0000186A                           685  
0000186A                           686              ; SET SECOND LINE POSITION
0000186A  103C 000B                687              MOVE.B  #11,D0
0000186E  323C 0102                688              MOVE.W  #SCOLINE2,D1       
00001872  4E4F                     689              TRAP    #15
00001874                           690  
00001874                           691              ; PRINT SECOND LINE
00001874  43F9 00001897            692              LEA     .TXT2,A1
0000187A  4281                     693              CLR.L   D1
0000187C  3239 000025DC            694              MOVE.W  (SCOLIFE),D1
00001882  103C 0011                695              MOVE.B  #17,D0
00001886  4E4F                     696              TRAP    #15
00001888                           697              
00001888  4CDF 0203                698              MOVEM.L (A7)+,D0-D1/A1
0000188C                           699              
0000188C  4E75                     700              RTS
0000188E                           701  
0000188E= 50 4F 49 4E 54 53 ...    702  .TXT1       DC.B    'POINTS :',0      ;0 IS END OF STRING
00001897= 4C 49 46 45 53 20 ...    703  .TXT2       DC.B    'LIFES  :',0
000018A0                           704  
000018A0                           705  
000018A0  4E75                     706              RTS
000018A2                           707  
000018A2                           708  
000018A2                           709  -------------------- end include --------------------
000018A2                           710              INCLUDE "SYSCONST.X68"
000018A2                           711  ; ==============================================================================
000018A2                           712  ; SYSTEM CONSTANTS
000018A2                           713  ; ==============================================================================
000018A2                           714  
000018A2                           715  ; --- SCREEN RELATED CONSTANTS -------------------------------------------------
000018A2                           716  
000018A2  =00000280                717  SCRWIDTH    EQU     640                     ; SCREEN WIDTH
000018A2  =00000280                718  SCRHEIGH    EQU     640                     ; SCREEN HEIGHT
000018A2                           719  
000018A2                           720  ;---KEYCODES--------------------------------------------------------------------
000018A2                           721  
000018A2  =00000025                722  KBDLEFT     EQU     $25
000018A2  =00000026                723  KBDUP       EQU     $26
000018A2  =00000027                724  KBDRIGHT    EQU     $27
000018A2  =00000028                725  KBDDOWN     EQU     $28
000018A2  =00000020                726  KBDFIRE1    EQU     ' '
000018A2  =0000004D                727  KBDFIRE2    EQU     'M'                         
000018A2  =00000010                728  KBDFIRE3    EQU     $10
000018A2  =00000050                729  KBDPAUSE    EQU     'P'
000018A2                           730  
000018A2                           731  
000018A2                           732  
000018A2                           733  
000018A2                           734  
000018A2                           735  
000018A2                           736  
000018A2                           737  
000018A2                           738  
000018A2                           739  -------------------- end include --------------------
000018A2                           740              INCLUDE "SYSTEM.X68"
000018A2                           741  ; ==============================================================================
000018A2                           742  ; SYSTEM
000018A2                           743  ; ==============================================================================
000018A2                           744              
000018A2                           745  ; ------------------------------------------------------------------------------
000018A2                           746  SYSINIT
000018A2                           747  ; INITIALIZE SYSTEM.
000018A2                           748  ; INPUT    : NONE
000018A2                           749  ; OUTPUT   : NONE
000018A2                           750  ; MODIFIES : NONE
000018A2                           751  ; ------------------------------------------------------------------------------
000018A2                           752              
000018A2  21FC 00001912 0080       753              MOVE.L  #SCRUPD,($80+0*4)          ;INSTALL SUBRUTINE TO TRAP #0
000018AA  21FC 00001948 0084       754              MOVE.L  #KBDUPD,($80+1*4)          ;INSTALL SUBRUTINE TO TRAP #1
000018B2                           755              
000018B2                           756              
000018B2  21FC 0000192C 0064       757              MOVE.L  #SCRTIM,($60+1*4)          ;INSTALL INTERRUPT #1
000018BA                           758              
000018BA  4EB9 000018CE            759              JSR     SCRINIT
000018C0  4EB9 0000193A            760              JSR     KBDINIT
000018C6                           761              
000018C6                           762              
000018C6  40E7                     763              MOVE.W  SR,-(A7)
000018C8  0257 D8FF                764              ANDI.W  #$D8FF,(A7)                ;BIT SUPERVISOR TO O AND INTERRPUT MASK 000 (FOR REACTIVATE INTERRUPTIONS)             
000018CC  4E73                     765              RTE
000018CE                           766     
000018CE                           767  ; ------------------------------------------------------------------------------
000018CE                           768  SCRINIT
000018CE                           769  ; INIT SCREEN. SET SCREEN RESOLUTION, SET WINDOWED MODE, CLEAR SCREEN, ENABLE BUFFER
000018CE                           770  ; ENABLE TIMED INTERRUPTION
000018CE                           771  ; INPUT    : NONE
000018CE                           772  ; OUTPUT   : NONE
000018CE                           773  ; MODIFIES : NONE
000018CE                           774  ; ------------------------------------------------------------------------------
000018CE                           775  
000018CE  48E7 C000                776              MOVEM.L D0-D1,-(A7)                 ;SAFE REGISTERS IN STACK
000018D2                           777  
000018D2                           778              ; SET SCREEN RESOLUTION
000018D2  103C 0021                779              MOVE.B  #33,D0
000018D6  223C 02800280            780              MOVE.L  #SCRWIDTH<<16|SCRHEIGH,D1
000018DC  4E4F                     781              TRAP    #15
000018DE                           782              
000018DE                           783              ; SET WINDOWED MODE
000018DE  7201                     784              MOVE.L  #1,D1
000018E0  4E4F                     785              TRAP    #15
000018E2                           786              
000018E2                           787              ; ENABLE DOUBLE BUFFER
000018E2  103C 005C                788              MOVE.B  #92,D0
000018E6  123C 0011                789              MOVE.B  #17,D1
000018EA  4E4F                     790              TRAP    #15
000018EC                           791              
000018EC                           792              ; CLEAR SCREEN
000018EC  103C 000B                793              MOVE.B  #11,D0
000018F0  323C FF00                794              MOVE.W  #$FF00,D1
000018F4  4E4F                     795              TRAP    #15
000018F6                           796              
000018F6                           797              ;ENABLE TIMED INTERRPUT
000018F6  303C 0020                798              MOVE.W  #32,D0
000018FA  123C 0006                799              MOVE.B  #6,D1
000018FE  143C 0081                800              MOVE.B  #$81,D2                   ;INDICATE THAT INTERRUPT 1 IS ACTIVATED PERIODICALLY
00001902  7614                     801              MOVE.L  #20,D3                    ;INDICATE THE MILISECONDS FOR THAT PERIOD (20 ms == 50 FPS)
00001904  4E4F                     802              TRAP    #15
00001906                           803              
00001906                           804              ;CLEAR INTERRUPT COUNTER
00001906  4239 000021C1            805              CLR.B   (SCRINTCT)
0000190C                           806              
0000190C  4CDF 0003                807              MOVEM.L (A7)+,D0-D1               ;RESTORE REGISTERS FROM STACK
00001910                           808              
00001910  4E75                     809              RTS
00001912                           810  
00001912                           811  
00001912                           812              
00001912                           813  ;------------------------------------------------------------------------------            
00001912                           814  SCRUPD
00001912                           815  ; UPDATES DOUBLE BUFFER
00001912                           816  ; INPUT    : NONE
00001912                           817  ; OUTPUT   : NONE
00001912                           818  ; MODIFIES : NONE
00001912                           819  ; ------------------------------------------------------------------------------
00001912                           820  
00001912  48E7 C000                821              MOVEM.L D0-D1,-(A7)
00001916                           822              
00001916                           823              ;SWITCH BUFFERS
00001916  103C 005E                824              MOVE.B #94,D0
0000191A  4E4F                     825              TRAP #15
0000191C                           826              
0000191C                           827              ;CLEAR HIDDEN BUFFER
0000191C  103C 000B                828              MOVE.B  #11,D0
00001920  323C FF00                829              MOVE.W  #$FF00,D1
00001924  4E4F                     830              TRAP    #15
00001926                           831              
00001926  4CDF 0003                832              MOVEM.L (A7)+,D0-D1
0000192A                           833              
0000192A  4E73                     834              RTE
0000192C                           835              
0000192C                           836  ; ------------------------------------------------------------------------------
0000192C                           837  SCRTIM
0000192C                           838  ; TIMED INTERRUPT SERVICE ROUTINE
0000192C                           839  ; INPUT    : NONE
0000192C                           840  ; OUTPUT   : NONE
0000192C                           841  ; MODIFIES : NONE
0000192C                           842  ; ------------------------------------------------------------------------------
0000192C  5239 000021C1            843              ADDQ.B  #1,(SCRINTCT)
00001932  5239 000021C2            844              ADDQ.B  #1,(SCRCYCCT)
00001938  4E73                     845              RTE
0000193A                           846              
0000193A                           847  ;------------------------------------------------------------------------------            
0000193A                           848  KBDINIT
0000193A                           849  ; INIT THE KEYBOARD
0000193A                           850  ; INPUT    : NONE
0000193A                           851  ; OUTPUT   : NONE
0000193A                           852  ; MODIFIES : NONE
0000193A                           853  ; ------------------------------------------------------------------------------
0000193A                           854  
0000193A  4239 000021BE            855              CLR.B   (KBDVAL)
00001940  4239 000021C0            856              CLR.B   (KBDEDGE)
00001946                           857  
00001946  4E75                     858              RTS
00001948                           859  
00001948                           860  ;------------------------------------------------------------------------------            
00001948                           861  KBDUPD
00001948                           862  ; UPDATES KEYBOARD INFO
00001948                           863  ; 3 -> DOWN     (HEX: 8)
00001948                           864  ; 2 -> RIGHT    (HEX: 4)
00001948                           865  ; 1 -> UP       (HEX: 2)
00001948                           866  ; 0 -> LEFT     (HEX: 1)
00001948                           867  ; ------------------------------------------------------------------------------
00001948                           868              
00001948  48E7 F800                869              MOVEM.L D0-D4,-(A7)
0000194C                           870              
0000194C  303C 0013                871              MOVE.W  #19,D0
00001950                           872              ;GET INFO OF THE KEYS
00001950  223C 28272625            873              MOVE.L  #KBDDOWN<<24|KBDRIGHT<<16|KBDUP<<8|KBDLEFT,D1
00001956  4E4F                     874              TRAP    #15
00001958                           875              
00001958                           876              ;CONVERT TO DESIRED FORMAT
00001958  4EB9 00001982            877              JSR .CONVERT
0000195E                           878  
0000195E                           879              ;GET KBDEDGE (IF SOME KEY HAVE CHANGED THE VALUE)
0000195E  1039 000021BE            880              MOVE.B  (KBDVAL),D0             ;D0 -> LAST KBDVAL
00001964  4600                     881              NOT.B   D0                      ;D2 -> ACTUAL KBDVAL
00001966  C002                     882              AND.B   D2,D0
00001968  13C0 000021C0            883              MOVE.B  D0,(KBDEDGE)
0000196E                           884              
0000196E                           885         
0000196E  B03C 0000                886              CMP.B   #0,D0
00001972  6700 0008                887              BEQ     .NOACT          
00001976                           888              
00001976                           889              ;STORE NEW KBDVAL
00001976  13C2 000021BE            890              MOVE.B  D2,(KBDVAL)
0000197C                           891  .NOACT
0000197C                           892              
0000197C  4CDF 001F                893              MOVEM.L (A7)+,D0-D4
00001980                           894              
00001980  4E73                     895              RTE    
00001982                           896              
00001982                           897  .CONVERT 
00001982  363C 0003                898              MOVE.W  #3,D3
00001986                           899              
00001986  E189                     900  .LOOP       LSL.L   #8,D1
00001988  E312                     901              ROXL.B  #1,D2
0000198A  51CB FFFA                902              DBRA.W  D3,.LOOP
0000198E  4E75                     903              RTS
00001990                           904             
00001990                           905  
00001990                           906  ;------------------------------------------------------------------------------            
00001990                           907  COLWALLRIGHT
00001990                           908  ; COLLISION PAC-MAN WITH WALL
00001990                           909  ; INPUT    : NONE
00001990                           910  ; OUTPUT   : NONE
00001990                           911  ; MODIFIES : NONE
00001990                           912  ; ------------------------------------------------------------------------------
00001990                           913  
00001990  48E7 F800                914              MOVEM.L D0-D4,-(A7)
00001994                           915  
00001994  3039 000025C6            916              MOVE.W  (PMPOSX),D0
0000199A  5140                     917              SUB.W   #8,D0
0000199C  3239 000025C8            918              MOVE.W  (PMPOSY),D1
000019A2  5041                     919              ADD.W   #8,D1
000019A4                           920              
000019A4  81FC 0010                921              DIVS.W  #16,D0
000019A8  83FC 0010                922              DIVS.W  #16,D1
000019AC                           923              
000019AC  5940                     924              SUB.W   #4,D0                   ;LI RESTAM 4 PERQUE LA MATRIU ESTA A UNA DISTANCIA DE 64 PIXELS DE LA PANTALLA
000019AE  5941                     925              SUB.W   #4,D1
000019B0                           926              
000019B0  41F9 000021C4            927              LEA.L   MAPVAR,A0
000019B6                           928              
000019B6  5240                     929              ADD.W   #1,D0
000019B8  5341                     930              SUB.W   #1,D1
000019BA  C2FC 0020                931              MULU.W  #32,D1
000019BE  D041                     932              ADD.W   D1,D0
000019C0                           933              
000019C0  3240                     934              MOVE.W  D0,A1
000019C2  13C0 000025C4            935              MOVE.B  D0,POSCON
000019C8                           936  
000019C8  1A29 21C4                937              MOVE.B  MAPVAR(A1),D5
000019CC                           938              
000019CC  4CDF 001F                939              MOVEM.L (A7)+,D0-D4
000019D0                           940              
000019D0  4E75                     941              RTS
000019D2                           942  
000019D2                           943  
000019D2                           944  ;------------------------------------------------------------------------------            
000019D2                           945  COLWALLLEFT
000019D2                           946  ; COLLISION PAC-MAN WITH WALL
000019D2                           947  ; INPUT    : NONE
000019D2                           948  ; OUTPUT   : NONE
000019D2                           949  ; MODIFIES : NONE
000019D2                           950  ; ------------------------------------------------------------------------------
000019D2                           951  
000019D2  48E7 F800                952              MOVEM.L D0-D4,-(A7)
000019D6                           953  
000019D6  3039 000025C6            954              MOVE.W  (PMPOSX),D0
000019DC  5C40                     955              ADD.W   #6,D0
000019DE  3239 000025C8            956              MOVE.W  (PMPOSY),D1
000019E4  5041                     957              ADD.W   #8,D1
000019E6                           958              
000019E6  81FC 0010                959              DIVS.W  #16,D0
000019EA  83FC 0010                960              DIVS.W  #16,D1
000019EE                           961              
000019EE  5940                     962              SUB.W   #4,D0                   ;LI RESTAM 4 PERQUE LA MATRIU ESTA A UNA DISTANCIA DE 64 PIXELS DE LA PANTALLA
000019F0  5941                     963              SUB.W   #4,D1
000019F2                           964              
000019F2  41F9 000021C4            965              LEA.L   MAPVAR,A0
000019F8                           966              
000019F8  5340                     967              SUB.W   #1,D0
000019FA  5341                     968              SUB.W   #1,D1
000019FC  C2FC 0020                969              MULU.W  #32,D1
00001A00  D041                     970              ADD.W   D1,D0
00001A02                           971  
00001A02  3240                     972              MOVE.W  D0,A1
00001A04  13C0 000025C4            973              MOVE.B  D0,POSCON
00001A0A                           974  
00001A0A  1A29 21C4                975              MOVE.B  MAPVAR(A1),D5               
00001A0E                           976  
00001A0E                           977              
00001A0E  4CDF 001F                978              MOVEM.L (A7)+,D0-D4
00001A12                           979              
00001A12  4E75                     980              RTS
00001A14                           981  
00001A14                           982  ;------------------------------------------------------------------------------            
00001A14                           983  COLWALLDOWN
00001A14                           984  ; COLLISION PAC-MAN WITH WALL
00001A14                           985  ; INPUT    : NONE
00001A14                           986  ; OUTPUT   : NONE
00001A14                           987  ; MODIFIES : NONE
00001A14                           988  ; ------------------------------------------------------------------------------
00001A14                           989  
00001A14  48E7 F800                990              MOVEM.L D0-D4,-(A7)
00001A18                           991  
00001A18  3039 000025C6            992              MOVE.W  (PMPOSX),D0
00001A1E                           993              ;ADD.W   #8,D0
00001A1E  3239 000025C8            994              MOVE.W  (PMPOSY),D1
00001A24  5041                     995              ADD.W   #8,D1
00001A26                           996              
00001A26  81FC 0010                997              DIVS.W  #16,D0
00001A2A  83FC 0010                998              DIVS.W  #16,D1
00001A2E                           999              
00001A2E  5940                    1000              SUB.W   #4,D0                   ;LI RESTAM 4 PERQUE LA MATRIU ESTA A UNA DISTANCIA DE 64 PIXELS DE LA PANTALLA
00001A30  5941                    1001              SUB.W   #4,D1
00001A32                          1002              
00001A32  41F9 000021C4           1003              LEA.L   MAPVAR,A0
00001A38                          1004              
00001A38  C2FC 0020               1005              MULU.W  #32,D1
00001A3C  D041                    1006              ADD.W   D1,D0
00001A3E                          1007  
00001A3E  3240                    1008              MOVE.W  D0,A1
00001A40  13C0 000025C4           1009              MOVE.B  D0,POSCON
00001A46                          1010  
00001A46  1A29 21C4               1011              MOVE.B  MAPVAR(A1),D5 
00001A4A                          1012  
00001A4A                          1013              
00001A4A  4CDF 001F               1014              MOVEM.L (A7)+,D0-D4
00001A4E                          1015              
00001A4E  4E75                    1016              RTS
00001A50                          1017  
00001A50                          1018  
00001A50                          1019  ;------------------------------------------------------------------------------            
00001A50                          1020  COLWALLUP
00001A50                          1021  ; COLLISION PAC-MAN WITH WALL
00001A50                          1022  ; INPUT    : NONE
00001A50                          1023  ; OUTPUT   : NONE
00001A50                          1024  ; MODIFIES : NONE
00001A50                          1025  ; ------------------------------------------------------------------------------
00001A50                          1026  
00001A50  48E7 F800               1027              MOVEM.L D0-D4,-(A7)
00001A54                          1028  
00001A54  3039 000025C6           1029              MOVE.W  (PMPOSX),D0
00001A5A                          1030              ;SUB.W   #8,D0
00001A5A  3239 000025C8           1031              MOVE.W  (PMPOSY),D1
00001A60  5C41                    1032              ADD.W   #6,D1
00001A62                          1033              
00001A62                          1034              
00001A62  81FC 0010               1035              DIVS.W  #16,D0
00001A66  83FC 0010               1036              DIVS.W  #16,D1
00001A6A                          1037              
00001A6A  5940                    1038              SUB.W   #4,D0                   ;LI RESTAM 4 PERQUE LA MATRIU ESTA A UNA DISTANCIA DE 64 PIXELS DE LA PANTALLA
00001A6C  5941                    1039              SUB.W   #4,D1
00001A6E                          1040              
00001A6E  41F9 000021C4           1041              LEA.L   MAPVAR,A0
00001A74                          1042              
00001A74  5341                    1043              SUB.W   #1,D1
00001A76                          1044              ;CMP     #1,D1
00001A76                          1045              ;BLO     BUCLE4
00001A76  C2FC 0020               1046              MULU.W  #32,D1
00001A7A  D041                    1047              ADD.W   D1,D0
00001A7C                          1048  
00001A7C                          1049  ;BUCLE4            
00001A7C  3240                    1050              MOVE.W  D0,A1
00001A7E  13C0 000025C4           1051              MOVE.B  D0,POSCON
00001A84                          1052  
00001A84  1A29 21C4               1053              MOVE.B  MAPVAR(A1),D5 
00001A88                          1054  
00001A88                          1055              ;MOVE.B  #0,D5
00001A88                          1056              
00001A88  4CDF 001F               1057              MOVEM.L (A7)+,D0-D4
00001A8C                          1058              
00001A8C  4E75                    1059              RTS
00001A8E                          1060  
00001A8E                          1061  
00001A8E                          1062  ;------------------------------------------------------------------------------            
00001A8E                          1063  GETPOINTS
00001A8E                          1064  ; COLLISION PAC-MAN WITH WALL
00001A8E                          1065  ; INPUT    : NONE
00001A8E                          1066  ; OUTPUT   : NONE
00001A8E                          1067  ; MODIFIES : NONE
00001A8E                          1068  ; ------------------------------------------------------------------------------
00001A8E                          1069  
00001A8E  48E7 F800               1070              MOVEM.L D0-D4,-(A7)
00001A92                          1071  
00001A92  3039 000025C6           1072              MOVE.W  (PMPOSX),D0
00001A98                          1073              ;SUB.W   #8,D0
00001A98  3239 000025C8           1074              MOVE.W  (PMPOSY),D1
00001A9E  0641 0010               1075              ADD.W   #16,D1
00001AA2                          1076              
00001AA2                          1077              
00001AA2  81FC 0010               1078              DIVS.W  #16,D0
00001AA6  83FC 0010               1079              DIVS.W  #16,D1
00001AAA                          1080              
00001AAA  5940                    1081              SUB.W   #4,D0                   ;LI RESTAM 4 PERQUE LA MATRIU ESTA A UNA DISTANCIA DE 64 PIXELS DE LA PANTALLA
00001AAC  5941                    1082              SUB.W   #4,D1
00001AAE                          1083                          
00001AAE  5341                    1084              SUB.W   #1,D1
00001AB0  C2FC 0020               1085              MULU.W  #32,D1
00001AB4  D041                    1086              ADD.W   D1,D0
00001AB6                          1087  
00001AB6  3240                    1088              MOVE.W  D0,A1
00001AB8  1A29 21C4               1089              MOVE.B  MAPVAR(A1),D5
00001ABC                          1090              
00001ABC  BA7C 0000               1091              CMP     #0,D5
00001AC0  6700 003A               1092              BEQ     .DONE
00001AC4  BA7C 0002               1093              CMP     #2,D5
00001AC8  6700 0020               1094              BEQ     .POINT
00001ACC  BA7C 0003               1095              CMP     #3,D5
00001AD0  6700 0006               1096              BEQ     .BPOINT
00001AD4  6600 0026               1097              BNE     .DONE
00001AD8                          1098  .BPOINT
00001AD8  137C 0000 21C4          1099              MOVE.B  #0,MAPVAR(A1)
00001ADE  0679 0032 000025DE      1100              ADD.W   #50,(SCOPOINTS)
00001AE6  6600 0014               1101              BNE     .DONE
00001AEA                          1102  .POINT
00001AEA  137C 0000 21C4          1103              MOVE.B  #0,MAPVAR(A1)
00001AF0  0679 000A 000025DE      1104              ADD.W   #10,(SCOPOINTS)
00001AF8  6600 0002               1105              BNE     .DONE            
00001AFC                          1106  .DONE                        
00001AFC  4CDF 001F               1107              MOVEM.L (A7)+,D0-D4
00001B00                          1108              
00001B00  4E75                    1109              RTS
00001B02                          1110  
00001B02                          1111  
00001B02                          1112  
00001B02                          1113  
00001B02                          1114  -------------------- end include --------------------
00001B02                          1115              INCLUDE "MAP.X68"
00001B02                          1116  
00001B02                          1117  ; ------------------------------------------------------------------------------
00001B02                          1118  MAPINIT
00001B02                          1119  ; INIT MAP
00001B02                          1120  ; INPUT    : NONE
00001B02                          1121  ; OUTPUT   : NONE
00001B02                          1122  ; MODIFIES : NONE
00001B02                          1123  ; ------------------------------------------------------------------------------            
00001B02                          1124              
00001B02                          1125              ;MOVE.L  #DIBFIGWALL,($80+2*4)          ;INSTALL SUBRUTINE TO TRAP #2
00001B02                          1126              ;MOVE.L  #DIBFIGPOINT,($80+3*4)          ;INSTALL SUBRUTINE TO TRAP #3
00001B02                          1127              ;MOVE.L  #DIBFIGBPOINT,($80+4*4)          ;INSTALL SUBRUTINE TO TRAP #4
00001B02                          1128              
00001B02  48E7 FE00               1129              MOVEM.L D0-D6,-(A7)
00001B06  48E7 00C0               1130              MOVEM.L A0-A1,-(A7)
00001B0A                          1131              
00001B0A  41F8 1000               1132              LEA.L   MAPMAT,A0
00001B0E  43F9 000021C4           1133              LEA.L   MAPVAR,A1
00001B14  3C3C 0030               1134              MOVE.W  #48,D6
00001B18  343C 001F               1135              MOVE.W  #31,D2
00001B1C                          1136  BUCLE_FILA
00001B1C  3A3C 0030               1137              MOVE.W  #48,D5
00001B20  323C 001F               1138              MOVE.W  #31,D1
00001B24  0646 0010               1139              ADD.W   #16,D6
00001B28                          1140  
00001B28                          1141  BUCLE_COLUMNA
00001B28  0645 0010               1142              ADD.W   #16,D5
00001B2C                          1143  
00001B2C  1018                    1144              MOVE.B  (A0)+,D0
00001B2E  12C0                    1145              MOVE.B  D0,(A1)+
00001B30                          1146               
00001B30  B07C 0000               1147              CMP     #0,D0
00001B34  6700 0034               1148              BEQ     ZERO
00001B38  B07C 0004               1149              CMP     #4,D0
00001B3C  6700 002C               1150              BEQ     ZERO
00001B40  B07C 0001               1151              CMP     #1,D0
00001B44  6600 0008               1152              BNE     NOTWALL
00001B48  4EB9 00001BF0           1153              JSR     DIBFIGWALL
00001B4E                          1154  NOTWALL
00001B4E  B07C 0002               1155              CMP     #2,D0
00001B52  6600 0008               1156              BNE     NOTPOINT
00001B56  4EB9 00001C28           1157              JSR     DIBFIGPOINT
00001B5C                          1158  NOTPOINT
00001B5C  B07C 0003               1159              CMP     #3,D0
00001B60  6600 0008               1160              BNE     ZERO
00001B64  4EB9 00001C64           1161              JSR     DIBFIGBPOINT
00001B6A                          1162           
00001B6A                          1163  ZERO
00001B6A  51C9 FFBC               1164              DBRA    D1,BUCLE_COLUMNA  
00001B6E  51CA FFAC               1165              DBRA    D2,BUCLE_FILA
00001B72                          1166              
00001B72  4CDF 0300               1167              MOVEM.L (A7)+,A0-A1
00001B76  4CDF 007F               1168              MOVEM.L (A7)+,D0-D6
00001B7A                          1169  
00001B7A                          1170  
00001B7A                          1171              
00001B7A  4E75                    1172              RTS            
00001B7C                          1173  
00001B7C                          1174  ; ------------------------------------------------------------------------------
00001B7C                          1175  MAPPLOT
00001B7C                          1176  ; INIT MAP
00001B7C                          1177  ; INPUT    : NONE
00001B7C                          1178  ; OUTPUT   : NONE
00001B7C                          1179  ; MODIFIES : NONE
00001B7C                          1180  ; ------------------------------------------------------------------------------            
00001B7C                          1181  
00001B7C  48E7 FE00               1182              MOVEM.L D0-D6,-(A7)
00001B80  48E7 0080               1183              MOVEM.L A0,-(A7)
00001B84                          1184  
00001B84  41F9 000021C4           1185              LEA.L   MAPVAR,A0
00001B8A  3C3C 0030               1186              MOVE.W  #48,D6
00001B8E  343C 001F               1187              MOVE.W  #31,D2
00001B92                          1188  BUCLE_FILA2
00001B92  3A3C 0030               1189              MOVE.W  #48,D5
00001B96  323C 001F               1190              MOVE.W  #31,D1
00001B9A  0646 0010               1191              ADD.W   #16,D6
00001B9E                          1192  
00001B9E                          1193  BUCLE_COLUMNA2
00001B9E  0645 0010               1194              ADD.W   #16,D5       
00001BA2                          1195  
00001BA2  1018                    1196              MOVE.B  (A0)+,D0
00001BA4                          1197  
00001BA4  B07C 0000               1198              CMP     #0,D0
00001BA8  6700 0034               1199              BEQ     ZERO2
00001BAC  B07C 0004               1200              CMP     #4,D0
00001BB0  6700 002C               1201              BEQ     ZERO2
00001BB4  B07C 0001               1202              CMP     #1,D0
00001BB8  6600 0008               1203              BNE     NOTWALL2
00001BBC  4EB9 00001BF0           1204              JSR     DIBFIGWALL
00001BC2                          1205  NOTWALL2
00001BC2  B07C 0002               1206              CMP     #2,D0
00001BC6  6600 0008               1207              BNE     NOTPOINT2
00001BCA  4EB9 00001C28           1208              JSR     DIBFIGPOINT
00001BD0                          1209  NOTPOINT2
00001BD0  B07C 0003               1210              CMP     #3,D0
00001BD4  6600 0008               1211              BNE     ZERO2
00001BD8  4EB9 00001C64           1212              JSR     DIBFIGBPOINT
00001BDE                          1213  
00001BDE                          1214     
00001BDE                          1215  ZERO2
00001BDE  51C9 FFBE               1216              DBRA    D1,BUCLE_COLUMNA2
00001BE2                          1217              
00001BE2  51CA FFAE               1218              DBRA    D2,BUCLE_FILA2
00001BE6                          1219              
00001BE6  4CDF 0100               1220              MOVEM.L (A7)+,A0
00001BEA  4CDF 007F               1221              MOVEM.L (A7)+,D0-D6
00001BEE                          1222              
00001BEE                          1223              
00001BEE  4E75                    1224              RTS 
00001BF0                          1225              
00001BF0                          1226  ; -----------------------------------------------------------------------------
00001BF0                          1227  DIBFIGWALL
00001BF0                          1228  ; SUBRUTINE DRAW MAP
00001BF0                          1229  ; INPUT    : D5=POSITION X, D6=POSITION Y
00001BF0                          1230  ; OUTPUT   : NONE
00001BF0                          1231  ; MODIFIES : NONE
00001BF0                          1232  ; -----------------------------------------------------------------------------
00001BF0  48E7 FE00               1233              MOVEM.L D0-D6,-(A7)
00001BF4                          1234              ; SET CONTOURN COLOR
00001BF4  103C 0050               1235              MOVE.B  #80,D0
00001BF8  223C 00AA0000           1236              MOVE.L  #$00AA0000,D1
00001BFE  4E4F                    1237              TRAP    #15
00001C00                          1238              
00001C00                          1239              ; SET FILL COLOR
00001C00  103C 0051               1240              MOVE.B  #81,D0
00001C04  223C 00FF0000           1241              MOVE.L  #$00FF0000,D1
00001C0A  4E4F                    1242              TRAP    #15
00001C0C                          1243              
00001C0C                          1244              ; DEFINE COORDINATES RECTANGLE
00001C0C  3205                    1245              MOVE.W  D5,D1
00001C0E  3406                    1246              MOVE.W  D6,D2
00001C10  0645 0010               1247              ADD.W   #16,D5
00001C14  0646 0010               1248              ADD.W   #16,D6
00001C18  3605                    1249              MOVE.W  D5,D3
00001C1A  3806                    1250              MOVE.W  D6,D4
00001C1C                          1251              
00001C1C                          1252              ; DRAW RECTANGLE
00001C1C  103C 0057               1253              MOVE.B  #87,D0
00001C20  4E4F                    1254              TRAP    #15
00001C22                          1255              
00001C22  4CDF 007F               1256              MOVEM.L (A7)+,D0-D6
00001C26                          1257  
00001C26  4E75                    1258              RTS
00001C28                          1259              
00001C28                          1260  ; -----------------------------------------------------------------------------
00001C28                          1261  DIBFIGPOINT
00001C28                          1262  ; SUBRUTINE DRAW MAP
00001C28                          1263  ; INPUT    : D5=POSITION X, D6=POSITION Y
00001C28                          1264  ; OUTPUT   : NONE
00001C28                          1265  ; MODIFIES : NONE
00001C28                          1266  ; -----------------------------------------------------------------------------
00001C28  48E7 FE00               1267              MOVEM.L D0-D6,-(A7)
00001C2C                          1268              ; SET CONTOURN COLOR
00001C2C  103C 0050               1269              MOVE.B  #80,D0
00001C30  223C 0000AAAA           1270              MOVE.L  #$0000AAAA,D1
00001C36  4E4F                    1271              TRAP    #15
00001C38                          1272              
00001C38                          1273              ; SET FILL COLOR
00001C38  103C 0051               1274              MOVE.B  #81,D0
00001C3C  223C 0000FFFF           1275              MOVE.L  #$0000FFFF,D1
00001C42  4E4F                    1276              TRAP    #15
00001C44                          1277              
00001C44                          1278              ; DEFINE COORDINATES RECTANGLE
00001C44  3205                    1279              MOVE.W  D5,D1
00001C46  5041                    1280              ADD.W   #8,D1
00001C48  5541                    1281              SUB.W   #2,D1
00001C4A  3406                    1282              MOVE.W  D6,D2
00001C4C  5042                    1283              ADD.W   #8,D2
00001C4E  5542                    1284              SUB.W   #2,D2
00001C50                          1285              
00001C50  3601                    1286              MOVE.W  D1,D3
00001C52  5843                    1287              ADD.W   #2*2,D3
00001C54  3802                    1288              MOVE.W  D2,D4
00001C56  5844                    1289              ADD.W   #2*2,D4
00001C58                          1290              
00001C58                          1291              ; DRAW POINT
00001C58  103C 0058               1292              MOVE.B  #88,D0
00001C5C  4E4F                    1293              TRAP    #15
00001C5E                          1294              
00001C5E  4CDF 007F               1295              MOVEM.L (A7)+,D0-D6
00001C62                          1296              
00001C62  4E75                    1297              RTS
00001C64                          1298  
00001C64                          1299  
00001C64                          1300  ; -----------------------------------------------------------------------------
00001C64                          1301  DIBFIGBPOINT
00001C64                          1302  ; SUBRUTINE DRAW MAP
00001C64                          1303  ; INPUT    : D5=POSITION X, D6=POSITION Y
00001C64                          1304  ; OUTPUT   : NONE
00001C64                          1305  ; MODIFIES : NONE
00001C64                          1306  ; -----------------------------------------------------------------------------
00001C64  48E7 FE00               1307              MOVEM.L D0-D6,-(A7)
00001C68                          1308              ; SET CONTOURN COLOR
00001C68  103C 0050               1309              MOVE.B  #80,D0
00001C6C  223C 0000AAAA           1310              MOVE.L  #$0000AAAA,D1
00001C72  4E4F                    1311              TRAP    #15
00001C74                          1312              
00001C74                          1313              ; SET FILL COLOR
00001C74  103C 0051               1314              MOVE.B  #81,D0
00001C78  223C 0000FFFF           1315              MOVE.L  #$0000FFFF,D1
00001C7E  4E4F                    1316              TRAP    #15
00001C80                          1317              
00001C80                          1318              ; DEFINE COORDINATES RECTANGLE
00001C80  3205                    1319              MOVE.W  D5,D1
00001C82  5041                    1320              ADD.W   #8,D1
00001C84  5941                    1321              SUB.W   #4,D1
00001C86  3406                    1322              MOVE.W  D6,D2
00001C88  5042                    1323              ADD.W   #8,D2
00001C8A  5942                    1324              SUB.W   #4,D2
00001C8C                          1325              
00001C8C  3601                    1326              MOVE.W  D1,D3
00001C8E  5043                    1327              ADD.W   #4*2,D3
00001C90  3802                    1328              MOVE.W  D2,D4
00001C92  5044                    1329              ADD.W   #4*2,D4
00001C94                          1330              
00001C94                          1331              ; DRAW BIG POINT
00001C94  103C 0058               1332              MOVE.B  #88,D0
00001C98  4E4F                    1333              TRAP    #15
00001C9A                          1334              
00001C9A  4CDF 007F               1335              MOVEM.L (A7)+,D0-D6
00001C9E                          1336              
00001C9E  4E75                    1337              RTS
00001CA0                          1338  
00001CA0                          1339  
00001CA0                          1340  
00001CA0                          1341  
00001CA0                          1342  
00001CA0                          1343  
00001CA0                          1344  
00001CA0                          1345  
00001CA0                          1346  
00001CA0                          1347  
00001CA0                          1348  
00001CA0                          1349  
00001CA0                          1350  -------------------- end include --------------------
00001CA0                          1351              INCLUDE "LIB/UTLCONST.X68"
00001CA0                          1352  ; ==============================================================================
00001CA0                          1353  ; UTIL CONSTANTS
00001CA0                          1354  ; ==============================================================================
00001CA0                          1355  
00001CA0  =00000008               1356  UTLCHRWD    EQU     8                       ; CHARACTER WIDTH IN PIXELS
00001CA0                          1357  
00001CA0                          1358  -------------------- end include --------------------
00001CA0                          1359              INCLUDE "LIB/UTLCODE.X68"
00001CA0                          1360  ; =============================================================================
00001CA0                          1361  ; UTILITY CODE
00001CA0                          1362  ; =============================================================================
00001CA0                          1363  
00001CA0                          1364  ; -----------------------------------------------------------------------------
00001CA0                          1365  UTLINIT
00001CA0                          1366  ; INITIALIZES UTILITY CODE
00001CA0                          1367  ; INPUT    - NONE
00001CA0                          1368  ; OUTPUT   - NONE
00001CA0                          1369  ; MODIFIES - NONE
00001CA0                          1370  ; -----------------------------------------------------------------------------
00001CA0  48E7 C000               1371              MOVEM.L D0-D1,-(A7)
00001CA4  103C 0008               1372              MOVE.B  #8,D0
00001CA8  4E4F                    1373              TRAP    #15
00001CAA  13C1 000025E6           1374              MOVE.B  D1,(UTLRNDIX)
00001CB0  4CDF 0003               1375              MOVEM.L (A7)+,D0-D1
00001CB4  4E75                    1376              RTS
00001CB6                          1377  
00001CB6                          1378  ; -----------------------------------------------------------------------------
00001CB6                          1379  UTLPRINT
00001CB6                          1380  ; PRINT SCREEN CENTERED TEXT
00001CB6                          1381  ; INPUT    : A0 POINTER TO ZERO-TERMINATED STRING
00001CB6                          1382  ;            D0.B SCREEN ROW TO PRINT TEXT
00001CB6                          1383  ; OUTPUT   : D0.B NEXT ROW
00001CB6                          1384  ; MODIFIES : NONE (ASIDE OF OUTPUT)
00001CB6                          1385  ; -----------------------------------------------------------------------------
00001CB6  48E7 C0C0               1386              MOVEM.L D0-D1/A0-A1,-(A7)
00001CBA  4201                    1387              CLR.B   D1
00001CBC  2248                    1388              MOVE.L  A0,A1
00001CBE  4A18                    1389  .LOOP       TST.B   (A0)+
00001CC0  6700 0006               1390              BEQ     .ENDLOOP
00001CC4  5201                    1391              ADDQ.B  #1,D1
00001CC6  60F6                    1392              BRA     .LOOP
00001CC8  E209                    1393  .ENDLOOP    LSR.B   #1,D1
00001CCA  0401 0028               1394              SUB.B   #(SCRWIDTH/UTLCHRWD)/2,D1
00001CCE  4401                    1395              NEG.B   D1
00001CD0  E141                    1396              ASL.W   #8,D1
00001CD2  8240                    1397              OR.W    D0,D1
00001CD4  103C 000B               1398              MOVE.B  #11,D0
00001CD8  4E4F                    1399              TRAP    #15
00001CDA  103C 000D               1400              MOVE.B  #13,D0
00001CDE  4E4F                    1401              TRAP    #15
00001CE0  4CDF 0303               1402              MOVEM.L (A7)+,D0-D1/A0-A1
00001CE4  5200                    1403              ADDQ.B  #1,D0
00001CE6  4E75                    1404              RTS
00001CE8                          1405              
00001CE8                          1406              
00001CE8                          1407  
00001CE8                          1408  
00001CE8                          1409              ; (SCRWIDTH/UTLCHRWD)/2 - D1/2
00001CE8                          1410  
00001CE8                          1411  
00001CE8                          1412  ; -----------------------------------------------------------------------------
00001CE8                          1413  UTLRAND
00001CE8                          1414  ; PROVIDES A PSEUDO-RANDOM BYTE
00001CE8                          1415  ; INPUT    - NONE
00001CE8                          1416  ; OUTPUT   - D0.L RANDOM VALUE (ONLY BYTE)
00001CE8                          1417  ; MODIFIES - NONE (ASIDE OF OUTPUT)
00001CE8                          1418  ; -----------------------------------------------------------------------------
00001CE8  2F08                    1419              MOVE.L  A0,-(A7)
00001CEA  41F9 00001D06           1420              LEA     .RANDVEC,A0
00001CF0  4280                    1421              CLR.L   D0
00001CF2  1039 000025E6           1422              MOVE.B  (UTLRNDIX),D0
00001CF8  1030 0800               1423              MOVE.B  (A0,D0.L),D0
00001CFC  5239 000025E6           1424              ADDQ.B  #1,(UTLRNDIX)
00001D02  205F                    1425              MOVE.L  (A7)+,A0
00001D04  4E75                    1426              RTS
00001D06                          1427  
00001D06                          1428  
00001D06= A2 EE 9A 0C F5 24 ...   1429  .RANDVEC    DC.B    162, 238, 154, 12 , 245, 36 , 32 , 103
00001D0E= 2A A3 51 26 E0 AC ...   1430              DC.B    42 , 163, 81 , 38 , 224, 172, 19 , 69
00001D16= 75 51 CA FD 33 EB ...   1431              DC.B    117, 81 , 202, 253, 51 , 235, 108, 154
00001D1E= 60 CC E7 B8 9A EB ...   1432              DC.B    96 , 204, 231, 184, 154, 235, 34 , 203
00001D26= 1D 76 B5 95 B0 89 ...   1433              DC.B    29 , 118, 181, 149, 176, 137, 62 , 108
00001D2E= 39 15 48 C9 6E CA ...   1434              DC.B    57 , 21 , 72 , 201, 110, 202, 159, 41
00001D36= 43 E7 E2 7C 37 25 ...   1435              DC.B    67 , 231, 226, 124, 55 , 37 , 84 , 62
00001D3E= E9 94 CE E9 E4 52 ...   1436              DC.B    233, 148, 206, 233, 228, 82 , 243, 78
00001D46= 37 6D 9A 84 A2 28 ...   1437              DC.B    55 , 109, 154, 132, 162, 40 , 30 , 39
00001D4E= 19 E2 C6 77 80 D4 ...   1438              DC.B    25 , 226, 198, 119, 128, 212, 232, 225
00001D56= 0A 5A 32 67 33 C2 ...   1439              DC.B    10 , 90 , 50 , 103, 51 , 194, 222, 40
00001D5E= 59 80 DC 0E 57 FC ...   1440              DC.B    89 , 128, 220, 14 , 87 , 252, 243, 252
00001D66= 8A AB BC F7 07 4D ...   1441              DC.B    138, 171, 188, 247, 7  , 77 , 29 , 234
00001D6E= EF D5 77 6E 1E BB ...   1442              DC.B    239, 213, 119, 110, 30 , 187, 131, 23
00001D76= D6 E0 2A 8F BD 28 ...   1443              DC.B    214, 224, 42 , 143, 189, 40 , 212, 130
00001D7E= 13 4F 66 EC 0A 64 ...   1444              DC.B    19 , 79 , 102, 236, 10 , 100, 122, 188
00001D86= 56 52 9A 16 9B 90 ...   1445              DC.B    86 , 82 , 154, 22 , 155, 144, 7  , 199
00001D8E= 06 8A A4 F7 01 DA ...   1446              DC.B    6  , 138, 164, 247, 1  , 218, 166, 82
00001D96= F2 E7 77 28 B1 76 ...   1447              DC.B    242, 231, 119, 40 , 177, 118, 220, 102
00001D9E= A4 42 E3 81 B1 67 ...   1448              DC.B    164, 66 , 227, 129, 177, 103, 165, 108
00001DA6= BF CE FA 16 BF 38 ...   1449              DC.B    191, 206, 250, 22 , 191, 56 , 30 , 161
00001DAE= D1 8B 50 0C 5F 49 ...   1450              DC.B    209, 139, 80 , 12 , 95 , 73 , 168, 56
00001DB6= DE 4C 14 A2 40 DC ...   1451              DC.B    222, 76 , 20 , 162, 64 , 220, 93 , 12
00001DBE= B6 9B 0A 38 5D AB ...   1452              DC.B    182, 155, 10 , 56 , 93 , 171, 89 , 6
00001DC6= E2 1B DD 75 15 82 ...   1453              DC.B    226, 27 , 221, 117, 21 , 130, 101, 18
00001DCE= 8A 26 51 30 9F 47 ...   1454              DC.B    138, 38 , 81 , 48 , 159, 71 , 57 , 21
00001DD6= 1E 8A BB 71 C6 6E ...   1455              DC.B    30 , 138, 187, 113, 198, 110, 185, 152
00001DDE= 9F 47 E5 34 94 27 ...   1456              DC.B    159, 71 , 229, 52 , 148, 39 , 77 , 6
00001DE6= 7D 06 D6 BA 30 0F ...   1457              DC.B    125, 6  , 214, 186, 48 , 15 , 212, 22
00001DEE= EC 7F 7E 03 CF 2D ...   1458              DC.B    236, 127, 126, 3  , 207, 45 , 193, 2
00001DF6= 94 5B 23 F2 8B CD ...   1459              DC.B    148, 91 , 35 , 242, 139, 205, 248, 237
00001DFE= 74 33 EC B9 0F D5 ...   1460              DC.B    116, 51 , 236, 185, 15 , 213, 221, 6
00001E06                          1461  
00001E06                          1462  
00001E06                          1463  
00001E06                          1464  
00001E06                          1465  -------------------- end include --------------------
00001E06                          1466              INCLUDE "INTRO.X68"
00001E06                          1467  ; ==============================================================================
00001E06                          1468  ; INTRO SCREEN
00001E06                          1469  ; ==============================================================================
00001E06                          1470  
00001E06                          1471  ; ------------------------------------------------------------------------------
00001E06                          1472  ISCINIT
00001E06                          1473  ; INTRO SCREEN INIT
00001E06                          1474  ; INPUT    : NONE
00001E06                          1475  ; OUTPUT   : NONE
00001E06                          1476  ; MODIFIES : NONE
00001E06                          1477  ; ------------------------------------------------------------------------------
00001E06  4279 000025E0           1478              CLR.W   (ISCTIMER)
00001E0C  4E75                    1479              RTS
00001E0E                          1480  
00001E0E                          1481  ; ------------------------------------------------------------------------------
00001E0E                          1482  ISCUPD
00001E0E                          1483  ; INTRO SCREEN UPDATE
00001E0E                          1484  ; INPUT    : NONE
00001E0E                          1485  ; OUTPUT   : NONE
00001E0E                          1486  ; MODIFIES : NONE
00001E0E                          1487  ; ------------------------------------------------------------------------------
00001E0E  0839 0001 000021BE      1488              BTST.B  #1,(KBDVAL)
00001E16  6700 000A               1489              BEQ     .CONT
00001E1A  33FC 0001 000025E4      1490              MOVE.W  #1,(STANEXT)
00001E22                          1491  .CONT       ;ADDQ.W  #1,(ISCTIMER)
00001E22                          1492  ;            CMP.W   #500,(ISCTIMER)
00001E22                          1493  ;            BLT     .DONE
00001E22                          1494  ;            MOVE.W  #1,(STANEXT)
00001E22  4E75                    1495  .DONE       RTS
00001E24                          1496  
00001E24                          1497  ; ------------------------------------------------------------------------------
00001E24                          1498  ISCPLOT
00001E24                          1499  ; INTRO SCREEN PLOT
00001E24                          1500  ; INPUT    : NONE
00001E24                          1501  ; OUTPUT   : NONE
00001E24                          1502  ; MODIFIES : NONE
00001E24                          1503  ; ------------------------------------------------------------------------------
00001E24  48E7 C080               1504              MOVEM.L D0-D1/A0,-(A7)
00001E28                          1505              
00001E28  4281                    1506              CLR.L   D1
00001E2A  103C 0051               1507              MOVE.B  #81,D0
00001E2E  4E4F                    1508              TRAP    #15
00001E30                          1509              
00001E30  41F9 00001E5E           1510              LEA     .TXT1,A0
00001E36  103C 000A               1511              MOVE.B  #10,D0
00001E3A  4EB8 1CB6               1512              JSR     UTLPRINT
00001E3E                          1513              
00001E3E  0839 0004 000021C2      1514              BTST.B  #4,(SCRCYCCT)
00001E46  6700 0010               1515              BEQ     .DONE
00001E4A                          1516              
00001E4A  41F9 00001E6C           1517              LEA     .TXT2,A0
00001E50  103C 0019               1518              MOVE.B  #25,D0
00001E54  4EB8 1CB6               1519              JSR     UTLPRINT
00001E58                          1520              
00001E58  4CDF 0103               1521  .DONE       MOVEM.L (A7)+,D0-D1/A0
00001E5C                          1522  
00001E5C  4E75                    1523              RTS
00001E5E= 50 41 43 2D 4D 41 ...   1524  .TXT1       DC.B    'PAC-MAN 68000',0
00001E6C= 50 52 45 53 53 20 ...   1525  .TXT2       DC.B    'PRESS (flecha arriba) TO START',0
00001E8C                          1526              DS.W    0
00001E8C                          1527  
00001E8C                          1528  
00001E8C                          1529  
00001E8C                          1530  
00001E8C                          1531  
00001E8C                          1532  
00001E8C                          1533  
00001E8C                          1534  
00001E8C                          1535  -------------------- end include --------------------
00001E8C                          1536              INCLUDE "INSTRUCTIONS.X68"
00001E8C                          1537  ; ==============================================================================
00001E8C                          1538  ; INSTRUCTIONS SCREEN
00001E8C                          1539  ; ==============================================================================
00001E8C                          1540  
00001E8C                          1541  ; ------------------------------------------------------------------------------
00001E8C                          1542  INSINIT
00001E8C                          1543  ; INSTRUCTIONS SCREEN INIT
00001E8C                          1544  ; INPUT    : NONE
00001E8C                          1545  ; OUTPUT   : NONE
00001E8C                          1546  ; MODIFIES : NONE
00001E8C                          1547  ; ------------------------------------------------------------------------------
00001E8C  4E75                    1548              RTS
00001E8E                          1549  
00001E8E                          1550  ; ------------------------------------------------------------------------------
00001E8E                          1551  INSUPD
00001E8E                          1552  ; INSTRUCTIONS SCREEN UPDATE
00001E8E                          1553  ; INPUT    : NONE
00001E8E                          1554  ; OUTPUT   : NONE
00001E8E                          1555  ; MODIFIES : NONE
00001E8E                          1556  ; ------------------------------------------------------------------------------
00001E8E  4E75                    1557              RTS
00001E90                          1558  
00001E90                          1559  ; ------------------------------------------------------------------------------
00001E90                          1560  INSPLOT
00001E90                          1561  ; INSTRUCTIONS SCREEN PLOT
00001E90                          1562  ; INPUT    : NONE
00001E90                          1563  ; OUTPUT   : NONE
00001E90                          1564  ; MODIFIES : NONE
00001E90                          1565  ; ------------------------------------------------------------------------------
00001E90                          1566  
00001E90  48E7 C0C0               1567              MOVEM.L D0-D1/A0-A1,-(A7)
00001E94  4281                    1568              CLR.L   D1
00001E96  103C 0051               1569              MOVE.B  #81,D0
00001E9A  4E4F                    1570              TRAP    #15
00001E9C  103C 000B               1571              MOVE.B  #11,D0
00001EA0  43F9 00002002           1572              LEA     .TXTLST,A1
00001EA6  2219                    1573  .LOOP       MOVE.L  (A1)+,D1
00001EA8  6700 000A               1574              BEQ     .DONE
00001EAC  2041                    1575              MOVE.L  D1,A0
00001EAE  4EB8 1CB6               1576              JSR     UTLPRINT
00001EB2  60F2                    1577              BRA     .LOOP
00001EB4  4CDF 0303               1578  .DONE       MOVEM.L (A7)+,D0-D1/A0-A1
00001EB8  4E75                    1579              RTS
00001EBA= 57 45 4C 43 4F 4D ...   1580  .TXT1       DC.B    'WELCOME TO THE WORLD OF MULTI-PONG 68000!',0
00001EE4= 59 4F 55 52 20 47 ...   1581  .TXT2       DC.B    'YOUR GOAL IN THIS GAME IS TO AVOID MISSING THE BALLS',0
00001F19= 54 4F 20 54 48 49 ...   1582  .TXT3       DC.B    'TO THIS END, MOVE THE PAD USING THE KEYBOARD',0
00001F46= 48 4F 57 20 54 4F ...   1583  .TXT4       DC.B    'HOW TO DO IT? YOU MAY ASK.',0
00001F61= 49 54 20 49 53 20 ...   1584  .TXT5       DC.B    'IT IS EASY: JUST USE THE UP KEY TO MOVE THE PAD...',0
00001F94= 55 50 21 00             1585  .TXT6       DC.B    'UP!',0
00001F98= 41 4E 44 20 55 53 ...   1586  .TXT7       DC.B    'AND USE THE DOWN KEY TO MOVE THE PAD DOWN.',0
00001FC3= 57 48 41 54 20 41 ...   1587  .TXT8       DC.B    'WHAT ABOUT LEFT AND RIGHT?',0
00001FDE= 4E 4F 2E 20 54 48 ...   1588  .TXT9       DC.B    'NO. THESE ARE FORBIDDEN DIRECTIONS',0
00002002                          1589              DS.W    0
00002002= 00001EBA 00001EE4 ...   1590  .TXTLST     DC.L    .TXT1,.TXT2,.TXT3,.TXT4,.TXT5,.TXT6,.TXT7,.TXT8,.TXT9,0
0000202A                          1591  
0000202A                          1592  
0000202A                          1593  -------------------- end include --------------------
0000202A                          1594              INCLUDE "WIN.X68"
0000202A                          1595  ; ==============================================================================
0000202A                          1596  ; VICTORY SCREEN
0000202A                          1597  ; ==============================================================================
0000202A                          1598  
0000202A                          1599  ; ------------------------------------------------------------------------------
0000202A                          1600  WININIT
0000202A                          1601  ; VICTORY SCREEN INIT
0000202A                          1602  ; INPUT    : NONE
0000202A                          1603  ; OUTPUT   : NONE
0000202A                          1604  ; MODIFIES : NONE
0000202A                          1605  ; ------------------------------------------------------------------------------
0000202A  4E75                    1606              RTS
0000202C                          1607  
0000202C                          1608  ; ------------------------------------------------------------------------------
0000202C                          1609  WINUPD
0000202C                          1610  ; VICTORY SCREEN UPDATE
0000202C                          1611  ; INPUT    : NONE
0000202C                          1612  ; OUTPUT   : NONE
0000202C                          1613  ; MODIFIES : NONE
0000202C                          1614  ; ------------------------------------------------------------------------------
0000202C  4E75                    1615              RTS
0000202E                          1616  
0000202E                          1617  ; ------------------------------------------------------------------------------
0000202E                          1618  WINPLOT
0000202E                          1619  ; VICTORY SCREEN PLOT
0000202E                          1620  ; INPUT    : NONE
0000202E                          1621  ; OUTPUT   : NONE
0000202E                          1622  ; MODIFIES : NONE
0000202E                          1623  ; ------------------------------------------------------------------------------
0000202E  48E7 C080               1624              MOVEM.L D0-D1/A0,-(A7)
00002032                          1625              
00002032  4281                    1626              CLR.L   D1
00002034  103C 0051               1627              MOVE.B  #81,D0
00002038  4E4F                    1628              TRAP    #15
0000203A                          1629              
0000203A  41F9 00002068           1630              LEA     .TXT1,A0
00002040  103C 000A               1631              MOVE.B  #10,D0
00002044  4EB8 1CB6               1632              JSR     UTLPRINT
00002048                          1633              
00002048  0839 0004 000021C2      1634              BTST.B  #4,(SCRCYCCT)
00002050  6700 0010               1635              BEQ     .DONE
00002054                          1636              
00002054  41F9 00002071           1637              LEA     .TXT2,A0
0000205A  103C 0019               1638              MOVE.B  #25,D0
0000205E  4EB8 1CB6               1639              JSR     UTLPRINT
00002062                          1640              
00002062  4CDF 0103               1641  .DONE       MOVEM.L (A7)+,D0-D1/A0
00002066                          1642  
00002066  4E75                    1643              RTS
00002068= 59 4F 55 20 57 4F ...   1644  .TXT1       DC.B    'YOU WON!',0
00002071= 50 52 45 53 53 20 ...   1645  .TXT2       DC.B    'PRESS FIRE1 TO CONTINUE',0
0000208A                          1646              DS.W    0
0000208A                          1647  
0000208A                          1648  
0000208A                          1649  
0000208A                          1650  -------------------- end include --------------------
0000208A                          1651              INCLUDE "GOVER.X68"
0000208A                          1652  ; ==============================================================================
0000208A                          1653  ; GAME OVER SCREEN
0000208A                          1654  ; ==============================================================================
0000208A                          1655  
0000208A                          1656  ; ------------------------------------------------------------------------------
0000208A                          1657  GOVINIT
0000208A                          1658  ; GAME OVER SCREEN INIT
0000208A                          1659  ; INPUT    : NONE
0000208A                          1660  ; OUTPUT   : NONE
0000208A                          1661  ; MODIFIES : NONE
0000208A                          1662  ; ------------------------------------------------------------------------------
0000208A  4E75                    1663              RTS
0000208C                          1664  
0000208C                          1665  ; ------------------------------------------------------------------------------
0000208C                          1666  GOVUPD
0000208C                          1667  ; GAME OVER SCREEN UPDATE
0000208C                          1668  ; INPUT    : NONE
0000208C                          1669  ; OUTPUT   : NONE
0000208C                          1670  ; MODIFIES : NONE
0000208C                          1671  ; ------------------------------------------------------------------------------
0000208C  4E75                    1672              RTS
0000208E                          1673  
0000208E                          1674  ; ------------------------------------------------------------------------------
0000208E                          1675  GOVPLOT
0000208E                          1676  ; GAME OVER SCREEN PLOT
0000208E                          1677  ; INPUT    : NONE
0000208E                          1678  ; OUTPUT   : NONE
0000208E                          1679  ; MODIFIES : NONE
0000208E                          1680  ; ------------------------------------------------------------------------------
0000208E  48E7 C080               1681              MOVEM.L D0-D1/A0,-(A7)
00002092                          1682              
00002092  4281                    1683              CLR.L   D1
00002094  103C 0051               1684              MOVE.B  #81,D0
00002098  4E4F                    1685              TRAP    #15
0000209A                          1686              
0000209A  41F9 000020C8           1687              LEA     .TXT1,A0
000020A0  103C 000A               1688              MOVE.B  #10,D0
000020A4  4EB8 1CB6               1689              JSR     UTLPRINT
000020A8                          1690              
000020A8  0839 0004 000021C2      1691              BTST.B  #4,(SCRCYCCT)
000020B0  6700 0010               1692              BEQ     .DONE
000020B4                          1693              
000020B4  41F9 000020D2           1694              LEA     .TXT2,A0
000020BA  103C 0019               1695              MOVE.B  #25,D0
000020BE  4EB8 1CB6               1696              JSR     UTLPRINT
000020C2                          1697              
000020C2  4CDF 0103               1698  .DONE       MOVEM.L (A7)+,D0-D1/A0
000020C6                          1699  
000020C6  4E75                    1700              RTS
000020C8= 47 41 4D 45 20 4F ...   1701  .TXT1       DC.B    'GAME OVER',0
000020D2= 50 52 45 53 53 20 ...   1702  .TXT2       DC.B    'PRESS FIRE1 TO CONTINUE',0
000020EA                          1703              DS.W    0
000020EA                          1704  
000020EA                          1705  
000020EA                          1706  -------------------- end include --------------------
000020EA                          1707              INCLUDE "STATES.X68"
000020EA                          1708  ; =============================================================================
000020EA                          1709  ; GAME STATE MANAGEMENT
000020EA                          1710  ; =============================================================================
000020EA                          1711  
000020EA                          1712  ; -----------------------------------------------------------------------------
000020EA                          1713  STAINIT
000020EA                          1714  ; INITALIZES THE STATE MANAGER
000020EA                          1715  ; INPUT    - NONE
000020EA                          1716  ; OUTPUT   - NONE
000020EA                          1717  ; MODIFIES - NONE
000020EA                          1718  ; -----------------------------------------------------------------------------
000020EA  33FC FFFF 000025E2      1719              MOVE.W  #STANONE,(STACUR)
000020F2  4279 000025E4           1720              CLR.W   (STANEXT)
000020F8  4E75                    1721              RTS
000020FA                          1722  
000020FA                          1723  ; -----------------------------------------------------------------------------
000020FA                          1724  STAUPD
000020FA                          1725  ; PERFORMS STATE UPDATE AND INIT IF NECESSARY
000020FA                          1726  ; INPUT    - NONE
000020FA                          1727  ; OUTPUT   - NONE
000020FA                          1728  ; MODIFIES - NONE
000020FA                          1729  ; -----------------------------------------------------------------------------
000020FA  48E7 8080               1730              MOVEM.L D0/A0,-(A7)
000020FE  4280                    1731              CLR.L   D0
00002100  3039 000025E4           1732              MOVE.W  (STANEXT),D0
00002106  B079 000025E2           1733              CMP.W   (STACUR),D0
0000210C  6700 0012               1734              BEQ     .DOUPD
00002110  33C0 000025E2           1735              MOVE.W  D0,(STACUR)             ; IF STATE CHANGED, DO INIT
00002116  E588                    1736              LSL.L   #2,D0
00002118  2040                    1737              MOVE.L  D0,A0
0000211A  2068 2138               1738              MOVE.L  .INITBL(A0),A0
0000211E  4E90                    1739              JSR     (A0)
00002120  4280                    1740  .DOUPD      CLR.L   D0                      ; IN ANY CASE, DO UPDATE
00002122  3039 000025E2           1741              MOVE.W  (STACUR),D0
00002128  E588                    1742              LSL.L   #2,D0
0000212A  2040                    1743              MOVE.L  D0,A0
0000212C  2068 2140               1744              MOVE.L  .UPDTBL(A0),A0
00002130  4E90                    1745              JSR     (A0)
00002132  4CDF 0101               1746              MOVEM.L (A7)+,D0/A0
00002136  4E75                    1747              RTS
00002138= 00001E06 0000216E       1748  .INITBL     DC.L    ISCINIT,GAMINIT
00002140= 00001E0E 0000217E       1749  .UPDTBL     DC.L    ISCUPD,GAMUPD
00002148                          1750  
00002148                          1751  ; -----------------------------------------------------------------------------
00002148                          1752  STAPLOT
00002148                          1753  ; PERFORMS STATE PLOT
00002148                          1754  ; INPUT    - NONE
00002148                          1755  ; OUTPUT   - NONE
00002148                          1756  ; MODIFIES - NONE
00002148                          1757  ; -----------------------------------------------------------------------------
00002148  48E7 8080               1758              MOVEM.L D0/A0,-(A7)
0000214C  4280                    1759              CLR.L   D0
0000214E  3039 000025E2           1760              MOVE.W  (STACUR),D0
00002154  E588                    1761              LSL.L   #2,D0
00002156  2040                    1762              MOVE.L  D0,A0
00002158  2068 2164               1763              MOVE.L  .PLTTBL(A0),A0
0000215C  4E90                    1764              JSR     (A0)
0000215E  4CDF 0101               1765              MOVEM.L (A7)+,D0/A0
00002162  4E75                    1766              RTS
00002164= 00001E24 00002182       1767  .PLTTBL     DC.L    ISCPLOT,GAMPLOT
0000216C                          1768  
0000216C                          1769  ; -----------------------------------------------------------------------------
0000216C                          1770  STAEMPTY
0000216C                          1771  ; EMPTY SUBROUTINE FOR CASES WITH NOTHING TO DO
0000216C                          1772  ; INPUT    - NONE
0000216C                          1773  ; OUTPUT   - NONE
0000216C                          1774  ; MODIFIES - NONE
0000216C                          1775  ; NOTE     - JUST A PLACEHOLDER. NOTHING TO DO.
0000216C                          1776  ; -----------------------------------------------------------------------------
0000216C  4E75                    1777              RTS
0000216E                          1778  
0000216E                          1779  
0000216E                          1780  
0000216E                          1781  
0000216E                          1782  
0000216E                          1783  
0000216E                          1784  
0000216E                          1785  
0000216E                          1786  
0000216E                          1787  -------------------- end include --------------------
0000216E                          1788              INCLUDE "GAME.X68"
0000216E                          1789  ; ==============================================================================
0000216E                          1790  ; GAME MANAGEMENT
0000216E                          1791  ; ==============================================================================
0000216E                          1792  
0000216E                          1793  ; ------------------------------------------------------------------------------
0000216E                          1794  GAMINIT
0000216E                          1795  ; INITIALIZES GAME.
0000216E                          1796  ; INPUT    : NONE
0000216E                          1797  ; OUTPUT   : NONE
0000216E                          1798  ; MODIFIES : NONE
0000216E                          1799  ; ------------------------------------------------------------------------------
0000216E  4EB8 14B4               1800              JSR     PMINIT
00002172  4EB8 1B02               1801              JSR     MAPINIT
00002176  4EB8 1400               1802              JSR     GSTINIT
0000217A  6000 F6B4               1803              BRA     SCOINIT
0000217E                          1804  
0000217E                          1805  ; ------------------------------------------------------------------------------
0000217E                          1806  GAMUPD
0000217E                          1807  ; UPDATES THE GAME
0000217E                          1808  ; INPUT    : NONE
0000217E                          1809  ; OUTPUT   : NONE
0000217E                          1810  ; MODIFIES : NONE
0000217E                          1811  ; ------------------------------------------------------------------------------
0000217E                          1812              
0000217E                          1813              ;JSR     GSTUPD
0000217E  6000 F368               1814              BRA     PMUPD
00002182                          1815              
00002182                          1816  ; ------------------------------------------------------------------------------
00002182                          1817  GAMPLOT
00002182                          1818  ; PLOTS THE GAME
00002182                          1819  ; INPUT    : NONE
00002182                          1820  ; OUTPUT   : NONE
00002182                          1821  ; MODIFIES : NONE
00002182                          1822  ; ------------------------------------------------------------------------------
00002182  4EB8 1B7C               1823              JSR     MAPPLOT
00002186  4EB8 1840               1824              JSR     SCOPLOT
0000218A  4EB8 1632               1825              JSR     PMPLOT
0000218E  6000 F2BA               1826              BRA     GSTPLOT
00002192                          1827  
00002192                          1828  
00002192                          1829  -------------------- end include --------------------
00002192                          1830              
00002192                          1831      
00002192                          1832  START:
00002192                          1833  
00002192                          1834  ;--- INITIALIZATION -----------------------------------------------------------
00002192                          1835  
00002192  007C 0700               1836              ORI.W   #$0700,SR               ;DISABLE INTERRUPTIONS
00002196                          1837  
00002196  4EB8 18A2               1838              JSR     SYSINIT
0000219A  4EB8 20EA               1839              JSR     STAINIT
0000219E                          1840  
0000219E                          1841  .LOOP
0000219E                          1842  
0000219E                          1843  ; --- UPDATE -------------------------------------------------------------------
0000219E                          1844  
0000219E                          1845  ; READ INPUT DEVICES
0000219E                          1846  
0000219E  4E41                    1847              TRAP    #1
000021A0                          1848  
000021A0                          1849  ; UPDATE GAME LOGIC
000021A0                          1850  
000021A0  4EB8 20FA               1851             JSR     STAUPD
000021A4                          1852  
000021A4                          1853  ; --- SYNC ---------------------------------------------------------------------
000021A4                          1854              ;WHILE THERES NO INTERRUPTS IN THE COUNTER THE PROGRAM WILL BE IN
000021A4                          1855              ;THE BUCLE
000021A4                          1856              
000021A4  4A39 000021C1           1857  .WAITINIT   TST.B   (SCRINTCT)
000021AA  67F8                    1858              BEQ     .WAITINIT
000021AC  4239 000021C1           1859              CLR.B   (SCRINTCT)
000021B2                          1860  
000021B2                          1861  ; --- PLOT ---------------------------------------------------------------------
000021B2                          1862              
000021B2  4EB8 2148               1863              JSR     STAPLOT
000021B6                          1864              
000021B6                          1865              
000021B6  4E40                    1866              TRAP    #0                      ;CHANGE BUFFER
000021B8                          1867  
000021B8  60E4                    1868              BRA     .LOOP
000021BA                          1869  
000021BA  FFFF FFFF               1870              SIMHALT  
000021BE                          1871             
000021BE                          1872              INCLUDE "SYSVARS.X68"
000021BE                          1873  ; ==============================================================================
000021BE                          1874  ; SYSTEM VARIABLES
000021BE                          1875  ; ==============================================================================
000021BE                          1876   
000021BE                          1877  ; --- KEYBOARD RELATED VARIABLES -----------------------------------------------
000021BE                          1878  
000021BE                          1879  KBDVAL      DS.B    1                       ; KEY STATE
000021BF                          1880  KBDLAST     DS.B    1                       ; LAST KEY PRESSED
000021C0                          1881  KBDEDGE     DS.B    1                       ; KEY EDGE
000021C1                          1882              DS.B    0 
000021C1                          1883  
000021C1                          1884  ; --- TIMED INTERRUPT RELATED VARIABLES ----------------------------------------
000021C1                          1885  
000021C1                          1886  SCRINTCT    DS.B    1                       ; INTERRUPT COUNTER
000021C2                          1887  SCRCYCCT    DS.B    1                       ; CYCLE COUNTER
000021C4                          1888              DS.W    0        
000021C4                          1889              
000021C4                          1890  ; --- MAP RELATED VARIABLE -----------------------------------------------------
000021C4                          1891  
000021C4                          1892  MAPVAR      DS.B    1024
000025C4                          1893  
000025C4                          1894              DS.B    0
000025C4                          1895  
000025C4                          1896  POSCON      DS.W    1
000025C6                          1897  
000025C6                          1898  
000025C6                          1899  
000025C6                          1900  
000025C6                          1901  
000025C6                          1902  
000025C6                          1903  -------------------- end include --------------------
000025C6                          1904              INCLUDE "VARS.X68"
000025C6                          1905  ; ==============================================================================
000025C6                          1906  ; GAME VARIABLES
000025C6                          1907  ; ==============================================================================
000025C6                          1908  
000025C6                          1909  ; --- PAC-MAN RELATED VARIABLES ------------------------------------------------
000025C6                          1910  
000025C6                          1911  PMPOSX      DS.W    1                       ; PM X COORDINATE
000025C8                          1912  PMPOSY      DS.W    1                       ; PM Y COORDINATE
000025CA                          1913  PMVELX      DS.W    1                       ; PM X VELOCITY
000025CC                          1914  PMVELY      DS.W    1                       ; PM Y VELOCITY
000025CE                          1915  PMEAT       DS.B    1                       ; PM BOOLEAN EAT GST
000025CF                          1916  PMLAMO      DS.B    1                       ; PM SAVE LAST MOVEMENT X O Y
000025D0                          1917              DS.B    0
000025D0                          1918  
000025D0                          1919  ; --- GHOST RELATED VARIABLES --------------------------------------------------
000025D0                          1920  
000025D0                          1921  GSTPOSX     DS.W    1                       ; GST X COORDINATE
000025D2                          1922  GSTPOSY     DS.W    1                       ; GST Y COORDINATE
000025D4                          1923  GSTVELX     DS.W    1                       ; GST X VELOCITY
000025D6                          1924  GSTVELY     DS.W    1                       ; GST Y VELOCITY
000025D8                          1925  GSTDEAD     DS.B    1                       ; GST BOOLEAN DEAD
000025D9                          1926  GSTLAMO     DS.B    1                       ; GST LAST MOVEMENT (X OR Y)
000025DA                          1927  GSTINRNG    DS.B    1                       ; GST IS IN RANGE
000025DB                          1928  GSTTARG     DS.B    1                       ; GST TARGET (0-PACMAN, 1-RANDOM)
000025DC                          1929              DS.B    0
000025DC                          1930  
000025DC                          1931  ; --- SCOREBOARD RELATED VARIABLES ---------------------------------------------
000025DC                          1932  
000025DC                          1933  SCOLIFE     DS.W    1                       ; NUMBER OF LIFES
000025DE                          1934  SCOPOINTS   DS.W    1                       ; NUMBER OF POINTS
000025E0                          1935  
000025E0                          1936  ; --- INTRO STATE RELATED VARIABLES --------------------------------------------
000025E0                          1937  
000025E0                          1938  ISCTIMER    DS.W    1                       ; INTRO TIMER
000025E2                          1939  
000025E2                          1940  ; --- STATE RELATED VARIABLES --------------------------------------------------
000025E2                          1941  
000025E2                          1942  STACUR      DS.W    1                       ; CURRENT STATE
000025E4                          1943  STANEXT     DS.W    1                       ; NEXT STATE
000025E6                          1944  
000025E6                          1945  
000025E6                          1946  
000025E6                          1947  
000025E6                          1948  
000025E6                          1949  
000025E6                          1950  
000025E6                          1951  
000025E6                          1952  
000025E6                          1953  -------------------- end include --------------------
000025E6                          1954              INCLUDE "LIB/UTLVARS.X68"
000025E6                          1955  ; =============================================================================
000025E6                          1956  ; UTILITY VARIABLES
000025E6                          1957  ; =============================================================================
000025E6                          1958  
000025E6                          1959  UTLRNDIX    DS.B    1                       ; NEXT INDEX TO RANDOM NUMBER
000025E8                          1960              DS.W    0
000025E8                          1961  -------------------- end include --------------------
000025E8                          1962              
000025E8                          1963              END    START        

No errors detected
No warnings generated


SYMBOL TABLE INFORMATION
Symbol-name         Value
-------------------------
BUCLE_COLUMNA       1B28
BUCLE_COLUMNA2      1B9E
BUCLE_FILA          1B1C
BUCLE_FILA2         1B92
COLWALLDOWN         1A14
COLWALLLEFT         19D2
COLWALLRIGHT        1990
COLWALLUP           1A50
DIBFIGBPOINT        1C64
DIBFIGPOINT         1C28
DIBFIGWALL          1BF0
GAMINIT             216E
GAMPLOT             2182
GAMUPD              217E
GETPOINTS           1A8E
GETPOINTS:BPOINT    1AD8
GETPOINTS:DONE      1AFC
GETPOINTS:POINT     1AEA
GOVINIT             208A
GOVPLOT             208E
GOVPLOT:DONE        20C2
GOVPLOT:TXT1        20C8
GOVPLOT:TXT2        20D2
GOVUPD              208C
GSTCOL1             FF
GSTCOL2             FF0080
GSTCOL3             FFFF00
GSTCOL4             80FF
GSTCOL5             800000
GSTDEAD             25D8
GSTFCOL1            FFFFFF
GSTFCOL2            0
GSTFCOL3            0
GSTFCOL4            0
GSTFCOL5            0
GSTINIT             1400
GSTINRNG            25DA
GSTINX1             2
GSTINX2             2
GSTINX3             1F
GSTINX4             1F
GSTINY1             2
GSTINY2             1F
GSTINY3             2
GSTINY4             1F
GSTLAMO             25D9
GSTPLOT             144A
GSTPOSX             25D0
GSTPOSY             25D2
GSTRAD              8
GSTRNG              10
GSTSPEED            7
GSTSPEED2           5
GSTTARG             25DB
GSTUPD              1428
GSTUPD:CHECKCRITIC  1444
GSTUPD:GSTINRNG     143C
GSTUPD:GSTNOTINRNG  1430
GSTVELX             25D4
GSTVELY             25D6
INSINIT             1E8C
INSPLOT             1E90
INSPLOT:DONE        1EB4
INSPLOT:LOOP        1EA6
INSPLOT:TXT1        1EBA
INSPLOT:TXT2        1EE4
INSPLOT:TXT3        1F19
INSPLOT:TXT4        1F46
INSPLOT:TXT5        1F61
INSPLOT:TXT6        1F94
INSPLOT:TXT7        1F98
INSPLOT:TXT8        1FC3
INSPLOT:TXT9        1FDE
INSPLOT:TXTLST      2002
INSUPD              1E8E
ISCINIT             1E06
ISCPLOT             1E24
ISCPLOT:DONE        1E58
ISCPLOT:TXT1        1E5E
ISCPLOT:TXT2        1E6C
ISCTIMER            25E0
ISCUPD              1E0E
ISCUPD:CONT         1E22
ISCUPD:DONE         1E22
KBDDOWN             28
KBDEDGE             21C0
KBDFIRE1            20
KBDFIRE2            4D
KBDFIRE3            10
KBDINIT             193A
KBDLAST             21BF
KBDLEFT             25
KBDPAUSE            50
KBDRIGHT            27
KBDUP               26
KBDUPD              1948
KBDUPD:CONVERT      1982
KBDUPD:LOOP         1986
KBDUPD:NOACT        197C
KBDVAL              21BE
MAPINIT             1B02
MAPMAT              1000
MAPPLOT             1B7C
MAPVAR              21C4
NOTPOINT            1B5C
NOTPOINT2           1BD0
NOTWALL             1B4E
NOTWALL2            1BC2
PMEAT               25CE
PMFCOL              FFFF
PMINIT              14B4
PMLAMO              25CF
PMPCOL              FFFF
PMPLOT              1632
PMPLOT:DDONE        16C6
PMPLOT:DDOWN        1698
PMPLOT:DLEFT        168E
PMPLOT:DOWNDRAW     1786
PMPLOT:DRAW_MOUTH1  16A2
PMPLOT:DRAW_MOUTH2  16AC
PMPLOT:DRAW_MOUTH3  16B6
PMPLOT:DRAW_MOUTH4  16C0
PMPLOT:DRIGHT       167A
PMPLOT:DUP          1684
PMPLOT:FULLDRAW     16CC
PMPLOT:LEFTDRAW     16F0
PMPLOT:RIGHTDRAW    1722
PMPLOT:SET_MOUTHDOWN  1812
PMPLOT:SET_MOUTHLEFT  17B8
PMPLOT:SET_MOUTHRIGHT  17D6
PMPLOT:SET_MOUTHUP  17F4
PMPLOT:UPDRAW       1754
PMPOSX              25C6
PMPOSY              25C8
PMRAD               8
PMSPEED             2
PMUPD               14E8
PMUPD:ACTXLEFT      15A6
PMUPD:ACTXRIGHT     157A
PMUPD:ACTYDOWN      15D2
PMUPD:ACTYUP        15EE
PMUPD:DONE          1620
PMUPD:NOTCOLISION   158C
PMUPD:NOTCOLISION2  15B8
PMUPD:NOTCOLISION3  15E4
PMUPD:NOTCOLISION4  1600
PMUPD:NOTDOWN       1576
PMUPD:NOTLEFT       1534
PMUPD:NOTMULT       160A
PMUPD:NOTRIGHT      154A
PMUPD:NOTTP         159C
PMUPD:NOTTP2        15C8
PMUPD:NOTUP         1560
PMVELX              25CA
PMVELY              25CC
POSCON              25C4
SCOFCOL             0
SCOINIT             1830
SCOLIFE             25DC
SCOLINE1            101
SCOLINE2            102
SCOPLOT             1840
SCOPLOT:TXT1        188E
SCOPLOT:TXT2        1897
SCOPOINTS           25DE
SCRCYCCT            21C2
SCRHEIGH            280
SCRINIT             18CE
SCRINTCT            21C1
SCRTIM              192C
SCRUPD              1912
SCRWIDTH            280
STACUR              25E2
STAEMPTY            216C
STAINIT             20EA
STANEXT             25E4
STANONE             FFFFFFFF
STAPLOT             2148
STAPLOT:PLTTBL      2164
START               2192
START:LOOP          219E
START:WAITINIT      21A4
STAUPD              20FA
STAUPD:DOUPD        2120
STAUPD:INITBL       2138
STAUPD:UPDTBL       2140
SYSINIT             18A2
UTLCHRWD            8
UTLINIT             1CA0
UTLPRINT            1CB6
UTLPRINT:ENDLOOP    1CC8
UTLPRINT:LOOP       1CBE
UTLRAND             1CE8
UTLRAND:RANDVEC     1D06
UTLRNDIX            25E6
WININIT             202A
WINPLOT             202E
WINPLOT:DONE        2062
WINPLOT:TXT1        2068
WINPLOT:TXT2        2071
WINUPD              202C
ZERO                1B6A
ZERO2               1BDE
