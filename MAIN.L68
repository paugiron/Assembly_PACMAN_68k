0000219C Starting Address
Assembler used: EASy68K Editor/Assembler v5.16.01
Created On: 23/12/2022 15:36:30

00000000                             1  ; ==============================================================================
00000000                             2  ; TITLE       : PAC-MAN 68000
00000000                             3  ; DESCRIPTION : GAME IN MOTOROLA 68000 BASED ON PAC-MAN GAME
00000000                             4  ; AUTHOR      : JORDI FLORIT ENSENYAT
00000000                             5  ;               JOSEP GABRIEL FORNES REYNES
00000000                             6  ;               PAU GIRON RODRIGUEZ
00000000                             7  ; ==============================================================================
00001000                             8              ORG    $1000
00001000                             9  
00001000                            10              INCLUDE "CONST.X68"
00001000                            11  ; ==============================================================================
00001000                            12  ; GAME CONSTANTS
00001000                            13  ; ==============================================================================
00001000                            14  
00001000                            15  ; --- PAC-MAN RELATED CONTANTS ----------------------------------------------------
00001000                            16  
00001000  =0000FFFF                 17  PMPCOL      EQU     $0000FFFF               ; PAC-MAN CONTOUR COLOR
00001000  =0000FFFF                 18  PMFCOL      EQU     $0000FFFF               ; PAC-MAN FILL COLOR
00001000  =00000002                 19  PMSPEED     EQU     2                       ; MAGNITUDE OF THE X AND Y VEL.
00001000  =00000008                 20  PMRAD       EQU     8                       ; PAC-MAN RADIUS
00001000                            21  
00001000                            22  ; --- GHOST RELATED CONSTANTS ----------------------------------------------------
00001000                            23  
00001000  =00000007                 24  GSTSPEED    EQU     7                       ; MAGNITUDE OF THE NORMAL DISPLACEMENT
00001000  =00000005                 25  GSTSPEED2   EQU     5                       ; MAGNITUDE OF THE ATACKED DISPLACEMENT
00001000                            26  
00001000  =000000FF                 27  GSTCOL1     EQU     $000000FF               ; GHOST 1 CONTOUR COLOR RED
00001000  =00FFFFFF                 28  GSTFCOL1    EQU     $00FFFFFF               ; GHOST 1 FILL COLOR WHITE
00001000  =00000002                 29  GSTINX1     EQU     2                       ; GHOST 1 INITIAL X
00001000  =00000002                 30  GSTINY1     EQU     2                       ; GHOST 1 INITIAL Y
00001000                            31  
00001000  =00FF0080                 32  GSTCOL2     EQU     $00FF0080               ; GHOST 2 CONTOUR COLOR PINK
00001000  =00000000                 33  GSTFCOL2    EQU     $00000000               ; GHOST 1 FILL COLOR
00001000  =00000002                 34  GSTINX2     EQU     2                       ; GHOST 2 INITIAL X
00001000  =0000001F                 35  GSTINY2     EQU     31                      ; GHOST 2 INITIAL Y
00001000                            36  
00001000  =00FFFF00                 37  GSTCOL3     EQU     $00FFFF00               ; GHOST 3 CONTOUR COLOR CYAN
00001000  =00000000                 38  GSTFCOL3    EQU     $00000000               ; GHOST 3 FILL COLOR
00001000  =0000001F                 39  GSTINX3     EQU     31                      ; GHOST 3 INITIAL X
00001000  =00000002                 40  GSTINY3     EQU     2                       ; GHOST 3 INITIAL Y
00001000                            41  
00001000  =000080FF                 42  GSTCOL4     EQU     $000080FF               ; GHOST 4 CONTOUR COLOR ORANGE
00001000  =00000000                 43  GSTFCOL4    EQU     $00000000               ; GHOST 4 FILL COLOR
00001000  =0000001F                 44  GSTINX4     EQU     31                      ; GHOST 4 INITIAL X
00001000  =0000001F                 45  GSTINY4     EQU     31                      ; GHOST 4 INITIAL Y 
00001000                            46  
00001000  =00800000                 47  GSTCOL5     EQU     $00800000               ; CONTOUR COLOR OF ATACKED MODE
00001000  =00000000                 48  GSTFCOL5    EQU     $00000000               ; FILL COLOR OF ATACKED MODE
00001000                            49  
00001000  =00000008                 50  GSTRAD      EQU     8                       ; GHOST RADIUS
00001000  =00000010                 51  GSTRNG      EQU     16                      ; GHOST DETECTING RANGE
00001000                            52              
00001000                            53  ; --- SCOREBOARD RELATED CONSTANTS ---------------------------------------------
00001000                            54  ;MODIFICATE
00001000                            55  
00001000  =00000000                 56  SCOFCOL     EQU     $00000000               ; TEXT BACKGROUND COLOR
00001000  =00000101                 57  SCOLINE1    EQU     $0101                   ; FIRST TEXT LINE COORDINATES
00001000  =00000102                 58  SCOLINE2    EQU     $0102                   ; SECOND TEXT LINE COORDINATES
00001000                            59  
00001000                            60  ; --- MAP RELATED CONSTANTS ----------------------------------------------------
00001000                            61  
00001000= 01 01 01 01 01 01 ...     62  MAPMAT      DC.B    $1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
00001020= 01 02 02 02 02 02 ...     63              DC.B    $1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1
00001040= 01 02 01 01 01 01 ...     64              DC.B    $1,2,1,1,1,1,1,2,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,2,1,1,1,1,1,2,1
00001060= 01 03 01 01 01 01 ...     65              DC.B    $1,3,1,1,1,1,1,2,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,2,1,1,1,1,1,3,1
00001080= 01 02 02 02 02 02 ...     66              DC.B    $1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1
000010A0= 01 02 01 01 01 01 ...     67              DC.B    $1,2,1,1,1,1,1,2,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,2,1,1,1,1,1,2,1
000010C0= 01 02 01 01 01 01 ...     68              DC.B    $1,2,1,1,1,1,1,2,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,2,1,1,1,1,1,2,1
000010E0= 01 02 02 02 02 02 ...     69              DC.B    $1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1
00001100= 01 02 01 01 01 01 ...     70              DC.B    $1,2,1,1,1,1,1,2,1,1,1,2,1,1,1,1,1,1,1,1,2,1,1,1,2,1,1,1,1,1,2,1
00001120= 01 02 01 00 00 00 ...     71              DC.B    $1,2,1,0,0,0,1,2,1,0,1,2,1,1,1,1,1,1,1,1,2,1,0,1,2,1,0,0,0,1,2,1
00001140= 01 02 01 01 01 01 ...     72              DC.B    $1,2,1,1,1,1,1,2,1,0,1,2,2,2,2,1,1,2,2,2,2,1,0,1,2,1,1,1,1,1,2,1
00001160= 01 02 02 02 02 02 ...     73              DC.B    $1,2,2,2,2,2,2,2,1,0,1,1,1,1,2,1,1,2,1,1,1,1,0,1,2,2,2,2,2,2,2,1
00001180= 01 01 01 01 01 01 ...     74              DC.B    $1,1,1,1,1,1,1,2,1,0,1,1,1,1,2,1,1,2,1,1,1,1,0,1,2,1,1,1,1,1,1,1
000011A0= 01 00 00 00 00 00 ...     75              DC.B    $1,0,0,0,0,0,1,2,1,0,1,0,0,0,0,0,0,0,0,0,0,1,0,1,2,1,0,0,0,0,0,1
000011C0= 01 00 00 00 00 00 ...     76              DC.B    $1,0,0,0,0,0,1,2,1,0,1,0,1,1,1,0,0,1,1,1,0,1,0,1,2,1,0,0,0,0,0,1
000011E0= 01 01 01 01 01 01 ...     77              DC.B    $1,1,1,1,1,1,1,2,1,1,1,0,1,0,0,0,0,0,0,1,0,1,1,1,2,1,1,1,1,1,1,1
00001200= 04 00 00 00 00 00 ...     78              DC.B    $4,0,0,0,0,0,0,2,2,2,2,0,1,0,0,0,0,0,0,1,0,2,2,2,2,0,0,0,0,0,0,4
00001220= 01 01 01 01 01 01 ...     79              DC.B    $1,1,1,1,1,1,1,2,1,1,1,0,1,0,0,0,0,0,0,1,0,1,1,1,2,1,1,1,1,1,1,1
00001240= 01 00 00 00 00 00 ...     80              DC.B    $1,0,0,0,0,0,1,2,1,0,1,0,1,1,1,1,1,1,1,1,0,1,0,1,2,1,0,0,0,0,0,1
00001260= 01 00 00 00 00 00 ...     81              DC.B    $1,0,0,0,0,0,1,2,1,0,1,0,0,0,0,0,0,0,0,0,0,1,0,1,2,1,0,0,0,0,0,1
00001280= 01 01 01 01 01 01 ...     82              DC.B    $1,1,1,1,1,1,1,2,1,1,1,0,1,1,1,1,1,1,1,1,0,1,1,1,2,1,1,1,1,1,1,1
000012A0= 01 02 02 02 02 02 ...     83              DC.B    $1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1
000012C0= 01 02 01 01 01 01 ...     84              DC.B    $1,2,1,1,1,1,1,2,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,2,1,1,1,1,1,2,1
000012E0= 01 02 01 01 01 01 ...     85              DC.B    $1,2,1,1,1,1,1,2,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,2,1,1,1,1,1,2,1
00001300= 01 02 02 02 02 01 ...     86              DC.B    $1,2,2,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,2,2,2,1
00001320= 01 01 01 01 02 01 ...     87              DC.B    $1,1,1,1,2,1,1,2,1,1,1,2,1,1,1,1,1,1,1,1,2,1,1,1,2,1,1,2,1,1,1,1
00001340= 01 01 01 01 02 01 ...     88              DC.B    $1,1,1,1,2,1,1,2,1,0,1,2,1,1,1,1,1,1,1,1,2,1,0,1,2,1,1,2,1,1,1,1
00001360= 01 02 02 02 02 02 ...     89              DC.B    $1,2,2,2,2,2,2,2,1,0,1,2,2,2,2,1,1,2,2,2,2,1,0,1,2,2,2,2,2,2,2,1
00001380= 01 02 01 01 01 01 ...     90              DC.B    $1,2,1,1,1,1,1,1,1,0,1,1,1,1,2,1,1,2,1,1,1,1,0,1,1,1,1,1,1,1,2,1
000013A0= 01 03 01 01 01 01 ...     91              DC.B    $1,3,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,3,1
000013C0= 01 02 02 02 02 02 ...     92              DC.B    $1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1
000013E0= 01 01 01 01 01 01 ...     93              DC.B    $1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
00001400                            94              
00001400                            95  ; --- STATE RELATED CONSTANTS --------------------------------------------------
00001400                            96  
00001400  =FFFFFFFF                 97  STANONE     EQU     -1                      ; NON-EXISTENT STATE NUMBER
00001400                            98  
00001400                            99  
00001400                           100  
00001400                           101  
00001400                           102  
00001400                           103  
00001400                           104  
00001400                           105  
00001400                           106  
00001400                           107  
00001400                           108  
00001400                           109  
00001400                           110  
00001400                           111  
00001400                           112  
00001400                           113  
00001400                           114  
00001400                           115  
00001400                           116  
00001400                           117  
00001400                           118  
00001400                           119  
00001400                           120  
00001400                           121  -------------------- end include --------------------
00001400                           122              INCLUDE "GHOST.X68"
00001400                           123  ; ==============================================================================
00001400                           124  ; GHOST MANAGEMENT
00001400                           125  ; ==============================================================================
00001400                           126              
00001400                           127  ; ------------------------------------------------------------------------------
00001400                           128  GSTINIT
00001400                           129  ; INITIALIZE GHOST.
00001400                           130  ; INPUT    : NONE 
00001400                           131  ; OUTPUT   : NONE
00001400                           132  ; MODIFIES : NONE
00001400                           133  ; ------------------------------------------------------------------------------
00001400  33FC 0058 000025D8       134              MOVE.W  #GSTINX1*16+64-8,(GSTPOSX)
00001408  33FC 0058 000025DA       135              MOVE.W  #GSTINY1*16+64-8,(GSTPOSY)
00001410  33FC 0007 000025DC       136              MOVE.W  #GSTSPEED,(GSTVELX)
00001418  33FC 0007 000025DE       137              MOVE.W  #GSTSPEED,(GSTVELY)
00001420  4239 000025E1            138              CLR.B   (GSTLAMO)
00001426  4E75                     139              RTS
00001428                           140              
00001428                           141  ; ------------------------------------------------------------------------------
00001428                           142  GSTUPD
00001428                           143  ; UPDATES THE GHOST.
00001428                           144  ; INPUT    : NONE 
00001428                           145  ; OUTPUT   : NONE
00001428                           146  ; MODIFIES : NONE
00001428                           147  ; ------------------------------------------------------------------------------
00001428  48E7 F800                148              MOVEM.L D0-D4,-(A7)
0000142C                           149              
0000142C                           150              ;MOVE.W  (PMPOSX)/16*(PMPOSX)/16+(PMPOSY)/16*(PMPOSY)/16-#GSTRNG*#GSTRNG,D0
0000142C  6600 000E                151              BNE     .GSTINRNG
00001430                           152  .GSTNOTINRNG
00001430  13FC 0001 000025E2       153              MOVE.B  #1,(GSTINRNG)
00001438  6000 000A                154              BRA     .CHECKCRITIC
0000143C                           155  .GSTINRNG
0000143C  13FC 0000 000025E2       156              MOVE.B  #0,(GSTINRNG)
00001444                           157  .CHECKCRITIC
00001444                           158              
00001444                           159  
00001444  4CDF 001F                160              MOVEM.L (A7)+,D0-D4
00001448                           161              
00001448  4E75                     162              RTS
0000144A                           163              
0000144A                           164  ; ------------------------------------------------------------------------------
0000144A                           165  GSTPLOT
0000144A                           166  ; PLOT THE GHOST.
0000144A                           167  ; INPUT    : NONE 
0000144A                           168  ; OUTPUT   : NONE
0000144A                           169  ; MODIFIES : NONE
0000144A                           170  ; ------------------------------------------------------------------------------
0000144A  48E7 F800                171              MOVEM.L D0-D4,-(A7)
0000144E                           172              
0000144E                           173              ;SET PEN COLOR
0000144E  303C 0050                174              MOVE.W  #80,D0
00001452  223C 000000FF            175              MOVE.L  #GSTCOL1,D1
00001458  4E4F                     176              TRAP    #15
0000145A                           177              
0000145A                           178              ;SET FILL COLOR
0000145A  303C 0051                179              MOVE.W  #81,D0
0000145E  223C 00FFFFFF            180              MOVE.L  #GSTFCOL1,D1
00001464  4E4F                     181              TRAP    #15
00001466                           182              
00001466                           183              ;SET COORDS
00001466  3239 000025D8            184              MOVE.W  (GSTPOSX),D1
0000146C  5141                     185              SUB.W   #GSTRAD,D1
0000146E  3439 000025DA            186              MOVE.W  (GSTPOSY),D2
00001474  5142                     187              SUB.W   #GSTRAD,D2
00001476                           188              
00001476  3601                     189              MOVE.W  D1,D3
00001478  0643 0010                190              ADD.W   #GSTRAD*2,D3
0000147C  3802                     191              MOVE.W  D2,D4
0000147E  0644 0010                192              ADD.W   #GSTRAD*2,D4
00001482                           193              
00001482                           194              ;DRAW GHOST
00001482  303C 0058                195              MOVE.W  #88,D0
00001486  4E4F                     196              TRAP    #15
00001488                           197              
00001488                           198              ;SET RANGE COORDS
00001488  3239 000025D8            199              MOVE.W  (GSTPOSX),D1
0000148E  0441 0100                200              SUB.W   #GSTRNG*16,D1
00001492  3439 000025DA            201              MOVE.W  (GSTPOSY),D2
00001498  0442 0100                202              SUB.W   #GSTRNG*16,D2
0000149C                           203              
0000149C  3601                     204              MOVE.W  D1,D3
0000149E  0643 0200                205              ADD.W   #GSTRNG*16*2,D3
000014A2  3802                     206              MOVE.W  D2,D4
000014A4  0644 0200                207              ADD.W   #GSTRNG*16*2,D4
000014A8                           208              
000014A8                           209              ;DRAW GHOST RANGE
000014A8  303C 005B                210              MOVE.W  #91,D0
000014AC  4E4F                     211              TRAP    #15
000014AE                           212              
000014AE  4CDF 001F                213              MOVEM.L (A7)+,D0-D4
000014B2                           214              
000014B2                           215  
000014B2  4E75                     216              RTS
000014B4                           217  
000014B4                           218  
000014B4                           219  
000014B4                           220  
000014B4                           221  
000014B4                           222  -------------------- end include --------------------
000014B4                           223              INCLUDE "PAC-MAN.X68"
000014B4                           224  ; ==============================================================================
000014B4                           225  ; PAC-MAN MANAGEMENT
000014B4                           226  ; ==============================================================================
000014B4                           227              
000014B4                           228  ; ------------------------------------------------------------------------------
000014B4                           229  PMINIT
000014B4                           230  ; INITIALIZE PAC-MAN.
000014B4                           231  ; INPUT    : NONE 
000014B4                           232  ; OUTPUT   : NONE
000014B4                           233  ; MODIFIES : NONE
000014B4                           234  ; ------------------------------------------------------------------------------
000014B4                           235  
000014B4  33FC 0140 000025CE       236              MOVE.W  #SCRWIDTH/2,(PMPOSX)
000014BC  33FC 0140 000025D0       237              MOVE.W  #SCRHEIGH/2,(PMPOSY)
000014C4  5079 000025CE            238              ADDQ.W  #8,(PMPOSX)
000014CA  5079 000025D0            239              ADDQ.W  #8,(PMPOSY)
000014D0  33FC 0002 000025D2       240              MOVE.W  #PMSPEED,(PMVELX)
000014D8  33FC 0002 000025D4       241              MOVE.W  #PMSPEED,(PMVELY)
000014E0  4239 000025D7            242              CLR.B   (PMLAMO)
000014E6                           243  
000014E6  4E75                     244              RTS
000014E8                           245              
000014E8                           246  ; ------------------------------------------------------------------------------
000014E8                           247  PMUPD
000014E8                           248  ; UPDATES THE PAC-MAN.
000014E8                           249  ; INPUT    : NONE 
000014E8                           250  ; OUTPUT   : NONE
000014E8                           251  ; MODIFIES : NONE
000014E8                           252  ; ------------------------------------------------------------------------------
000014E8                           253              
000014E8  48E7 FE00                254              MOVEM.L D0-D6,-(A7)
000014EC                           255              
000014EC  303C 0002                256              MOVE.W  #PMSPEED,D0
000014F0                           257              
000014F0                           258              
000014F0  3439 000025CE            259              MOVE.W  (PMPOSX),D2
000014F6  3639 000025D0            260              MOVE.W  (PMPOSY),D3
000014FC                           261              
000014FC  5042                     262              ADDQ.W  #8,D2              
000014FE  5043                     263              ADDQ.W  #8,D3  
00001500                           264              
00001500  1839 000025D7            265              MOVE.B  (PMLAMO),D4
00001506                           266              
00001506                           267              ;MASK OF THE LAST NIBBLE        
00001506  C47C 000F                268              AND.W   #$000F,D2               ; COORDENADA X
0000150A  C67C 000F                269              AND.W   #$000F,D3               ; COORDENADA Y
0000150E                           270              
0000150E                           271              ;CHECK IF COORDS ARE MULTIPLES OF 16
0000150E  B47C 0000                272              CMP     #$0000,D2
00001512  6600 00F6                273              BNE     .NOTMULT
00001516  B67C 0000                274              CMP     #$0000,D3
0000151A  6600 00EE                275              BNE     .NOTMULT
0000151E                           276              
0000151E                           277              ;BRA     .ACTYUP
0000151E                           278  
0000151E                           279              ;CHECK THE DIRECTION
0000151E  0839 0000 000021C8       280              BTST.B  #0,(KBDVAL)             ;CHECK LEFT
00001526  6700 000C                281              BEQ     .NOTLEFT
0000152A  4204                     282              CLR.B   D4
0000152C  183C 0000                283              MOVE.B  #0,D4
00001530  6000 0074                284              BRA     .ACTXLEFT
00001534                           285  .NOTLEFT            
00001534  0839 0002 000021C8       286              BTST.B   #2,(KBDVAL)             ;CHECK RIGHT
0000153C  6700 000C                287              BEQ     .NOTRIGHT
00001540  4204                     288              CLR.B   D4
00001542  183C 0001                289              MOVE.B   #1,D4
00001546  6000 0032                290              BRA     .ACTXRIGHT
0000154A                           291  .NOTRIGHT            
0000154A  0839 0001 000021C8       292              BTST.B   #1,(KBDVAL)             ;CHECK UP
00001552  6700 000C                293              BEQ     .NOTUP
00001556  4204                     294              CLR.B   D4
00001558  183C 0002                295              MOVE.B  #2,D4
0000155C  6000 0090                296              BRA     .ACTYUP
00001560                           297  .NOTUP            
00001560  0839 0003 000021C8       298              BTST.B   #3,(KBDVAL)             ;CHECK DOWN
00001568  6700 000C                299              BEQ     .NOTDOWN
0000156C  4204                     300              CLR.B   D4
0000156E  183C 0003                301              MOVE.B   #3,D4
00001572  6000 005E                302              BRA     .ACTYDOWN
00001576                           303  .NOTDOWN
00001576  6000 00A8                304              BRA     .DONE
0000157A                           305              
0000157A                           306              
0000157A                           307              ;UPDATE COORDS
0000157A                           308              
0000157A                           309  .ACTXRIGHT  
0000157A  4EB9 0000199E            310              JSR     COLWALLRIGHT
00001580  BA7C 0001                311              CMP     #1,D5
00001584  6600 0006                312              BNE     .NOTCOLISION
00001588  303C 0000                313              MOVE.W  #0,D0
0000158C                           314  .NOTCOLISION
0000158C  BA7C 0004                315              CMP     #4,D5
00001590  6600 000A                316              BNE     .NOTTP
00001594  0479 01E0 000025CE       317              SUB.W   #30*16,(PMPOSX)
0000159C                           318  .NOTTP
0000159C  D179 000025CE            319              ADD.W   D0,(PMPOSX)
000015A2  6000 007C                320              BRA     .DONE
000015A6                           321  .ACTXLEFT
000015A6  4EB9 000019E0            322              JSR     COLWALLLEFT
000015AC  BA7C 0001                323              CMP     #1,D5
000015B0  6600 0006                324              BNE     .NOTCOLISION2
000015B4  303C 0000                325              MOVE.W  #0,D0
000015B8                           326  .NOTCOLISION2
000015B8  BA7C 0004                327              CMP     #4,D5
000015BC  6600 000A                328              BNE     .NOTTP2
000015C0  0679 01E0 000025CE       329              ADD.W   #30*16,(PMPOSX)
000015C8                           330  .NOTTP2
000015C8  9179 000025CE            331              SUB.W   D0,(PMPOSX)
000015CE  6000 0050                332              BRA     .DONE
000015D2                           333      
000015D2                           334  .ACTYDOWN
000015D2  4EB9 00001A22            335              JSR     COLWALLDOWN
000015D8  BA7C 0001                336              CMP     #1,D5
000015DC  6600 0006                337              BNE     .NOTCOLISION3
000015E0  303C 0000                338              MOVE.W  #0,D0
000015E4                           339  .NOTCOLISION3
000015E4  D179 000025D0            340              ADD.W   D0,(PMPOSY)
000015EA  6000 0034                341              BRA     .DONE
000015EE                           342  .ACTYUP     
000015EE  4EB9 00001A5E            343              JSR     COLWALLUP
000015F4  BA7C 0001                344              CMP     #1,D5
000015F8  6600 0006                345              BNE     .NOTCOLISION4
000015FC  303C 0000                346              MOVE.W  #0,D0
00001600                           347  .NOTCOLISION4
00001600  9179 000025D0            348              SUB.W   D0,(PMPOSY)
00001606  6000 0018                349              BRA     .DONE
0000160A                           350              
0000160A                           351              
0000160A                           352              ;IF NOT MULT DO
0000160A                           353  .NOTMULT     
0000160A  B83C 0000                354              CMP.B     #0,D4
0000160E  6796                     355              BEQ     .ACTXLEFT
00001610  B83C 0001                356              CMP.B     #1,D4
00001614  6700 FF64                357              BEQ     .ACTXRIGHT
00001618  B83C 0002                358              CMP.B     #2,D4
0000161C  67D0                     359              BEQ     .ACTYUP
0000161E  60B2                     360              BRA     .ACTYDOWN
00001620                           361  .DONE
00001620                           362              ;RESTORE
00001620  4EB9 00001A9C            363              JSR     GETPOINTS
00001626  13C4 000025D7            364              MOVE.B  D4,(PMLAMO)
0000162C                           365              
0000162C  4CDF 007F                366              MOVEM.L (A7)+,D0-D6
00001630                           367              
00001630  4E75                     368              RTS
00001632                           369                          
00001632                           370  ; ------------------------------------------------------------------------------
00001632                           371  PMPLOT
00001632                           372  ; PLOT THE BALL.
00001632                           373  ; INPUT    : NONE 
00001632                           374  ; OUTPUT   : NONE
00001632                           375  ; MODIFIES : NONE
00001632                           376  ; ------------------------------------------------------------------------------
00001632                           377  
00001632  48E7 F800                378              MOVEM.L D0-D4,-(A7)
00001636                           379  
00001636                           380              ;SET PEN COLOR
00001636  303C 0050                381              MOVE.W  #80,D0
0000163A  7200                     382              MOVE.L  #$0000,D1
0000163C  4E4F                     383              TRAP    #15
0000163E                           384              
0000163E                           385              ;SET FILL COLOR
0000163E  303C 0051                386              MOVE.W  #81,D0
00001642  223C 0000FFFF            387              MOVE.L  #PMFCOL,D1
00001648  4E4F                     388              TRAP    #15
0000164A                           389              
0000164A                           390              ;DRAW QUIET
0000164A  4EB9 000016CC            391              JSR     .FULLDRAW
00001650  1A39 000021C8            392              MOVE.B  (KBDVAL),D5
00001656  CA3C 000F                393              AND.B   #$0F,D5
0000165A                           394  
0000165A                           395              ;CHECK KBDVAL
0000165A  BA3C 0001                396              CMP.B  #$1,D5             ;LEFT
0000165E  6700 002E                397              BEQ     .DLEFT
00001662  BA3C 0002                398              CMP.B  #$2,D5             ;UP
00001666  6700 001C                399              BEQ     .DUP
0000166A  BA3C 0004                400              CMP.B  #$4,D5             ;RIGHT
0000166E  6700 000A                401              BEQ     .DRIGHT
00001672  BA3C 0008                402              CMP.B  #$8,D5             ;DOWN
00001676  6700 0020                403              BEQ     .DDOWN
0000167A                           404              
0000167A                           405              ;DRAW MOVEMENT
0000167A                           406  .DRIGHT
0000167A  4EB9 00001722            407              JSR     .RIGHTDRAW
00001680  6000 0034                408              BRA     .DRAW_MOUTH3
00001684                           409  .DUP
00001684  4EB9 00001754            410              JSR     .UPDRAW
0000168A  6000 0020                411              BRA     .DRAW_MOUTH2
0000168E                           412  
0000168E                           413  .DLEFT
0000168E  4EB9 000016F0            414              JSR     .LEFTDRAW
00001694  6000 000C                415              BRA     .DRAW_MOUTH1
00001698                           416  
00001698                           417  .DDOWN
00001698  4EB9 00001786            418              JSR     .DOWNDRAW
0000169E  6000 0020                419              BRA     .DRAW_MOUTH4
000016A2                           420              
000016A2                           421  .DRAW_MOUTH1            
000016A2  4EB9 000017B8            422              JSR     .SET_MOUTHLEFT
000016A8  6000 001C                423              BRA     .DDONE
000016AC                           424  .DRAW_MOUTH2            
000016AC  4EB9 000017F4            425              JSR     .SET_MOUTHUP
000016B2  6000 0012                426              BRA     .DDONE
000016B6                           427  .DRAW_MOUTH3            
000016B6  4EB9 000017D6            428              JSR     .SET_MOUTHRIGHT
000016BC  6000 0008                429              BRA     .DDONE
000016C0                           430  .DRAW_MOUTH4            
000016C0  4EB9 00001812            431              JSR     .SET_MOUTHDOWN
000016C6                           432  .DDONE
000016C6  4CDF 001F                433              MOVEM.L (A7)+,D0-D4
000016CA                           434              
000016CA  4E75                     435              RTS
000016CC                           436  
000016CC                           437  
000016CC                           438  ;INTERNAL SUBRUTINES FOR PACMAN PLOT-------------------------------------------------------------
000016CC                           439  
000016CC                           440  .FULLDRAW
000016CC                           441              ;SET COORDS
000016CC  3239 000025CE            442              MOVE.W  (PMPOSX),D1
000016D2  5141                     443              SUB.W   #PMRAD,D1
000016D4  3439 000025D0            444              MOVE.W  (PMPOSY),D2
000016DA  5142                     445              SUB.W   #PMRAD,D2
000016DC                           446              
000016DC  3601                     447              MOVE.W  D1,D3
000016DE  0643 0010                448              ADD.W   #PMRAD*2,D3
000016E2  3802                     449              MOVE.W  D2,D4
000016E4  0644 0010                450              ADD.W   #PMRAD*2,D4
000016E8                           451              
000016E8                           452              ;DRAW PAC-MAN
000016E8  303C 0058                453              MOVE.W  #88,D0
000016EC  4E4F                     454              TRAP    #15
000016EE                           455              
000016EE  4E75                     456              RTS
000016F0                           457  .LEFTDRAW
000016F0                           458              
000016F0                           459              
000016F0  303C 0054                460              MOVE.W  #84,D0
000016F4  3239 000025CE            461              MOVE.W  (PMPOSX),D1                   ;FINAL COORD OF THE FIRST LINE
000016FA  5141                     462              SUB.W   #PMRAD,D1
000016FC  3439 000025D0            463              MOVE.W  (PMPOSY),D2
00001702  5142                     464              SUB.W   #PMRAD,D2
00001704                           465              
00001704  3639 000025CE            466              MOVE.W  (PMPOSX),D3                   ;ORIGINAL COORD FIRST LINE
0000170A  3839 000025D0            467              MOVE.W  (PMPOSY),D4
00001710                           468              
00001710  4E4F                     469              TRAP    #15
00001712                           470             
00001712  303C 0055                471              MOVE.W  #85,D0                        ;DRAW SECOND LINE
00001716                           472              
00001716  3203                     473              MOVE.W  D3,D1
00001718  3404                     474              MOVE.W  D4,D2
0000171A  5042                     475              ADD.W   #PMRAD,D2
0000171C  5141                     476              SUB.W   #PMRAD,D1
0000171E                           477              
0000171E  4E4F                     478              TRAP    #15
00001720                           479              
00001720                           480              
00001720  4E75                     481              RTS
00001722                           482              
00001722                           483  .RIGHTDRAW
00001722                           484              
00001722                           485              
00001722  303C 0054                486              MOVE.W  #84,D0
00001726  3239 000025CE            487              MOVE.W  (PMPOSX),D1                   ;FINAL COORD OF THE FIRST LINE
0000172C  5041                     488              ADD.W   #PMRAD,D1
0000172E  3439 000025D0            489              MOVE.W  (PMPOSY),D2
00001734  5042                     490              ADD.W   #PMRAD,D2
00001736                           491              
00001736  3639 000025CE            492              MOVE.W  (PMPOSX),D3                   ;ORIGINAL COORD FIRST LINE
0000173C  3839 000025D0            493              MOVE.W  (PMPOSY),D4
00001742                           494              
00001742  4E4F                     495              TRAP    #15
00001744                           496             
00001744  303C 0055                497              MOVE.W  #85,D0                        ;DRAW SECOND LINE
00001748                           498              
00001748  3203                     499              MOVE.W  D3,D1
0000174A  3404                     500              MOVE.W  D4,D2
0000174C  5142                     501              SUB.W   #PMRAD,D2
0000174E  5041                     502              ADD.W   #PMRAD,D1
00001750                           503              
00001750  4E4F                     504              TRAP    #15
00001752                           505              
00001752                           506              
00001752  4E75                     507              RTS
00001754                           508  .UPDRAW
00001754                           509              
00001754                           510              
00001754  303C 0054                511              MOVE.W  #84,D0
00001758  3239 000025CE            512              MOVE.W  (PMPOSX),D1                   ;FINAL COORD OF THE FIRST LINE
0000175E  5141                     513              SUB.W   #PMRAD,D1
00001760  3439 000025D0            514              MOVE.W  (PMPOSY),D2
00001766  5142                     515              SUB.W   #PMRAD,D2
00001768                           516              
00001768  3639 000025CE            517              MOVE.W  (PMPOSX),D3                   ;ORIGINAL COORD FIRST LINE
0000176E  3839 000025D0            518              MOVE.W  (PMPOSY),D4
00001774                           519              
00001774  4E4F                     520              TRAP    #15
00001776                           521             
00001776  303C 0055                522              MOVE.W  #85,D0                        ;DRAW SECOND LINE
0000177A                           523              
0000177A  3203                     524              MOVE.W  D3,D1
0000177C  3404                     525              MOVE.W  D4,D2
0000177E  5142                     526              SUB.W   #PMRAD,D2
00001780  5041                     527              ADD.W   #PMRAD,D1
00001782                           528              
00001782  4E4F                     529              TRAP    #15
00001784                           530              
00001784                           531              
00001784  4E75                     532              RTS
00001786                           533              
00001786                           534  .DOWNDRAW
00001786                           535              
00001786                           536              
00001786  303C 0054                537              MOVE.W  #84,D0
0000178A  3239 000025CE            538              MOVE.W  (PMPOSX),D1                   ;FINAL COORD OF THE FIRST LINE
00001790  5141                     539              SUB.W   #PMRAD,D1
00001792  3439 000025D0            540              MOVE.W  (PMPOSY),D2
00001798  5042                     541              ADD.W   #PMRAD,D2
0000179A                           542              
0000179A  3639 000025CE            543              MOVE.W  (PMPOSX),D3                   ;ORIGINAL COORD FIRST LINE
000017A0  3839 000025D0            544              MOVE.W  (PMPOSY),D4
000017A6                           545              
000017A6  4E4F                     546              TRAP    #15
000017A8                           547             
000017A8  303C 0055                548              MOVE.W  #85,D0                        ;DRAW SECOND LINE
000017AC                           549              
000017AC  3203                     550              MOVE.W  D3,D1
000017AE  3404                     551              MOVE.W  D4,D2
000017B0  5042                     552              ADD.W   #PMRAD,D2
000017B2  5041                     553              ADD.W   #PMRAD,D1
000017B4                           554              
000017B4  4E4F                     555              TRAP    #15
000017B6                           556              
000017B6                           557              
000017B6  4E75                     558              RTS
000017B8                           559  
000017B8                           560              
000017B8                           561  .SET_MOUTHLEFT
000017B8                           562              
000017B8  303C 0051                563              MOVE.W  #81,D0                         ;SET BLACK
000017BC  7200                     564              MOVE.L  #$0000,D1
000017BE  4E4F                     565              TRAP    #15
000017C0                           566              
000017C0  303C 0059                567              MOVE.W  #89,D0                         ;FILL
000017C4  3239 000025CE            568              MOVE.W  (PMPOSX),D1
000017CA  5541                     569              SUBQ.W   #2,D1
000017CC  3439 000025D0            570              MOVE.W  (PMPOSY),D2
000017D2  4E4F                     571              TRAP    #15
000017D4                           572  
000017D4  4E75                     573              RTS
000017D6                           574              
000017D6                           575  .SET_MOUTHRIGHT
000017D6                           576              
000017D6  303C 0051                577              MOVE.W  #81,D0                         ;SET BLACK
000017DA  7200                     578              MOVE.L  #$0000,D1
000017DC  4E4F                     579              TRAP    #15
000017DE                           580              
000017DE  303C 0059                581              MOVE.W  #89,D0                         ;FILL
000017E2  3239 000025CE            582              MOVE.W  (PMPOSX),D1
000017E8  5441                     583              ADDQ.W   #2,D1
000017EA  3439 000025D0            584              MOVE.W  (PMPOSY),D2
000017F0  4E4F                     585              TRAP    #15
000017F2                           586  
000017F2  4E75                     587              RTS
000017F4                           588  
000017F4                           589  .SET_MOUTHUP
000017F4                           590              
000017F4  303C 0051                591              MOVE.W  #81,D0                         ;SET BLACK
000017F8  7200                     592              MOVE.L  #$0000,D1
000017FA  4E4F                     593              TRAP    #15
000017FC                           594              
000017FC  303C 0059                595              MOVE.W  #89,D0                         ;FILL
00001800  3239 000025CE            596              MOVE.W  (PMPOSX),D1
00001806  3439 000025D0            597              MOVE.W  (PMPOSY),D2
0000180C  5542                     598              SUBQ.W   #2,D2
0000180E  4E4F                     599              TRAP    #15
00001810                           600  
00001810  4E75                     601              RTS
00001812                           602  
00001812                           603  .SET_MOUTHDOWN
00001812                           604              
00001812  303C 0051                605              MOVE.W  #81,D0                         ;SET BLACK
00001816  7200                     606              MOVE.L  #$0000,D1
00001818  4E4F                     607              TRAP    #15
0000181A                           608              
0000181A  303C 0059                609              MOVE.W  #89,D0                         ;FILL
0000181E  3239 000025CE            610              MOVE.W  (PMPOSX),D1
00001824  3439 000025D0            611              MOVE.W  (PMPOSY),D2
0000182A  5442                     612              ADDQ.W   #2,D2
0000182C  4E4F                     613              TRAP    #15
0000182E                           614  
0000182E  4E75                     615              RTS
00001830                           616  
00001830                           617  
00001830                           618  
00001830                           619  
00001830                           620  
00001830                           621  
00001830                           622  
00001830                           623  
00001830                           624  
00001830                           625  
00001830                           626  
00001830                           627  
00001830                           628  
00001830                           629  
00001830                           630  
00001830                           631  
00001830                           632  
00001830                           633  
00001830                           634  
00001830                           635  
00001830                           636  
00001830                           637  
00001830                           638  
00001830                           639  
00001830                           640  
00001830                           641  
00001830                           642  -------------------- end include --------------------
00001830                           643              INCLUDE "SCORE.X68"
00001830                           644  ; ==============================================================================
00001830                           645  ; SCOREBOARD MANAGEMENT
00001830                           646  ; ==============================================================================
00001830                           647              
00001830                           648  ; ------------------------------------------------------------------------------
00001830                           649  SCOINIT
00001830                           650  ; INITIALIZE SCOREBOARD
00001830                           651  ; INPUT    : NONE 
00001830                           652  ; OUTPUT   : NONE
00001830                           653  ; MODIFIES : NONE
00001830                           654  ; ------------------------------------------------------------------------------
00001830  4279 000025E6            655              CLR.W   (SCOPOINTS)
00001836  33FC 0003 000025E4       656              MOVE.W  #3,(SCOLIFE)
0000183E  4E75                     657              RTS
00001840                           658              
00001840                           659  ; ------------------------------------------------------------------------------
00001840                           660  SCOPLOT
00001840                           661  ; PLOT THE SCOREBOARD
00001840                           662  ; INPUT    : NONE 
00001840                           663  ; OUTPUT   : NONE
00001840                           664  ; MODIFIES : NONE
00001840                           665  ; ------------------------------------------------------------------------------
00001840                           666              
00001840  48E7 C040                667               MOVEM.L D0-D1/A1,-(A7)
00001844                           668  
00001844                           669              ; SET BACKGROUND COLOR
00001844  103C 0051                670              MOVE.B  #81,D0
00001848  7200                     671              MOVE.L  #SCOFCOL,D1
0000184A  4E4F                     672              TRAP    #15
0000184C                           673              
0000184C                           674              ; SET FIRST LINE POSITION
0000184C  103C 000B                675              MOVE.B  #11,D0
00001850  323C 0101                676              MOVE.W  #SCOLINE1,D1
00001854  4E4F                     677              TRAP    #15
00001856                           678  
00001856                           679              ; PRINT FIRST LINE
00001856  43F9 0000188E            680              LEA     .TXT1,A1            ;PUT FIRST STRING IN A1
0000185C  4281                     681              CLR.L   D1
0000185E  3239 000025E6            682              MOVE.W  (SCOPOINTS),D1
00001864  103C 0011                683              MOVE.B  #17,D0
00001868  4E4F                     684              TRAP    #15
0000186A                           685  
0000186A                           686              ; SET SECOND LINE POSITION
0000186A  103C 000B                687              MOVE.B  #11,D0
0000186E  323C 0102                688              MOVE.W  #SCOLINE2,D1       
00001872  4E4F                     689              TRAP    #15
00001874                           690  
00001874                           691              ; PRINT SECOND LINE
00001874  43F9 00001897            692              LEA     .TXT2,A1
0000187A  4281                     693              CLR.L   D1
0000187C  3239 000025E4            694              MOVE.W  (SCOLIFE),D1
00001882  103C 0011                695              MOVE.B  #17,D0
00001886  4E4F                     696              TRAP    #15
00001888                           697              
00001888  4CDF 0203                698              MOVEM.L (A7)+,D0-D1/A1
0000188C                           699              
0000188C  4E75                     700              RTS
0000188E                           701  
0000188E= 50 4F 49 4E 54 53 ...    702  .TXT1       DC.B    'POINTS :',0      ;0 IS END OF STRING
00001897= 4C 49 46 45 53 20 ...    703  .TXT2       DC.B    'LIFES  :',0
000018A0                           704  
000018A0                           705  
000018A0  4E75                     706              RTS
000018A2                           707  
000018A2                           708  
000018A2                           709  -------------------- end include --------------------
000018A2                           710              INCLUDE "SYSCONST.X68"
000018A2                           711  ; ==============================================================================
000018A2                           712  ; SYSTEM CONSTANTS
000018A2                           713  ; ==============================================================================
000018A2                           714  
000018A2                           715  ; --- SCREEN RELATED CONSTANTS -------------------------------------------------
000018A2                           716  
000018A2  =00000280                717  SCRWIDTH    EQU     640                     ; SCREEN WIDTH
000018A2  =00000280                718  SCRHEIGH    EQU     640                     ; SCREEN HEIGHT
000018A2                           719  
000018A2                           720  ;---KEYCODES--------------------------------------------------------------------
000018A2                           721  
000018A2  =00000025                722  KBDLEFT     EQU     $25
000018A2  =00000026                723  KBDUP       EQU     $26
000018A2  =00000027                724  KBDRIGHT    EQU     $27
000018A2  =00000028                725  KBDDOWN     EQU     $28
000018A2  =00000020                726  KBDFIRE1    EQU     ' '
000018A2  =0000004D                727  KBDFIRE2    EQU     'M'                         
000018A2  =00000010                728  KBDFIRE3    EQU     $10
000018A2  =00000050                729  KBDPAUSE    EQU     'P'
000018A2                           730  
000018A2                           731  
000018A2                           732  
000018A2                           733  
000018A2                           734  
000018A2                           735  
000018A2                           736  
000018A2                           737  
000018A2                           738  
000018A2                           739  -------------------- end include --------------------
000018A2                           740              INCLUDE "SYSTEM.X68"
000018A2                           741  ; ==============================================================================
000018A2                           742  ; SYSTEM
000018A2                           743  ; ==============================================================================
000018A2                           744              
000018A2                           745  ; ------------------------------------------------------------------------------
000018A2                           746  SYSINIT
000018A2                           747  ; INITIALIZE SYSTEM.
000018A2                           748  ; INPUT    : NONE
000018A2                           749  ; OUTPUT   : NONE
000018A2                           750  ; MODIFIES : NONE
000018A2                           751  ; ------------------------------------------------------------------------------
000018A2                           752              
000018A2  21FC 00001912 0080       753              MOVE.L  #SCRUPD,($80+0*4)          ;INSTALL SUBRUTINE TO TRAP #0
000018AA  21FC 00001948 0084       754              MOVE.L  #KBDUPD,($80+1*4)          ;INSTALL SUBRUTINE TO TRAP #1
000018B2                           755              
000018B2                           756              
000018B2  21FC 0000192C 0064       757              MOVE.L  #SCRTIM,($60+1*4)          ;INSTALL INTERRUPT #1
000018BA                           758              
000018BA  4EB9 000018CE            759              JSR     SCRINIT
000018C0  4EB9 0000193A            760              JSR     KBDINIT
000018C6                           761              
000018C6                           762              
000018C6  40E7                     763              MOVE.W  SR,-(A7)
000018C8  0257 D8FF                764              ANDI.W  #$D8FF,(A7)                ;BIT SUPERVISOR TO O AND INTERRPUT MASK 000 (FOR REACTIVATE INTERRUPTIONS)             
000018CC  4E73                     765              RTE
000018CE                           766     
000018CE                           767  ; ------------------------------------------------------------------------------
000018CE                           768  SCRINIT
000018CE                           769  ; INIT SCREEN. SET SCREEN RESOLUTION, SET WINDOWED MODE, CLEAR SCREEN, ENABLE BUFFER
000018CE                           770  ; ENABLE TIMED INTERRUPTION
000018CE                           771  ; INPUT    : NONE
000018CE                           772  ; OUTPUT   : NONE
000018CE                           773  ; MODIFIES : NONE
000018CE                           774  ; ------------------------------------------------------------------------------
000018CE                           775  
000018CE  48E7 C000                776              MOVEM.L D0-D1,-(A7)                 ;SAFE REGISTERS IN STACK
000018D2                           777  
000018D2                           778              ; SET SCREEN RESOLUTION
000018D2  103C 0021                779              MOVE.B  #33,D0
000018D6  223C 02800280            780              MOVE.L  #SCRWIDTH<<16|SCRHEIGH,D1
000018DC  4E4F                     781              TRAP    #15
000018DE                           782              
000018DE                           783              ; SET WINDOWED MODE
000018DE  7201                     784              MOVE.L  #1,D1
000018E0  4E4F                     785              TRAP    #15
000018E2                           786              
000018E2                           787              ; ENABLE DOUBLE BUFFER
000018E2  103C 005C                788              MOVE.B  #92,D0
000018E6  123C 0011                789              MOVE.B  #17,D1
000018EA  4E4F                     790              TRAP    #15
000018EC                           791              
000018EC                           792              ; CLEAR SCREEN
000018EC  103C 000B                793              MOVE.B  #11,D0
000018F0  323C FF00                794              MOVE.W  #$FF00,D1
000018F4  4E4F                     795              TRAP    #15
000018F6                           796              
000018F6                           797              ;ENABLE TIMED INTERRPUT
000018F6  303C 0020                798              MOVE.W  #32,D0
000018FA  123C 0006                799              MOVE.B  #6,D1
000018FE  143C 0081                800              MOVE.B  #$81,D2                   ;INDICATE THAT INTERRUPT 1 IS ACTIVATED PERIODICALLY
00001902  7614                     801              MOVE.L  #20,D3                    ;INDICATE THE MILISECONDS FOR THAT PERIOD (20 ms == 50 FPS)
00001904  4E4F                     802              TRAP    #15
00001906                           803              
00001906                           804              ;CLEAR INTERRUPT COUNTER
00001906  4239 000021CA            805              CLR.B   (SCRINTCT)
0000190C                           806              
0000190C  4CDF 0003                807              MOVEM.L (A7)+,D0-D1               ;RESTORE REGISTERS FROM STACK
00001910                           808              
00001910  4E75                     809              RTS
00001912                           810  
00001912                           811  
00001912                           812              
00001912                           813  ;------------------------------------------------------------------------------            
00001912                           814  SCRUPD
00001912                           815  ; UPDATES DOUBLE BUFFER
00001912                           816  ; INPUT    : NONE
00001912                           817  ; OUTPUT   : NONE
00001912                           818  ; MODIFIES : NONE
00001912                           819  ; ------------------------------------------------------------------------------
00001912                           820  
00001912  48E7 C000                821              MOVEM.L D0-D1,-(A7)
00001916                           822              
00001916                           823              ;SWITCH BUFFERS
00001916  103C 005E                824              MOVE.B #94,D0
0000191A  4E4F                     825              TRAP #15
0000191C                           826              
0000191C                           827              ;CLEAR HIDDEN BUFFER
0000191C  103C 000B                828              MOVE.B  #11,D0
00001920  323C FF00                829              MOVE.W  #$FF00,D1
00001924  4E4F                     830              TRAP    #15
00001926                           831              
00001926  4CDF 0003                832              MOVEM.L (A7)+,D0-D1
0000192A                           833              
0000192A  4E73                     834              RTE
0000192C                           835              
0000192C                           836  ; ------------------------------------------------------------------------------
0000192C                           837  SCRTIM
0000192C                           838  ; TIMED INTERRUPT SERVICE ROUTINE
0000192C                           839  ; INPUT    : NONE
0000192C                           840  ; OUTPUT   : NONE
0000192C                           841  ; MODIFIES : NONE
0000192C                           842  ; ------------------------------------------------------------------------------
0000192C  5239 000021CA            843              ADDQ.B  #1,(SCRINTCT)
00001932  5239 000021CB            844              ADDQ.B  #1,(SCRCYCCT)
00001938  4E73                     845              RTE
0000193A                           846              
0000193A                           847  ;------------------------------------------------------------------------------            
0000193A                           848  KBDINIT
0000193A                           849  ; INIT THE KEYBOARD
0000193A                           850  ; INPUT    : NONE
0000193A                           851  ; OUTPUT   : NONE
0000193A                           852  ; MODIFIES : NONE
0000193A                           853  ; ------------------------------------------------------------------------------
0000193A                           854  
0000193A  4239 000021C8            855              CLR.B   (KBDVAL)
00001940  4239 000021C9            856              CLR.B   (KBDEDGE)
00001946                           857  
00001946  4E75                     858              RTS
00001948                           859  
00001948                           860  ;------------------------------------------------------------------------------            
00001948                           861  KBDUPD
00001948                           862  ; UPDATES KEYBOARD INFO
00001948                           863  ; 3 -> DOWN     (HEX: 8)
00001948                           864  ; 2 -> RIGHT    (HEX: 4)
00001948                           865  ; 1 -> UP       (HEX: 2)
00001948                           866  ; 0 -> LEFT     (HEX: 1)
00001948                           867  ; ------------------------------------------------------------------------------
00001948                           868              
00001948  48E7 F800                869              MOVEM.L D0-D4,-(A7)
0000194C                           870              
0000194C                           871              ; READ FIRST PART
0000194C  103C 0013                872              MOVE.B  #19,D0
00001950  223C 50104D20            873              MOVE.L  #KBDPAUSE<<24|KBDFIRE3<<16|KBDFIRE2<<8|KBDFIRE1,D1
00001956  4E4F                     874              TRAP    #15
00001958                           875  
00001958                           876              ; CONVERT TO DESIRED FORMAT
00001958  4EB9 00001990            877              JSR     .CONVERT
0000195E                           878  
0000195E                           879              ; READ SECOND PART
0000195E  223C 28272625            880              MOVE.L  #KBDDOWN<<24|KBDRIGHT<<16|KBDUP<<8|KBDLEFT,D1
00001964  4E4F                     881              TRAP    #15
00001966                           882              
00001966                           883              ;CONVERT TO DESIRED FORMAT
00001966  4EB9 00001990            884              JSR .CONVERT
0000196C                           885  
0000196C                           886              ;GET KBDEDGE (IF SOME KEY HAVE CHANGED THE VALUE)
0000196C  1039 000021C8            887              MOVE.B  (KBDVAL),D0             ;D0 -> LAST KBDVAL
00001972  4600                     888              NOT.B   D0                      ;D2 -> ACTUAL KBDVAL
00001974  C002                     889              AND.B   D2,D0
00001976  13C0 000021C9            890              MOVE.B  D0,(KBDEDGE)
0000197C                           891              
0000197C                           892         
0000197C  B03C 0000                893              CMP.B   #0,D0
00001980  6700 0008                894              BEQ     .NOACT          
00001984                           895              
00001984                           896              ;STORE NEW KBDVAL
00001984  13C2 000021C8            897              MOVE.B  D2,(KBDVAL)
0000198A                           898  .NOACT
0000198A                           899              
0000198A  4CDF 001F                900              MOVEM.L (A7)+,D0-D4
0000198E                           901              
0000198E  4E73                     902              RTE    
00001990                           903              
00001990                           904  .CONVERT 
00001990  363C 0003                905              MOVE.W  #3,D3
00001994                           906              
00001994  E189                     907  .LOOP       LSL.L   #8,D1
00001996  E312                     908              ROXL.B  #1,D2
00001998  51CB FFFA                909              DBRA.W  D3,.LOOP
0000199C  4E75                     910              RTS
0000199E                           911             
0000199E                           912  
0000199E                           913  ;------------------------------------------------------------------------------            
0000199E                           914  COLWALLRIGHT
0000199E                           915  ; COLLISION PAC-MAN WITH WALL
0000199E                           916  ; INPUT    : NONE
0000199E                           917  ; OUTPUT   : NONE
0000199E                           918  ; MODIFIES : NONE
0000199E                           919  ; ------------------------------------------------------------------------------
0000199E                           920  
0000199E  48E7 F800                921              MOVEM.L D0-D4,-(A7)
000019A2                           922  
000019A2  3039 000025CE            923              MOVE.W  (PMPOSX),D0
000019A8  5140                     924              SUB.W   #8,D0
000019AA  3239 000025D0            925              MOVE.W  (PMPOSY),D1
000019B0  5041                     926              ADD.W   #8,D1
000019B2                           927              
000019B2  81FC 0010                928              DIVS.W  #16,D0
000019B6  83FC 0010                929              DIVS.W  #16,D1
000019BA                           930              
000019BA  5940                     931              SUB.W   #4,D0                   ;LI RESTAM 4 PERQUE LA MATRIU ESTA A UNA DISTANCIA DE 64 PIXELS DE LA PANTALLA
000019BC  5941                     932              SUB.W   #4,D1
000019BE                           933              
000019BE  41F9 000021CC            934              LEA.L   MAPVAR,A0
000019C4                           935              
000019C4  5240                     936              ADD.W   #1,D0
000019C6  5341                     937              SUB.W   #1,D1
000019C8  C2FC 0020                938              MULU.W  #32,D1
000019CC  D041                     939              ADD.W   D1,D0
000019CE                           940              
000019CE  3240                     941              MOVE.W  D0,A1
000019D0  13C0 000025CC            942              MOVE.B  D0,POSCON
000019D6                           943  
000019D6  1A29 21CC                944              MOVE.B  MAPVAR(A1),D5
000019DA                           945              
000019DA  4CDF 001F                946              MOVEM.L (A7)+,D0-D4
000019DE                           947              
000019DE  4E75                     948              RTS
000019E0                           949  
000019E0                           950  
000019E0                           951  ;------------------------------------------------------------------------------            
000019E0                           952  COLWALLLEFT
000019E0                           953  ; COLLISION PAC-MAN WITH WALL
000019E0                           954  ; INPUT    : NONE
000019E0                           955  ; OUTPUT   : NONE
000019E0                           956  ; MODIFIES : NONE
000019E0                           957  ; ------------------------------------------------------------------------------
000019E0                           958  
000019E0  48E7 F800                959              MOVEM.L D0-D4,-(A7)
000019E4                           960  
000019E4  3039 000025CE            961              MOVE.W  (PMPOSX),D0
000019EA  5C40                     962              ADD.W   #6,D0
000019EC  3239 000025D0            963              MOVE.W  (PMPOSY),D1
000019F2  5041                     964              ADD.W   #8,D1
000019F4                           965              
000019F4  81FC 0010                966              DIVS.W  #16,D0
000019F8  83FC 0010                967              DIVS.W  #16,D1
000019FC                           968              
000019FC  5940                     969              SUB.W   #4,D0                   ;LI RESTAM 4 PERQUE LA MATRIU ESTA A UNA DISTANCIA DE 64 PIXELS DE LA PANTALLA
000019FE  5941                     970              SUB.W   #4,D1
00001A00                           971              
00001A00  41F9 000021CC            972              LEA.L   MAPVAR,A0
00001A06                           973              
00001A06  5340                     974              SUB.W   #1,D0
00001A08  5341                     975              SUB.W   #1,D1
00001A0A  C2FC 0020                976              MULU.W  #32,D1
00001A0E  D041                     977              ADD.W   D1,D0
00001A10                           978  
00001A10  3240                     979              MOVE.W  D0,A1
00001A12  13C0 000025CC            980              MOVE.B  D0,POSCON
00001A18                           981  
00001A18  1A29 21CC                982              MOVE.B  MAPVAR(A1),D5               
00001A1C                           983  
00001A1C                           984              
00001A1C  4CDF 001F                985              MOVEM.L (A7)+,D0-D4
00001A20                           986              
00001A20  4E75                     987              RTS
00001A22                           988  
00001A22                           989  ;------------------------------------------------------------------------------            
00001A22                           990  COLWALLDOWN
00001A22                           991  ; COLLISION PAC-MAN WITH WALL
00001A22                           992  ; INPUT    : NONE
00001A22                           993  ; OUTPUT   : NONE
00001A22                           994  ; MODIFIES : NONE
00001A22                           995  ; ------------------------------------------------------------------------------
00001A22                           996  
00001A22  48E7 F800                997              MOVEM.L D0-D4,-(A7)
00001A26                           998  
00001A26  3039 000025CE            999              MOVE.W  (PMPOSX),D0
00001A2C                          1000              ;ADD.W   #8,D0
00001A2C  3239 000025D0           1001              MOVE.W  (PMPOSY),D1
00001A32  5041                    1002              ADD.W   #8,D1
00001A34                          1003              
00001A34  81FC 0010               1004              DIVS.W  #16,D0
00001A38  83FC 0010               1005              DIVS.W  #16,D1
00001A3C                          1006              
00001A3C  5940                    1007              SUB.W   #4,D0                   ;LI RESTAM 4 PERQUE LA MATRIU ESTA A UNA DISTANCIA DE 64 PIXELS DE LA PANTALLA
00001A3E  5941                    1008              SUB.W   #4,D1
00001A40                          1009              
00001A40  41F9 000021CC           1010              LEA.L   MAPVAR,A0
00001A46                          1011              
00001A46  C2FC 0020               1012              MULU.W  #32,D1
00001A4A  D041                    1013              ADD.W   D1,D0
00001A4C                          1014  
00001A4C  3240                    1015              MOVE.W  D0,A1
00001A4E  13C0 000025CC           1016              MOVE.B  D0,POSCON
00001A54                          1017  
00001A54  1A29 21CC               1018              MOVE.B  MAPVAR(A1),D5 
00001A58                          1019  
00001A58                          1020              
00001A58  4CDF 001F               1021              MOVEM.L (A7)+,D0-D4
00001A5C                          1022              
00001A5C  4E75                    1023              RTS
00001A5E                          1024  
00001A5E                          1025  
00001A5E                          1026  ;------------------------------------------------------------------------------            
00001A5E                          1027  COLWALLUP
00001A5E                          1028  ; COLLISION PAC-MAN WITH WALL
00001A5E                          1029  ; INPUT    : NONE
00001A5E                          1030  ; OUTPUT   : NONE
00001A5E                          1031  ; MODIFIES : NONE
00001A5E                          1032  ; ------------------------------------------------------------------------------
00001A5E                          1033  
00001A5E  48E7 F800               1034              MOVEM.L D0-D4,-(A7)
00001A62                          1035  
00001A62  3039 000025CE           1036              MOVE.W  (PMPOSX),D0
00001A68                          1037              ;SUB.W   #8,D0
00001A68  3239 000025D0           1038              MOVE.W  (PMPOSY),D1
00001A6E  5C41                    1039              ADD.W   #6,D1
00001A70                          1040              
00001A70                          1041              
00001A70  81FC 0010               1042              DIVS.W  #16,D0
00001A74  83FC 0010               1043              DIVS.W  #16,D1
00001A78                          1044              
00001A78  5940                    1045              SUB.W   #4,D0                   ;LI RESTAM 4 PERQUE LA MATRIU ESTA A UNA DISTANCIA DE 64 PIXELS DE LA PANTALLA
00001A7A  5941                    1046              SUB.W   #4,D1
00001A7C                          1047              
00001A7C  41F9 000021CC           1048              LEA.L   MAPVAR,A0
00001A82                          1049              
00001A82  5341                    1050              SUB.W   #1,D1
00001A84                          1051              ;CMP     #1,D1
00001A84                          1052              ;BLO     BUCLE4
00001A84  C2FC 0020               1053              MULU.W  #32,D1
00001A88  D041                    1054              ADD.W   D1,D0
00001A8A                          1055  
00001A8A                          1056  ;BUCLE4            
00001A8A  3240                    1057              MOVE.W  D0,A1
00001A8C  13C0 000025CC           1058              MOVE.B  D0,POSCON
00001A92                          1059  
00001A92  1A29 21CC               1060              MOVE.B  MAPVAR(A1),D5 
00001A96                          1061  
00001A96                          1062              ;MOVE.B  #0,D5
00001A96                          1063              
00001A96  4CDF 001F               1064              MOVEM.L (A7)+,D0-D4
00001A9A                          1065              
00001A9A  4E75                    1066              RTS
00001A9C                          1067  
00001A9C                          1068  
00001A9C                          1069  ;------------------------------------------------------------------------------            
00001A9C                          1070  GETPOINTS
00001A9C                          1071  ; COLLISION PAC-MAN WITH WALL
00001A9C                          1072  ; INPUT    : NONE
00001A9C                          1073  ; OUTPUT   : NONE
00001A9C                          1074  ; MODIFIES : NONE
00001A9C                          1075  ; ------------------------------------------------------------------------------
00001A9C                          1076  
00001A9C  48E7 F800               1077              MOVEM.L D0-D4,-(A7)
00001AA0                          1078  
00001AA0  3039 000025CE           1079              MOVE.W  (PMPOSX),D0
00001AA6                          1080              ;SUB.W   #8,D0
00001AA6  3239 000025D0           1081              MOVE.W  (PMPOSY),D1
00001AAC  0641 0010               1082              ADD.W   #16,D1
00001AB0                          1083              
00001AB0                          1084              
00001AB0  81FC 0010               1085              DIVS.W  #16,D0
00001AB4  83FC 0010               1086              DIVS.W  #16,D1
00001AB8                          1087              
00001AB8  5940                    1088              SUB.W   #4,D0                   ;LI RESTAM 4 PERQUE LA MATRIU ESTA A UNA DISTANCIA DE 64 PIXELS DE LA PANTALLA
00001ABA  5941                    1089              SUB.W   #4,D1
00001ABC                          1090                          
00001ABC  5341                    1091              SUB.W   #1,D1
00001ABE  C2FC 0020               1092              MULU.W  #32,D1
00001AC2  D041                    1093              ADD.W   D1,D0
00001AC4                          1094  
00001AC4  3240                    1095              MOVE.W  D0,A1
00001AC6  1A29 21CC               1096              MOVE.B  MAPVAR(A1),D5
00001ACA                          1097              
00001ACA  BA7C 0000               1098              CMP     #0,D5
00001ACE  6700 003A               1099              BEQ     .DONE
00001AD2  BA7C 0002               1100              CMP     #2,D5
00001AD6  6700 0020               1101              BEQ     .POINT
00001ADA  BA7C 0003               1102              CMP     #3,D5
00001ADE  6700 0006               1103              BEQ     .BPOINT
00001AE2  6600 0026               1104              BNE     .DONE
00001AE6                          1105  .BPOINT
00001AE6  137C 0000 21CC          1106              MOVE.B  #0,MAPVAR(A1)
00001AEC  0679 0032 000025E6      1107              ADD.W   #50,(SCOPOINTS)
00001AF4  6600 0014               1108              BNE     .DONE
00001AF8                          1109  .POINT
00001AF8  137C 0000 21CC          1110              MOVE.B  #0,MAPVAR(A1)
00001AFE  0679 000A 000025E6      1111              ADD.W   #10,(SCOPOINTS)
00001B06  6600 0002               1112              BNE     .DONE            
00001B0A                          1113  .DONE                        
00001B0A  4CDF 001F               1114              MOVEM.L (A7)+,D0-D4
00001B0E                          1115              
00001B0E  4E75                    1116              RTS
00001B10                          1117  
00001B10                          1118  
00001B10                          1119  
00001B10                          1120  
00001B10                          1121  
00001B10                          1122  -------------------- end include --------------------
00001B10                          1123              INCLUDE "MAP.X68"
00001B10                          1124  
00001B10                          1125  ; ------------------------------------------------------------------------------
00001B10                          1126  MAPINIT
00001B10                          1127  ; INIT MAP
00001B10                          1128  ; INPUT    : NONE
00001B10                          1129  ; OUTPUT   : NONE
00001B10                          1130  ; MODIFIES : NONE
00001B10                          1131  ; ------------------------------------------------------------------------------            
00001B10                          1132              
00001B10                          1133              ;MOVE.L  #DIBFIGWALL,($80+2*4)          ;INSTALL SUBRUTINE TO TRAP #2
00001B10                          1134              ;MOVE.L  #DIBFIGPOINT,($80+3*4)          ;INSTALL SUBRUTINE TO TRAP #3
00001B10                          1135              ;MOVE.L  #DIBFIGBPOINT,($80+4*4)          ;INSTALL SUBRUTINE TO TRAP #4
00001B10                          1136              
00001B10  48E7 FE00               1137              MOVEM.L D0-D6,-(A7)
00001B14  48E7 00C0               1138              MOVEM.L A0-A1,-(A7)
00001B18                          1139              
00001B18  41F8 1000               1140              LEA.L   MAPMAT,A0
00001B1C  43F9 000021CC           1141              LEA.L   MAPVAR,A1
00001B22  3C3C 0030               1142              MOVE.W  #48,D6
00001B26  343C 001F               1143              MOVE.W  #31,D2
00001B2A                          1144  BUCLE_FILA
00001B2A  3A3C 0030               1145              MOVE.W  #48,D5
00001B2E  323C 001F               1146              MOVE.W  #31,D1
00001B32  0646 0010               1147              ADD.W   #16,D6
00001B36                          1148  
00001B36                          1149  BUCLE_COLUMNA
00001B36  0645 0010               1150              ADD.W   #16,D5
00001B3A                          1151  
00001B3A  1018                    1152              MOVE.B  (A0)+,D0
00001B3C  12C0                    1153              MOVE.B  D0,(A1)+
00001B3E                          1154               
00001B3E  B07C 0000               1155              CMP     #0,D0
00001B42  6700 0034               1156              BEQ     ZERO
00001B46  B07C 0004               1157              CMP     #4,D0
00001B4A  6700 002C               1158              BEQ     ZERO
00001B4E  B07C 0001               1159              CMP     #1,D0
00001B52  6600 0008               1160              BNE     NOTWALL
00001B56  4EB9 00001BFE           1161              JSR     DIBFIGWALL
00001B5C                          1162  NOTWALL
00001B5C  B07C 0002               1163              CMP     #2,D0
00001B60  6600 0008               1164              BNE     NOTPOINT
00001B64  4EB9 00001C36           1165              JSR     DIBFIGPOINT
00001B6A                          1166  NOTPOINT
00001B6A  B07C 0003               1167              CMP     #3,D0
00001B6E  6600 0008               1168              BNE     ZERO
00001B72  4EB9 00001C72           1169              JSR     DIBFIGBPOINT
00001B78                          1170           
00001B78                          1171  ZERO
00001B78  51C9 FFBC               1172              DBRA    D1,BUCLE_COLUMNA  
00001B7C  51CA FFAC               1173              DBRA    D2,BUCLE_FILA
00001B80                          1174              
00001B80  4CDF 0300               1175              MOVEM.L (A7)+,A0-A1
00001B84  4CDF 007F               1176              MOVEM.L (A7)+,D0-D6
00001B88                          1177  
00001B88                          1178  
00001B88                          1179              
00001B88  4E75                    1180              RTS            
00001B8A                          1181  
00001B8A                          1182  ; ------------------------------------------------------------------------------
00001B8A                          1183  MAPPLOT
00001B8A                          1184  ; INIT MAP
00001B8A                          1185  ; INPUT    : NONE
00001B8A                          1186  ; OUTPUT   : NONE
00001B8A                          1187  ; MODIFIES : NONE
00001B8A                          1188  ; ------------------------------------------------------------------------------            
00001B8A                          1189  
00001B8A  48E7 FE00               1190              MOVEM.L D0-D6,-(A7)
00001B8E  48E7 0080               1191              MOVEM.L A0,-(A7)
00001B92                          1192  
00001B92  41F9 000021CC           1193              LEA.L   MAPVAR,A0
00001B98  3C3C 0030               1194              MOVE.W  #48,D6
00001B9C  343C 001F               1195              MOVE.W  #31,D2
00001BA0                          1196  BUCLE_FILA2
00001BA0  3A3C 0030               1197              MOVE.W  #48,D5
00001BA4  323C 001F               1198              MOVE.W  #31,D1
00001BA8  0646 0010               1199              ADD.W   #16,D6
00001BAC                          1200  
00001BAC                          1201  BUCLE_COLUMNA2
00001BAC  0645 0010               1202              ADD.W   #16,D5       
00001BB0                          1203  
00001BB0  1018                    1204              MOVE.B  (A0)+,D0
00001BB2                          1205  
00001BB2  B07C 0000               1206              CMP     #0,D0
00001BB6  6700 0034               1207              BEQ     ZERO2
00001BBA  B07C 0004               1208              CMP     #4,D0
00001BBE  6700 002C               1209              BEQ     ZERO2
00001BC2  B07C 0001               1210              CMP     #1,D0
00001BC6  6600 0008               1211              BNE     NOTWALL2
00001BCA  4EB9 00001BFE           1212              JSR     DIBFIGWALL
00001BD0                          1213  NOTWALL2
00001BD0  B07C 0002               1214              CMP     #2,D0
00001BD4  6600 0008               1215              BNE     NOTPOINT2
00001BD8  4EB9 00001C36           1216              JSR     DIBFIGPOINT
00001BDE                          1217  NOTPOINT2
00001BDE  B07C 0003               1218              CMP     #3,D0
00001BE2  6600 0008               1219              BNE     ZERO2
00001BE6  4EB9 00001C72           1220              JSR     DIBFIGBPOINT
00001BEC                          1221  
00001BEC                          1222     
00001BEC                          1223  ZERO2
00001BEC  51C9 FFBE               1224              DBRA    D1,BUCLE_COLUMNA2
00001BF0                          1225              
00001BF0  51CA FFAE               1226              DBRA    D2,BUCLE_FILA2
00001BF4                          1227              
00001BF4  4CDF 0100               1228              MOVEM.L (A7)+,A0
00001BF8  4CDF 007F               1229              MOVEM.L (A7)+,D0-D6
00001BFC                          1230              
00001BFC                          1231              
00001BFC  4E75                    1232              RTS 
00001BFE                          1233              
00001BFE                          1234  ; -----------------------------------------------------------------------------
00001BFE                          1235  DIBFIGWALL
00001BFE                          1236  ; SUBRUTINE DRAW MAP
00001BFE                          1237  ; INPUT    : D5=POSITION X, D6=POSITION Y
00001BFE                          1238  ; OUTPUT   : NONE
00001BFE                          1239  ; MODIFIES : NONE
00001BFE                          1240  ; -----------------------------------------------------------------------------
00001BFE  48E7 FE00               1241              MOVEM.L D0-D6,-(A7)
00001C02                          1242              ; SET CONTOURN COLOR
00001C02  103C 0050               1243              MOVE.B  #80,D0
00001C06  223C 00AA0000           1244              MOVE.L  #$00AA0000,D1
00001C0C  4E4F                    1245              TRAP    #15
00001C0E                          1246              
00001C0E                          1247              ; SET FILL COLOR
00001C0E  103C 0051               1248              MOVE.B  #81,D0
00001C12  223C 00FF0000           1249              MOVE.L  #$00FF0000,D1
00001C18  4E4F                    1250              TRAP    #15
00001C1A                          1251              
00001C1A                          1252              ; DEFINE COORDINATES RECTANGLE
00001C1A  3205                    1253              MOVE.W  D5,D1
00001C1C  3406                    1254              MOVE.W  D6,D2
00001C1E  0645 0010               1255              ADD.W   #16,D5
00001C22  0646 0010               1256              ADD.W   #16,D6
00001C26  3605                    1257              MOVE.W  D5,D3
00001C28  3806                    1258              MOVE.W  D6,D4
00001C2A                          1259              
00001C2A                          1260              ; DRAW RECTANGLE
00001C2A  103C 0057               1261              MOVE.B  #87,D0
00001C2E  4E4F                    1262              TRAP    #15
00001C30                          1263              
00001C30  4CDF 007F               1264              MOVEM.L (A7)+,D0-D6
00001C34                          1265  
00001C34  4E75                    1266              RTS
00001C36                          1267              
00001C36                          1268  ; -----------------------------------------------------------------------------
00001C36                          1269  DIBFIGPOINT
00001C36                          1270  ; SUBRUTINE DRAW MAP
00001C36                          1271  ; INPUT    : D5=POSITION X, D6=POSITION Y
00001C36                          1272  ; OUTPUT   : NONE
00001C36                          1273  ; MODIFIES : NONE
00001C36                          1274  ; -----------------------------------------------------------------------------
00001C36  48E7 FE00               1275              MOVEM.L D0-D6,-(A7)
00001C3A                          1276              ; SET CONTOURN COLOR
00001C3A  103C 0050               1277              MOVE.B  #80,D0
00001C3E  223C 0000AAAA           1278              MOVE.L  #$0000AAAA,D1
00001C44  4E4F                    1279              TRAP    #15
00001C46                          1280              
00001C46                          1281              ; SET FILL COLOR
00001C46  103C 0051               1282              MOVE.B  #81,D0
00001C4A  223C 0000FFFF           1283              MOVE.L  #$0000FFFF,D1
00001C50  4E4F                    1284              TRAP    #15
00001C52                          1285              
00001C52                          1286              ; DEFINE COORDINATES RECTANGLE
00001C52  3205                    1287              MOVE.W  D5,D1
00001C54  5041                    1288              ADD.W   #8,D1
00001C56  5541                    1289              SUB.W   #2,D1
00001C58  3406                    1290              MOVE.W  D6,D2
00001C5A  5042                    1291              ADD.W   #8,D2
00001C5C  5542                    1292              SUB.W   #2,D2
00001C5E                          1293              
00001C5E  3601                    1294              MOVE.W  D1,D3
00001C60  5843                    1295              ADD.W   #2*2,D3
00001C62  3802                    1296              MOVE.W  D2,D4
00001C64  5844                    1297              ADD.W   #2*2,D4
00001C66                          1298              
00001C66                          1299              ; DRAW POINT
00001C66  103C 0058               1300              MOVE.B  #88,D0
00001C6A  4E4F                    1301              TRAP    #15
00001C6C                          1302              
00001C6C  4CDF 007F               1303              MOVEM.L (A7)+,D0-D6
00001C70                          1304              
00001C70  4E75                    1305              RTS
00001C72                          1306  
00001C72                          1307  
00001C72                          1308  ; -----------------------------------------------------------------------------
00001C72                          1309  DIBFIGBPOINT
00001C72                          1310  ; SUBRUTINE DRAW MAP
00001C72                          1311  ; INPUT    : D5=POSITION X, D6=POSITION Y
00001C72                          1312  ; OUTPUT   : NONE
00001C72                          1313  ; MODIFIES : NONE
00001C72                          1314  ; -----------------------------------------------------------------------------
00001C72  48E7 FE00               1315              MOVEM.L D0-D6,-(A7)
00001C76                          1316              ; SET CONTOURN COLOR
00001C76  103C 0050               1317              MOVE.B  #80,D0
00001C7A  223C 0000AAAA           1318              MOVE.L  #$0000AAAA,D1
00001C80  4E4F                    1319              TRAP    #15
00001C82                          1320              
00001C82                          1321              ; SET FILL COLOR
00001C82  103C 0051               1322              MOVE.B  #81,D0
00001C86  223C 0000FFFF           1323              MOVE.L  #$0000FFFF,D1
00001C8C  4E4F                    1324              TRAP    #15
00001C8E                          1325              
00001C8E                          1326              ; DEFINE COORDINATES RECTANGLE
00001C8E  3205                    1327              MOVE.W  D5,D1
00001C90  5041                    1328              ADD.W   #8,D1
00001C92  5941                    1329              SUB.W   #4,D1
00001C94  3406                    1330              MOVE.W  D6,D2
00001C96  5042                    1331              ADD.W   #8,D2
00001C98  5942                    1332              SUB.W   #4,D2
00001C9A                          1333              
00001C9A  3601                    1334              MOVE.W  D1,D3
00001C9C  5043                    1335              ADD.W   #4*2,D3
00001C9E  3802                    1336              MOVE.W  D2,D4
00001CA0  5044                    1337              ADD.W   #4*2,D4
00001CA2                          1338              
00001CA2                          1339              ; DRAW BIG POINT
00001CA2  103C 0058               1340              MOVE.B  #88,D0
00001CA6  4E4F                    1341              TRAP    #15
00001CA8                          1342              
00001CA8  4CDF 007F               1343              MOVEM.L (A7)+,D0-D6
00001CAC                          1344              
00001CAC  4E75                    1345              RTS
00001CAE                          1346  
00001CAE                          1347  
00001CAE                          1348  
00001CAE                          1349  
00001CAE                          1350  
00001CAE                          1351  
00001CAE                          1352  
00001CAE                          1353  
00001CAE                          1354  
00001CAE                          1355  
00001CAE                          1356  
00001CAE                          1357  
00001CAE                          1358  -------------------- end include --------------------
00001CAE                          1359              INCLUDE "LIB/UTLCONST.X68"
00001CAE                          1360  ; ==============================================================================
00001CAE                          1361  ; UTIL CONSTANTS
00001CAE                          1362  ; ==============================================================================
00001CAE                          1363  
00001CAE  =00000008               1364  UTLCHRWD    EQU     8                       ; CHARACTER WIDTH IN PIXELS
00001CAE                          1365  
00001CAE                          1366  -------------------- end include --------------------
00001CAE                          1367              INCLUDE "LIB/UTLCODE.X68"
00001CAE                          1368  ; =============================================================================
00001CAE                          1369  ; UTILITY CODE
00001CAE                          1370  ; =============================================================================
00001CAE                          1371  
00001CAE                          1372  ; -----------------------------------------------------------------------------
00001CAE                          1373  UTLINIT
00001CAE                          1374  ; INITIALIZES UTILITY CODE
00001CAE                          1375  ; INPUT    - NONE
00001CAE                          1376  ; OUTPUT   - NONE
00001CAE                          1377  ; MODIFIES - NONE
00001CAE                          1378  ; -----------------------------------------------------------------------------
00001CAE  48E7 C000               1379              MOVEM.L D0-D1,-(A7)
00001CB2  103C 0008               1380              MOVE.B  #8,D0
00001CB6  4E4F                    1381              TRAP    #15
00001CB8  13C1 000025EE           1382              MOVE.B  D1,(UTLRNDIX)
00001CBE  4CDF 0003               1383              MOVEM.L (A7)+,D0-D1
00001CC2  4E75                    1384              RTS
00001CC4                          1385  
00001CC4                          1386  ; -----------------------------------------------------------------------------
00001CC4                          1387  UTLPRINT
00001CC4                          1388  ; PRINT SCREEN CENTERED TEXT
00001CC4                          1389  ; INPUT    : A0 POINTER TO ZERO-TERMINATED STRING
00001CC4                          1390  ;            D0.B SCREEN ROW TO PRINT TEXT
00001CC4                          1391  ; OUTPUT   : D0.B NEXT ROW
00001CC4                          1392  ; MODIFIES : NONE (ASIDE OF OUTPUT)
00001CC4                          1393  ; -----------------------------------------------------------------------------
00001CC4  48E7 C0C0               1394              MOVEM.L D0-D1/A0-A1,-(A7)
00001CC8  4201                    1395              CLR.B   D1
00001CCA  2248                    1396              MOVE.L  A0,A1
00001CCC  4A18                    1397  .LOOP       TST.B   (A0)+
00001CCE  6700 0006               1398              BEQ     .ENDLOOP
00001CD2  5201                    1399              ADDQ.B  #1,D1
00001CD4  60F6                    1400              BRA     .LOOP
00001CD6  E209                    1401  .ENDLOOP    LSR.B   #1,D1
00001CD8  0401 0028               1402              SUB.B   #(SCRWIDTH/UTLCHRWD)/2,D1
00001CDC  4401                    1403              NEG.B   D1
00001CDE  E141                    1404              ASL.W   #8,D1
00001CE0  8240                    1405              OR.W    D0,D1
00001CE2  103C 000B               1406              MOVE.B  #11,D0
00001CE6  4E4F                    1407              TRAP    #15
00001CE8  103C 000D               1408              MOVE.B  #13,D0
00001CEC  4E4F                    1409              TRAP    #15
00001CEE  4CDF 0303               1410              MOVEM.L (A7)+,D0-D1/A0-A1
00001CF2  5200                    1411              ADDQ.B  #1,D0
00001CF4  4E75                    1412              RTS
00001CF6                          1413              
00001CF6                          1414              
00001CF6                          1415  
00001CF6                          1416  
00001CF6                          1417              ; (SCRWIDTH/UTLCHRWD)/2 - D1/2
00001CF6                          1418  
00001CF6                          1419  
00001CF6                          1420  ; -----------------------------------------------------------------------------
00001CF6                          1421  UTLRAND
00001CF6                          1422  ; PROVIDES A PSEUDO-RANDOM BYTE
00001CF6                          1423  ; INPUT    - NONE
00001CF6                          1424  ; OUTPUT   - D0.L RANDOM VALUE (ONLY BYTE)
00001CF6                          1425  ; MODIFIES - NONE (ASIDE OF OUTPUT)
00001CF6                          1426  ; -----------------------------------------------------------------------------
00001CF6  2F08                    1427              MOVE.L  A0,-(A7)
00001CF8  41F9 00001D14           1428              LEA     .RANDVEC,A0
00001CFE  4280                    1429              CLR.L   D0
00001D00  1039 000025EE           1430              MOVE.B  (UTLRNDIX),D0
00001D06  1030 0800               1431              MOVE.B  (A0,D0.L),D0
00001D0A  5239 000025EE           1432              ADDQ.B  #1,(UTLRNDIX)
00001D10  205F                    1433              MOVE.L  (A7)+,A0
00001D12  4E75                    1434              RTS
00001D14                          1435  
00001D14                          1436  
00001D14= A2 EE 9A 0C F5 24 ...   1437  .RANDVEC    DC.B    162, 238, 154, 12 , 245, 36 , 32 , 103
00001D1C= 2A A3 51 26 E0 AC ...   1438              DC.B    42 , 163, 81 , 38 , 224, 172, 19 , 69
00001D24= 75 51 CA FD 33 EB ...   1439              DC.B    117, 81 , 202, 253, 51 , 235, 108, 154
00001D2C= 60 CC E7 B8 9A EB ...   1440              DC.B    96 , 204, 231, 184, 154, 235, 34 , 203
00001D34= 1D 76 B5 95 B0 89 ...   1441              DC.B    29 , 118, 181, 149, 176, 137, 62 , 108
00001D3C= 39 15 48 C9 6E CA ...   1442              DC.B    57 , 21 , 72 , 201, 110, 202, 159, 41
00001D44= 43 E7 E2 7C 37 25 ...   1443              DC.B    67 , 231, 226, 124, 55 , 37 , 84 , 62
00001D4C= E9 94 CE E9 E4 52 ...   1444              DC.B    233, 148, 206, 233, 228, 82 , 243, 78
00001D54= 37 6D 9A 84 A2 28 ...   1445              DC.B    55 , 109, 154, 132, 162, 40 , 30 , 39
00001D5C= 19 E2 C6 77 80 D4 ...   1446              DC.B    25 , 226, 198, 119, 128, 212, 232, 225
00001D64= 0A 5A 32 67 33 C2 ...   1447              DC.B    10 , 90 , 50 , 103, 51 , 194, 222, 40
00001D6C= 59 80 DC 0E 57 FC ...   1448              DC.B    89 , 128, 220, 14 , 87 , 252, 243, 252
00001D74= 8A AB BC F7 07 4D ...   1449              DC.B    138, 171, 188, 247, 7  , 77 , 29 , 234
00001D7C= EF D5 77 6E 1E BB ...   1450              DC.B    239, 213, 119, 110, 30 , 187, 131, 23
00001D84= D6 E0 2A 8F BD 28 ...   1451              DC.B    214, 224, 42 , 143, 189, 40 , 212, 130
00001D8C= 13 4F 66 EC 0A 64 ...   1452              DC.B    19 , 79 , 102, 236, 10 , 100, 122, 188
00001D94= 56 52 9A 16 9B 90 ...   1453              DC.B    86 , 82 , 154, 22 , 155, 144, 7  , 199
00001D9C= 06 8A A4 F7 01 DA ...   1454              DC.B    6  , 138, 164, 247, 1  , 218, 166, 82
00001DA4= F2 E7 77 28 B1 76 ...   1455              DC.B    242, 231, 119, 40 , 177, 118, 220, 102
00001DAC= A4 42 E3 81 B1 67 ...   1456              DC.B    164, 66 , 227, 129, 177, 103, 165, 108
00001DB4= BF CE FA 16 BF 38 ...   1457              DC.B    191, 206, 250, 22 , 191, 56 , 30 , 161
00001DBC= D1 8B 50 0C 5F 49 ...   1458              DC.B    209, 139, 80 , 12 , 95 , 73 , 168, 56
00001DC4= DE 4C 14 A2 40 DC ...   1459              DC.B    222, 76 , 20 , 162, 64 , 220, 93 , 12
00001DCC= B6 9B 0A 38 5D AB ...   1460              DC.B    182, 155, 10 , 56 , 93 , 171, 89 , 6
00001DD4= E2 1B DD 75 15 82 ...   1461              DC.B    226, 27 , 221, 117, 21 , 130, 101, 18
00001DDC= 8A 26 51 30 9F 47 ...   1462              DC.B    138, 38 , 81 , 48 , 159, 71 , 57 , 21
00001DE4= 1E 8A BB 71 C6 6E ...   1463              DC.B    30 , 138, 187, 113, 198, 110, 185, 152
00001DEC= 9F 47 E5 34 94 27 ...   1464              DC.B    159, 71 , 229, 52 , 148, 39 , 77 , 6
00001DF4= 7D 06 D6 BA 30 0F ...   1465              DC.B    125, 6  , 214, 186, 48 , 15 , 212, 22
00001DFC= EC 7F 7E 03 CF 2D ...   1466              DC.B    236, 127, 126, 3  , 207, 45 , 193, 2
00001E04= 94 5B 23 F2 8B CD ...   1467              DC.B    148, 91 , 35 , 242, 139, 205, 248, 237
00001E0C= 74 33 EC B9 0F D5 ...   1468              DC.B    116, 51 , 236, 185, 15 , 213, 221, 6
00001E14                          1469  
00001E14                          1470  
00001E14                          1471  
00001E14                          1472  
00001E14                          1473  -------------------- end include --------------------
00001E14                          1474              INCLUDE "INTRO.X68"
00001E14                          1475  ; ==============================================================================
00001E14                          1476  ; INTRO SCREEN
00001E14                          1477  ; ==============================================================================
00001E14                          1478  
00001E14                          1479  ; ------------------------------------------------------------------------------
00001E14                          1480  ISCINIT
00001E14                          1481  ; INTRO SCREEN INIT
00001E14                          1482  ; INPUT    : NONE
00001E14                          1483  ; OUTPUT   : NONE
00001E14                          1484  ; MODIFIES : NONE
00001E14                          1485  ; ------------------------------------------------------------------------------
00001E14  4279 000025E8           1486              CLR.W   (ISCTIMER)
00001E1A  4E75                    1487              RTS
00001E1C                          1488  
00001E1C                          1489  ; ------------------------------------------------------------------------------
00001E1C                          1490  ISCUPD
00001E1C                          1491  ; INTRO SCREEN UPDATE
00001E1C                          1492  ; INPUT    : NONE
00001E1C                          1493  ; OUTPUT   : NONE
00001E1C                          1494  ; MODIFIES : NONE
00001E1C                          1495  ; ------------------------------------------------------------------------------
00001E1C  0839 0004 000021C8      1496              BTST.B  #4,(KBDVAL)
00001E24  6700 000A               1497              BEQ     .CONT
00001E28  33FC 0001 000025EC      1498              MOVE.W  #1,(STANEXT)
00001E30                          1499  .CONT       ;ADDQ.W  #1,(ISCTIMER)
00001E30                          1500  ;            CMP.W   #500,(ISCTIMER)
00001E30                          1501  ;            BLT     .DONE
00001E30                          1502  ;            MOVE.W  #1,(STANEXT)
00001E30  4E75                    1503  .DONE       RTS
00001E32                          1504  
00001E32                          1505  ; ------------------------------------------------------------------------------
00001E32                          1506  ISCPLOT
00001E32                          1507  ; INTRO SCREEN PLOT
00001E32                          1508  ; INPUT    : NONE
00001E32                          1509  ; OUTPUT   : NONE
00001E32                          1510  ; MODIFIES : NONE
00001E32                          1511  ; ------------------------------------------------------------------------------
00001E32  48E7 C080               1512              MOVEM.L D0-D1/A0,-(A7)
00001E36                          1513              
00001E36  4281                    1514              CLR.L   D1
00001E38  103C 0051               1515              MOVE.B  #81,D0
00001E3C  4E4F                    1516              TRAP    #15
00001E3E                          1517              
00001E3E  41F9 00001E6C           1518              LEA     .TXT1,A0
00001E44  103C 000A               1519              MOVE.B  #10,D0
00001E48  4EB8 1CC4               1520              JSR     UTLPRINT
00001E4C                          1521              
00001E4C  0839 0004 000021CB      1522              BTST.B  #4,(SCRCYCCT)
00001E54  6700 0010               1523              BEQ     .DONE
00001E58                          1524              
00001E58  41F9 00001E7A           1525              LEA     .TXT2,A0
00001E5E  103C 0019               1526              MOVE.B  #25,D0
00001E62  4EB8 1CC4               1527              JSR     UTLPRINT
00001E66                          1528              
00001E66  4CDF 0103               1529  .DONE       MOVEM.L (A7)+,D0-D1/A0
00001E6A                          1530  
00001E6A  4E75                    1531              RTS
00001E6C= 50 41 43 2D 4D 41 ...   1532  .TXT1       DC.B    'PAC-MAN 68000',0
00001E7A= 50 52 45 53 53 20 ...   1533  .TXT2       DC.B    'PRESS SPACE BUTTON TO START',0
00001E96                          1534              DS.W    0
00001E96                          1535  
00001E96                          1536  
00001E96                          1537  
00001E96                          1538  
00001E96                          1539  
00001E96                          1540  
00001E96                          1541  
00001E96                          1542  
00001E96                          1543  
00001E96                          1544  -------------------- end include --------------------
00001E96                          1545              INCLUDE "INSTRUCTIONS.X68"
00001E96                          1546  ; ==============================================================================
00001E96                          1547  ; INSTRUCTIONS SCREEN
00001E96                          1548  ; ==============================================================================
00001E96                          1549  
00001E96                          1550  ; ------------------------------------------------------------------------------
00001E96                          1551  INSINIT
00001E96                          1552  ; INSTRUCTIONS SCREEN INIT
00001E96                          1553  ; INPUT    : NONE
00001E96                          1554  ; OUTPUT   : NONE
00001E96                          1555  ; MODIFIES : NONE
00001E96                          1556  ; ------------------------------------------------------------------------------
00001E96  4E75                    1557              RTS
00001E98                          1558  
00001E98                          1559  ; ------------------------------------------------------------------------------
00001E98                          1560  INSUPD
00001E98                          1561  ; INSTRUCTIONS SCREEN UPDATE
00001E98                          1562  ; INPUT    : NONE
00001E98                          1563  ; OUTPUT   : NONE
00001E98                          1564  ; MODIFIES : NONE
00001E98                          1565  ; ------------------------------------------------------------------------------
00001E98  4E75                    1566              RTS
00001E9A                          1567  
00001E9A                          1568  ; ------------------------------------------------------------------------------
00001E9A                          1569  INSPLOT
00001E9A                          1570  ; INSTRUCTIONS SCREEN PLOT
00001E9A                          1571  ; INPUT    : NONE
00001E9A                          1572  ; OUTPUT   : NONE
00001E9A                          1573  ; MODIFIES : NONE
00001E9A                          1574  ; ------------------------------------------------------------------------------
00001E9A                          1575  
00001E9A  48E7 C0C0               1576              MOVEM.L D0-D1/A0-A1,-(A7)
00001E9E  4281                    1577              CLR.L   D1
00001EA0  103C 0051               1578              MOVE.B  #81,D0
00001EA4  4E4F                    1579              TRAP    #15
00001EA6  103C 000B               1580              MOVE.B  #11,D0
00001EAA  43F9 0000200C           1581              LEA     .TXTLST,A1
00001EB0  2219                    1582  .LOOP       MOVE.L  (A1)+,D1
00001EB2  6700 000A               1583              BEQ     .DONE
00001EB6  2041                    1584              MOVE.L  D1,A0
00001EB8  4EB8 1CC4               1585              JSR     UTLPRINT
00001EBC  60F2                    1586              BRA     .LOOP
00001EBE  4CDF 0303               1587  .DONE       MOVEM.L (A7)+,D0-D1/A0-A1
00001EC2  4E75                    1588              RTS
00001EC4= 57 45 4C 43 4F 4D ...   1589  .TXT1       DC.B    'WELCOME TO THE WORLD OF MULTI-PONG 68000!',0
00001EEE= 59 4F 55 52 20 47 ...   1590  .TXT2       DC.B    'YOUR GOAL IN THIS GAME IS TO AVOID MISSING THE BALLS',0
00001F23= 54 4F 20 54 48 49 ...   1591  .TXT3       DC.B    'TO THIS END, MOVE THE PAD USING THE KEYBOARD',0
00001F50= 48 4F 57 20 54 4F ...   1592  .TXT4       DC.B    'HOW TO DO IT? YOU MAY ASK.',0
00001F6B= 49 54 20 49 53 20 ...   1593  .TXT5       DC.B    'IT IS EASY: JUST USE THE UP KEY TO MOVE THE PAD...',0
00001F9E= 55 50 21 00             1594  .TXT6       DC.B    'UP!',0
00001FA2= 41 4E 44 20 55 53 ...   1595  .TXT7       DC.B    'AND USE THE DOWN KEY TO MOVE THE PAD DOWN.',0
00001FCD= 57 48 41 54 20 41 ...   1596  .TXT8       DC.B    'WHAT ABOUT LEFT AND RIGHT?',0
00001FE8= 4E 4F 2E 20 54 48 ...   1597  .TXT9       DC.B    'NO. THESE ARE FORBIDDEN DIRECTIONS',0
0000200C                          1598              DS.W    0
0000200C= 00001EC4 00001EEE ...   1599  .TXTLST     DC.L    .TXT1,.TXT2,.TXT3,.TXT4,.TXT5,.TXT6,.TXT7,.TXT8,.TXT9,0
00002034                          1600  
00002034                          1601  
00002034                          1602  -------------------- end include --------------------
00002034                          1603              INCLUDE "WIN.X68"
00002034                          1604  ; ==============================================================================
00002034                          1605  ; VICTORY SCREEN
00002034                          1606  ; ==============================================================================
00002034                          1607  
00002034                          1608  ; ------------------------------------------------------------------------------
00002034                          1609  WININIT
00002034                          1610  ; VICTORY SCREEN INIT
00002034                          1611  ; INPUT    : NONE
00002034                          1612  ; OUTPUT   : NONE
00002034                          1613  ; MODIFIES : NONE
00002034                          1614  ; ------------------------------------------------------------------------------
00002034  4E75                    1615              RTS
00002036                          1616  
00002036                          1617  ; ------------------------------------------------------------------------------
00002036                          1618  WINUPD
00002036                          1619  ; VICTORY SCREEN UPDATE
00002036                          1620  ; INPUT    : NONE
00002036                          1621  ; OUTPUT   : NONE
00002036                          1622  ; MODIFIES : NONE
00002036                          1623  ; ------------------------------------------------------------------------------
00002036  4E75                    1624              RTS
00002038                          1625  
00002038                          1626  ; ------------------------------------------------------------------------------
00002038                          1627  WINPLOT
00002038                          1628  ; VICTORY SCREEN PLOT
00002038                          1629  ; INPUT    : NONE
00002038                          1630  ; OUTPUT   : NONE
00002038                          1631  ; MODIFIES : NONE
00002038                          1632  ; ------------------------------------------------------------------------------
00002038  48E7 C080               1633              MOVEM.L D0-D1/A0,-(A7)
0000203C                          1634              
0000203C  4281                    1635              CLR.L   D1
0000203E  103C 0051               1636              MOVE.B  #81,D0
00002042  4E4F                    1637              TRAP    #15
00002044                          1638              
00002044  41F9 00002072           1639              LEA     .TXT1,A0
0000204A  103C 000A               1640              MOVE.B  #10,D0
0000204E  4EB8 1CC4               1641              JSR     UTLPRINT
00002052                          1642              
00002052  0839 0004 000021CB      1643              BTST.B  #4,(SCRCYCCT)
0000205A  6700 0010               1644              BEQ     .DONE
0000205E                          1645              
0000205E  41F9 0000207B           1646              LEA     .TXT2,A0
00002064  103C 0019               1647              MOVE.B  #25,D0
00002068  4EB8 1CC4               1648              JSR     UTLPRINT
0000206C                          1649              
0000206C  4CDF 0103               1650  .DONE       MOVEM.L (A7)+,D0-D1/A0
00002070                          1651  
00002070  4E75                    1652              RTS
00002072= 59 4F 55 20 57 4F ...   1653  .TXT1       DC.B    'YOU WON!',0
0000207B= 50 52 45 53 53 20 ...   1654  .TXT2       DC.B    'PRESS FIRE1 TO CONTINUE',0
00002094                          1655              DS.W    0
00002094                          1656  
00002094                          1657  
00002094                          1658  
00002094                          1659  -------------------- end include --------------------
00002094                          1660              INCLUDE "GOVER.X68"
00002094                          1661  ; ==============================================================================
00002094                          1662  ; GAME OVER SCREEN
00002094                          1663  ; ==============================================================================
00002094                          1664  
00002094                          1665  ; ------------------------------------------------------------------------------
00002094                          1666  GOVINIT
00002094                          1667  ; GAME OVER SCREEN INIT
00002094                          1668  ; INPUT    : NONE
00002094                          1669  ; OUTPUT   : NONE
00002094                          1670  ; MODIFIES : NONE
00002094                          1671  ; ------------------------------------------------------------------------------
00002094  4E75                    1672              RTS
00002096                          1673  
00002096                          1674  ; ------------------------------------------------------------------------------
00002096                          1675  GOVUPD
00002096                          1676  ; GAME OVER SCREEN UPDATE
00002096                          1677  ; INPUT    : NONE
00002096                          1678  ; OUTPUT   : NONE
00002096                          1679  ; MODIFIES : NONE
00002096                          1680  ; ------------------------------------------------------------------------------
00002096  4E75                    1681              RTS
00002098                          1682  
00002098                          1683  ; ------------------------------------------------------------------------------
00002098                          1684  GOVPLOT
00002098                          1685  ; GAME OVER SCREEN PLOT
00002098                          1686  ; INPUT    : NONE
00002098                          1687  ; OUTPUT   : NONE
00002098                          1688  ; MODIFIES : NONE
00002098                          1689  ; ------------------------------------------------------------------------------
00002098  48E7 C080               1690              MOVEM.L D0-D1/A0,-(A7)
0000209C                          1691              
0000209C  4281                    1692              CLR.L   D1
0000209E  103C 0051               1693              MOVE.B  #81,D0
000020A2  4E4F                    1694              TRAP    #15
000020A4                          1695              
000020A4  41F9 000020D2           1696              LEA     .TXT1,A0
000020AA  103C 000A               1697              MOVE.B  #10,D0
000020AE  4EB8 1CC4               1698              JSR     UTLPRINT
000020B2                          1699              
000020B2  0839 0004 000021CB      1700              BTST.B  #4,(SCRCYCCT)
000020BA  6700 0010               1701              BEQ     .DONE
000020BE                          1702              
000020BE  41F9 000020DC           1703              LEA     .TXT2,A0
000020C4  103C 0019               1704              MOVE.B  #25,D0
000020C8  4EB8 1CC4               1705              JSR     UTLPRINT
000020CC                          1706              
000020CC  4CDF 0103               1707  .DONE       MOVEM.L (A7)+,D0-D1/A0
000020D0                          1708  
000020D0  4E75                    1709              RTS
000020D2= 47 41 4D 45 20 4F ...   1710  .TXT1       DC.B    'GAME OVER',0
000020DC= 50 52 45 53 53 20 ...   1711  .TXT2       DC.B    'PRESS FIRE1 TO CONTINUE',0
000020F4                          1712              DS.W    0
000020F4                          1713  
000020F4                          1714  
000020F4                          1715  -------------------- end include --------------------
000020F4                          1716              INCLUDE "STATES.X68"
000020F4                          1717  ; =============================================================================
000020F4                          1718  ; GAME STATE MANAGEMENT
000020F4                          1719  ; =============================================================================
000020F4                          1720  
000020F4                          1721  ; -----------------------------------------------------------------------------
000020F4                          1722  STAINIT
000020F4                          1723  ; INITALIZES THE STATE MANAGER
000020F4                          1724  ; INPUT    - NONE
000020F4                          1725  ; OUTPUT   - NONE
000020F4                          1726  ; MODIFIES - NONE
000020F4                          1727  ; -----------------------------------------------------------------------------
000020F4  33FC FFFF 000025EA      1728              MOVE.W  #STANONE,(STACUR)
000020FC  4279 000025EC           1729              CLR.W   (STANEXT)
00002102  4E75                    1730              RTS
00002104                          1731  
00002104                          1732  ; -----------------------------------------------------------------------------
00002104                          1733  STAUPD
00002104                          1734  ; PERFORMS STATE UPDATE AND INIT IF NECESSARY
00002104                          1735  ; INPUT    - NONE
00002104                          1736  ; OUTPUT   - NONE
00002104                          1737  ; MODIFIES - NONE
00002104                          1738  ; -----------------------------------------------------------------------------
00002104  48E7 8080               1739              MOVEM.L D0/A0,-(A7)
00002108  4280                    1740              CLR.L   D0
0000210A  3039 000025EC           1741              MOVE.W  (STANEXT),D0
00002110  B079 000025EA           1742              CMP.W   (STACUR),D0
00002116  6700 0012               1743              BEQ     .DOUPD
0000211A  33C0 000025EA           1744              MOVE.W  D0,(STACUR)             ; IF STATE CHANGED, DO INIT
00002120  E588                    1745              LSL.L   #2,D0
00002122  2040                    1746              MOVE.L  D0,A0
00002124  2068 2142               1747              MOVE.L  .INITBL(A0),A0
00002128  4E90                    1748              JSR     (A0)
0000212A  4280                    1749  .DOUPD      CLR.L   D0                      ; IN ANY CASE, DO UPDATE
0000212C  3039 000025EA           1750              MOVE.W  (STACUR),D0
00002132  E588                    1751              LSL.L   #2,D0
00002134  2040                    1752              MOVE.L  D0,A0
00002136  2068 214A               1753              MOVE.L  .UPDTBL(A0),A0
0000213A  4E90                    1754              JSR     (A0)
0000213C  4CDF 0101               1755              MOVEM.L (A7)+,D0/A0
00002140  4E75                    1756              RTS
00002142= 00001E14 00002178       1757  .INITBL     DC.L    ISCINIT,GAMINIT
0000214A= 00001E1C 00002188       1758  .UPDTBL     DC.L    ISCUPD,GAMUPD
00002152                          1759  
00002152                          1760  ; -----------------------------------------------------------------------------
00002152                          1761  STAPLOT
00002152                          1762  ; PERFORMS STATE PLOT
00002152                          1763  ; INPUT    - NONE
00002152                          1764  ; OUTPUT   - NONE
00002152                          1765  ; MODIFIES - NONE
00002152                          1766  ; -----------------------------------------------------------------------------
00002152  48E7 8080               1767              MOVEM.L D0/A0,-(A7)
00002156  4280                    1768              CLR.L   D0
00002158  3039 000025EA           1769              MOVE.W  (STACUR),D0
0000215E  E588                    1770              LSL.L   #2,D0
00002160  2040                    1771              MOVE.L  D0,A0
00002162  2068 216E               1772              MOVE.L  .PLTTBL(A0),A0
00002166  4E90                    1773              JSR     (A0)
00002168  4CDF 0101               1774              MOVEM.L (A7)+,D0/A0
0000216C  4E75                    1775              RTS
0000216E= 00001E32 0000218C       1776  .PLTTBL     DC.L    ISCPLOT,GAMPLOT
00002176                          1777  
00002176                          1778  ; -----------------------------------------------------------------------------
00002176                          1779  STAEMPTY
00002176                          1780  ; EMPTY SUBROUTINE FOR CASES WITH NOTHING TO DO
00002176                          1781  ; INPUT    - NONE
00002176                          1782  ; OUTPUT   - NONE
00002176                          1783  ; MODIFIES - NONE
00002176                          1784  ; NOTE     - JUST A PLACEHOLDER. NOTHING TO DO.
00002176                          1785  ; -----------------------------------------------------------------------------
00002176  4E75                    1786              RTS
00002178                          1787  
00002178                          1788  
00002178                          1789  
00002178                          1790  
00002178                          1791  
00002178                          1792  
00002178                          1793  
00002178                          1794  
00002178                          1795  
00002178                          1796  -------------------- end include --------------------
00002178                          1797              INCLUDE "GAME.X68"
00002178                          1798  ; ==============================================================================
00002178                          1799  ; GAME MANAGEMENT
00002178                          1800  ; ==============================================================================
00002178                          1801  
00002178                          1802  ; ------------------------------------------------------------------------------
00002178                          1803  GAMINIT
00002178                          1804  ; INITIALIZES GAME.
00002178                          1805  ; INPUT    : NONE
00002178                          1806  ; OUTPUT   : NONE
00002178                          1807  ; MODIFIES : NONE
00002178                          1808  ; ------------------------------------------------------------------------------
00002178  4EB8 14B4               1809              JSR     PMINIT
0000217C  4EB8 1B10               1810              JSR     MAPINIT
00002180  4EB8 1400               1811              JSR     GSTINIT
00002184  6000 F6AA               1812              BRA     SCOINIT
00002188                          1813  
00002188                          1814  ; ------------------------------------------------------------------------------
00002188                          1815  GAMUPD
00002188                          1816  ; UPDATES THE GAME
00002188                          1817  ; INPUT    : NONE
00002188                          1818  ; OUTPUT   : NONE
00002188                          1819  ; MODIFIES : NONE
00002188                          1820  ; ------------------------------------------------------------------------------
00002188                          1821              
00002188                          1822              ;JSR     GSTUPD
00002188  6000 F35E               1823              BRA     PMUPD
0000218C                          1824              
0000218C                          1825  ; ------------------------------------------------------------------------------
0000218C                          1826  GAMPLOT
0000218C                          1827  ; PLOTS THE GAME
0000218C                          1828  ; INPUT    : NONE
0000218C                          1829  ; OUTPUT   : NONE
0000218C                          1830  ; MODIFIES : NONE
0000218C                          1831  ; ------------------------------------------------------------------------------
0000218C  4EB8 1B8A               1832              JSR     MAPPLOT
00002190  4EB8 1840               1833              JSR     SCOPLOT
00002194  4EB8 1632               1834              JSR     PMPLOT
00002198  6000 F2B0               1835              BRA     GSTPLOT
0000219C                          1836  
0000219C                          1837  
0000219C                          1838  -------------------- end include --------------------
0000219C                          1839              
0000219C                          1840      
0000219C                          1841  START:
0000219C                          1842  
0000219C                          1843  ;--- INITIALIZATION -----------------------------------------------------------
0000219C                          1844  
0000219C  007C 0700               1845              ORI.W   #$0700,SR               ;DISABLE INTERRUPTIONS
000021A0                          1846  
000021A0  4EB8 18A2               1847              JSR     SYSINIT
000021A4  4EB8 20F4               1848              JSR     STAINIT
000021A8                          1849  
000021A8                          1850  .LOOP
000021A8                          1851  
000021A8                          1852  ; --- UPDATE -------------------------------------------------------------------
000021A8                          1853  
000021A8                          1854  ; READ INPUT DEVICES
000021A8                          1855  
000021A8  4E41                    1856              TRAP    #1
000021AA                          1857  
000021AA                          1858  ; UPDATE GAME LOGIC
000021AA                          1859  
000021AA  4EB8 2104               1860             JSR     STAUPD
000021AE                          1861  
000021AE                          1862  ; --- SYNC ---------------------------------------------------------------------
000021AE                          1863              ;WHILE THERES NO INTERRUPTS IN THE COUNTER THE PROGRAM WILL BE IN
000021AE                          1864              ;THE BUCLE
000021AE                          1865              
000021AE  4A39 000021CA           1866  .WAITINIT   TST.B   (SCRINTCT)
000021B4  67F8                    1867              BEQ     .WAITINIT
000021B6  4239 000021CA           1868              CLR.B   (SCRINTCT)
000021BC                          1869  
000021BC                          1870  ; --- PLOT ---------------------------------------------------------------------
000021BC                          1871              
000021BC  4EB8 2152               1872              JSR     STAPLOT
000021C0                          1873              
000021C0                          1874              
000021C0  4E40                    1875              TRAP    #0                      ;CHANGE BUFFER
000021C2                          1876  
000021C2  60E4                    1877              BRA     .LOOP
000021C4                          1878  
000021C4  FFFF FFFF               1879              SIMHALT  
000021C8                          1880             
000021C8                          1881              INCLUDE "SYSVARS.X68"
000021C8                          1882  ; ==============================================================================
000021C8                          1883  ; SYSTEM VARIABLES
000021C8                          1884  ; ==============================================================================
000021C8                          1885   
000021C8                          1886  ; --- KEYBOARD RELATED VARIABLES -----------------------------------------------
000021C8                          1887  
000021C8                          1888  KBDVAL      DS.B    1                       ; KEY STATE
000021C9                          1889  KBDEDGE     DS.B    1                       ; KEY EDGE
000021CA                          1890              DS.W    0 
000021CA                          1891  
000021CA                          1892  ; --- TIMED INTERRUPT RELATED VARIABLES ----------------------------------------
000021CA                          1893  
000021CA                          1894  SCRINTCT    DS.B    1                       ; INTERRUPT COUNTER
000021CB                          1895  SCRCYCCT    DS.B    1                       ; CYCLE COUNTER
000021CC                          1896              DS.W    0        
000021CC                          1897              
000021CC                          1898  ; --- MAP RELATED VARIABLE -----------------------------------------------------
000021CC                          1899  
000021CC                          1900  MAPVAR      DS.B    1024
000025CC                          1901  
000025CC                          1902              DS.B    0
000025CC                          1903  
000025CC                          1904  POSCON      DS.W    1
000025CE                          1905  
000025CE                          1906  
000025CE                          1907  
000025CE                          1908  
000025CE                          1909  
000025CE                          1910  
000025CE                          1911  
000025CE                          1912  -------------------- end include --------------------
000025CE                          1913              INCLUDE "VARS.X68"
000025CE                          1914  ; ==============================================================================
000025CE                          1915  ; GAME VARIABLES
000025CE                          1916  ; ==============================================================================
000025CE                          1917  
000025CE                          1918  ; --- PAC-MAN RELATED VARIABLES ------------------------------------------------
000025CE                          1919  
000025CE                          1920  PMPOSX      DS.W    1                       ; PM X COORDINATE
000025D0                          1921  PMPOSY      DS.W    1                       ; PM Y COORDINATE
000025D2                          1922  PMVELX      DS.W    1                       ; PM X VELOCITY
000025D4                          1923  PMVELY      DS.W    1                       ; PM Y VELOCITY
000025D6                          1924  PMEAT       DS.B    1                       ; PM BOOLEAN EAT GST
000025D7                          1925  PMLAMO      DS.B    1                       ; PM SAVE LAST MOVEMENT X O Y
000025D8                          1926              DS.B    0
000025D8                          1927  
000025D8                          1928  ; --- GHOST RELATED VARIABLES --------------------------------------------------
000025D8                          1929  
000025D8                          1930  GSTPOSX     DS.W    1                       ; GST X COORDINATE
000025DA                          1931  GSTPOSY     DS.W    1                       ; GST Y COORDINATE
000025DC                          1932  GSTVELX     DS.W    1                       ; GST X VELOCITY
000025DE                          1933  GSTVELY     DS.W    1                       ; GST Y VELOCITY
000025E0                          1934  GSTDEAD     DS.B    1                       ; GST BOOLEAN DEAD
000025E1                          1935  GSTLAMO     DS.B    1                       ; GST LAST MOVEMENT (X OR Y)
000025E2                          1936  GSTINRNG    DS.B    1                       ; GST IS IN RANGE
000025E3                          1937  GSTTARG     DS.B    1                       ; GST TARGET (0-PACMAN, 1-RANDOM)
000025E4                          1938              DS.B    0
000025E4                          1939  
000025E4                          1940  ; --- SCOREBOARD RELATED VARIABLES ---------------------------------------------
000025E4                          1941  
000025E4                          1942  SCOLIFE     DS.W    1                       ; NUMBER OF LIFES
000025E6                          1943  SCOPOINTS   DS.W    1                       ; NUMBER OF POINTS
000025E8                          1944  
000025E8                          1945  ; --- INTRO STATE RELATED VARIABLES --------------------------------------------
000025E8                          1946  
000025E8                          1947  ISCTIMER    DS.W    1                       ; INTRO TIMER
000025EA                          1948  
000025EA                          1949  ; --- STATE RELATED VARIABLES --------------------------------------------------
000025EA                          1950  
000025EA                          1951  STACUR      DS.W    1                       ; CURRENT STATE
000025EC                          1952  STANEXT     DS.W    1                       ; NEXT STATE
000025EE                          1953  
000025EE                          1954  
000025EE                          1955  
000025EE                          1956  
000025EE                          1957  
000025EE                          1958  
000025EE                          1959  
000025EE                          1960  
000025EE                          1961  
000025EE                          1962  -------------------- end include --------------------
000025EE                          1963              INCLUDE "LIB/UTLVARS.X68"
000025EE                          1964  ; =============================================================================
000025EE                          1965  ; UTILITY VARIABLES
000025EE                          1966  ; =============================================================================
000025EE                          1967  
000025EE                          1968  UTLRNDIX    DS.B    1                       ; NEXT INDEX TO RANDOM NUMBER
000025F0                          1969              DS.W    0
000025F0                          1970  -------------------- end include --------------------
000025F0                          1971              
000025F0                          1972              END    START        

No errors detected
No warnings generated


SYMBOL TABLE INFORMATION
Symbol-name         Value
-------------------------
BUCLE_COLUMNA       1B36
BUCLE_COLUMNA2      1BAC
BUCLE_FILA          1B2A
BUCLE_FILA2         1BA0
COLWALLDOWN         1A22
COLWALLLEFT         19E0
COLWALLRIGHT        199E
COLWALLUP           1A5E
DIBFIGBPOINT        1C72
DIBFIGPOINT         1C36
DIBFIGWALL          1BFE
GAMINIT             2178
GAMPLOT             218C
GAMUPD              2188
GETPOINTS           1A9C
GETPOINTS:BPOINT    1AE6
GETPOINTS:DONE      1B0A
GETPOINTS:POINT     1AF8
GOVINIT             2094
GOVPLOT             2098
GOVPLOT:DONE        20CC
GOVPLOT:TXT1        20D2
GOVPLOT:TXT2        20DC
GOVUPD              2096
GSTCOL1             FF
GSTCOL2             FF0080
GSTCOL3             FFFF00
GSTCOL4             80FF
GSTCOL5             800000
GSTDEAD             25E0
GSTFCOL1            FFFFFF
GSTFCOL2            0
GSTFCOL3            0
GSTFCOL4            0
GSTFCOL5            0
GSTINIT             1400
GSTINRNG            25E2
GSTINX1             2
GSTINX2             2
GSTINX3             1F
GSTINX4             1F
GSTINY1             2
GSTINY2             1F
GSTINY3             2
GSTINY4             1F
GSTLAMO             25E1
GSTPLOT             144A
GSTPOSX             25D8
GSTPOSY             25DA
GSTRAD              8
GSTRNG              10
GSTSPEED            7
GSTSPEED2           5
GSTTARG             25E3
GSTUPD              1428
GSTUPD:CHECKCRITIC  1444
GSTUPD:GSTINRNG     143C
GSTUPD:GSTNOTINRNG  1430
GSTVELX             25DC
GSTVELY             25DE
INSINIT             1E96
INSPLOT             1E9A
INSPLOT:DONE        1EBE
INSPLOT:LOOP        1EB0
INSPLOT:TXT1        1EC4
INSPLOT:TXT2        1EEE
INSPLOT:TXT3        1F23
INSPLOT:TXT4        1F50
INSPLOT:TXT5        1F6B
INSPLOT:TXT6        1F9E
INSPLOT:TXT7        1FA2
INSPLOT:TXT8        1FCD
INSPLOT:TXT9        1FE8
INSPLOT:TXTLST      200C
INSUPD              1E98
ISCINIT             1E14
ISCPLOT             1E32
ISCPLOT:DONE        1E66
ISCPLOT:TXT1        1E6C
ISCPLOT:TXT2        1E7A
ISCTIMER            25E8
ISCUPD              1E1C
ISCUPD:CONT         1E30
ISCUPD:DONE         1E30
KBDDOWN             28
KBDEDGE             21C9
KBDFIRE1            20
KBDFIRE2            4D
KBDFIRE3            10
KBDINIT             193A
KBDLEFT             25
KBDPAUSE            50
KBDRIGHT            27
KBDUP               26
KBDUPD              1948
KBDUPD:CONVERT      1990
KBDUPD:LOOP         1994
KBDUPD:NOACT        198A
KBDVAL              21C8
MAPINIT             1B10
MAPMAT              1000
MAPPLOT             1B8A
MAPVAR              21CC
NOTPOINT            1B6A
NOTPOINT2           1BDE
NOTWALL             1B5C
NOTWALL2            1BD0
PMEAT               25D6
PMFCOL              FFFF
PMINIT              14B4
PMLAMO              25D7
PMPCOL              FFFF
PMPLOT              1632
PMPLOT:DDONE        16C6
PMPLOT:DDOWN        1698
PMPLOT:DLEFT        168E
PMPLOT:DOWNDRAW     1786
PMPLOT:DRAW_MOUTH1  16A2
PMPLOT:DRAW_MOUTH2  16AC
PMPLOT:DRAW_MOUTH3  16B6
PMPLOT:DRAW_MOUTH4  16C0
PMPLOT:DRIGHT       167A
PMPLOT:DUP          1684
PMPLOT:FULLDRAW     16CC
PMPLOT:LEFTDRAW     16F0
PMPLOT:RIGHTDRAW    1722
PMPLOT:SET_MOUTHDOWN  1812
PMPLOT:SET_MOUTHLEFT  17B8
PMPLOT:SET_MOUTHRIGHT  17D6
PMPLOT:SET_MOUTHUP  17F4
PMPLOT:UPDRAW       1754
PMPOSX              25CE
PMPOSY              25D0
PMRAD               8
PMSPEED             2
PMUPD               14E8
PMUPD:ACTXLEFT      15A6
PMUPD:ACTXRIGHT     157A
PMUPD:ACTYDOWN      15D2
PMUPD:ACTYUP        15EE
PMUPD:DONE          1620
PMUPD:NOTCOLISION   158C
PMUPD:NOTCOLISION2  15B8
PMUPD:NOTCOLISION3  15E4
PMUPD:NOTCOLISION4  1600
PMUPD:NOTDOWN       1576
PMUPD:NOTLEFT       1534
PMUPD:NOTMULT       160A
PMUPD:NOTRIGHT      154A
PMUPD:NOTTP         159C
PMUPD:NOTTP2        15C8
PMUPD:NOTUP         1560
PMVELX              25D2
PMVELY              25D4
POSCON              25CC
SCOFCOL             0
SCOINIT             1830
SCOLIFE             25E4
SCOLINE1            101
SCOLINE2            102
SCOPLOT             1840
SCOPLOT:TXT1        188E
SCOPLOT:TXT2        1897
SCOPOINTS           25E6
SCRCYCCT            21CB
SCRHEIGH            280
SCRINIT             18CE
SCRINTCT            21CA
SCRTIM              192C
SCRUPD              1912
SCRWIDTH            280
STACUR              25EA
STAEMPTY            2176
STAINIT             20F4
STANEXT             25EC
STANONE             FFFFFFFF
STAPLOT             2152
STAPLOT:PLTTBL      216E
START               219C
START:LOOP          21A8
START:WAITINIT      21AE
STAUPD              2104
STAUPD:DOUPD        212A
STAUPD:INITBL       2142
STAUPD:UPDTBL       214A
SYSINIT             18A2
UTLCHRWD            8
UTLINIT             1CAE
UTLPRINT            1CC4
UTLPRINT:ENDLOOP    1CD6
UTLPRINT:LOOP       1CCC
UTLRAND             1CF6
UTLRAND:RANDVEC     1D14
UTLRNDIX            25EE
WININIT             2034
WINPLOT             2038
WINPLOT:DONE        206C
WINPLOT:TXT1        2072
WINPLOT:TXT2        207B
WINUPD              2036
ZERO                1B78
ZERO2               1BEC
