00002588 Starting Address
Assembler used: EASy68K Editor/Assembler v5.16.01
Created On: 25/12/2022 22:21:57

00000000                             1  ; ==============================================================================
00000000                             2  ; TITLE       : PAC-MAN 68000
00000000                             3  ; DESCRIPTION : GAME IN MOTOROLA 68000 BASED ON PAC-MAN GAME
00000000                             4  ; AUTHOR      : JORDI FLORIT ENSENYAT
00000000                             5  ;               JOSEP GABRIEL FORNES REYNES
00000000                             6  ;               PAU GIRON RODRIGUEZ
00000000                             7  ; ==============================================================================
00001000                             8              ORG    $1000
00001000                             9  
00001000                            10              INCLUDE "CONST.X68"
00001000                            11  ; ==============================================================================
00001000                            12  ; GAME CONSTANTS
00001000                            13  ; ==============================================================================
00001000                            14  
00001000                            15  ; --- PAC-MAN RELATED CONTANTS ----------------------------------------------------
00001000                            16  
00001000  =0000FFFF                 17  PMPCOL      EQU     $0000FFFF               ; PAC-MAN CONTOUR COLOR
00001000  =0000FFFF                 18  PMFCOL      EQU     $0000FFFF               ; PAC-MAN FILL COLOR
00001000  =00000002                 19  PMSPEED     EQU     2                       ; MAGNITUDE OF THE X AND Y VEL.
00001000  =00000008                 20  PMRAD       EQU     8                       ; PAC-MAN RADIUS
00001000                            21  
00001000                            22  ; --- GHOST RELATED CONSTANTS ----------------------------------------------------
00001000                            23  
00001000  =00000002                 24  GSTSPEED    EQU     2                       ; MAGNITUDE OF THE NORMAL DISPLACEMENT
00001000  =00000005                 25  GSTSPEED2   EQU     5                       ; MAGNITUDE OF THE ATACKED DISPLACEMENT
00001000                            26  
00001000  =000000FF                 27  GSTCOL1     EQU     $000000FF               ; GHOST 1 CONTOUR COLOR RED
00001000  =00FFFFFF                 28  GSTFCOL1    EQU     $00FFFFFF               ; GHOST 1 FILL COLOR WHITE
00001000  =00000002                 29  GSTINX1     EQU     2                       ; GHOST 1 INITIAL X
00001000  =00000002                 30  GSTINY1     EQU     2                       ; GHOST 1 INITIAL Y
00001000                            31  
00001000  =00FF0080                 32  GSTCOL2     EQU     $00FF0080               ; GHOST 2 CONTOUR COLOR PINK
00001000  =00000000                 33  GSTFCOL2    EQU     $00000000               ; GHOST 1 FILL COLOR
00001000  =00000002                 34  GSTINX2     EQU     2                       ; GHOST 2 INITIAL X
00001000  =0000001F                 35  GSTINY2     EQU     31                      ; GHOST 2 INITIAL Y
00001000                            36  
00001000  =00FFFF00                 37  GSTCOL3     EQU     $00FFFF00               ; GHOST 3 CONTOUR COLOR CYAN
00001000  =00000000                 38  GSTFCOL3    EQU     $00000000               ; GHOST 3 FILL COLOR
00001000  =0000001F                 39  GSTINX3     EQU     31                      ; GHOST 3 INITIAL X
00001000  =00000002                 40  GSTINY3     EQU     2                       ; GHOST 3 INITIAL Y
00001000                            41  
00001000  =000080FF                 42  GSTCOL4     EQU     $000080FF               ; GHOST 4 CONTOUR COLOR ORANGE
00001000  =00000000                 43  GSTFCOL4    EQU     $00000000               ; GHOST 4 FILL COLOR
00001000  =0000001F                 44  GSTINX4     EQU     31                      ; GHOST 4 INITIAL X
00001000  =0000001F                 45  GSTINY4     EQU     31                      ; GHOST 4 INITIAL Y 
00001000                            46  
00001000  =00800000                 47  GSTCOL5     EQU     $00800000               ; CONTOUR COLOR OF ATACKED MODE
00001000  =00000000                 48  GSTFCOL5    EQU     $00000000               ; FILL COLOR OF ATACKED MODE
00001000                            49  
00001000  =00000008                 50  GSTRAD      EQU     8                       ; GHOST RADIUS
00001000  =00000010                 51  GSTRNG      EQU     16                      ; GHOST DETECTING RANGE
00001000= 0001 0002 0003 0004       52  GSTDECVEC   DC.W    1,2,3,4                 ; GHOST MOVEMENT DECISSIONS
00001008                            53              
00001008                            54  ; --- SCOREBOARD RELATED CONSTANTS ---------------------------------------------
00001008                            55  ;MODIFICATE
00001008                            56  
00001008  =00000000                 57  SCOFCOL     EQU     $00000000               ; TEXT BACKGROUND COLOR
00001008  =00000101                 58  SCOLINE1    EQU     $0101                   ; FIRST TEXT LINE COORDINATES
00001008  =00000102                 59  SCOLINE2    EQU     $0102                   ; SECOND TEXT LINE COORDINATES
00001008                            60  
00001008                            61  ; --- MAP RELATED CONSTANTS ----------------------------------------------------
00001008                            62  
00001008= 01 01 01 01 01 01 ...     63  MAPMAT      DC.B    $1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
00001028= 01 02 02 02 02 02 ...     64              DC.B    $1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1
00001048= 01 02 01 01 01 01 ...     65              DC.B    $1,2,1,1,1,1,1,2,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,2,1,1,1,1,1,2,1
00001068= 01 03 01 01 01 01 ...     66              DC.B    $1,3,1,1,1,1,1,2,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,2,1,1,1,1,1,3,1
00001088= 01 02 02 02 02 02 ...     67              DC.B    $1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1
000010A8= 01 02 01 01 01 01 ...     68              DC.B    $1,2,1,1,1,1,1,2,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,2,1,1,1,1,1,2,1
000010C8= 01 02 01 01 01 01 ...     69              DC.B    $1,2,1,1,1,1,1,2,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,2,1,1,1,1,1,2,1
000010E8= 01 02 02 02 02 02 ...     70              DC.B    $1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1
00001108= 01 02 01 01 01 01 ...     71              DC.B    $1,2,1,1,1,1,1,2,1,1,1,2,1,1,1,1,1,1,1,1,2,1,1,1,2,1,1,1,1,1,2,1
00001128= 01 02 01 00 00 00 ...     72              DC.B    $1,2,1,0,0,0,1,2,1,0,1,2,1,1,1,1,1,1,1,1,2,1,0,1,2,1,0,0,0,1,2,1
00001148= 01 02 01 01 01 01 ...     73              DC.B    $1,2,1,1,1,1,1,2,1,0,1,2,2,2,2,1,1,2,2,2,2,1,0,1,2,1,1,1,1,1,2,1
00001168= 01 02 02 02 02 02 ...     74              DC.B    $1,2,2,2,2,2,2,2,1,0,1,1,1,1,2,1,1,2,1,1,1,1,0,1,2,2,2,2,2,2,2,1
00001188= 01 01 01 01 01 01 ...     75              DC.B    $1,1,1,1,1,1,1,2,1,0,1,1,1,1,2,1,1,2,1,1,1,1,0,1,2,1,1,1,1,1,1,1
000011A8= 01 00 00 00 00 00 ...     76              DC.B    $1,0,0,0,0,0,1,2,1,0,1,0,0,0,0,0,0,0,0,0,0,1,0,1,2,1,0,0,0,0,0,1
000011C8= 01 00 00 00 00 00 ...     77              DC.B    $1,0,0,0,0,0,1,2,1,0,1,0,1,1,1,0,0,1,1,1,0,1,0,1,2,1,0,0,0,0,0,1
000011E8= 01 01 01 01 01 01 ...     78              DC.B    $1,1,1,1,1,1,1,2,1,1,1,0,1,0,0,0,0,0,0,1,0,1,1,1,2,1,1,1,1,1,1,1
00001208= 04 00 00 00 00 00 ...     79              DC.B    $4,0,0,0,0,0,0,2,2,2,2,0,1,0,0,0,0,0,0,1,0,2,2,2,2,0,0,0,0,0,0,4
00001228= 01 01 01 01 01 01 ...     80              DC.B    $1,1,1,1,1,1,1,2,1,1,1,0,1,0,0,0,0,0,0,1,0,1,1,1,2,1,1,1,1,1,1,1
00001248= 01 00 00 00 00 00 ...     81              DC.B    $1,0,0,0,0,0,1,2,1,0,1,0,1,1,1,1,1,1,1,1,0,1,0,1,2,1,0,0,0,0,0,1
00001268= 01 00 00 00 00 00 ...     82              DC.B    $1,0,0,0,0,0,1,2,1,0,1,0,0,0,0,0,0,0,0,0,0,1,0,1,2,1,0,0,0,0,0,1
00001288= 01 01 01 01 01 01 ...     83              DC.B    $1,1,1,1,1,1,1,2,1,1,1,0,1,1,1,1,1,1,1,1,0,1,1,1,2,1,1,1,1,1,1,1
000012A8= 01 02 02 02 02 02 ...     84              DC.B    $1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1
000012C8= 01 02 01 01 01 01 ...     85              DC.B    $1,2,1,1,1,1,1,2,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,2,1,1,1,1,1,2,1
000012E8= 01 02 01 01 01 01 ...     86              DC.B    $1,2,1,1,1,1,1,2,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,2,1,1,1,1,1,2,1
00001308= 01 02 02 02 02 01 ...     87              DC.B    $1,2,2,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,2,2,2,1
00001328= 01 01 01 01 02 01 ...     88              DC.B    $1,1,1,1,2,1,1,2,1,1,1,2,1,1,1,1,1,1,1,1,2,1,1,1,2,1,1,2,1,1,1,1
00001348= 01 01 01 01 02 01 ...     89              DC.B    $1,1,1,1,2,1,1,2,1,0,1,2,1,1,1,1,1,1,1,1,2,1,0,1,2,1,1,2,1,1,1,1
00001368= 01 02 02 02 02 02 ...     90              DC.B    $1,2,2,2,2,2,2,2,1,0,1,2,2,2,2,1,1,2,2,2,2,1,0,1,2,2,2,2,2,2,2,1
00001388= 01 02 01 01 01 01 ...     91              DC.B    $1,2,1,1,1,1,1,1,1,0,1,1,1,1,2,1,1,2,1,1,1,1,0,1,1,1,1,1,1,1,2,1
000013A8= 01 03 01 01 01 01 ...     92              DC.B    $1,3,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,3,1
000013C8= 01 02 02 02 02 02 ...     93              DC.B    $1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1
000013E8= 01 01 01 01 01 01 ...     94              DC.B    $1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
00001408                            95              
00001408                            96  ; --- STATE RELATED CONSTANTS --------------------------------------------------
00001408                            97  
00001408  =FFFFFFFF                 98  STANONE     EQU     -1                      ; NON-EXISTENT STATE NUMBER
00001408                            99  
00001408                           100  
00001408                           101  
00001408                           102  
00001408                           103  
00001408                           104  
00001408                           105  
00001408                           106  
00001408                           107  
00001408                           108  
00001408                           109  
00001408                           110  
00001408                           111  
00001408                           112  
00001408                           113  
00001408                           114  
00001408                           115  
00001408                           116  
00001408                           117  
00001408                           118  
00001408                           119  
00001408                           120  
00001408                           121  
00001408                           122  
00001408                           123  -------------------- end include --------------------
00001408                           124              INCLUDE "GHOST.X68"
00001408                           125  ; ==============================================================================
00001408                           126  ; GHOST MANAGEMENT
00001408                           127  ; ==============================================================================
00001408                           128              
00001408                           129  ; ------------------------------------------------------------------------------
00001408                           130  GSTINIT
00001408                           131  ; INITIALIZE GHOST.
00001408                           132  ; INPUT    : NONE 
00001408                           133  ; OUTPUT   : NONE
00001408                           134  ; MODIFIES : NONE
00001408                           135  ; ------------------------------------------------------------------------------
00001408  33FC 0058 00003450       136              MOVE.W  #GSTINX1*16+64-8,(GSTPOSX)
00001410  33FC 0058 00003452       137              MOVE.W  #GSTINY1*16+64-8,(GSTPOSY)
00001418  33FC 0002 00003454       138              MOVE.W  #GSTSPEED,(GSTVELX)
00001420  33FC 0002 00003456       139              MOVE.W  #GSTSPEED,(GSTVELY)
00001428  13FC 0001 00003459       140              MOVE.B  #1,(GSTLAMO)
00001430  13FC 0000 0000345D       141              MOVE.B  #0,(GSTCHDIR)
00001438  4E75                     142              RTS
0000143A                           143              
0000143A                           144  ; ------------------------------------------------------------------------------
0000143A                           145  GSTUPD
0000143A                           146  ; UPDATES THE GHOST.
0000143A                           147  ; INPUT    : NONE 
0000143A                           148  ; OUTPUT   : NONE
0000143A                           149  ; MODIFIES : NONE
0000143A                           150  ; ------------------------------------------------------------------------------
0000143A  48E7 FC00                151              MOVEM.L D0-D5,-(A7)
0000143E                           152              
0000143E                           153              ;MOVE.W  (PMPOSX)/16*(PMPOSX)/16+(PMPOSY)/16*(PMPOSY)/16,D0
0000143E  323C 0010                154              MOVE.W  #GSTRNG,D1
00001442  C2FC 0010                155              MULU.W  #GSTRNG,D1
00001446  9240                     156              SUB.W   D0,D1
00001448  303C 0002                157              MOVE.W  #GSTSPEED,D0
0000144C  6600 0016                158              BNE     .GSTINRNG
00001450                           159  .GSTNOTINRNG
00001450  4240                     160              CLR     D0
00001452  4241                     161              CLR     D1
00001454  383C 0000                162              MOVE.W  #0,D4
00001458  13FC 0001 0000345A       163              MOVE.B  #1,(GSTINRNG)
00001460  6000 000E                164              BRA     .GSTMOVE
00001464                           165  .GSTINRNG
00001464  383C 0000                166              MOVE.W  #0,D4
00001468  13FC 0000 0000345A       167              MOVE.B  #0,(GSTINRNG)
00001470                           168  .GSTMOVE
00001470  1439 0000345D            169              MOVE.B  (GSTCHDIR),D2
00001476                           170              ;CMP.B   #1,D2
00001476                           171              ;BGE     .GSTNOTMULT
00001476  3439 00003450            172              MOVE.W  (GSTPOSX),D2
0000147C  3639 00003452            173              MOVE.W  (GSTPOSY),D3
00001482                           174              
00001482  5042                     175              ADDQ.W  #8,D2              
00001484  5043                     176              ADDQ.W  #8,D3
00001486                           177  
00001486                           178              ;MASK OF THE LAST NIBBLE        
00001486  C47C 000F                179              AND.W   #$000F,D2               ; COORDENADA X
0000148A  C67C 000F                180              AND.W   #$000F,D3               ; COORDENADA Y
0000148E                           181              
0000148E                           182              ;CHECK IF COORDS ARE MULTIPLES OF 16
0000148E  B47C 0000                183              CMP     #$0000,D2
00001492  6600 00E0                184              BNE     .GSTNOTMULT
00001496  B67C 0000                185              CMP     #$0000,D3
0000149A  6600 00D8                186              BNE     .GSTNOTMULT
0000149E                           187  .GSTMULT
0000149E  4279 0000345C            188              CLR     (GSTPOSMV)
000014A4  13FC 0003 0000345D       189              MOVE.B  #3,(GSTCHDIR)
000014AC                           190  .GSTMULTRIGHT
000014AC  4EB9 00001CFE            191              JSR     GSTCOLWALLRIGHT
000014B2  BA7C 0001                192              CMP     #1,D5
000014B6  6700 000A                193              BEQ     .GSTMULTLEFT
000014BA  5239 0000345C            194              ADD.B   #1,(GSTPOSMV)
000014C0  5244                     195              ADDQ.W  #1,D4
000014C2                           196  .GSTMULTLEFT
000014C2  4EB9 00001D3A            197              JSR     GSTCOLWALLLEFT
000014C8  BA7C 0001                198              CMP     #1,D5
000014CC  6700 000A                199              BEQ     .GSTMULTDOWN
000014D0  5439 0000345C            200              ADD.B   #2,(GSTPOSMV)
000014D6  5244                     201              ADDQ.W  #1,D4
000014D8                           202  .GSTMULTDOWN
000014D8  4EB9 00001D76            203              JSR     GSTCOLWALLDOWN
000014DE  BA7C 0001                204              CMP     #1,D5
000014E2  6700 000A                205              BEQ     .GSTMULTUP
000014E6  5839 0000345C            206              ADD.B   #4,(GSTPOSMV)
000014EC  5244                     207              ADDQ.W  #1,D4
000014EE                           208  .GSTMULTUP
000014EE  4EB9 00001DAC            209              JSR     GSTCOLWALLUP
000014F4  BA7C 0001                210              CMP     #1,D5
000014F8  6700 000A                211              BEQ     .GSTDECISSION
000014FC  5039 0000345C            212              ADD.B   #8,(GSTPOSMV)
00001502  5244                     213              ADDQ.W  #1,D4
00001504                           214  .GSTDECISSION
00001504  B87C 0002                215              CMP     #2,D4
00001508  6F00 006A                216              BLE     .GSTNOTMULT
0000150C  4EB9 0000203E            217              JSR     UTLRAND
00001512  C0BC 00000006            218              AND.L   #$00000006,D0
00001518  43F8 1000                219              LEA     GSTDECVEC,A1
0000151C  3231 0000                220              MOVE.W  (A1,D0),D1
00001520  B27C 0001                221              CMP     #1,D1
00001524  6700 0016                222              BEQ     .GSTRANRIGHT
00001528  B27C 0002                223              CMP     #2,D1
0000152C  6700 001C                224              BEQ     .GSTRANLEFT
00001530  B27C 0003                225              CMP     #3,D1
00001534  6700 0022                226              BEQ     .GSTRANDOWN
00001538  6000 002C                227              BRA     .GSTRANUP          
0000153C                           228  .GSTRANRIGHT
0000153C  0839 0000 0000345C       229              BTST.B  #0,(GSTPOSMV)
00001544  67BE                     230              BEQ     .GSTDECISSION
00001546  6000 0054                231              BRA     .GSTRIGHTMOVE
0000154A                           232  .GSTRANLEFT
0000154A  0839 0001 0000345C       233              BTST.B  #1,(GSTPOSMV)
00001552  67B0                     234              BEQ     .GSTDECISSION
00001554  6000 007A                235              BRA     .GSTLEFTMOVE
00001558                           236  .GSTRANDOWN
00001558  0839 0002 0000345C       237              BTST.B  #2,(GSTPOSMV)
00001560  67A2                     238              BEQ     .GSTDECISSION
00001562  6000 00A0                239              BRA     .GSTDOWNMOVE
00001566                           240  .GSTRANUP
00001566  0839 0003 0000345C       241              BTST.B  #3,(GSTPOSMV)
0000156E  6794                     242              BEQ     .GSTDECISSION
00001570  6000 00B6                243              BRA     .GSTUPMOVE
00001574                           244  .GSTNOTMULT 
00001574  5339 0000345D            245              SUB.B   #1,(GSTCHDIR)
0000157A  1839 00003459            246              MOVE.B  (GSTLAMO),D4           
00001580  B87C 0001                247              CMP     #1,D4
00001584  6700 0016                248              BEQ     .GSTRIGHTMOVE
00001588  B87C 0002                249              CMP     #2,D4
0000158C  6700 0042                250              BEQ     .GSTLEFTMOVE
00001590  B87C 0003                251              CMP     #3,D4
00001594  6700 006E                252              BEQ     .GSTDOWNMOVE
00001598  6000 008E                253              BRA     .GSTUPMOVE
0000159C                           254  
0000159C                           255              ;UPDATE COORDS
0000159C                           256              
0000159C                           257  .GSTRIGHTMOVE
0000159C  4EB9 00001CFE            258              JSR     GSTCOLWALLRIGHT
000015A2  BA7C 0001                259              CMP     #1,D5
000015A6  6600 0006                260              BNE     .GSTNOTCOLISION
000015AA  303C 0000                261              MOVE.W  #0,D0
000015AE                           262  .GSTNOTCOLISION
000015AE  BA7C 0004                263              CMP     #4,D5
000015B2  6600 000A                264              BNE     .GSTNOTTP
000015B6  0479 01E0 00003450       265              SUB.W   #30*16,(GSTPOSX)
000015BE                           266  .GSTNOTTP
000015BE  D179 00003450            267              ADD.W   D0,(GSTPOSX)
000015C4  13FC 0001 00003459       268              MOVE.B  #1,(GSTLAMO)
000015CC  6000 007E                269              BRA     .GSTDONE
000015D0                           270  .GSTLEFTMOVE
000015D0  4EB9 00001D3A            271              JSR     GSTCOLWALLLEFT
000015D6  BA7C 0001                272              CMP     #1,D5
000015DA  6600 0006                273              BNE     .GSTNOTCOLISION2
000015DE  303C 0000                274              MOVE.W  #0,D0
000015E2                           275  .GSTNOTCOLISION2
000015E2  BA7C 0004                276              CMP     #4,D5
000015E6  6600 000A                277              BNE     .GSTNOTTP2
000015EA  0679 01E0 00003450       278              ADD.W   #30*16,(GSTPOSX)
000015F2                           279  .GSTNOTTP2
000015F2  9179 00003450            280              SUB.W   D0,(GSTPOSX)
000015F8  13FC 0002 00003459       281              MOVE.B  #2,(GSTLAMO)
00001600  6000 004A                282              BRA     .GSTDONE
00001604                           283      
00001604                           284  .GSTDOWNMOVE
00001604  4EB9 00001D76            285              JSR     GSTCOLWALLDOWN
0000160A  BA7C 0001                286              CMP     #1,D5
0000160E  6600 0006                287              BNE     .GSTNOTCOLISION3
00001612  303C 0000                288              MOVE.W  #0,D0
00001616                           289  .GSTNOTCOLISION3
00001616  D179 00003452            290              ADD.W   D0,(GSTPOSY)
0000161C  13FC 0003 00003459       291              MOVE.B  #3,(GSTLAMO)
00001624  6000 0026                292              BRA     .GSTDONE
00001628                           293  .GSTUPMOVE    
00001628  4EB9 00001DAC            294              JSR     GSTCOLWALLUP
0000162E  BA7C 0001                295              CMP     #1,D5
00001632  6600 0006                296              BNE     .GSTNOTCOLISION4
00001636  303C 0000                297              MOVE.W  #0,D0
0000163A                           298  .GSTNOTCOLISION4
0000163A  9179 00003452            299              SUB.W   D0,(GSTPOSY)
00001640  13FC 0004 00003459       300              MOVE.B  #4,(GSTLAMO)
00001648  6000 0002                301              BRA     .GSTDONE
0000164C                           302  
0000164C                           303  .GSTDONE
0000164C  13C4 00003459            304              MOVE.B  D4,(GSTLAMO)
00001652                           305  
00001652  4CDF 003F                306              MOVEM.L (A7)+,D0-D5
00001656                           307              
00001656  4E75                     308              RTS
00001658                           309              
00001658                           310  ; ------------------------------------------------------------------------------
00001658                           311  GSTPLOT
00001658                           312  ; PLOT THE GHOST.
00001658                           313  ; INPUT    : NONE 
00001658                           314  ; OUTPUT   : NONE
00001658                           315  ; MODIFIES : NONE
00001658                           316  ; ------------------------------------------------------------------------------
00001658  48E7 F800                317              MOVEM.L D0-D4,-(A7)
0000165C                           318              
0000165C                           319              ;SET PEN COLOR
0000165C  303C 0050                320              MOVE.W  #80,D0
00001660  223C 000000FF            321              MOVE.L  #GSTCOL1,D1
00001666  4E4F                     322              TRAP    #15
00001668                           323              
00001668                           324              ;SET FILL COLOR
00001668  303C 0051                325              MOVE.W  #81,D0
0000166C  223C 00FFFFFF            326              MOVE.L  #GSTFCOL1,D1
00001672  4E4F                     327              TRAP    #15
00001674                           328              
00001674                           329              ;SET COORDS
00001674  3239 00003450            330              MOVE.W  (GSTPOSX),D1
0000167A  5141                     331              SUB.W   #GSTRAD,D1
0000167C  3439 00003452            332              MOVE.W  (GSTPOSY),D2
00001682  5142                     333              SUB.W   #GSTRAD,D2
00001684                           334              
00001684  3601                     335              MOVE.W  D1,D3
00001686  0643 0010                336              ADD.W   #GSTRAD*2,D3
0000168A  3802                     337              MOVE.W  D2,D4
0000168C  0644 0010                338              ADD.W   #GSTRAD*2,D4
00001690                           339              
00001690                           340              ;DRAW GHOST
00001690  303C 0058                341              MOVE.W  #88,D0
00001694  4E4F                     342              TRAP    #15
00001696                           343              
00001696                           344              ;SET RANGE COORDS
00001696  3239 00003450            345              MOVE.W  (GSTPOSX),D1
0000169C  0441 0100                346              SUB.W   #GSTRNG*16,D1
000016A0  3439 00003452            347              MOVE.W  (GSTPOSY),D2
000016A6  0442 0100                348              SUB.W   #GSTRNG*16,D2
000016AA                           349              
000016AA  3601                     350              MOVE.W  D1,D3
000016AC  0643 0200                351              ADD.W   #GSTRNG*16*2,D3
000016B0  3802                     352              MOVE.W  D2,D4
000016B2  0644 0200                353              ADD.W   #GSTRNG*16*2,D4
000016B6                           354              
000016B6                           355              ;DRAW GHOST RANGE
000016B6  303C 005B                356              MOVE.W  #91,D0
000016BA  4E4F                     357              TRAP    #15
000016BC                           358              
000016BC  4CDF 001F                359              MOVEM.L (A7)+,D0-D4
000016C0                           360              
000016C0                           361  
000016C0  4E75                     362              RTS
000016C2                           363  
000016C2                           364  
000016C2                           365  
000016C2                           366  
000016C2                           367  
000016C2                           368  
000016C2                           369  
000016C2                           370  -------------------- end include --------------------
000016C2                           371              INCLUDE "PAC-MAN.X68"
000016C2                           372  ; ==============================================================================
000016C2                           373  ; PAC-MAN MANAGEMENT
000016C2                           374  ; ==============================================================================
000016C2                           375              
000016C2                           376  ; ------------------------------------------------------------------------------
000016C2                           377  PMINIT
000016C2                           378  ; INITIALIZE PAC-MAN.
000016C2                           379  ; INPUT    : NONE 
000016C2                           380  ; OUTPUT   : NONE
000016C2                           381  ; MODIFIES : NONE
000016C2                           382  ; ------------------------------------------------------------------------------
000016C2                           383  
000016C2  33FC 0140 00003446       384              MOVE.W  #SCRWIDTH/2,(PMPOSX)
000016CA  33FC 0140 00003448       385              MOVE.W  #SCRHEIGH/2,(PMPOSY)
000016D2  5079 00003446            386              ADDQ.W  #8,(PMPOSX)
000016D8  5079 00003448            387              ADDQ.W  #8,(PMPOSY)
000016DE  33FC 0002 0000344A       388              MOVE.W  #PMSPEED,(PMVELX)
000016E6  33FC 0002 0000344C       389              MOVE.W  #PMSPEED,(PMVELY)
000016EE  4239 0000344F            390              CLR.B   (PMLAMO)
000016F4                           391  
000016F4  4E75                     392              RTS
000016F6                           393              
000016F6                           394  ; ------------------------------------------------------------------------------
000016F6                           395  PMUPD
000016F6                           396  ; UPDATES THE PAC-MAN.
000016F6                           397  ; INPUT    : NONE 
000016F6                           398  ; OUTPUT   : NONE
000016F6                           399  ; MODIFIES : NONE
000016F6                           400  ; ------------------------------------------------------------------------------
000016F6                           401              
000016F6  48E7 FE00                402              MOVEM.L D0-D6,-(A7)
000016FA                           403              
000016FA  303C 0002                404              MOVE.W  #PMSPEED,D0
000016FE                           405              
000016FE                           406              
000016FE  3439 00003446            407              MOVE.W  (PMPOSX),D2
00001704  3639 00003448            408              MOVE.W  (PMPOSY),D3
0000170A                           409              
0000170A  5042                     410              ADDQ.W  #8,D2              
0000170C  5043                     411              ADDQ.W  #8,D3  
0000170E                           412              
0000170E  1839 0000344F            413              MOVE.B  (PMLAMO),D4
00001714                           414              
00001714                           415              ;MASK OF THE LAST NIBBLE        
00001714  C47C 000F                416              AND.W   #$000F,D2               ; COORDENADA X
00001718  C67C 000F                417              AND.W   #$000F,D3               ; COORDENADA Y
0000171C                           418              
0000171C                           419              ;CHECK IF COORDS ARE MULTIPLES OF 16
0000171C  B47C 0000                420              CMP     #$0000,D2
00001720  6600 0116                421              BNE     .NOTMULT
00001724  B67C 0000                422              CMP     #$0000,D3
00001728  6600 010E                423              BNE     .NOTMULT
0000172C                           424              
0000172C                           425              ;BRA     .ACTYUP
0000172C                           426  
0000172C                           427              ;CHECK THE DIRECTION
0000172C  0839 0000 000025B4       428              BTST.B  #0,(KBDVAL)             ;CHECK LEFT
00001734  6700 000C                429              BEQ     .NOTLEFT
00001738  4204                     430              CLR.B   D4
0000173A  183C 0000                431              MOVE.B  #0,D4
0000173E  6000 007C                432              BRA     .ACTXLEFT
00001742                           433  .NOTLEFT            
00001742  0839 0002 000025B4       434              BTST.B   #2,(KBDVAL)             ;CHECK RIGHT
0000174A  6700 000C                435              BEQ     .NOTRIGHT
0000174E  4204                     436              CLR.B   D4
00001750  183C 0001                437              MOVE.B   #1,D4
00001754  6000 0032                438              BRA     .ACTXRIGHT
00001758                           439  .NOTRIGHT            
00001758  0839 0001 000025B4       440              BTST.B   #1,(KBDVAL)             ;CHECK UP
00001760  6700 000C                441              BEQ     .NOTUP
00001764  4204                     442              CLR.B   D4
00001766  183C 0002                443              MOVE.B  #2,D4
0000176A  6000 00A8                444              BRA     .ACTYUP
0000176E                           445  .NOTUP            
0000176E  0839 0003 000025B4       446              BTST.B   #3,(KBDVAL)             ;CHECK DOWN
00001776  6700 000C                447              BEQ     .NOTDOWN
0000177A  4204                     448              CLR.B   D4
0000177C  183C 0003                449              MOVE.B   #3,D4
00001780  6000 006E                450              BRA     .ACTYDOWN
00001784                           451  .NOTDOWN
00001784  6000 00CA                452              BRA     .DONE
00001788                           453              
00001788                           454              
00001788                           455              ;UPDATE COORDS
00001788                           456              
00001788                           457  .ACTXRIGHT  
00001788  4EB9 00001C00            458              JSR     COLWALLRIGHT
0000178E  BA7C 0001                459              CMP     #1,D5
00001792  6600 000E                460              BNE     .NOTCOLISION
00001796  13FC 0000 000025B4       461              MOVE.B  #0,(KBDVAL)
0000179E  303C 0000                462              MOVE.W  #0,D0
000017A2                           463  .NOTCOLISION
000017A2  BA7C 0004                464              CMP     #4,D5
000017A6  6600 000A                465              BNE     .NOTTP
000017AA  0479 01E0 00003446       466              SUB.W   #30*16,(PMPOSX)
000017B2                           467  .NOTTP
000017B2  D179 00003446            468              ADD.W   D0,(PMPOSX)
000017B8  6000 0096                469              BRA     .DONE
000017BC                           470  .ACTXLEFT
000017BC  4EB9 00001C42            471              JSR     COLWALLLEFT
000017C2  BA7C 0001                472              CMP     #1,D5
000017C6  6600 000E                473              BNE     .NOTCOLISION2
000017CA  13FC 0000 000025B4       474              MOVE.B  #0,(KBDVAL)
000017D2  303C 0000                475              MOVE.W  #0,D0
000017D6                           476  .NOTCOLISION2
000017D6  BA7C 0004                477              CMP     #4,D5
000017DA  6600 000A                478              BNE     .NOTTP2
000017DE  0679 01E0 00003446       479              ADD.W   #30*16,(PMPOSX)
000017E6                           480  .NOTTP2
000017E6  9179 00003446            481              SUB.W   D0,(PMPOSX)
000017EC  6000 0062                482              BRA     .DONE
000017F0                           483      
000017F0                           484  .ACTYDOWN
000017F0  4EB9 00001C84            485              JSR     COLWALLDOWN
000017F6  BA7C 0001                486              CMP     #1,D5
000017FA  6600 000E                487              BNE     .NOTCOLISION3
000017FE  13FC 0000 000025B4       488              MOVE.B  #0,(KBDVAL)
00001806  303C 0000                489              MOVE.W  #0,D0
0000180A                           490  .NOTCOLISION3
0000180A  D179 00003448            491              ADD.W   D0,(PMPOSY)
00001810  6000 003E                492              BRA     .DONE
00001814                           493  .ACTYUP     
00001814  4EB9 00001CC0            494              JSR     COLWALLUP
0000181A  BA7C 0001                495              CMP     #1,D5
0000181E  6600 000E                496              BNE     .NOTCOLISION4
00001822  13FC 0000 000025B4       497              MOVE.B  #0,(KBDVAL)
0000182A  303C 0000                498              MOVE.W  #0,D0
0000182E                           499  .NOTCOLISION4
0000182E  9179 00003448            500              SUB.W   D0,(PMPOSY)
00001834  6000 001A                501              BRA     .DONE
00001838                           502              
00001838                           503              
00001838                           504              ;IF NOT MULT DO
00001838                           505  .NOTMULT     
00001838  B83C 0000                506              CMP.B     #0,D4
0000183C  6700 FF7E                507              BEQ     .ACTXLEFT
00001840  B83C 0001                508              CMP.B     #1,D4
00001844  6700 FF42                509              BEQ     .ACTXRIGHT
00001848  B83C 0002                510              CMP.B     #2,D4
0000184C  67C6                     511              BEQ     .ACTYUP
0000184E  60A0                     512              BRA     .ACTYDOWN
00001850                           513  .DONE
00001850                           514              ;RESTORE
00001850  4EB9 00001DE4            515              JSR     GETPOINTS
00001856  13C4 0000344F            516              MOVE.B  D4,(PMLAMO)
0000185C                           517              
0000185C  4CDF 007F                518              MOVEM.L (A7)+,D0-D6
00001860                           519              
00001860  4E75                     520              RTS
00001862                           521                          
00001862                           522  ; ------------------------------------------------------------------------------
00001862                           523  PMPLOT
00001862                           524  ; PLOT THE BALL.
00001862                           525  ; INPUT    : NONE 
00001862                           526  ; OUTPUT   : NONE
00001862                           527  ; MODIFIES : NONE
00001862                           528  ; ------------------------------------------------------------------------------
00001862                           529  
00001862  48E7 FC00                530              MOVEM.L D0-D5,-(A7)
00001866                           531  
00001866                           532              ;SET PEN COLOR
00001866  303C 0050                533              MOVE.W  #80,D0
0000186A  7200                     534              MOVE.L  #$0000,D1
0000186C  4E4F                     535              TRAP    #15
0000186E                           536              
0000186E                           537              ;SET FILL COLOR
0000186E  303C 0051                538              MOVE.W  #81,D0
00001872  223C 0000FFFF            539              MOVE.L  #PMFCOL,D1
00001878  4E4F                     540              TRAP    #15
0000187A                           541              
0000187A  0839 0003 000025B7       542              BTST.B  #3,(SCRCYCCT)
00001882  6700 000C                543              BEQ     .MOUTHOPEN
00001886                           544              
00001886                           545              ;DRAW QUIET
00001886  4EB9 00001924            546              JSR     .FULLDRAW
0000188C  6000 0090                547              BRA     .DDONE
00001890                           548              
00001890                           549  .MOUTHOPEN     
00001890  4EB9 00001924            550              JSR     .FULLDRAW       
00001896  1A39 000025B4            551              MOVE.B  (KBDVAL),D5
0000189C  CA3C 000F                552              AND.B   #$0F,D5
000018A0                           553   
000018A0                           554              ;CHECK KBDVAL
000018A0  BA3C 0000                555              CMP.B   #$0,D5
000018A4  6700 0022                556              BEQ     .NOTMOVE
000018A8  BA3C 0001                557              CMP.B  #$1,D5             ;LEFT
000018AC  6700 0038                558              BEQ     .DLEFT
000018B0  BA3C 0002                559              CMP.B  #$2,D5             ;UP
000018B4  6700 0026                560              BEQ     .DUP
000018B8  BA3C 0004                561              CMP.B  #$4,D5             ;RIGHT
000018BC  6700 0014                562              BEQ     .DRIGHT
000018C0  BA3C 0008                563              CMP.B  #$8,D5             ;DOWN
000018C4  6700 002A                564              BEQ     .DDOWN
000018C8                           565              
000018C8                           566              ;DRAW MOVEMENT
000018C8  4EB9 00001924            567  .NOTMOVE    JSR     .FULLDRAW
000018CE  6000 004E                568              BRA     .DDONE
000018D2                           569  .DRIGHT
000018D2  4EB9 0000197A            570              JSR     .RIGHTDRAW
000018D8  6000 0034                571              BRA     .DRAW_MOUTH3
000018DC                           572  .DUP
000018DC  4EB9 000019AC            573              JSR     .UPDRAW
000018E2  6000 0020                574              BRA     .DRAW_MOUTH2
000018E6                           575  
000018E6                           576  .DLEFT
000018E6  4EB9 00001948            577              JSR     .LEFTDRAW
000018EC  6000 000C                578              BRA     .DRAW_MOUTH1
000018F0                           579  
000018F0                           580  .DDOWN
000018F0  4EB9 000019DE            581              JSR     .DOWNDRAW
000018F6  6000 0020                582              BRA     .DRAW_MOUTH4
000018FA                           583              
000018FA                           584  .DRAW_MOUTH1            
000018FA  4EB9 00001A10            585              JSR     .SET_MOUTHLEFT
00001900  6000 001C                586              BRA     .DDONE
00001904                           587  .DRAW_MOUTH2            
00001904  4EB9 00001A4C            588              JSR     .SET_MOUTHUP
0000190A  6000 0012                589              BRA     .DDONE
0000190E                           590  .DRAW_MOUTH3            
0000190E  4EB9 00001A2E            591              JSR     .SET_MOUTHRIGHT
00001914  6000 0008                592              BRA     .DDONE
00001918                           593  .DRAW_MOUTH4            
00001918  4EB9 00001A6A            594              JSR     .SET_MOUTHDOWN
0000191E                           595  .DDONE
0000191E  4CDF 003F                596              MOVEM.L (A7)+,D0-D5
00001922                           597              
00001922  4E75                     598              RTS
00001924                           599  
00001924                           600  
00001924                           601  ;INTERNAL SUBRUTINES FOR PACMAN PLOT-------------------------------------------------------------
00001924                           602  
00001924                           603  .FULLDRAW
00001924                           604              ;SET COORDS
00001924  3239 00003446            605              MOVE.W  (PMPOSX),D1
0000192A  5141                     606              SUB.W   #PMRAD,D1
0000192C  3439 00003448            607              MOVE.W  (PMPOSY),D2
00001932  5142                     608              SUB.W   #PMRAD,D2
00001934                           609              
00001934  3601                     610              MOVE.W  D1,D3
00001936  0643 0010                611              ADD.W   #PMRAD*2,D3
0000193A  3802                     612              MOVE.W  D2,D4
0000193C  0644 0010                613              ADD.W   #PMRAD*2,D4
00001940                           614              
00001940                           615              ;DRAW PAC-MAN
00001940  303C 0058                616              MOVE.W  #88,D0
00001944  4E4F                     617              TRAP    #15
00001946                           618              
00001946  4E75                     619              RTS
00001948                           620  .LEFTDRAW
00001948                           621              
00001948                           622              
00001948  303C 0054                623              MOVE.W  #84,D0
0000194C  3239 00003446            624              MOVE.W  (PMPOSX),D1                   ;FINAL COORD OF THE FIRST LINE
00001952  5141                     625              SUB.W   #PMRAD,D1
00001954  3439 00003448            626              MOVE.W  (PMPOSY),D2
0000195A  5142                     627              SUB.W   #PMRAD,D2
0000195C                           628              
0000195C  3639 00003446            629              MOVE.W  (PMPOSX),D3                   ;ORIGINAL COORD FIRST LINE
00001962  3839 00003448            630              MOVE.W  (PMPOSY),D4
00001968                           631              
00001968  4E4F                     632              TRAP    #15
0000196A                           633             
0000196A  303C 0055                634              MOVE.W  #85,D0                        ;DRAW SECOND LINE
0000196E                           635              
0000196E  3203                     636              MOVE.W  D3,D1
00001970  3404                     637              MOVE.W  D4,D2
00001972  5042                     638              ADD.W   #PMRAD,D2
00001974  5141                     639              SUB.W   #PMRAD,D1
00001976                           640              
00001976  4E4F                     641              TRAP    #15
00001978                           642              
00001978                           643              
00001978  4E75                     644              RTS
0000197A                           645              
0000197A                           646  .RIGHTDRAW
0000197A                           647              
0000197A                           648              
0000197A  303C 0054                649              MOVE.W  #84,D0
0000197E  3239 00003446            650              MOVE.W  (PMPOSX),D1                   ;FINAL COORD OF THE FIRST LINE
00001984  5041                     651              ADD.W   #PMRAD,D1
00001986  3439 00003448            652              MOVE.W  (PMPOSY),D2
0000198C  5042                     653              ADD.W   #PMRAD,D2
0000198E                           654              
0000198E  3639 00003446            655              MOVE.W  (PMPOSX),D3                   ;ORIGINAL COORD FIRST LINE
00001994  3839 00003448            656              MOVE.W  (PMPOSY),D4
0000199A                           657              
0000199A  4E4F                     658              TRAP    #15
0000199C                           659             
0000199C  303C 0055                660              MOVE.W  #85,D0                        ;DRAW SECOND LINE
000019A0                           661              
000019A0  3203                     662              MOVE.W  D3,D1
000019A2  3404                     663              MOVE.W  D4,D2
000019A4  5142                     664              SUB.W   #PMRAD,D2
000019A6  5041                     665              ADD.W   #PMRAD,D1
000019A8                           666              
000019A8  4E4F                     667              TRAP    #15
000019AA                           668              
000019AA                           669              
000019AA  4E75                     670              RTS
000019AC                           671  .UPDRAW
000019AC                           672              
000019AC                           673              
000019AC  303C 0054                674              MOVE.W  #84,D0
000019B0  3239 00003446            675              MOVE.W  (PMPOSX),D1                   ;FINAL COORD OF THE FIRST LINE
000019B6  5141                     676              SUB.W   #PMRAD,D1
000019B8  3439 00003448            677              MOVE.W  (PMPOSY),D2
000019BE  5142                     678              SUB.W   #PMRAD,D2
000019C0                           679              
000019C0  3639 00003446            680              MOVE.W  (PMPOSX),D3                   ;ORIGINAL COORD FIRST LINE
000019C6  3839 00003448            681              MOVE.W  (PMPOSY),D4
000019CC                           682              
000019CC  4E4F                     683              TRAP    #15
000019CE                           684             
000019CE  303C 0055                685              MOVE.W  #85,D0                        ;DRAW SECOND LINE
000019D2                           686              
000019D2  3203                     687              MOVE.W  D3,D1
000019D4  3404                     688              MOVE.W  D4,D2
000019D6  5142                     689              SUB.W   #PMRAD,D2
000019D8  5041                     690              ADD.W   #PMRAD,D1
000019DA                           691              
000019DA  4E4F                     692              TRAP    #15
000019DC                           693              
000019DC                           694              
000019DC  4E75                     695              RTS
000019DE                           696              
000019DE                           697  .DOWNDRAW
000019DE                           698              
000019DE                           699              
000019DE  303C 0054                700              MOVE.W  #84,D0
000019E2  3239 00003446            701              MOVE.W  (PMPOSX),D1                   ;FINAL COORD OF THE FIRST LINE
000019E8  5141                     702              SUB.W   #PMRAD,D1
000019EA  3439 00003448            703              MOVE.W  (PMPOSY),D2
000019F0  5042                     704              ADD.W   #PMRAD,D2
000019F2                           705              
000019F2  3639 00003446            706              MOVE.W  (PMPOSX),D3                   ;ORIGINAL COORD FIRST LINE
000019F8  3839 00003448            707              MOVE.W  (PMPOSY),D4
000019FE                           708              
000019FE  4E4F                     709              TRAP    #15
00001A00                           710             
00001A00  303C 0055                711              MOVE.W  #85,D0                        ;DRAW SECOND LINE
00001A04                           712              
00001A04  3203                     713              MOVE.W  D3,D1
00001A06  3404                     714              MOVE.W  D4,D2
00001A08  5042                     715              ADD.W   #PMRAD,D2
00001A0A  5041                     716              ADD.W   #PMRAD,D1
00001A0C                           717              
00001A0C  4E4F                     718              TRAP    #15
00001A0E                           719              
00001A0E                           720              
00001A0E  4E75                     721              RTS
00001A10                           722  
00001A10                           723              
00001A10                           724  .SET_MOUTHLEFT
00001A10                           725              
00001A10  303C 0051                726              MOVE.W  #81,D0                         ;SET BLACK
00001A14  7200                     727              MOVE.L  #$0000,D1
00001A16  4E4F                     728              TRAP    #15
00001A18                           729              
00001A18  303C 0059                730              MOVE.W  #89,D0                         ;FILL
00001A1C  3239 00003446            731              MOVE.W  (PMPOSX),D1
00001A22  5541                     732              SUBQ.W   #2,D1
00001A24  3439 00003448            733              MOVE.W  (PMPOSY),D2
00001A2A  4E4F                     734              TRAP    #15
00001A2C                           735  
00001A2C  4E75                     736              RTS
00001A2E                           737              
00001A2E                           738  .SET_MOUTHRIGHT
00001A2E                           739              
00001A2E  303C 0051                740              MOVE.W  #81,D0                         ;SET BLACK
00001A32  7200                     741              MOVE.L  #$0000,D1
00001A34  4E4F                     742              TRAP    #15
00001A36                           743              
00001A36  303C 0059                744              MOVE.W  #89,D0                         ;FILL
00001A3A  3239 00003446            745              MOVE.W  (PMPOSX),D1
00001A40  5441                     746              ADDQ.W   #2,D1
00001A42  3439 00003448            747              MOVE.W  (PMPOSY),D2
00001A48  4E4F                     748              TRAP    #15
00001A4A                           749  
00001A4A  4E75                     750              RTS
00001A4C                           751  
00001A4C                           752  .SET_MOUTHUP
00001A4C                           753              
00001A4C  303C 0051                754              MOVE.W  #81,D0                         ;SET BLACK
00001A50  7200                     755              MOVE.L  #$0000,D1
00001A52  4E4F                     756              TRAP    #15
00001A54                           757              
00001A54  303C 0059                758              MOVE.W  #89,D0                         ;FILL
00001A58  3239 00003446            759              MOVE.W  (PMPOSX),D1
00001A5E  3439 00003448            760              MOVE.W  (PMPOSY),D2
00001A64  5542                     761              SUBQ.W   #2,D2
00001A66  4E4F                     762              TRAP    #15
00001A68                           763  
00001A68  4E75                     764              RTS
00001A6A                           765  
00001A6A                           766  .SET_MOUTHDOWN
00001A6A                           767              
00001A6A  303C 0051                768              MOVE.W  #81,D0                         ;SET BLACK
00001A6E  7200                     769              MOVE.L  #$0000,D1
00001A70  4E4F                     770              TRAP    #15
00001A72                           771              
00001A72  303C 0059                772              MOVE.W  #89,D0                         ;FILL
00001A76  3239 00003446            773              MOVE.W  (PMPOSX),D1
00001A7C  3439 00003448            774              MOVE.W  (PMPOSY),D2
00001A82  5442                     775              ADDQ.W   #2,D2
00001A84  4E4F                     776              TRAP    #15
00001A86                           777  
00001A86  4E75                     778              RTS
00001A88                           779  
00001A88                           780  
00001A88                           781  
00001A88                           782  
00001A88                           783  
00001A88                           784  
00001A88                           785  
00001A88                           786  
00001A88                           787  
00001A88                           788  
00001A88                           789  
00001A88                           790  
00001A88                           791  
00001A88                           792  
00001A88                           793  
00001A88                           794  
00001A88                           795  
00001A88                           796  
00001A88                           797  
00001A88                           798  
00001A88                           799  
00001A88                           800  
00001A88                           801  
00001A88                           802  
00001A88                           803  
00001A88                           804  
00001A88                           805  
00001A88                           806  -------------------- end include --------------------
00001A88                           807              INCLUDE "SCORE.X68"
00001A88                           808  ; ==============================================================================
00001A88                           809  ; SCOREBOARD MANAGEMENT
00001A88                           810  ; ==============================================================================
00001A88                           811              
00001A88                           812  ; ------------------------------------------------------------------------------
00001A88                           813  SCOINIT
00001A88                           814  ; INITIALIZE SCOREBOARD
00001A88                           815  ; INPUT    : NONE 
00001A88                           816  ; OUTPUT   : NONE
00001A88                           817  ; MODIFIES : NONE
00001A88                           818  ; ------------------------------------------------------------------------------
00001A88  4279 00003460            819              CLR.W   (SCOPOINTS)
00001A8E  33FC 0003 0000345E       820              MOVE.W  #3,(SCOLIFE)
00001A96  4E75                     821              RTS
00001A98                           822              
00001A98                           823  ; ------------------------------------------------------------------------------
00001A98                           824  SCOPLOT
00001A98                           825  ; PLOT THE SCOREBOARD
00001A98                           826  ; INPUT    : NONE 
00001A98                           827  ; OUTPUT   : NONE
00001A98                           828  ; MODIFIES : NONE
00001A98                           829  ; ------------------------------------------------------------------------------
00001A98                           830              
00001A98  48E7 C040                831               MOVEM.L D0-D1/A1,-(A7)
00001A9C                           832  
00001A9C                           833              ; SET BACKGROUND COLOR
00001A9C  103C 0051                834              MOVE.B  #81,D0
00001AA0  7200                     835              MOVE.L  #SCOFCOL,D1
00001AA2  4E4F                     836              TRAP    #15
00001AA4                           837              
00001AA4                           838              ; SET FIRST LINE POSITION
00001AA4  103C 000B                839              MOVE.B  #11,D0
00001AA8  323C 0101                840              MOVE.W  #SCOLINE1,D1
00001AAC  4E4F                     841              TRAP    #15
00001AAE                           842  
00001AAE                           843              ; PRINT FIRST LINE
00001AAE  43F9 00001AE6            844              LEA     .TXT1,A1            ;PUT FIRST STRING IN A1
00001AB4  4281                     845              CLR.L   D1
00001AB6  3239 00003460            846              MOVE.W  (SCOPOINTS),D1
00001ABC  103C 0011                847              MOVE.B  #17,D0
00001AC0  4E4F                     848              TRAP    #15
00001AC2                           849  
00001AC2                           850              ; SET SECOND LINE POSITION
00001AC2  103C 000B                851              MOVE.B  #11,D0
00001AC6  323C 0102                852              MOVE.W  #SCOLINE2,D1       
00001ACA  4E4F                     853              TRAP    #15
00001ACC                           854  
00001ACC                           855              ; PRINT SECOND LINE
00001ACC  43F9 00001AEF            856              LEA     .TXT2,A1
00001AD2  4281                     857              CLR.L   D1
00001AD4  3239 0000345E            858              MOVE.W  (SCOLIFE),D1
00001ADA  103C 0011                859              MOVE.B  #17,D0
00001ADE  4E4F                     860              TRAP    #15
00001AE0                           861              
00001AE0  4CDF 0203                862              MOVEM.L (A7)+,D0-D1/A1
00001AE4                           863              
00001AE4  4E75                     864              RTS
00001AE6                           865  
00001AE6= 50 4F 49 4E 54 53 ...    866  .TXT1       DC.B    'POINTS :',0      ;0 IS END OF STRING
00001AEF= 4C 49 46 45 53 20 ...    867  .TXT2       DC.B    'LIFES  :',0
00001AF8                           868  
00001AF8                           869  
00001AF8  4E75                     870              RTS
00001AFA                           871  
00001AFA                           872  
00001AFA                           873  -------------------- end include --------------------
00001AFA                           874              INCLUDE "SYSCONST.X68"
00001AFA                           875  ; ==============================================================================
00001AFA                           876  ; SYSTEM CONSTANTS
00001AFA                           877  ; ==============================================================================
00001AFA                           878  
00001AFA                           879  ; --- SCREEN RELATED CONSTANTS -------------------------------------------------
00001AFA                           880  
00001AFA  =00000280                881  SCRWIDTH    EQU     640                     ; SCREEN WIDTH
00001AFA  =00000280                882  SCRHEIGH    EQU     640                     ; SCREEN HEIGHT
00001AFA                           883  
00001AFA                           884  ;--- TITLE RELATED CONSTANTS ---------------------------------------------------
00001AFA= 74 69 74 6C 65 2E ...    885  FILENAME    DC.B    'title.txt',0
00001B04  =00000A8C                886  FILESIZE    EQU     2700
00001B04                           887              DS.B    0                       
00001B04                           888  ;---KEYCODES--------------------------------------------------------------------
00001B04                           889  
00001B04  =00000025                890  KBDLEFT     EQU     $25
00001B04  =00000026                891  KBDUP       EQU     $26
00001B04  =00000027                892  KBDRIGHT    EQU     $27
00001B04  =00000028                893  KBDDOWN     EQU     $28
00001B04  =00000020                894  KBDFIRE1    EQU     ' '
00001B04  =0000004D                895  KBDFIRE2    EQU     'M'                         
00001B04  =00000010                896  KBDFIRE3    EQU     $10
00001B04  =00000050                897  KBDPAUSE    EQU     'P'
00001B04                           898  
00001B04                           899  
00001B04                           900  
00001B04                           901  
00001B04                           902  
00001B04                           903  
00001B04                           904  
00001B04                           905  
00001B04                           906  
00001B04                           907  
00001B04                           908  -------------------- end include --------------------
00001B04                           909              INCLUDE "SYSTEM.X68"
00001B04                           910  ; ==============================================================================
00001B04                           911  ; SYSTEM
00001B04                           912  ; ==============================================================================
00001B04                           913              
00001B04                           914  ; ------------------------------------------------------------------------------
00001B04                           915  SYSINIT
00001B04                           916  ; INITIALIZE SYSTEM.
00001B04                           917  ; INPUT    : NONE
00001B04                           918  ; OUTPUT   : NONE
00001B04                           919  ; MODIFIES : NONE
00001B04                           920  ; ------------------------------------------------------------------------------
00001B04                           921              
00001B04  21FC 00001B74 0080       922              MOVE.L  #SCRUPD,($80+0*4)          ;INSTALL SUBRUTINE TO TRAP #0
00001B0C  21FC 00001BAA 0084       923              MOVE.L  #KBDUPD,($80+1*4)          ;INSTALL SUBRUTINE TO TRAP #1
00001B14                           924              
00001B14                           925              
00001B14  21FC 00001B8E 0064       926              MOVE.L  #SCRTIM,($60+1*4)          ;INSTALL INTERRUPT #1
00001B1C                           927              
00001B1C  4EB9 00001B30            928              JSR     SCRINIT
00001B22  4EB9 00001B9C            929              JSR     KBDINIT
00001B28                           930              
00001B28                           931              
00001B28  40E7                     932              MOVE.W  SR,-(A7)
00001B2A  0257 D8FF                933              ANDI.W  #$D8FF,(A7)                ;BIT SUPERVISOR TO O AND INTERRPUT MASK 000 (FOR REACTIVATE INTERRUPTIONS)             
00001B2E  4E73                     934              RTE
00001B30                           935     
00001B30                           936  ; ------------------------------------------------------------------------------
00001B30                           937  SCRINIT
00001B30                           938  ; INIT SCREEN. SET SCREEN RESOLUTION, SET WINDOWED MODE, CLEAR SCREEN, ENABLE BUFFER
00001B30                           939  ; ENABLE TIMED INTERRUPTION
00001B30                           940  ; INPUT    : NONE
00001B30                           941  ; OUTPUT   : NONE
00001B30                           942  ; MODIFIES : NONE
00001B30                           943  ; ------------------------------------------------------------------------------
00001B30                           944  
00001B30  48E7 C000                945              MOVEM.L D0-D1,-(A7)                 ;SAFE REGISTERS IN STACK
00001B34                           946  
00001B34                           947              ; SET SCREEN RESOLUTION
00001B34  103C 0021                948              MOVE.B  #33,D0
00001B38  223C 02800280            949              MOVE.L  #SCRWIDTH<<16|SCRHEIGH,D1
00001B3E  4E4F                     950              TRAP    #15
00001B40                           951              
00001B40                           952              ; SET WINDOWED MODE
00001B40  7201                     953              MOVE.L  #1,D1
00001B42  4E4F                     954              TRAP    #15
00001B44                           955              
00001B44                           956              ; ENABLE DOUBLE BUFFER
00001B44  103C 005C                957              MOVE.B  #92,D0
00001B48  123C 0011                958              MOVE.B  #17,D1
00001B4C  4E4F                     959              TRAP    #15
00001B4E                           960              
00001B4E                           961              ; CLEAR SCREEN
00001B4E  103C 000B                962              MOVE.B  #11,D0
00001B52  323C FF00                963              MOVE.W  #$FF00,D1
00001B56  4E4F                     964              TRAP    #15
00001B58                           965              
00001B58                           966              ;ENABLE TIMED INTERRPUT
00001B58  303C 0020                967              MOVE.W  #32,D0
00001B5C  123C 0006                968              MOVE.B  #6,D1
00001B60  143C 0081                969              MOVE.B  #$81,D2                   ;INDICATE THAT INTERRUPT 1 IS ACTIVATED PERIODICALLY
00001B64  7614                     970              MOVE.L  #20,D3                    ;INDICATE THE MILISECONDS FOR THAT PERIOD (20 ms == 50 FPS)
00001B66  4E4F                     971              TRAP    #15
00001B68                           972              
00001B68                           973              ;CLEAR INTERRUPT COUNTER
00001B68  4239 000025B6            974              CLR.B   (SCRINTCT)
00001B6E                           975              
00001B6E  4CDF 0003                976              MOVEM.L (A7)+,D0-D1               ;RESTORE REGISTERS FROM STACK
00001B72                           977              
00001B72  4E75                     978              RTS
00001B74                           979  
00001B74                           980  
00001B74                           981              
00001B74                           982  ;------------------------------------------------------------------------------            
00001B74                           983  SCRUPD
00001B74                           984  ; UPDATES DOUBLE BUFFER
00001B74                           985  ; INPUT    : NONE
00001B74                           986  ; OUTPUT   : NONE
00001B74                           987  ; MODIFIES : NONE
00001B74                           988  ; ------------------------------------------------------------------------------
00001B74                           989  
00001B74  48E7 C000                990              MOVEM.L D0-D1,-(A7)
00001B78                           991              
00001B78                           992              ;SWITCH BUFFERS
00001B78  103C 005E                993              MOVE.B #94,D0
00001B7C  4E4F                     994              TRAP #15
00001B7E                           995              
00001B7E                           996              ;CLEAR HIDDEN BUFFER
00001B7E  103C 000B                997              MOVE.B  #11,D0
00001B82  323C FF00                998              MOVE.W  #$FF00,D1
00001B86  4E4F                     999              TRAP    #15
00001B88                          1000              
00001B88  4CDF 0003               1001              MOVEM.L (A7)+,D0-D1
00001B8C                          1002              
00001B8C  4E73                    1003              RTE
00001B8E                          1004              
00001B8E                          1005  ; ------------------------------------------------------------------------------
00001B8E                          1006  SCRTIM
00001B8E                          1007  ; TIMED INTERRUPT SERVICE ROUTINE
00001B8E                          1008  ; INPUT    : NONE
00001B8E                          1009  ; OUTPUT   : NONE
00001B8E                          1010  ; MODIFIES : NONE
00001B8E                          1011  ; ------------------------------------------------------------------------------
00001B8E  5239 000025B6           1012              ADDQ.B  #1,(SCRINTCT)
00001B94  5239 000025B7           1013              ADDQ.B  #1,(SCRCYCCT)
00001B9A  4E73                    1014              RTE
00001B9C                          1015              
00001B9C                          1016  ;------------------------------------------------------------------------------            
00001B9C                          1017  KBDINIT
00001B9C                          1018  ; INIT THE KEYBOARD
00001B9C                          1019  ; INPUT    : NONE
00001B9C                          1020  ; OUTPUT   : NONE
00001B9C                          1021  ; MODIFIES : NONE
00001B9C                          1022  ; ------------------------------------------------------------------------------
00001B9C                          1023  
00001B9C  4239 000025B4           1024              CLR.B   (KBDVAL)
00001BA2  4239 000025B5           1025              CLR.B   (KBDEDGE)
00001BA8                          1026  
00001BA8  4E75                    1027              RTS
00001BAA                          1028  
00001BAA                          1029  ;------------------------------------------------------------------------------            
00001BAA                          1030  KBDUPD
00001BAA                          1031  ; UPDATES KEYBOARD INFO
00001BAA                          1032  ; 3 -> DOWN     (HEX: 8)
00001BAA                          1033  ; 2 -> RIGHT    (HEX: 4)
00001BAA                          1034  ; 1 -> UP       (HEX: 2)
00001BAA                          1035  ; 0 -> LEFT     (HEX: 1)
00001BAA                          1036  ; ------------------------------------------------------------------------------
00001BAA                          1037              
00001BAA  48E7 F800               1038              MOVEM.L D0-D4,-(A7)
00001BAE                          1039              
00001BAE                          1040              ; READ FIRST PART
00001BAE  103C 0013               1041              MOVE.B  #19,D0
00001BB2  223C 50104D20           1042              MOVE.L  #KBDPAUSE<<24|KBDFIRE3<<16|KBDFIRE2<<8|KBDFIRE1,D1
00001BB8  4E4F                    1043              TRAP    #15
00001BBA                          1044  
00001BBA                          1045              ; CONVERT TO DESIRED FORMAT
00001BBA  4EB9 00001BF2           1046              JSR     .CONVERT
00001BC0                          1047  
00001BC0                          1048              ; READ SECOND PART
00001BC0  223C 28272625           1049              MOVE.L  #KBDDOWN<<24|KBDRIGHT<<16|KBDUP<<8|KBDLEFT,D1
00001BC6  4E4F                    1050              TRAP    #15
00001BC8                          1051              
00001BC8                          1052              ;CONVERT TO DESIRED FORMAT
00001BC8  4EB9 00001BF2           1053              JSR .CONVERT
00001BCE                          1054  
00001BCE                          1055              ;GET KBDEDGE (IF SOME KEY HAVE CHANGED THE VALUE)
00001BCE  1039 000025B4           1056              MOVE.B  (KBDVAL),D0             ;D0 -> LAST KBDVAL
00001BD4  4600                    1057              NOT.B   D0                      ;D2 -> ACTUAL KBDVAL
00001BD6  C002                    1058              AND.B   D2,D0
00001BD8  13C0 000025B5           1059              MOVE.B  D0,(KBDEDGE)
00001BDE                          1060              
00001BDE                          1061         
00001BDE  B03C 0000               1062              CMP.B   #0,D0
00001BE2  6700 0008               1063              BEQ     .NOACT          
00001BE6                          1064              
00001BE6                          1065              ;STORE NEW KBDVAL
00001BE6  13C2 000025B4           1066              MOVE.B  D2,(KBDVAL)
00001BEC                          1067  .NOACT
00001BEC                          1068              
00001BEC  4CDF 001F               1069              MOVEM.L (A7)+,D0-D4
00001BF0                          1070              
00001BF0  4E73                    1071              RTE    
00001BF2                          1072              
00001BF2                          1073  .CONVERT 
00001BF2  363C 0003               1074              MOVE.W  #3,D3
00001BF6                          1075              
00001BF6  E189                    1076  .LOOP       LSL.L   #8,D1
00001BF8  E312                    1077              ROXL.B  #1,D2
00001BFA  51CB FFFA               1078              DBRA.W  D3,.LOOP
00001BFE  4E75                    1079              RTS
00001C00                          1080             
00001C00                          1081  
00001C00                          1082  ;------------------------------------------------------------------------------            
00001C00                          1083  COLWALLRIGHT
00001C00                          1084  ; COLLISION PAC-MAN WITH WALL
00001C00                          1085  ; INPUT    : NONE
00001C00                          1086  ; OUTPUT   : NONE
00001C00                          1087  ; MODIFIES : NONE
00001C00                          1088  ; ------------------------------------------------------------------------------
00001C00                          1089  
00001C00  48E7 F800               1090              MOVEM.L D0-D4,-(A7)
00001C04                          1091  
00001C04  3039 00003446           1092              MOVE.W  (PMPOSX),D0
00001C0A  5140                    1093              SUB.W   #8,D0
00001C0C  3239 00003448           1094              MOVE.W  (PMPOSY),D1
00001C12  5041                    1095              ADD.W   #8,D1
00001C14                          1096              
00001C14  81FC 0010               1097              DIVS.W  #16,D0
00001C18  83FC 0010               1098              DIVS.W  #16,D1
00001C1C                          1099              
00001C1C  5940                    1100              SUB.W   #4,D0                   ;LI RESTAM 4 PERQUE LA MATRIU ESTA A UNA DISTANCIA DE 64 PIXELS DE LA PANTALLA
00001C1E  5941                    1101              SUB.W   #4,D1
00001C20                          1102              
00001C20  41F9 000025B8           1103              LEA.L   MAPVAR,A0
00001C26                          1104              
00001C26  5240                    1105              ADD.W   #1,D0
00001C28  5341                    1106              SUB.W   #1,D1
00001C2A  C2FC 0020               1107              MULU.W  #32,D1
00001C2E  D041                    1108              ADD.W   D1,D0
00001C30                          1109              
00001C30  3240                    1110              MOVE.W  D0,A1
00001C32  13C0 000029B8           1111              MOVE.B  D0,POSCON
00001C38                          1112  
00001C38  1A29 25B8               1113              MOVE.B  MAPVAR(A1),D5
00001C3C                          1114              
00001C3C  4CDF 001F               1115              MOVEM.L (A7)+,D0-D4
00001C40                          1116              
00001C40  4E75                    1117              RTS
00001C42                          1118  
00001C42                          1119  
00001C42                          1120  ;------------------------------------------------------------------------------            
00001C42                          1121  COLWALLLEFT
00001C42                          1122  ; COLLISION PAC-MAN WITH WALL
00001C42                          1123  ; INPUT    : NONE
00001C42                          1124  ; OUTPUT   : NONE
00001C42                          1125  ; MODIFIES : NONE
00001C42                          1126  ; ------------------------------------------------------------------------------
00001C42                          1127  
00001C42  48E7 F800               1128              MOVEM.L D0-D4,-(A7)
00001C46                          1129  
00001C46  3039 00003446           1130              MOVE.W  (PMPOSX),D0
00001C4C  5C40                    1131              ADD.W   #6,D0
00001C4E  3239 00003448           1132              MOVE.W  (PMPOSY),D1
00001C54  5041                    1133              ADD.W   #8,D1
00001C56                          1134              
00001C56  81FC 0010               1135              DIVS.W  #16,D0
00001C5A  83FC 0010               1136              DIVS.W  #16,D1
00001C5E                          1137              
00001C5E  5940                    1138              SUB.W   #4,D0                   ;LI RESTAM 4 PERQUE LA MATRIU ESTA A UNA DISTANCIA DE 64 PIXELS DE LA PANTALLA
00001C60  5941                    1139              SUB.W   #4,D1
00001C62                          1140              
00001C62  41F9 000025B8           1141              LEA.L   MAPVAR,A0
00001C68                          1142              
00001C68  5340                    1143              SUB.W   #1,D0
00001C6A  5341                    1144              SUB.W   #1,D1
00001C6C  C2FC 0020               1145              MULU.W  #32,D1
00001C70  D041                    1146              ADD.W   D1,D0
00001C72                          1147  
00001C72  3240                    1148              MOVE.W  D0,A1
00001C74  13C0 000029B8           1149              MOVE.B  D0,POSCON
00001C7A                          1150  
00001C7A  1A29 25B8               1151              MOVE.B  MAPVAR(A1),D5               
00001C7E                          1152  
00001C7E                          1153              
00001C7E  4CDF 001F               1154              MOVEM.L (A7)+,D0-D4
00001C82                          1155              
00001C82  4E75                    1156              RTS
00001C84                          1157  
00001C84                          1158  ;------------------------------------------------------------------------------            
00001C84                          1159  COLWALLDOWN
00001C84                          1160  ; COLLISION PAC-MAN WITH WALL
00001C84                          1161  ; INPUT    : NONE
00001C84                          1162  ; OUTPUT   : NONE
00001C84                          1163  ; MODIFIES : NONE
00001C84                          1164  ; ------------------------------------------------------------------------------
00001C84                          1165  
00001C84  48E7 F800               1166              MOVEM.L D0-D4,-(A7)
00001C88                          1167  
00001C88  3039 00003446           1168              MOVE.W  (PMPOSX),D0
00001C8E                          1169              ;ADD.W   #8,D0
00001C8E  3239 00003448           1170              MOVE.W  (PMPOSY),D1
00001C94  5041                    1171              ADD.W   #8,D1
00001C96                          1172              
00001C96  81FC 0010               1173              DIVS.W  #16,D0
00001C9A  83FC 0010               1174              DIVS.W  #16,D1
00001C9E                          1175              
00001C9E  5940                    1176              SUB.W   #4,D0                   ;LI RESTAM 4 PERQUE LA MATRIU ESTA A UNA DISTANCIA DE 64 PIXELS DE LA PANTALLA
00001CA0  5941                    1177              SUB.W   #4,D1
00001CA2                          1178              
00001CA2  41F9 000025B8           1179              LEA.L   MAPVAR,A0
00001CA8                          1180              
00001CA8  C2FC 0020               1181              MULU.W  #32,D1
00001CAC  D041                    1182              ADD.W   D1,D0
00001CAE                          1183  
00001CAE  3240                    1184              MOVE.W  D0,A1
00001CB0  13C0 000029B8           1185              MOVE.B  D0,POSCON
00001CB6                          1186  
00001CB6  1A29 25B8               1187              MOVE.B  MAPVAR(A1),D5 
00001CBA                          1188  
00001CBA                          1189              
00001CBA  4CDF 001F               1190              MOVEM.L (A7)+,D0-D4
00001CBE                          1191              
00001CBE  4E75                    1192              RTS
00001CC0                          1193  
00001CC0                          1194  
00001CC0                          1195  ;------------------------------------------------------------------------------            
00001CC0                          1196  COLWALLUP
00001CC0                          1197  ; COLLISION PAC-MAN WITH WALL
00001CC0                          1198  ; INPUT    : NONE
00001CC0                          1199  ; OUTPUT   : NONE
00001CC0                          1200  ; MODIFIES : NONE
00001CC0                          1201  ; ------------------------------------------------------------------------------
00001CC0                          1202  
00001CC0  48E7 F800               1203              MOVEM.L D0-D4,-(A7)
00001CC4                          1204  
00001CC4  3039 00003446           1205              MOVE.W  (PMPOSX),D0
00001CCA                          1206              ;SUB.W   #8,D0
00001CCA  3239 00003448           1207              MOVE.W  (PMPOSY),D1
00001CD0  5C41                    1208              ADD.W   #6,D1
00001CD2                          1209              
00001CD2                          1210              
00001CD2  81FC 0010               1211              DIVS.W  #16,D0
00001CD6  83FC 0010               1212              DIVS.W  #16,D1
00001CDA                          1213              
00001CDA  5940                    1214              SUB.W   #4,D0                   ;LI RESTAM 4 PERQUE LA MATRIU ESTA A UNA DISTANCIA DE 64 PIXELS DE LA PANTALLA
00001CDC  5941                    1215              SUB.W   #4,D1
00001CDE                          1216              
00001CDE  41F9 000025B8           1217              LEA.L   MAPVAR,A0
00001CE4                          1218              
00001CE4  5341                    1219              SUB.W   #1,D1
00001CE6                          1220              ;CMP     #1,D1
00001CE6                          1221              ;BLO     BUCLE4
00001CE6  C2FC 0020               1222              MULU.W  #32,D1
00001CEA  D041                    1223              ADD.W   D1,D0
00001CEC                          1224  
00001CEC                          1225  ;BUCLE4            
00001CEC  3240                    1226              MOVE.W  D0,A1
00001CEE  13C0 000029B8           1227              MOVE.B  D0,POSCON
00001CF4                          1228  
00001CF4  1A29 25B8               1229              MOVE.B  MAPVAR(A1),D5 
00001CF8                          1230  
00001CF8                          1231              ;MOVE.B  #0,D5
00001CF8                          1232              
00001CF8  4CDF 001F               1233              MOVEM.L (A7)+,D0-D4
00001CFC                          1234              
00001CFC  4E75                    1235              RTS
00001CFE                          1236  
00001CFE                          1237  ;------------------------------------------------------------------------------            
00001CFE                          1238  GSTCOLWALLRIGHT
00001CFE                          1239  ; COLLISION PAC-MAN WITH WALL
00001CFE                          1240  ; INPUT    : NONE
00001CFE                          1241  ; OUTPUT   : NONE
00001CFE                          1242  ; MODIFIES : NONE
00001CFE                          1243  ; ------------------------------------------------------------------------------
00001CFE                          1244  
00001CFE  48E7 F800               1245              MOVEM.L D0-D4,-(A7)
00001D02                          1246  
00001D02  3039 00003450           1247              MOVE.W  (GSTPOSX),D0
00001D08  5140                    1248              SUB.W   #8,D0
00001D0A  3239 00003452           1249              MOVE.W  (GSTPOSY),D1
00001D10  5041                    1250              ADD.W   #8,D1
00001D12                          1251              
00001D12  81FC 0010               1252              DIVS.W  #16,D0
00001D16  83FC 0010               1253              DIVS.W  #16,D1
00001D1A                          1254              
00001D1A  5940                    1255              SUB.W   #4,D0                   ;LI RESTAM 4 PERQUE LA MATRIU ESTA A UNA DISTANCIA DE 64 PIXELS DE LA PANTALLA
00001D1C  5941                    1256              SUB.W   #4,D1
00001D1E                          1257              
00001D1E  41F9 000025B8           1258              LEA.L   MAPVAR,A0
00001D24                          1259              
00001D24  5240                    1260              ADD.W   #1,D0
00001D26  5341                    1261              SUB.W   #1,D1
00001D28  C2FC 0020               1262              MULU.W  #32,D1
00001D2C  D041                    1263              ADD.W   D1,D0
00001D2E                          1264              
00001D2E  3240                    1265              MOVE.W  D0,A1
00001D30                          1266  
00001D30  1A29 25B8               1267              MOVE.B  MAPVAR(A1),D5
00001D34                          1268              
00001D34  4CDF 001F               1269              MOVEM.L (A7)+,D0-D4
00001D38                          1270              
00001D38  4E75                    1271              RTS
00001D3A                          1272  
00001D3A                          1273  
00001D3A                          1274  ;------------------------------------------------------------------------------            
00001D3A                          1275  GSTCOLWALLLEFT
00001D3A                          1276  ; COLLISION PAC-MAN WITH WALL
00001D3A                          1277  ; INPUT    : NONE
00001D3A                          1278  ; OUTPUT   : NONE
00001D3A                          1279  ; MODIFIES : NONE
00001D3A                          1280  ; ------------------------------------------------------------------------------
00001D3A                          1281  
00001D3A  48E7 F800               1282              MOVEM.L D0-D4,-(A7)
00001D3E                          1283  
00001D3E  3039 00003450           1284              MOVE.W  (GSTPOSX),D0
00001D44  5C40                    1285              ADD.W   #6,D0
00001D46  3239 00003452           1286              MOVE.W  (GSTPOSY),D1
00001D4C  5041                    1287              ADD.W   #8,D1
00001D4E                          1288              
00001D4E  81FC 0010               1289              DIVS.W  #16,D0
00001D52  83FC 0010               1290              DIVS.W  #16,D1
00001D56                          1291              
00001D56  5940                    1292              SUB.W   #4,D0                   ;LI RESTAM 4 PERQUE LA MATRIU ESTA A UNA DISTANCIA DE 64 PIXELS DE LA PANTALLA
00001D58  5941                    1293              SUB.W   #4,D1
00001D5A                          1294              
00001D5A  41F9 000025B8           1295              LEA.L   MAPVAR,A0
00001D60                          1296              
00001D60  5340                    1297              SUB.W   #1,D0
00001D62  5341                    1298              SUB.W   #1,D1
00001D64  C2FC 0020               1299              MULU.W  #32,D1
00001D68  D041                    1300              ADD.W   D1,D0
00001D6A                          1301  
00001D6A  3240                    1302              MOVE.W  D0,A1
00001D6C  1A29 25B8               1303              MOVE.B  MAPVAR(A1),D5               
00001D70                          1304  
00001D70                          1305              
00001D70  4CDF 001F               1306              MOVEM.L (A7)+,D0-D4
00001D74                          1307              
00001D74  4E75                    1308              RTS
00001D76                          1309  
00001D76                          1310  ;------------------------------------------------------------------------------            
00001D76                          1311  GSTCOLWALLDOWN
00001D76                          1312  ; COLLISION PAC-MAN WITH WALL
00001D76                          1313  ; INPUT    : NONE
00001D76                          1314  ; OUTPUT   : NONE
00001D76                          1315  ; MODIFIES : NONE
00001D76                          1316  ; ------------------------------------------------------------------------------
00001D76                          1317  
00001D76  48E7 F800               1318              MOVEM.L D0-D4,-(A7)
00001D7A                          1319  
00001D7A  3039 00003450           1320              MOVE.W  (GSTPOSX),D0
00001D80                          1321              ;ADD.W   #8,D0
00001D80  3239 00003452           1322              MOVE.W  (GSTPOSY),D1
00001D86  5041                    1323              ADD.W   #8,D1
00001D88                          1324              
00001D88  81FC 0010               1325              DIVS.W  #16,D0
00001D8C  83FC 0010               1326              DIVS.W  #16,D1
00001D90                          1327              
00001D90  5940                    1328              SUB.W   #4,D0                   ;LI RESTAM 4 PERQUE LA MATRIU ESTA A UNA DISTANCIA DE 64 PIXELS DE LA PANTALLA
00001D92  5941                    1329              SUB.W   #4,D1
00001D94                          1330              
00001D94  41F9 000025B8           1331              LEA.L   MAPVAR,A0
00001D9A                          1332              
00001D9A  C2FC 0020               1333              MULU.W  #32,D1
00001D9E  D041                    1334              ADD.W   D1,D0
00001DA0                          1335  
00001DA0  3240                    1336              MOVE.W  D0,A1
00001DA2  1A29 25B8               1337              MOVE.B  MAPVAR(A1),D5 
00001DA6                          1338  
00001DA6                          1339              
00001DA6  4CDF 001F               1340              MOVEM.L (A7)+,D0-D4
00001DAA                          1341              
00001DAA  4E75                    1342              RTS
00001DAC                          1343  
00001DAC                          1344  
00001DAC                          1345  ;------------------------------------------------------------------------------            
00001DAC                          1346  GSTCOLWALLUP
00001DAC                          1347  ; COLLISION PAC-MAN WITH WALL
00001DAC                          1348  ; INPUT    : NONE
00001DAC                          1349  ; OUTPUT   : NONE
00001DAC                          1350  ; MODIFIES : NONE
00001DAC                          1351  ; ------------------------------------------------------------------------------
00001DAC                          1352  
00001DAC  48E7 F800               1353              MOVEM.L D0-D4,-(A7)
00001DB0                          1354  
00001DB0  3039 00003450           1355              MOVE.W  (GSTPOSX),D0
00001DB6                          1356              ;SUB.W   #8,D0
00001DB6  3239 00003452           1357              MOVE.W  (GSTPOSY),D1
00001DBC  5C41                    1358              ADD.W   #6,D1
00001DBE                          1359              
00001DBE                          1360              
00001DBE  81FC 0010               1361              DIVS.W  #16,D0
00001DC2  83FC 0010               1362              DIVS.W  #16,D1
00001DC6                          1363              
00001DC6  5940                    1364              SUB.W   #4,D0                   ;LI RESTAM 4 PERQUE LA MATRIU ESTA A UNA DISTANCIA DE 64 PIXELS DE LA PANTALLA
00001DC8  5941                    1365              SUB.W   #4,D1
00001DCA                          1366              
00001DCA  41F9 000025B8           1367              LEA.L   MAPVAR,A0
00001DD0                          1368              
00001DD0  5341                    1369              SUB.W   #1,D1
00001DD2                          1370  
00001DD2  C2FC 0020               1371              MULU.W  #32,D1
00001DD6  D041                    1372              ADD.W   D1,D0
00001DD8                          1373  
00001DD8  3240                    1374              MOVE.W  D0,A1
00001DDA                          1375  
00001DDA  1A29 25B8               1376              MOVE.B  MAPVAR(A1),D5 
00001DDE                          1377  
00001DDE                          1378              ;MOVE.B  #0,D5
00001DDE                          1379              
00001DDE  4CDF 001F               1380              MOVEM.L (A7)+,D0-D4
00001DE2                          1381              
00001DE2  4E75                    1382              RTS
00001DE4                          1383  ;------------------------------------------------------------------------------            
00001DE4                          1384  GETPOINTS
00001DE4                          1385  ; COLLISION PAC-MAN WITH WALL
00001DE4                          1386  ; INPUT    : NONE
00001DE4                          1387  ; OUTPUT   : NONE
00001DE4                          1388  ; MODIFIES : NONE
00001DE4                          1389  ; ------------------------------------------------------------------------------
00001DE4                          1390  
00001DE4  48E7 F800               1391              MOVEM.L D0-D4,-(A7)
00001DE8                          1392  
00001DE8  3039 00003446           1393              MOVE.W  (PMPOSX),D0
00001DEE                          1394              ;SUB.W   #8,D0
00001DEE  3239 00003448           1395              MOVE.W  (PMPOSY),D1
00001DF4  0641 0010               1396              ADD.W   #16,D1
00001DF8                          1397              
00001DF8                          1398              
00001DF8  81FC 0010               1399              DIVS.W  #16,D0
00001DFC  83FC 0010               1400              DIVS.W  #16,D1
00001E00                          1401              
00001E00  5940                    1402              SUB.W   #4,D0                   ;LI RESTAM 4 PERQUE LA MATRIU ESTA A UNA DISTANCIA DE 64 PIXELS DE LA PANTALLA
00001E02  5941                    1403              SUB.W   #4,D1
00001E04                          1404                          
00001E04  5341                    1405              SUB.W   #1,D1
00001E06  C2FC 0020               1406              MULU.W  #32,D1
00001E0A  D041                    1407              ADD.W   D1,D0
00001E0C                          1408  
00001E0C  3240                    1409              MOVE.W  D0,A1
00001E0E  1A29 25B8               1410              MOVE.B  MAPVAR(A1),D5
00001E12                          1411              
00001E12  BA7C 0000               1412              CMP     #0,D5
00001E16  6700 003A               1413              BEQ     .DONE
00001E1A  BA7C 0002               1414              CMP     #2,D5
00001E1E  6700 0020               1415              BEQ     .POINT
00001E22  BA7C 0003               1416              CMP     #3,D5
00001E26  6700 0006               1417              BEQ     .BPOINT
00001E2A  6600 0026               1418              BNE     .DONE
00001E2E                          1419  .BPOINT
00001E2E  137C 0000 25B8          1420              MOVE.B  #0,MAPVAR(A1)
00001E34  0679 0032 00003460      1421              ADD.W   #50,(SCOPOINTS)
00001E3C  6600 0014               1422              BNE     .DONE
00001E40                          1423  .POINT
00001E40  137C 0000 25B8          1424              MOVE.B  #0,MAPVAR(A1)
00001E46  0679 000A 00003460      1425              ADD.W   #10,(SCOPOINTS)
00001E4E  6600 0002               1426              BNE     .DONE            
00001E52                          1427  .DONE                        
00001E52  4CDF 001F               1428              MOVEM.L (A7)+,D0-D4
00001E56                          1429              
00001E56  4E75                    1430              RTS
00001E58                          1431  
00001E58                          1432  
00001E58                          1433  
00001E58                          1434  
00001E58                          1435  
00001E58                          1436  
00001E58                          1437  -------------------- end include --------------------
00001E58                          1438              INCLUDE "MAP.X68"
00001E58                          1439  
00001E58                          1440  ; ------------------------------------------------------------------------------
00001E58                          1441  MAPINIT
00001E58                          1442  ; INIT MAP
00001E58                          1443  ; INPUT    : NONE
00001E58                          1444  ; OUTPUT   : NONE
00001E58                          1445  ; MODIFIES : NONE
00001E58                          1446  ; ------------------------------------------------------------------------------            
00001E58                          1447              
00001E58                          1448              ;MOVE.L  #DIBFIGWALL,($80+2*4)          ;INSTALL SUBRUTINE TO TRAP #2
00001E58                          1449              ;MOVE.L  #DIBFIGPOINT,($80+3*4)          ;INSTALL SUBRUTINE TO TRAP #3
00001E58                          1450              ;MOVE.L  #DIBFIGBPOINT,($80+4*4)          ;INSTALL SUBRUTINE TO TRAP #4
00001E58                          1451              
00001E58  48E7 FE00               1452              MOVEM.L D0-D6,-(A7)
00001E5C  48E7 00C0               1453              MOVEM.L A0-A1,-(A7)
00001E60                          1454              
00001E60  41F8 1008               1455              LEA.L   MAPMAT,A0
00001E64  43F9 000025B8           1456              LEA.L   MAPVAR,A1
00001E6A  3C3C 0030               1457              MOVE.W  #48,D6
00001E6E  343C 001F               1458              MOVE.W  #31,D2
00001E72                          1459  BUCLE_FILA
00001E72  3A3C 0030               1460              MOVE.W  #48,D5
00001E76  323C 001F               1461              MOVE.W  #31,D1
00001E7A  0646 0010               1462              ADD.W   #16,D6
00001E7E                          1463  
00001E7E                          1464  BUCLE_COLUMNA
00001E7E  0645 0010               1465              ADD.W   #16,D5
00001E82                          1466  
00001E82  1018                    1467              MOVE.B  (A0)+,D0
00001E84  12C0                    1468              MOVE.B  D0,(A1)+
00001E86                          1469               
00001E86  B07C 0000               1470              CMP     #0,D0
00001E8A  6700 0034               1471              BEQ     ZERO
00001E8E  B07C 0004               1472              CMP     #4,D0
00001E92  6700 002C               1473              BEQ     ZERO
00001E96  B07C 0001               1474              CMP     #1,D0
00001E9A  6600 0008               1475              BNE     NOTWALL
00001E9E  4EB9 00001F46           1476              JSR     DIBFIGWALL
00001EA4                          1477  NOTWALL
00001EA4  B07C 0002               1478              CMP     #2,D0
00001EA8  6600 0008               1479              BNE     NOTPOINT
00001EAC  4EB9 00001F7E           1480              JSR     DIBFIGPOINT
00001EB2                          1481  NOTPOINT
00001EB2  B07C 0003               1482              CMP     #3,D0
00001EB6  6600 0008               1483              BNE     ZERO
00001EBA  4EB9 00001FBA           1484              JSR     DIBFIGBPOINT
00001EC0                          1485           
00001EC0                          1486  ZERO
00001EC0  51C9 FFBC               1487              DBRA    D1,BUCLE_COLUMNA  
00001EC4  51CA FFAC               1488              DBRA    D2,BUCLE_FILA
00001EC8                          1489              
00001EC8  4CDF 0300               1490              MOVEM.L (A7)+,A0-A1
00001ECC  4CDF 007F               1491              MOVEM.L (A7)+,D0-D6
00001ED0                          1492  
00001ED0                          1493  
00001ED0                          1494              
00001ED0  4E75                    1495              RTS            
00001ED2                          1496  
00001ED2                          1497  ; ------------------------------------------------------------------------------
00001ED2                          1498  MAPPLOT
00001ED2                          1499  ; INIT MAP
00001ED2                          1500  ; INPUT    : NONE
00001ED2                          1501  ; OUTPUT   : NONE
00001ED2                          1502  ; MODIFIES : NONE
00001ED2                          1503  ; ------------------------------------------------------------------------------            
00001ED2                          1504  
00001ED2  48E7 FE00               1505              MOVEM.L D0-D6,-(A7)
00001ED6  48E7 0080               1506              MOVEM.L A0,-(A7)
00001EDA                          1507  
00001EDA  41F9 000025B8           1508              LEA.L   MAPVAR,A0
00001EE0  3C3C 0030               1509              MOVE.W  #48,D6
00001EE4  343C 001F               1510              MOVE.W  #31,D2
00001EE8                          1511  BUCLE_FILA2
00001EE8  3A3C 0030               1512              MOVE.W  #48,D5
00001EEC  323C 001F               1513              MOVE.W  #31,D1
00001EF0  0646 0010               1514              ADD.W   #16,D6
00001EF4                          1515  
00001EF4                          1516  BUCLE_COLUMNA2
00001EF4  0645 0010               1517              ADD.W   #16,D5       
00001EF8                          1518  
00001EF8  1018                    1519              MOVE.B  (A0)+,D0
00001EFA                          1520  
00001EFA  B07C 0000               1521              CMP     #0,D0
00001EFE  6700 0034               1522              BEQ     ZERO2
00001F02  B07C 0004               1523              CMP     #4,D0
00001F06  6700 002C               1524              BEQ     ZERO2
00001F0A  B07C 0001               1525              CMP     #1,D0
00001F0E  6600 0008               1526              BNE     NOTWALL2
00001F12  4EB9 00001F46           1527              JSR     DIBFIGWALL
00001F18                          1528  NOTWALL2
00001F18  B07C 0002               1529              CMP     #2,D0
00001F1C  6600 0008               1530              BNE     NOTPOINT2
00001F20  4EB9 00001F7E           1531              JSR     DIBFIGPOINT
00001F26                          1532  NOTPOINT2
00001F26  B07C 0003               1533              CMP     #3,D0
00001F2A  6600 0008               1534              BNE     ZERO2
00001F2E  4EB9 00001FBA           1535              JSR     DIBFIGBPOINT
00001F34                          1536  
00001F34                          1537     
00001F34                          1538  ZERO2
00001F34  51C9 FFBE               1539              DBRA    D1,BUCLE_COLUMNA2
00001F38                          1540              
00001F38  51CA FFAE               1541              DBRA    D2,BUCLE_FILA2
00001F3C                          1542              
00001F3C  4CDF 0100               1543              MOVEM.L (A7)+,A0
00001F40  4CDF 007F               1544              MOVEM.L (A7)+,D0-D6
00001F44                          1545              
00001F44                          1546              
00001F44  4E75                    1547              RTS 
00001F46                          1548              
00001F46                          1549  ; -----------------------------------------------------------------------------
00001F46                          1550  DIBFIGWALL
00001F46                          1551  ; SUBRUTINE DRAW MAP
00001F46                          1552  ; INPUT    : D5=POSITION X, D6=POSITION Y
00001F46                          1553  ; OUTPUT   : NONE
00001F46                          1554  ; MODIFIES : NONE
00001F46                          1555  ; -----------------------------------------------------------------------------
00001F46  48E7 FE00               1556              MOVEM.L D0-D6,-(A7)
00001F4A                          1557              ; SET CONTOURN COLOR
00001F4A  103C 0050               1558              MOVE.B  #80,D0
00001F4E  223C 00AA0000           1559              MOVE.L  #$00AA0000,D1
00001F54  4E4F                    1560              TRAP    #15
00001F56                          1561              
00001F56                          1562              ; SET FILL COLOR
00001F56  103C 0051               1563              MOVE.B  #81,D0
00001F5A  223C 00FF0000           1564              MOVE.L  #$00FF0000,D1
00001F60  4E4F                    1565              TRAP    #15
00001F62                          1566              
00001F62                          1567              ; DEFINE COORDINATES RECTANGLE
00001F62  3205                    1568              MOVE.W  D5,D1
00001F64  3406                    1569              MOVE.W  D6,D2
00001F66  0645 0010               1570              ADD.W   #16,D5
00001F6A  0646 0010               1571              ADD.W   #16,D6
00001F6E  3605                    1572              MOVE.W  D5,D3
00001F70  3806                    1573              MOVE.W  D6,D4
00001F72                          1574              
00001F72                          1575              ; DRAW RECTANGLE
00001F72  103C 0057               1576              MOVE.B  #87,D0
00001F76  4E4F                    1577              TRAP    #15
00001F78                          1578              
00001F78  4CDF 007F               1579              MOVEM.L (A7)+,D0-D6
00001F7C                          1580  
00001F7C  4E75                    1581              RTS
00001F7E                          1582              
00001F7E                          1583  ; -----------------------------------------------------------------------------
00001F7E                          1584  DIBFIGPOINT
00001F7E                          1585  ; SUBRUTINE DRAW MAP
00001F7E                          1586  ; INPUT    : D5=POSITION X, D6=POSITION Y
00001F7E                          1587  ; OUTPUT   : NONE
00001F7E                          1588  ; MODIFIES : NONE
00001F7E                          1589  ; -----------------------------------------------------------------------------
00001F7E  48E7 FE00               1590              MOVEM.L D0-D6,-(A7)
00001F82                          1591              ; SET CONTOURN COLOR
00001F82  103C 0050               1592              MOVE.B  #80,D0
00001F86  223C 0000AAAA           1593              MOVE.L  #$0000AAAA,D1
00001F8C  4E4F                    1594              TRAP    #15
00001F8E                          1595              
00001F8E                          1596              ; SET FILL COLOR
00001F8E  103C 0051               1597              MOVE.B  #81,D0
00001F92  223C 0000FFFF           1598              MOVE.L  #$0000FFFF,D1
00001F98  4E4F                    1599              TRAP    #15
00001F9A                          1600              
00001F9A                          1601              ; DEFINE COORDINATES RECTANGLE
00001F9A  3205                    1602              MOVE.W  D5,D1
00001F9C  5041                    1603              ADD.W   #8,D1
00001F9E  5541                    1604              SUB.W   #2,D1
00001FA0  3406                    1605              MOVE.W  D6,D2
00001FA2  5042                    1606              ADD.W   #8,D2
00001FA4  5542                    1607              SUB.W   #2,D2
00001FA6                          1608              
00001FA6  3601                    1609              MOVE.W  D1,D3
00001FA8  5843                    1610              ADD.W   #2*2,D3
00001FAA  3802                    1611              MOVE.W  D2,D4
00001FAC  5844                    1612              ADD.W   #2*2,D4
00001FAE                          1613              
00001FAE                          1614              ; DRAW POINT
00001FAE  103C 0058               1615              MOVE.B  #88,D0
00001FB2  4E4F                    1616              TRAP    #15
00001FB4                          1617              
00001FB4  4CDF 007F               1618              MOVEM.L (A7)+,D0-D6
00001FB8                          1619              
00001FB8  4E75                    1620              RTS
00001FBA                          1621  
00001FBA                          1622  
00001FBA                          1623  ; -----------------------------------------------------------------------------
00001FBA                          1624  DIBFIGBPOINT
00001FBA                          1625  ; SUBRUTINE DRAW MAP
00001FBA                          1626  ; INPUT    : D5=POSITION X, D6=POSITION Y
00001FBA                          1627  ; OUTPUT   : NONE
00001FBA                          1628  ; MODIFIES : NONE
00001FBA                          1629  ; -----------------------------------------------------------------------------
00001FBA  48E7 FE00               1630              MOVEM.L D0-D6,-(A7)
00001FBE                          1631              ; SET CONTOURN COLOR
00001FBE  103C 0050               1632              MOVE.B  #80,D0
00001FC2  223C 0000AAAA           1633              MOVE.L  #$0000AAAA,D1
00001FC8  4E4F                    1634              TRAP    #15
00001FCA                          1635              
00001FCA                          1636              ; SET FILL COLOR
00001FCA  103C 0051               1637              MOVE.B  #81,D0
00001FCE  223C 0000FFFF           1638              MOVE.L  #$0000FFFF,D1
00001FD4  4E4F                    1639              TRAP    #15
00001FD6                          1640              
00001FD6                          1641              ; DEFINE COORDINATES RECTANGLE
00001FD6  3205                    1642              MOVE.W  D5,D1
00001FD8  5041                    1643              ADD.W   #8,D1
00001FDA  5941                    1644              SUB.W   #4,D1
00001FDC  3406                    1645              MOVE.W  D6,D2
00001FDE  5042                    1646              ADD.W   #8,D2
00001FE0  5942                    1647              SUB.W   #4,D2
00001FE2                          1648              
00001FE2  3601                    1649              MOVE.W  D1,D3
00001FE4  5043                    1650              ADD.W   #4*2,D3
00001FE6  3802                    1651              MOVE.W  D2,D4
00001FE8  5044                    1652              ADD.W   #4*2,D4
00001FEA                          1653              
00001FEA                          1654              ; DRAW BIG POINT
00001FEA  103C 0058               1655              MOVE.B  #88,D0
00001FEE  4E4F                    1656              TRAP    #15
00001FF0                          1657              
00001FF0  4CDF 007F               1658              MOVEM.L (A7)+,D0-D6
00001FF4                          1659              
00001FF4  4E75                    1660              RTS
00001FF6                          1661  
00001FF6                          1662  
00001FF6                          1663  
00001FF6                          1664  
00001FF6                          1665  
00001FF6                          1666  
00001FF6                          1667  
00001FF6                          1668  
00001FF6                          1669  
00001FF6                          1670  
00001FF6                          1671  
00001FF6                          1672  
00001FF6                          1673  -------------------- end include --------------------
00001FF6                          1674              INCLUDE "LIB/UTLCONST.X68"
00001FF6                          1675  ; ==============================================================================
00001FF6                          1676  ; UTIL CONSTANTS
00001FF6                          1677  ; ==============================================================================
00001FF6                          1678  
00001FF6  =00000008               1679  UTLCHRWD    EQU     8                       ; CHARACTER WIDTH IN PIXELS
00001FF6                          1680  
00001FF6                          1681  -------------------- end include --------------------
00001FF6                          1682              INCLUDE "LIB/UTLCODE.X68"
00001FF6                          1683  ; =============================================================================
00001FF6                          1684  ; UTILITY CODE
00001FF6                          1685  ; =============================================================================
00001FF6                          1686  
00001FF6                          1687  ; -----------------------------------------------------------------------------
00001FF6                          1688  UTLINIT
00001FF6                          1689  ; INITIALIZES UTILITY CODE
00001FF6                          1690  ; INPUT    - NONE
00001FF6                          1691  ; OUTPUT   - NONE
00001FF6                          1692  ; MODIFIES - NONE
00001FF6                          1693  ; -----------------------------------------------------------------------------
00001FF6  48E7 C000               1694              MOVEM.L D0-D1,-(A7)
00001FFA  103C 0008               1695              MOVE.B  #8,D0
00001FFE  4E4F                    1696              TRAP    #15
00002000  13C1 00003468           1697              MOVE.B  D1,(UTLRNDIX)
00002006  4CDF 0003               1698              MOVEM.L (A7)+,D0-D1
0000200A  4E75                    1699              RTS
0000200C                          1700  
0000200C                          1701  ; -----------------------------------------------------------------------------
0000200C                          1702  UTLPRINT
0000200C                          1703  ; PRINT SCREEN CENTERED TEXT
0000200C                          1704  ; INPUT    : A0 POINTER TO ZERO-TERMINATED STRING
0000200C                          1705  ;            D0.B SCREEN ROW TO PRINT TEXT
0000200C                          1706  ; OUTPUT   : D0.B NEXT ROW
0000200C                          1707  ; MODIFIES : NONE (ASIDE OF OUTPUT)
0000200C                          1708  ; -----------------------------------------------------------------------------
0000200C  48E7 C0C0               1709              MOVEM.L D0-D1/A0-A1,-(A7)
00002010  4201                    1710              CLR.B   D1
00002012  2248                    1711              MOVE.L  A0,A1
00002014  4A18                    1712  .LOOP       TST.B   (A0)+
00002016  6700 0006               1713              BEQ     .ENDLOOP
0000201A  5201                    1714              ADDQ.B  #1,D1
0000201C  60F6                    1715              BRA     .LOOP
0000201E  E209                    1716  .ENDLOOP    LSR.B   #1,D1
00002020  0401 0028               1717              SUB.B   #(SCRWIDTH/UTLCHRWD)/2,D1
00002024  4401                    1718              NEG.B   D1
00002026  E141                    1719              ASL.W   #8,D1
00002028  8240                    1720              OR.W    D0,D1
0000202A  103C 000B               1721              MOVE.B  #11,D0
0000202E  4E4F                    1722              TRAP    #15
00002030  103C 000D               1723              MOVE.B  #13,D0
00002034  4E4F                    1724              TRAP    #15
00002036  4CDF 0303               1725              MOVEM.L (A7)+,D0-D1/A0-A1
0000203A  5200                    1726              ADDQ.B  #1,D0
0000203C  4E75                    1727              RTS
0000203E                          1728              
0000203E                          1729              
0000203E                          1730  
0000203E                          1731  
0000203E                          1732              ; (SCRWIDTH/UTLCHRWD)/2 - D1/2
0000203E                          1733  
0000203E                          1734  
0000203E                          1735  ; -----------------------------------------------------------------------------
0000203E                          1736  UTLRAND
0000203E                          1737  ; PROVIDES A PSEUDO-RANDOM BYTE
0000203E                          1738  ; INPUT    - NONE
0000203E                          1739  ; OUTPUT   - D0.L RANDOM VALUE (ONLY BYTE)
0000203E                          1740  ; MODIFIES - NONE (ASIDE OF OUTPUT)
0000203E                          1741  ; -----------------------------------------------------------------------------
0000203E  2F08                    1742              MOVE.L  A0,-(A7)
00002040  41F9 0000205C           1743              LEA     .RANDVEC,A0
00002046  4280                    1744              CLR.L   D0
00002048  1039 00003468           1745              MOVE.B  (UTLRNDIX),D0
0000204E  1030 0800               1746              MOVE.B  (A0,D0.L),D0
00002052  5239 00003468           1747              ADDQ.B  #1,(UTLRNDIX)
00002058  205F                    1748              MOVE.L  (A7)+,A0
0000205A  4E75                    1749              RTS
0000205C                          1750  
0000205C                          1751  
0000205C= A2 EE 9A 0C F5 24 ...   1752  .RANDVEC    DC.B    162, 238, 154, 12 , 245, 36 , 32 , 103
00002064= 2A A3 51 26 E0 AC ...   1753              DC.B    42 , 163, 81 , 38 , 224, 172, 19 , 69
0000206C= 75 51 CA FD 33 EB ...   1754              DC.B    117, 81 , 202, 253, 51 , 235, 108, 154
00002074= 60 CC E7 B8 9A EB ...   1755              DC.B    96 , 204, 231, 184, 154, 235, 34 , 203
0000207C= 1D 76 B5 95 B0 89 ...   1756              DC.B    29 , 118, 181, 149, 176, 137, 62 , 108
00002084= 39 15 48 C9 6E CA ...   1757              DC.B    57 , 21 , 72 , 201, 110, 202, 159, 41
0000208C= 43 E7 E2 7C 37 25 ...   1758              DC.B    67 , 231, 226, 124, 55 , 37 , 84 , 62
00002094= E9 94 CE E9 E4 52 ...   1759              DC.B    233, 148, 206, 233, 228, 82 , 243, 78
0000209C= 37 6D 9A 84 A2 28 ...   1760              DC.B    55 , 109, 154, 132, 162, 40 , 30 , 39
000020A4= 19 E2 C6 77 80 D4 ...   1761              DC.B    25 , 226, 198, 119, 128, 212, 232, 225
000020AC= 0A 5A 32 67 33 C2 ...   1762              DC.B    10 , 90 , 50 , 103, 51 , 194, 222, 40
000020B4= 59 80 DC 0E 57 FC ...   1763              DC.B    89 , 128, 220, 14 , 87 , 252, 243, 252
000020BC= 8A AB BC F7 07 4D ...   1764              DC.B    138, 171, 188, 247, 7  , 77 , 29 , 234
000020C4= EF D5 77 6E 1E BB ...   1765              DC.B    239, 213, 119, 110, 30 , 187, 131, 23
000020CC= D6 E0 2A 8F BD 28 ...   1766              DC.B    214, 224, 42 , 143, 189, 40 , 212, 130
000020D4= 13 4F 66 EC 0A 64 ...   1767              DC.B    19 , 79 , 102, 236, 10 , 100, 122, 188
000020DC= 56 52 9A 16 9B 90 ...   1768              DC.B    86 , 82 , 154, 22 , 155, 144, 7  , 199
000020E4= 06 8A A4 F7 01 DA ...   1769              DC.B    6  , 138, 164, 247, 1  , 218, 166, 82
000020EC= F2 E7 77 28 B1 76 ...   1770              DC.B    242, 231, 119, 40 , 177, 118, 220, 102
000020F4= A4 42 E3 81 B1 67 ...   1771              DC.B    164, 66 , 227, 129, 177, 103, 165, 108
000020FC= BF CE FA 16 BF 38 ...   1772              DC.B    191, 206, 250, 22 , 191, 56 , 30 , 161
00002104= D1 8B 50 0C 5F 49 ...   1773              DC.B    209, 139, 80 , 12 , 95 , 73 , 168, 56
0000210C= DE 4C 14 A2 40 DC ...   1774              DC.B    222, 76 , 20 , 162, 64 , 220, 93 , 12
00002114= B6 9B 0A 38 5D AB ...   1775              DC.B    182, 155, 10 , 56 , 93 , 171, 89 , 6
0000211C= E2 1B DD 75 15 82 ...   1776              DC.B    226, 27 , 221, 117, 21 , 130, 101, 18
00002124= 8A 26 51 30 9F 47 ...   1777              DC.B    138, 38 , 81 , 48 , 159, 71 , 57 , 21
0000212C= 1E 8A BB 71 C6 6E ...   1778              DC.B    30 , 138, 187, 113, 198, 110, 185, 152
00002134= 9F 47 E5 34 94 27 ...   1779              DC.B    159, 71 , 229, 52 , 148, 39 , 77 , 6
0000213C= 7D 06 D6 BA 30 0F ...   1780              DC.B    125, 6  , 214, 186, 48 , 15 , 212, 22
00002144= EC 7F 7E 03 CF 2D ...   1781              DC.B    236, 127, 126, 3  , 207, 45 , 193, 2
0000214C= 94 5B 23 F2 8B CD ...   1782              DC.B    148, 91 , 35 , 242, 139, 205, 248, 237
00002154= 74 33 EC B9 0F D5 ...   1783              DC.B    116, 51 , 236, 185, 15 , 213, 221, 6
0000215C                          1784  
0000215C                          1785  
0000215C                          1786  
0000215C                          1787  
0000215C                          1788  -------------------- end include --------------------
0000215C                          1789              INCLUDE "INTRO.X68"
0000215C                          1790  ; ==============================================================================
0000215C                          1791  ; INTRO SCREEN
0000215C                          1792  ; ==============================================================================
0000215C                          1793  
0000215C                          1794  ; ------------------------------------------------------------------------------
0000215C                          1795  ISCINIT
0000215C                          1796  ; INTRO SCREEN INIT
0000215C                          1797  ; INPUT    : NONE
0000215C                          1798  ; OUTPUT   : NONE
0000215C                          1799  ; MODIFIES : NONE
0000215C                          1800  ; ------------------------------------------------------------------------------
0000215C  4279 00003462           1801              CLR.W   (ISCTIMER)
00002162  4EB9 000021DC           1802              JSR     OPENFILE
00002168  4E75                    1803              RTS
0000216A                          1804  
0000216A                          1805  ; ------------------------------------------------------------------------------
0000216A                          1806  ISCUPD
0000216A                          1807  ; INTRO SCREEN UPDATE
0000216A                          1808  ; INPUT    : NONE
0000216A                          1809  ; OUTPUT   : NONE
0000216A                          1810  ; MODIFIES : NONE
0000216A                          1811  ; ------------------------------------------------------------------------------
0000216A  0839 0004 000025B4      1812              BTST.B  #4,(KBDVAL)
00002172  6700 000A               1813              BEQ     .CONT
00002176  33FC 0001 00003466      1814              MOVE.W  #1,(STANEXT)
0000217E                          1815  .CONT       ;ADDQ.W  #1,(ISCTIMER)
0000217E                          1816  ;            CMP.W   #500,(ISCTIMER)
0000217E                          1817  ;            BLT     .DONE
0000217E                          1818  ;            MOVE.W  #1,(STANEXT)
0000217E  4E75                    1819  .DONE       RTS
00002180                          1820  
00002180                          1821  ; ------------------------------------------------------------------------------
00002180                          1822  ISCPLOT
00002180                          1823  ; INTRO SCREEN PLOT
00002180                          1824  ; INPUT    : NONE
00002180                          1825  ; OUTPUT   : NONE
00002180                          1826  ; MODIFIES : NONE
00002180                          1827  ; ------------------------------------------------------------------------------
00002180  48E7 C080               1828              MOVEM.L D0-D1/A0,-(A7)
00002184                          1829              
00002184  4281                    1830              CLR.L   D1
00002186  103C 0051               1831              MOVE.B  #81,D0
0000218A  4E4F                    1832              TRAP    #15
0000218C                          1833              
0000218C  4EB9 0000220E           1834              JSR     IMGPLOT
00002192                          1835              
00002192  0839 0004 000025B7      1836              BTST.B  #4,(SCRCYCCT)
0000219A  6700 0010               1837              BEQ     .DONE
0000219E                          1838              
0000219E  41F9 000021C0           1839              LEA     .TXT2,A0
000021A4  103C 0019               1840              MOVE.B  #25,D0
000021A8  4EB8 200C               1841              JSR     UTLPRINT
000021AC                          1842              
000021AC  4CDF 0103               1843  .DONE       MOVEM.L (A7)+,D0-D1/A0
000021B0                          1844  
000021B0  4E75                    1845              RTS
000021B2= 50 41 43 2D 4D 41 ...   1846  .TXT1       DC.B    'PAC-MAN 68000',0
000021C0= 50 52 45 53 53 20 ...   1847  .TXT2       DC.B    'PRESS SPACE BUTTON TO START',0
000021DC                          1848              DS.W    0
000021DC                          1849              
000021DC                          1850  ;------------------------------------------------------------------------
000021DC                          1851              
000021DC                          1852  OPENFILE                 
000021DC                          1853              ;OPEN FILE
000021DC  43F8 1AFA               1854              LEA     FILENAME,A1
000021E0  303C 0033               1855              MOVE    #51,D0
000021E4  4E4F                    1856              TRAP    #15
000021E6                          1857              
000021E6                          1858              ;READ FILE
000021E6  243C 00000A8C           1859              MOVE.L  #FILESIZE,D2
000021EC  43F9 000029BA           1860              LEA     BUFFER,A1
000021F2  303C 0035               1861              MOVE    #53,D0
000021F6  4E4F                    1862              TRAP    #15
000021F8                          1863              
000021F8  263C 00000A8C           1864              MOVE.L  #FILESIZE,D3
000021FE                          1865              
000021FE                          1866  .convert_loop 
000021FE  4A03                    1867              TST.B   D3
00002200  6700 000A               1868              BEQ     .END
00002204  0419 0030               1869              SUB.B   #$30,(A1)+
00002208  5303                    1870              SUB.B   #1,D3
0000220A  60F2                    1871              BRA     .convert_loop           
0000220C                          1872  .END        
0000220C                          1873  
0000220C                          1874           
0000220C                          1875            
0000220C                          1876              
0000220C  4E75                    1877              RTS
0000220E                          1878  ; ------------------------------------------------------------------------------
0000220E                          1879  IMGPLOT
0000220E                          1880  ; TITLE IMAGE PLOT
0000220E                          1881  ; INPUT    : NONE
0000220E                          1882  ; OUTPUT   : NONE
0000220E                          1883  ; MODIFIES : NONE
0000220E                          1884  ; ------------------------------------------------------------------------------
0000220E  48E7 FE00               1885              MOVEM.L D0-D6,-(A7)
00002212  48E7 00C0               1886              MOVEM.L A0-A1,-(A7)
00002216                          1887              
00002216                          1888              ;PLOT
00002216                          1889   
00002216  41F9 000029BA           1890              LEA.L   BUFFER,A0
0000221C  3C3C 00DC               1891              MOVE.W  #220,D6
00002220  343C 001C               1892              MOVE.W  #28,D2
00002224                          1893  BUCLE_FILA3
00002224  3A3C 0064               1894              MOVE.W  #100,D5
00002228  323C 0065               1895              MOVE.W  #101,D1
0000222C  5846                    1896              ADD.W   #4,D6
0000222E                          1897  
0000222E                          1898  BUCLE_COLUMNA3
0000222E  5845                    1899              ADD.W   #4,D5
00002230                          1900  
00002230  1018                    1901              MOVE.B  (A0)+,D0
00002232                          1902               
00002232  B07C 0001               1903              CMP     #1,D0
00002236  6700 000C               1904              BEQ     ZERO3
0000223A  B07C 0000               1905              CMP     #0,D0
0000223E  4EB9 00002256           1906              JSR     DRAW
00002244                          1907  ZERO3
00002244  51C9 FFE8               1908              DBRA    D1,BUCLE_COLUMNA3
00002248  51CA FFDA               1909              DBRA    D2,BUCLE_FILA3
0000224C                          1910              
0000224C  4CDF 0300               1911              MOVEM.L (A7)+,A0-A1
00002250  4CDF 007F               1912              MOVEM.L (A7)+,D0-D6
00002254                          1913          
00002254                          1914  
00002254  4E75                    1915              RTS
00002256                          1916  
00002256                          1917  
00002256                          1918  ; -----------------------------------------------------------------------------
00002256                          1919  DRAW
00002256                          1920  ; SUBRUTINE DRAW 
00002256                          1921  ; INPUT    : D5=POSITION X, D6=POSITION Y
00002256                          1922  ; OUTPUT   : NONE
00002256                          1923  ; MODIFIES : NONE
00002256                          1924  ; -----------------------------------------------------------------------------
00002256  48E7 FE00               1925              MOVEM.L D0-D6,-(A7)
0000225A                          1926              ; SET CONTOURN COLOR
0000225A  103C 0050               1927              MOVE.B  #80,D0
0000225E  223C 00AA0000           1928              MOVE.L  #$00AA0000,D1
00002264  4E4F                    1929              TRAP    #15
00002266                          1930              
00002266                          1931              ; SET FILL COLOR
00002266  103C 0051               1932              MOVE.B  #81,D0
0000226A  223C 00FF0000           1933              MOVE.L  #$00FF0000,D1
00002270  4E4F                    1934              TRAP    #15
00002272                          1935              
00002272                          1936              ; DEFINE COORDINATES RECTANGLE
00002272  3205                    1937              MOVE.W  D5,D1
00002274  3406                    1938              MOVE.W  D6,D2
00002276  5845                    1939              ADD.W   #4,D5
00002278  5846                    1940              ADD.W   #4,D6
0000227A  3605                    1941              MOVE.W  D5,D3
0000227C  3806                    1942              MOVE.W  D6,D4
0000227E                          1943              
0000227E                          1944              ; DRAW RECTANGLE
0000227E  103C 0057               1945              MOVE.B  #87,D0
00002282  4E4F                    1946              TRAP    #15
00002284                          1947              
00002284  4CDF 007F               1948              MOVEM.L (A7)+,D0-D6
00002288                          1949  
00002288  4E75                    1950              RTS
0000228A                          1951  
0000228A                          1952  
0000228A                          1953  
0000228A                          1954  
0000228A                          1955  
0000228A                          1956  
0000228A                          1957  -------------------- end include --------------------
0000228A                          1958              INCLUDE "INSTRUCTIONS.X68"
0000228A                          1959  ; ==============================================================================
0000228A                          1960  ; INSTRUCTIONS SCREEN
0000228A                          1961  ; ==============================================================================
0000228A                          1962  
0000228A                          1963  ; ------------------------------------------------------------------------------
0000228A                          1964  INSINIT
0000228A                          1965  ; INSTRUCTIONS SCREEN INIT
0000228A                          1966  ; INPUT    : NONE
0000228A                          1967  ; OUTPUT   : NONE
0000228A                          1968  ; MODIFIES : NONE
0000228A                          1969  ; ------------------------------------------------------------------------------
0000228A  4E75                    1970              RTS
0000228C                          1971  
0000228C                          1972  ; ------------------------------------------------------------------------------
0000228C                          1973  INSUPD
0000228C                          1974  ; INSTRUCTIONS SCREEN UPDATE
0000228C                          1975  ; INPUT    : NONE
0000228C                          1976  ; OUTPUT   : NONE
0000228C                          1977  ; MODIFIES : NONE
0000228C                          1978  ; ------------------------------------------------------------------------------
0000228C  4E75                    1979              RTS
0000228E                          1980  
0000228E                          1981  ; ------------------------------------------------------------------------------
0000228E                          1982  INSPLOT
0000228E                          1983  ; INSTRUCTIONS SCREEN PLOT
0000228E                          1984  ; INPUT    : NONE
0000228E                          1985  ; OUTPUT   : NONE
0000228E                          1986  ; MODIFIES : NONE
0000228E                          1987  ; ------------------------------------------------------------------------------
0000228E                          1988  
0000228E  48E7 C0C0               1989              MOVEM.L D0-D1/A0-A1,-(A7)
00002292  4281                    1990              CLR.L   D1
00002294  103C 0051               1991              MOVE.B  #81,D0
00002298  4E4F                    1992              TRAP    #15
0000229A  103C 000B               1993              MOVE.B  #11,D0
0000229E  43F9 00002400           1994              LEA     .TXTLST,A1
000022A4  2219                    1995  .LOOP       MOVE.L  (A1)+,D1
000022A6  6700 000A               1996              BEQ     .DONE
000022AA  2041                    1997              MOVE.L  D1,A0
000022AC  4EB8 200C               1998              JSR     UTLPRINT
000022B0  60F2                    1999              BRA     .LOOP
000022B2  4CDF 0303               2000  .DONE       MOVEM.L (A7)+,D0-D1/A0-A1
000022B6  4E75                    2001              RTS
000022B8= 57 45 4C 43 4F 4D ...   2002  .TXT1       DC.B    'WELCOME TO THE WORLD OF MULTI-PONG 68000!',0
000022E2= 59 4F 55 52 20 47 ...   2003  .TXT2       DC.B    'YOUR GOAL IN THIS GAME IS TO AVOID MISSING THE BALLS',0
00002317= 54 4F 20 54 48 49 ...   2004  .TXT3       DC.B    'TO THIS END, MOVE THE PAD USING THE KEYBOARD',0
00002344= 48 4F 57 20 54 4F ...   2005  .TXT4       DC.B    'HOW TO DO IT? YOU MAY ASK.',0
0000235F= 49 54 20 49 53 20 ...   2006  .TXT5       DC.B    'IT IS EASY: JUST USE THE UP KEY TO MOVE THE PAD...',0
00002392= 55 50 21 00             2007  .TXT6       DC.B    'UP!',0
00002396= 41 4E 44 20 55 53 ...   2008  .TXT7       DC.B    'AND USE THE DOWN KEY TO MOVE THE PAD DOWN.',0
000023C1= 57 48 41 54 20 41 ...   2009  .TXT8       DC.B    'WHAT ABOUT LEFT AND RIGHT?',0
000023DC= 4E 4F 2E 20 54 48 ...   2010  .TXT9       DC.B    'NO. THESE ARE FORBIDDEN DIRECTIONS',0
00002400                          2011              DS.W    0
00002400= 000022B8 000022E2 ...   2012  .TXTLST     DC.L    .TXT1,.TXT2,.TXT3,.TXT4,.TXT5,.TXT6,.TXT7,.TXT8,.TXT9,0
00002428                          2013  
00002428                          2014  
00002428                          2015  -------------------- end include --------------------
00002428                          2016              INCLUDE "WIN.X68"
00002428                          2017  ; ==============================================================================
00002428                          2018  ; VICTORY SCREEN
00002428                          2019  ; ==============================================================================
00002428                          2020  
00002428                          2021  ; ------------------------------------------------------------------------------
00002428                          2022  WININIT
00002428                          2023  ; VICTORY SCREEN INIT
00002428                          2024  ; INPUT    : NONE
00002428                          2025  ; OUTPUT   : NONE
00002428                          2026  ; MODIFIES : NONE
00002428                          2027  ; ------------------------------------------------------------------------------
00002428  4E75                    2028              RTS
0000242A                          2029  
0000242A                          2030  ; ------------------------------------------------------------------------------
0000242A                          2031  WINUPD
0000242A                          2032  ; VICTORY SCREEN UPDATE
0000242A                          2033  ; INPUT    : NONE
0000242A                          2034  ; OUTPUT   : NONE
0000242A                          2035  ; MODIFIES : NONE
0000242A                          2036  ; ------------------------------------------------------------------------------
0000242A  4E75                    2037              RTS
0000242C                          2038  
0000242C                          2039  ; ------------------------------------------------------------------------------
0000242C                          2040  WINPLOT
0000242C                          2041  ; VICTORY SCREEN PLOT
0000242C                          2042  ; INPUT    : NONE
0000242C                          2043  ; OUTPUT   : NONE
0000242C                          2044  ; MODIFIES : NONE
0000242C                          2045  ; ------------------------------------------------------------------------------
0000242C  48E7 C080               2046              MOVEM.L D0-D1/A0,-(A7)
00002430                          2047              
00002430  4281                    2048              CLR.L   D1
00002432  103C 0051               2049              MOVE.B  #81,D0
00002436  4E4F                    2050              TRAP    #15
00002438                          2051              
00002438  41F9 00002466           2052              LEA     .TXT1,A0
0000243E  103C 000A               2053              MOVE.B  #10,D0
00002442  4EB8 200C               2054              JSR     UTLPRINT
00002446                          2055              
00002446  0839 0004 000025B7      2056              BTST.B  #4,(SCRCYCCT)
0000244E  6700 0010               2057              BEQ     .DONE
00002452                          2058              
00002452  41F9 0000246F           2059              LEA     .TXT2,A0
00002458  103C 0019               2060              MOVE.B  #25,D0
0000245C  4EB8 200C               2061              JSR     UTLPRINT
00002460                          2062              
00002460  4CDF 0103               2063  .DONE       MOVEM.L (A7)+,D0-D1/A0
00002464                          2064  
00002464  4E75                    2065              RTS
00002466= 59 4F 55 20 57 4F ...   2066  .TXT1       DC.B    'YOU WON!',0
0000246F= 50 52 45 53 53 20 ...   2067  .TXT2       DC.B    'PRESS FIRE1 TO CONTINUE',0
00002488                          2068              DS.W    0
00002488                          2069  
00002488                          2070  
00002488                          2071  
00002488                          2072  -------------------- end include --------------------
00002488                          2073              INCLUDE "GOVER.X68"
00002488                          2074  ; ==============================================================================
00002488                          2075  ; GAME OVER SCREEN
00002488                          2076  ; ==============================================================================
00002488                          2077  
00002488                          2078  ; ------------------------------------------------------------------------------
00002488                          2079  GOVINIT
00002488                          2080  ; GAME OVER SCREEN INIT
00002488                          2081  ; INPUT    : NONE
00002488                          2082  ; OUTPUT   : NONE
00002488                          2083  ; MODIFIES : NONE
00002488                          2084  ; ------------------------------------------------------------------------------
00002488  4E75                    2085              RTS
0000248A                          2086  
0000248A                          2087  ; ------------------------------------------------------------------------------
0000248A                          2088  GOVUPD
0000248A                          2089  ; GAME OVER SCREEN UPDATE
0000248A                          2090  ; INPUT    : NONE
0000248A                          2091  ; OUTPUT   : NONE
0000248A                          2092  ; MODIFIES : NONE
0000248A                          2093  ; ------------------------------------------------------------------------------
0000248A  4E75                    2094              RTS
0000248C                          2095  
0000248C                          2096  ; ------------------------------------------------------------------------------
0000248C                          2097  GOVPLOT
0000248C                          2098  ; GAME OVER SCREEN PLOT
0000248C                          2099  ; INPUT    : NONE
0000248C                          2100  ; OUTPUT   : NONE
0000248C                          2101  ; MODIFIES : NONE
0000248C                          2102  ; ------------------------------------------------------------------------------
0000248C  48E7 C080               2103              MOVEM.L D0-D1/A0,-(A7)
00002490                          2104              
00002490  4281                    2105              CLR.L   D1
00002492  103C 0051               2106              MOVE.B  #81,D0
00002496  4E4F                    2107              TRAP    #15
00002498                          2108              
00002498  41F9 000024C6           2109              LEA     .TXT1,A0
0000249E  103C 000A               2110              MOVE.B  #10,D0
000024A2  4EB8 200C               2111              JSR     UTLPRINT
000024A6                          2112              
000024A6  0839 0004 000025B7      2113              BTST.B  #4,(SCRCYCCT)
000024AE  6700 0010               2114              BEQ     .DONE
000024B2                          2115              
000024B2  41F9 000024D0           2116              LEA     .TXT2,A0
000024B8  103C 0019               2117              MOVE.B  #25,D0
000024BC  4EB8 200C               2118              JSR     UTLPRINT
000024C0                          2119              
000024C0  4CDF 0103               2120  .DONE       MOVEM.L (A7)+,D0-D1/A0
000024C4                          2121  
000024C4  4E75                    2122              RTS
000024C6= 47 41 4D 45 20 4F ...   2123  .TXT1       DC.B    'GAME OVER',0
000024D0= 50 52 45 53 53 20 ...   2124  .TXT2       DC.B    'PRESS FIRE1 TO CONTINUE',0
000024E8                          2125              DS.W    0
000024E8                          2126  
000024E8                          2127  
000024E8                          2128  -------------------- end include --------------------
000024E8                          2129              INCLUDE "STATES.X68"
000024E8                          2130  ; =============================================================================
000024E8                          2131  ; GAME STATE MANAGEMENT
000024E8                          2132  ; =============================================================================
000024E8                          2133  
000024E8                          2134  ; -----------------------------------------------------------------------------
000024E8                          2135  STAINIT
000024E8                          2136  ; INITALIZES THE STATE MANAGER
000024E8                          2137  ; INPUT    - NONE
000024E8                          2138  ; OUTPUT   - NONE
000024E8                          2139  ; MODIFIES - NONE
000024E8                          2140  ; -----------------------------------------------------------------------------
000024E8  33FC FFFF 00003464      2141              MOVE.W  #STANONE,(STACUR)
000024F0  4279 00003466           2142              CLR.W   (STANEXT)
000024F6  4E75                    2143              RTS
000024F8                          2144  
000024F8                          2145  ; -----------------------------------------------------------------------------
000024F8                          2146  STAUPD
000024F8                          2147  ; PERFORMS STATE UPDATE AND INIT IF NECESSARY
000024F8                          2148  ; INPUT    - NONE
000024F8                          2149  ; OUTPUT   - NONE
000024F8                          2150  ; MODIFIES - NONE
000024F8                          2151  ; -----------------------------------------------------------------------------
000024F8  48E7 8080               2152              MOVEM.L D0/A0,-(A7)
000024FC  4280                    2153              CLR.L   D0
000024FE  3039 00003466           2154              MOVE.W  (STANEXT),D0
00002504  B079 00003464           2155              CMP.W   (STACUR),D0
0000250A  6700 0012               2156              BEQ     .DOUPD
0000250E  33C0 00003464           2157              MOVE.W  D0,(STACUR)             ; IF STATE CHANGED, DO INIT
00002514  E588                    2158              LSL.L   #2,D0
00002516  2040                    2159              MOVE.L  D0,A0
00002518  2068 2536               2160              MOVE.L  .INITBL(A0),A0
0000251C  4E90                    2161              JSR     (A0)
0000251E  4280                    2162  .DOUPD      CLR.L   D0                      ; IN ANY CASE, DO UPDATE
00002520  3039 00003464           2163              MOVE.W  (STACUR),D0
00002526  E588                    2164              LSL.L   #2,D0
00002528  2040                    2165              MOVE.L  D0,A0
0000252A  2068 253A               2166              MOVE.L  .UPDTBL(A0),A0
0000252E  4E90                    2167              JSR     (A0)
00002530  4CDF 0101               2168              MOVEM.L (A7)+,D0/A0
00002534  4E75                    2169              RTS
00002536                          2170  .INITBL     ;DC.L    ISCINIT
00002536= 00002560                2171              DC.L    GAMINIT
0000253A                          2172  .UPDTBL     ;DC.L    ISCUPD
0000253A= 00002570                2173              DC.L    GAMUPD
0000253E                          2174  
0000253E                          2175  ; -----------------------------------------------------------------------------
0000253E                          2176  STAPLOT
0000253E                          2177  ; PERFORMS STATE PLOT
0000253E                          2178  ; INPUT    - NONE
0000253E                          2179  ; OUTPUT   - NONE
0000253E                          2180  ; MODIFIES - NONE
0000253E                          2181  ; -----------------------------------------------------------------------------
0000253E  48E7 8080               2182              MOVEM.L D0/A0,-(A7)
00002542  4280                    2183              CLR.L   D0
00002544  3039 00003464           2184              MOVE.W  (STACUR),D0
0000254A  E588                    2185              LSL.L   #2,D0
0000254C  2040                    2186              MOVE.L  D0,A0
0000254E  2068 255A               2187              MOVE.L  .PLTTBL(A0),A0
00002552  4E90                    2188              JSR     (A0)
00002554  4CDF 0101               2189              MOVEM.L (A7)+,D0/A0
00002558  4E75                    2190              RTS
0000255A                          2191  .PLTTBL     ;DC.L    ISCPLOT
0000255A= 00002578                2192              DC.L    GAMPLOT
0000255E                          2193  
0000255E                          2194  ; -----------------------------------------------------------------------------
0000255E                          2195  STAEMPTY
0000255E                          2196  ; EMPTY SUBROUTINE FOR CASES WITH NOTHING TO DO
0000255E                          2197  ; INPUT    - NONE
0000255E                          2198  ; OUTPUT   - NONE
0000255E                          2199  ; MODIFIES - NONE
0000255E                          2200  ; NOTE     - JUST A PLACEHOLDER. NOTHING TO DO.
0000255E                          2201  ; -----------------------------------------------------------------------------
0000255E  4E75                    2202              RTS
00002560                          2203  
00002560                          2204  
00002560                          2205  
00002560                          2206  
00002560                          2207  
00002560                          2208  
00002560                          2209  
00002560                          2210  
00002560                          2211  
00002560                          2212  
00002560                          2213  -------------------- end include --------------------
00002560                          2214              INCLUDE "GAME.X68"
00002560                          2215  ; ==============================================================================
00002560                          2216  ; GAME MANAGEMENT
00002560                          2217  ; ==============================================================================
00002560                          2218  
00002560                          2219  ; ------------------------------------------------------------------------------
00002560                          2220  GAMINIT
00002560                          2221  ; INITIALIZES GAME.
00002560                          2222  ; INPUT    : NONE
00002560                          2223  ; OUTPUT   : NONE
00002560                          2224  ; MODIFIES : NONE
00002560                          2225  ; ------------------------------------------------------------------------------
00002560  4EB8 16C2               2226              JSR     PMINIT
00002564  4EB8 1E58               2227              JSR     MAPINIT
00002568  4EB8 1408               2228              JSR     GSTINIT
0000256C  6000 F51A               2229              BRA     SCOINIT
00002570                          2230  
00002570                          2231  ; ------------------------------------------------------------------------------
00002570                          2232  GAMUPD
00002570                          2233  ; UPDATES THE GAME
00002570                          2234  ; INPUT    : NONE
00002570                          2235  ; OUTPUT   : NONE
00002570                          2236  ; MODIFIES : NONE
00002570                          2237  ; ------------------------------------------------------------------------------
00002570                          2238              
00002570  4EB8 143A               2239              JSR     GSTUPD
00002574  6000 F180               2240              BRA     PMUPD
00002578                          2241              
00002578                          2242  ; ------------------------------------------------------------------------------
00002578                          2243  GAMPLOT
00002578                          2244  ; PLOTS THE GAME
00002578                          2245  ; INPUT    : NONE
00002578                          2246  ; OUTPUT   : NONE
00002578                          2247  ; MODIFIES : NONE
00002578                          2248  ; ------------------------------------------------------------------------------
00002578  4EB8 1ED2               2249              JSR     MAPPLOT
0000257C  4EB8 1A98               2250              JSR     SCOPLOT
00002580  4EB8 1862               2251              JSR     PMPLOT
00002584  6000 F0D2               2252              BRA     GSTPLOT
00002588                          2253  
00002588                          2254  
00002588                          2255  
00002588                          2256  -------------------- end include --------------------
00002588                          2257        
00002588                          2258              
00002588                          2259      
00002588                          2260  START:
00002588                          2261  
00002588                          2262  ;--- INITIALIZATION -----------------------------------------------------------
00002588                          2263  
00002588  007C 0700               2264              ORI.W   #$0700,SR               ;DISABLE INTERRUPTIONS
0000258C                          2265  
0000258C  4EB8 1B04               2266              JSR     SYSINIT
00002590  4EB8 24E8               2267              JSR     STAINIT
00002594                          2268  
00002594                          2269  .LOOP
00002594                          2270  
00002594                          2271  ; --- UPDATE -------------------------------------------------------------------
00002594                          2272  
00002594                          2273  ; READ INPUT DEVICES
00002594                          2274  
00002594  4E41                    2275              TRAP    #1
00002596                          2276  
00002596                          2277  ; UPDATE GAME LOGIC
00002596                          2278  
00002596  4EB8 24F8               2279             JSR     STAUPD
0000259A                          2280  
0000259A                          2281  ; --- SYNC ---------------------------------------------------------------------
0000259A                          2282              ;WHILE THERES NO INTERRUPTS IN THE COUNTER THE PROGRAM WILL BE IN
0000259A                          2283              ;THE BUCLE
0000259A                          2284              
0000259A  4A39 000025B6           2285  .WAITINIT   TST.B   (SCRINTCT)
000025A0  67F8                    2286              BEQ     .WAITINIT
000025A2  4239 000025B6           2287              CLR.B   (SCRINTCT)
000025A8                          2288  
000025A8                          2289  ; --- PLOT ---------------------------------------------------------------------
000025A8                          2290              
000025A8  4EB8 253E               2291              JSR     STAPLOT
000025AC                          2292              
000025AC                          2293              
000025AC  4E40                    2294              TRAP    #0                      ;CHANGE BUFFER
000025AE                          2295  
000025AE  60E4                    2296              BRA     .LOOP
000025B0                          2297  
000025B0  FFFF FFFF               2298              SIMHALT  
000025B4                          2299             
000025B4                          2300              INCLUDE "SYSVARS.X68"
000025B4                          2301  ; ==============================================================================
000025B4                          2302  ; SYSTEM VARIABLES
000025B4                          2303  ; ==============================================================================
000025B4                          2304   
000025B4                          2305  ; --- KEYBOARD RELATED VARIABLES -----------------------------------------------
000025B4                          2306  
000025B4                          2307  KBDVAL      DS.B    1                       ; KEY STATE
000025B5                          2308  KBDEDGE     DS.B    1                       ; KEY EDGE
000025B6                          2309              DS.W    0 
000025B6                          2310  
000025B6                          2311  ; --- TIMED INTERRUPT RELATED VARIABLES ----------------------------------------
000025B6                          2312  
000025B6                          2313  SCRINTCT    DS.B    1                       ; INTERRUPT COUNTER
000025B7                          2314  SCRCYCCT    DS.B    1                       ; CYCLE COUNTER
000025B8                          2315              DS.W    0        
000025B8                          2316              
000025B8                          2317  ; --- MAP RELATED VARIABLE -----------------------------------------------------
000025B8                          2318  
000025B8                          2319  MAPVAR      DS.B    1024
000029B8                          2320  
000029B8                          2321              DS.B    0
000029B8                          2322  
000029B8                          2323  POSCON      DS.W    1
000029BA                          2324  
000029BA                          2325  ; --- TITLE RELATED VARIABLE -----------------------------------------------------
000029BA                          2326  
000029BA                          2327  BUFFER      DS.B    2700
00003446                          2328              DS.B    0
00003446                          2329              
00003446                          2330  
00003446                          2331  
00003446                          2332  
00003446                          2333  
00003446                          2334  
00003446                          2335  
00003446                          2336  
00003446                          2337  -------------------- end include --------------------
00003446                          2338              INCLUDE "VARS.X68"
00003446                          2339  ; ==============================================================================
00003446                          2340  ; GAME VARIABLES
00003446                          2341  ; ==============================================================================
00003446                          2342  
00003446                          2343  ; --- PAC-MAN RELATED VARIABLES ------------------------------------------------
00003446                          2344  
00003446                          2345  PMPOSX      DS.W    1                       ; PM X COORDINATE
00003448                          2346  PMPOSY      DS.W    1                       ; PM Y COORDINATE
0000344A                          2347  PMVELX      DS.W    1                       ; PM X VELOCITY
0000344C                          2348  PMVELY      DS.W    1                       ; PM Y VELOCITY
0000344E                          2349  PMEAT       DS.B    1                       ; PM BOOLEAN EAT GST
0000344F                          2350  PMLAMO      DS.B    1                       ; PM SAVE LAST MOVEMENT X O Y
00003450                          2351              DS.B    0
00003450                          2352  
00003450                          2353  ; --- GHOST RELATED VARIABLES --------------------------------------------------
00003450                          2354  
00003450                          2355  GSTPOSX     DS.W    1                       ; GST X COORDINATE
00003452                          2356  GSTPOSY     DS.W    1                       ; GST Y COORDINATE
00003454                          2357  GSTVELX     DS.W    1                       ; GST X VELOCITY
00003456                          2358  GSTVELY     DS.W    1                       ; GST Y VELOCITY
00003458                          2359  GSTDEAD     DS.B    1                       ; GST BOOLEAN DEAD
00003459                          2360  GSTLAMO     DS.B    1                       ; GST LAST MOVEMENT (X OR Y)
0000345A                          2361  GSTINRNG    DS.B    1                       ; GST IS IN RANGE
0000345B                          2362  GSTTARG     DS.B    1                       ; GST TARGET (0-PACMAN, 1-RANDOM)
0000345C                          2363  GSTPOSMV    DS.B    1                       ; GST POSSIBLE MOVEMENTS (R,L,U,D)
0000345D                          2364  GSTCHDIR    DS.B    1                       ; GST HAS CHANGED DIR IN LAST FRAME
0000345E                          2365              DS.B    0
0000345E                          2366  
0000345E                          2367  ; --- SCOREBOARD RELATED VARIABLES ---------------------------------------------
0000345E                          2368  
0000345E                          2369  SCOLIFE     DS.W    1                       ; NUMBER OF LIFES
00003460                          2370  SCOPOINTS   DS.W    1                       ; NUMBER OF POINTS
00003462                          2371  
00003462                          2372  ; --- INTRO STATE RELATED VARIABLES --------------------------------------------
00003462                          2373  
00003462                          2374  ISCTIMER    DS.W    1                       ; INTRO TIMER
00003464                          2375  
00003464                          2376  ; --- STATE RELATED VARIABLES --------------------------------------------------
00003464                          2377  
00003464                          2378  STACUR      DS.W    1                       ; CURRENT STATE
00003466                          2379  STANEXT     DS.W    1                       ; NEXT STATE
00003468                          2380  
00003468                          2381  
00003468                          2382  
00003468                          2383  
00003468                          2384  
00003468                          2385  
00003468                          2386  
00003468                          2387  
00003468                          2388  
00003468                          2389  
00003468                          2390  -------------------- end include --------------------
00003468                          2391              INCLUDE "LIB/UTLVARS.X68"
00003468                          2392  ; =============================================================================
00003468                          2393  ; UTILITY VARIABLES
00003468                          2394  ; =============================================================================
00003468                          2395  
00003468                          2396  UTLRNDIX    DS.B    1                       ; NEXT INDEX TO RANDOM NUMBER
0000346A                          2397              DS.W    0
0000346A                          2398  -------------------- end include --------------------
0000346A                          2399              
0000346A                          2400              END    START        

No errors detected
No warnings generated


SYMBOL TABLE INFORMATION
Symbol-name         Value
-------------------------
BUCLE_COLUMNA       1E7E
BUCLE_COLUMNA2      1EF4
BUCLE_COLUMNA3      222E
BUCLE_FILA          1E72
BUCLE_FILA2         1EE8
BUCLE_FILA3         2224
BUFFER              29BA
COLWALLDOWN         1C84
COLWALLLEFT         1C42
COLWALLRIGHT        1C00
COLWALLUP           1CC0
DIBFIGBPOINT        1FBA
DIBFIGPOINT         1F7E
DIBFIGWALL          1F46
DRAW                2256
FILENAME            1AFA
FILESIZE            A8C
GAMINIT             2560
GAMPLOT             2578
GAMUPD              2570
GETPOINTS           1DE4
GETPOINTS:BPOINT    1E2E
GETPOINTS:DONE      1E52
GETPOINTS:POINT     1E40
GOVINIT             2488
GOVPLOT             248C
GOVPLOT:DONE        24C0
GOVPLOT:TXT1        24C6
GOVPLOT:TXT2        24D0
GOVUPD              248A
GSTCHDIR            345D
GSTCOL1             FF
GSTCOL2             FF0080
GSTCOL3             FFFF00
GSTCOL4             80FF
GSTCOL5             800000
GSTCOLWALLDOWN      1D76
GSTCOLWALLLEFT      1D3A
GSTCOLWALLRIGHT     1CFE
GSTCOLWALLUP        1DAC
GSTDEAD             3458
GSTDECVEC           1000
GSTFCOL1            FFFFFF
GSTFCOL2            0
GSTFCOL3            0
GSTFCOL4            0
GSTFCOL5            0
GSTINIT             1408
GSTINRNG            345A
GSTINX1             2
GSTINX2             2
GSTINX3             1F
GSTINX4             1F
GSTINY1             2
GSTINY2             1F
GSTINY3             2
GSTINY4             1F
GSTLAMO             3459
GSTPLOT             1658
GSTPOSMV            345C
GSTPOSX             3450
GSTPOSY             3452
GSTRAD              8
GSTRNG              10
GSTSPEED            2
GSTSPEED2           5
GSTTARG             345B
GSTUPD              143A
GSTUPD:GSTDECISSION  1504
GSTUPD:GSTDONE      164C
GSTUPD:GSTDOWNMOVE  1604
GSTUPD:GSTINRNG     1464
GSTUPD:GSTLEFTMOVE  15D0
GSTUPD:GSTMOVE      1470
GSTUPD:GSTMULT      149E
GSTUPD:GSTMULTDOWN  14D8
GSTUPD:GSTMULTLEFT  14C2
GSTUPD:GSTMULTRIGHT  14AC
GSTUPD:GSTMULTUP    14EE
GSTUPD:GSTNOTCOLISION  15AE
GSTUPD:GSTNOTCOLISION2  15E2
GSTUPD:GSTNOTCOLISION3  1616
GSTUPD:GSTNOTCOLISION4  163A
GSTUPD:GSTNOTINRNG  1450
GSTUPD:GSTNOTMULT   1574
GSTUPD:GSTNOTTP     15BE
GSTUPD:GSTNOTTP2    15F2
GSTUPD:GSTRANDOWN   1558
GSTUPD:GSTRANLEFT   154A
GSTUPD:GSTRANRIGHT  153C
GSTUPD:GSTRANUP     1566
GSTUPD:GSTRIGHTMOVE  159C
GSTUPD:GSTUPMOVE    1628
GSTVELX             3454
GSTVELY             3456
IMGPLOT             220E
INSINIT             228A
INSPLOT             228E
INSPLOT:DONE        22B2
INSPLOT:LOOP        22A4
INSPLOT:TXT1        22B8
INSPLOT:TXT2        22E2
INSPLOT:TXT3        2317
INSPLOT:TXT4        2344
INSPLOT:TXT5        235F
INSPLOT:TXT6        2392
INSPLOT:TXT7        2396
INSPLOT:TXT8        23C1
INSPLOT:TXT9        23DC
INSPLOT:TXTLST      2400
INSUPD              228C
ISCINIT             215C
ISCPLOT             2180
ISCPLOT:DONE        21AC
ISCPLOT:TXT1        21B2
ISCPLOT:TXT2        21C0
ISCTIMER            3462
ISCUPD              216A
ISCUPD:CONT         217E
ISCUPD:DONE         217E
KBDDOWN             28
KBDEDGE             25B5
KBDFIRE1            20
KBDFIRE2            4D
KBDFIRE3            10
KBDINIT             1B9C
KBDLEFT             25
KBDPAUSE            50
KBDRIGHT            27
KBDUP               26
KBDUPD              1BAA
KBDUPD:CONVERT      1BF2
KBDUPD:LOOP         1BF6
KBDUPD:NOACT        1BEC
KBDVAL              25B4
MAPINIT             1E58
MAPMAT              1008
MAPPLOT             1ED2
MAPVAR              25B8
NOTPOINT            1EB2
NOTPOINT2           1F26
NOTWALL             1EA4
NOTWALL2            1F18
OPENFILE            21DC
OPENFILE:CONVERT_LOOP  21FE
OPENFILE:END        220C
PMEAT               344E
PMFCOL              FFFF
PMINIT              16C2
PMLAMO              344F
PMPCOL              FFFF
PMPLOT              1862
PMPLOT:DDONE        191E
PMPLOT:DDOWN        18F0
PMPLOT:DLEFT        18E6
PMPLOT:DOWNDRAW     19DE
PMPLOT:DRAW_MOUTH1  18FA
PMPLOT:DRAW_MOUTH2  1904
PMPLOT:DRAW_MOUTH3  190E
PMPLOT:DRAW_MOUTH4  1918
PMPLOT:DRIGHT       18D2
PMPLOT:DUP          18DC
PMPLOT:FULLDRAW     1924
PMPLOT:LEFTDRAW     1948
PMPLOT:MOUTHOPEN    1890
PMPLOT:NOTMOVE      18C8
PMPLOT:RIGHTDRAW    197A
PMPLOT:SET_MOUTHDOWN  1A6A
PMPLOT:SET_MOUTHLEFT  1A10
PMPLOT:SET_MOUTHRIGHT  1A2E
PMPLOT:SET_MOUTHUP  1A4C
PMPLOT:UPDRAW       19AC
PMPOSX              3446
PMPOSY              3448
PMRAD               8
PMSPEED             2
PMUPD               16F6
PMUPD:ACTXLEFT      17BC
PMUPD:ACTXRIGHT     1788
PMUPD:ACTYDOWN      17F0
PMUPD:ACTYUP        1814
PMUPD:DONE          1850
PMUPD:NOTCOLISION   17A2
PMUPD:NOTCOLISION2  17D6
PMUPD:NOTCOLISION3  180A
PMUPD:NOTCOLISION4  182E
PMUPD:NOTDOWN       1784
PMUPD:NOTLEFT       1742
PMUPD:NOTMULT       1838
PMUPD:NOTRIGHT      1758
PMUPD:NOTTP         17B2
PMUPD:NOTTP2        17E6
PMUPD:NOTUP         176E
PMVELX              344A
PMVELY              344C
POSCON              29B8
SCOFCOL             0
SCOINIT             1A88
SCOLIFE             345E
SCOLINE1            101
SCOLINE2            102
SCOPLOT             1A98
SCOPLOT:TXT1        1AE6
SCOPLOT:TXT2        1AEF
SCOPOINTS           3460
SCRCYCCT            25B7
SCRHEIGH            280
SCRINIT             1B30
SCRINTCT            25B6
SCRTIM              1B8E
SCRUPD              1B74
SCRWIDTH            280
STACUR              3464
STAEMPTY            255E
STAINIT             24E8
STANEXT             3466
STANONE             FFFFFFFF
STAPLOT             253E
STAPLOT:PLTTBL      255A
START               2588
START:LOOP          2594
START:WAITINIT      259A
STAUPD              24F8
STAUPD:DOUPD        251E
STAUPD:INITBL       2536
STAUPD:UPDTBL       253A
SYSINIT             1B04
UTLCHRWD            8
UTLINIT             1FF6
UTLPRINT            200C
UTLPRINT:ENDLOOP    201E
UTLPRINT:LOOP       2014
UTLRAND             203E
UTLRAND:RANDVEC     205C
UTLRNDIX            3468
WININIT             2428
WINPLOT             242C
WINPLOT:DONE        2460
WINPLOT:TXT1        2466
WINPLOT:TXT2        246F
WINUPD              242A
ZERO                1EC0
ZERO2               1F34
ZERO3               2244
