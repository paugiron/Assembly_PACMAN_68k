000021BA Starting Address
Assembler used: EASy68K Editor/Assembler v5.16.01
Created On: 22/12/2022 0:43:18

00000000                             1  ; ==============================================================================
00000000                             2  ; TITLE       : PAC-MAN 68000
00000000                             3  ; DESCRIPTION : GAME IN MOTOROLA 68000 BASED ON PAC-MAN GAME
00000000                             4  ; AUTHOR      : JORDI FLORIT ENSENYAT
00000000                             5  ;               JOSEP GABRIEL FORNES REYNES
00000000                             6  ;               PAU GIRON RODRIGUEZ
00000000                             7  ; ==============================================================================
00001000                             8              ORG    $1000
00001000                             9  
00001000                            10              INCLUDE "CONST.X68"
00001000                            11  ; ==============================================================================
00001000                            12  ; GAME CONSTANTS
00001000                            13  ; ==============================================================================
00001000                            14  
00001000                            15  ; --- PAC-MAN RELATED CONTANTS ----------------------------------------------------
00001000                            16  
00001000  =0000FFFF                 17  PMPCOL      EQU     $0000FFFF               ; PAC-MAN CONTOUR COLOR
00001000  =0000FFFF                 18  PMFCOL      EQU     $0000FFFF               ; PAC-MAN FILL COLOR
00001000  =00000002                 19  PMSPEED     EQU     2                       ; MAGNITUDE OF THE X AND Y VEL.
00001000  =00000008                 20  PMRAD       EQU     8                       ; PAC-MAN RADIUS
00001000                            21  
00001000                            22  ; --- GHOST RELATED CONSTANTS ----------------------------------------------------
00001000                            23  
00001000  =00000007                 24  GSTSPEED    EQU     7                       ; MAGNITUDE OF THE NORMAL DISPLACEMENT
00001000  =00000005                 25  GSTSPEED2   EQU     5                       ; MAGNITUDE OF THE ATACKED DISPLACEMENT
00001000                            26  
00001000  =000000FF                 27  GSTCOL1     EQU     $000000FF               ; GHOST 1 CONTOUR COLOR RED
00001000  =00FFFFFF                 28  GSTFCOL1    EQU     $00FFFFFF               ; GHOST 1 FILL COLOR WHITE
00001000  =00000002                 29  GSTINX1     EQU     2                       ; GHOST 1 INITIAL X
00001000  =00000002                 30  GSTINY1     EQU     2                       ; GHOST 1 INITIAL Y
00001000                            31  
00001000  =00FF0080                 32  GSTCOL2     EQU     $00FF0080               ; GHOST 2 CONTOUR COLOR PINK
00001000  =00000000                 33  GSTFCOL2    EQU     $00000000               ; GHOST 1 FILL COLOR
00001000  =00000002                 34  GSTINX2     EQU     2                       ; GHOST 2 INITIAL X
00001000  =0000001F                 35  GSTINY2     EQU     31                      ; GHOST 2 INITIAL Y
00001000                            36  
00001000  =00FFFF00                 37  GSTCOL3     EQU     $00FFFF00               ; GHOST 3 CONTOUR COLOR CYAN
00001000  =00000000                 38  GSTFCOL3    EQU     $00000000               ; GHOST 3 FILL COLOR
00001000  =0000001F                 39  GSTINX3     EQU     31                      ; GHOST 3 INITIAL X
00001000  =00000002                 40  GSTINY3     EQU     2                       ; GHOST 3 INITIAL Y
00001000                            41  
00001000  =000080FF                 42  GSTCOL4     EQU     $000080FF               ; GHOST 4 CONTOUR COLOR ORANGE
00001000  =00000000                 43  GSTFCOL4    EQU     $00000000               ; GHOST 4 FILL COLOR
00001000  =0000001F                 44  GSTINX4     EQU     31                      ; GHOST 4 INITIAL X
00001000  =0000001F                 45  GSTINY4     EQU     31                      ; GHOST 4 INITIAL Y 
00001000                            46  
00001000  =00800000                 47  GSTCOL5     EQU     $00800000               ; CONTOUR COLOR OF ATACKED MODE
00001000  =00000000                 48  GSTFCOL5    EQU     $00000000               ; FILL COLOR OF ATACKED MODE
00001000                            49  
00001000  =00000008                 50  GSTRAD      EQU     8                       ; GHOST RADIUS
00001000  =00000010                 51  GSTRNG      EQU     16                      ; GHOST DETECTING RANGE
00001000                            52              
00001000                            53  ; --- SCOREBOARD RELATED CONSTANTS ---------------------------------------------
00001000                            54  ;MODIFICATE
00001000                            55  
00001000  =00000000                 56  SCOFCOL     EQU     $00000000               ; TEXT BACKGROUND COLOR
00001000  =00000101                 57  SCOLINE1    EQU     $0101                   ; FIRST TEXT LINE COORDINATES
00001000  =00000102                 58  SCOLINE2    EQU     $0102                   ; SECOND TEXT LINE COORDINATES
00001000                            59  
00001000                            60  ; --- MAP RELATED CONSTANTS ----------------------------------------------------
00001000                            61  
00001000= 01 01 01 01 01 01 ...     62  MAPMAT      DC.B    $1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
00001020= 01 02 02 02 02 02 ...     63              DC.B    $1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1
00001040= 01 02 01 01 01 01 ...     64              DC.B    $1,2,1,1,1,1,1,2,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,2,1,1,1,1,1,2,1
00001060= 01 03 01 01 01 01 ...     65              DC.B    $1,3,1,1,1,1,1,2,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,2,1,1,1,1,1,3,1
00001080= 01 02 02 02 02 02 ...     66              DC.B    $1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1
000010A0= 01 02 01 01 01 01 ...     67              DC.B    $1,2,1,1,1,1,1,2,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,2,1,1,1,1,1,2,1
000010C0= 01 02 01 01 01 01 ...     68              DC.B    $1,2,1,1,1,1,1,2,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,2,1,1,1,1,1,2,1
000010E0= 01 02 02 02 02 02 ...     69              DC.B    $1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1
00001100= 01 02 01 01 01 01 ...     70              DC.B    $1,2,1,1,1,1,1,2,1,1,1,2,1,1,1,1,1,1,1,1,2,1,1,1,2,1,1,1,1,1,2,1
00001120= 01 02 01 00 00 00 ...     71              DC.B    $1,2,1,0,0,0,1,2,1,0,1,2,1,1,1,1,1,1,1,1,2,1,0,1,2,1,0,0,0,1,2,1
00001140= 01 02 01 01 01 01 ...     72              DC.B    $1,2,1,1,1,1,1,2,1,0,1,2,2,2,2,1,1,2,2,2,2,1,0,1,2,1,1,1,1,1,2,1
00001160= 01 02 02 02 02 02 ...     73              DC.B    $1,2,2,2,2,2,2,2,1,0,1,1,1,1,2,1,1,2,1,1,1,1,0,1,2,2,2,2,2,2,2,1
00001180= 01 01 01 01 01 01 ...     74              DC.B    $1,1,1,1,1,1,1,2,1,0,1,1,1,1,2,1,1,2,1,1,1,1,0,1,2,1,1,1,1,1,1,1
000011A0= 01 00 00 00 00 00 ...     75              DC.B    $1,0,0,0,0,0,1,2,1,0,1,0,0,0,0,0,0,0,0,0,0,1,0,1,2,1,0,0,0,0,0,1
000011C0= 01 00 00 00 00 00 ...     76              DC.B    $1,0,0,0,0,0,1,2,1,0,1,0,1,1,1,0,0,1,1,1,0,1,0,1,2,1,0,0,0,0,0,1
000011E0= 01 01 01 01 01 01 ...     77              DC.B    $1,1,1,1,1,1,1,2,1,1,1,0,1,0,0,0,0,0,0,1,0,1,1,1,2,1,1,1,1,1,1,1
00001200= 04 00 00 00 00 00 ...     78              DC.B    $4,0,0,0,0,0,0,2,2,2,2,0,1,0,0,0,0,0,0,1,0,2,2,2,2,0,0,0,0,0,0,4
00001220= 01 01 01 01 01 01 ...     79              DC.B    $1,1,1,1,1,1,1,2,1,1,1,0,1,0,0,0,0,0,0,1,0,1,1,1,2,1,1,1,1,1,1,1
00001240= 01 00 00 00 00 00 ...     80              DC.B    $1,0,0,0,0,0,1,2,1,0,1,0,1,1,1,1,1,1,1,1,0,1,0,1,2,1,0,0,0,0,0,1
00001260= 01 00 00 00 00 00 ...     81              DC.B    $1,0,0,0,0,0,1,2,1,0,1,0,0,0,0,0,0,0,0,0,0,1,0,1,2,1,0,0,0,0,0,1
00001280= 01 01 01 01 01 01 ...     82              DC.B    $1,1,1,1,1,1,1,2,1,1,1,0,1,1,1,1,1,1,1,1,0,1,1,1,2,1,1,1,1,1,1,1
000012A0= 01 02 02 02 02 02 ...     83              DC.B    $1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1
000012C0= 01 02 01 01 01 01 ...     84              DC.B    $1,2,1,1,1,1,1,2,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,2,1,1,1,1,1,2,1
000012E0= 01 02 01 01 01 01 ...     85              DC.B    $1,2,1,1,1,1,1,2,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,2,1,1,1,1,1,2,1
00001300= 01 02 02 02 02 01 ...     86              DC.B    $1,2,2,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,2,2,2,1
00001320= 01 01 01 01 02 01 ...     87              DC.B    $1,1,1,1,2,1,1,2,1,1,1,2,1,1,1,1,1,1,1,1,2,1,1,1,2,1,1,2,1,1,1,1
00001340= 01 01 01 01 02 01 ...     88              DC.B    $1,1,1,1,2,1,1,2,1,0,1,2,1,1,1,1,1,1,1,1,2,1,0,1,2,1,1,2,1,1,1,1
00001360= 01 02 02 02 02 02 ...     89              DC.B    $1,2,2,2,2,2,2,2,1,0,1,2,2,2,2,1,1,2,2,2,2,1,0,1,2,2,2,2,2,2,2,1
00001380= 01 02 01 01 01 01 ...     90              DC.B    $1,2,1,1,1,1,1,1,1,0,1,1,1,1,2,1,1,2,1,1,1,1,0,1,1,1,1,1,1,1,2,1
000013A0= 01 03 01 01 01 01 ...     91              DC.B    $1,3,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,3,1
000013C0= 01 02 02 02 02 02 ...     92              DC.B    $1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1
000013E0= 01 01 01 01 01 01 ...     93              DC.B    $1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
00001400                            94              
00001400                            95  ; --- STATE RELATED CONSTANTS --------------------------------------------------
00001400                            96  
00001400  =FFFFFFFF                 97  STANONE     EQU     -1                      ; NON-EXISTENT STATE NUMBER
00001400                            98  
00001400                            99  
00001400                           100  
00001400                           101  
00001400                           102  
00001400                           103  
00001400                           104  
00001400                           105  
00001400                           106  
00001400                           107  
00001400                           108  
00001400                           109  
00001400                           110  
00001400                           111  
00001400                           112  
00001400                           113  
00001400                           114  
00001400                           115  
00001400                           116  
00001400                           117  
00001400                           118  
00001400                           119  
00001400                           120  
00001400                           121  -------------------- end include --------------------
00001400                           122              INCLUDE "GHOST.X68"
00001400                           123  ; ==============================================================================
00001400                           124  ; GHOST MANAGEMENT
00001400                           125  ; ==============================================================================
00001400                           126              
00001400                           127  ; ------------------------------------------------------------------------------
00001400                           128  GSTINIT
00001400                           129  ; INITIALIZE GHOST.
00001400                           130  ; INPUT    : NONE 
00001400                           131  ; OUTPUT   : NONE
00001400                           132  ; MODIFIES : NONE
00001400                           133  ; ------------------------------------------------------------------------------
00001400  33FC 0058 00002612       134              MOVE.W  #GSTINX1*16+64-8,(GSTPOSX)
00001408  33FC 0058 00002614       135              MOVE.W  #GSTINY1*16+64-8,(GSTPOSY)
00001410  33FC 0007 00002616       136              MOVE.W  #GSTSPEED,(GSTVELX)
00001418  33FC 0007 00002618       137              MOVE.W  #GSTSPEED,(GSTVELY)
00001420  4239 0000261B            138              CLR.B   (GSTLAMO)
00001426  4E75                     139              RTS
00001428                           140              
00001428                           141  ; ------------------------------------------------------------------------------
00001428                           142  GSTUPD
00001428                           143  ; UPDATES THE GHOST.
00001428                           144  ; INPUT    : NONE 
00001428                           145  ; OUTPUT   : NONE
00001428                           146  ; MODIFIES : NONE
00001428                           147  ; ------------------------------------------------------------------------------
00001428  48E7 F800                148              MOVEM.L D0-D4,-(A7)
0000142C                           149              
0000142C  303C 0007                150              MOVE.W  #GSTSPEED,D0
00001430                           151              
00001430  3439 00002612            152              MOVE.W  (GSTPOSX),D2
00001436  3639 00002614            153              MOVE.W  (GSTPOSY),D3
0000143C  5042                     154              ADDQ.W  #8,D2
0000143E  5043                     155              ADDQ.W  #8,D3
00001440                           156              
00001440  1839 0000261B            157              MOVE.B  (GSTLAMO),D4
00001446                           158              
00001446                           159              ;MASK OF THE LAST NIBBLE
00001446  C47C 000F                160              AND.W   #$000F,D2
0000144A  C67C 000F                161              AND.W   #$000F,D3
0000144E                           162              
0000144E                           163              ;CHECK IF COORDS ARE MULTIPLES OF 16
0000144E  B47C 0000                164              CMP     #$0000,D2
00001452  6600 000A                165              BNE     .GSTNOTMULT
00001456  B67C 0000                166              CMP     #$0000,D3
0000145A  6600 0002                167              BNE     .GSTNOTMULT
0000145E                           168              
0000145E                           169  .GSTNOTMULT
0000145E                           170  
0000145E  4CDF 001F                171              MOVEM.L (A7)+,D0-D4
00001462                           172              
00001462  4E75                     173              RTS
00001464                           174              
00001464                           175  ; ------------------------------------------------------------------------------
00001464                           176  GSTPLOT
00001464                           177  ; PLOT THE GHOST.
00001464                           178  ; INPUT    : NONE 
00001464                           179  ; OUTPUT   : NONE
00001464                           180  ; MODIFIES : NONE
00001464                           181  ; ------------------------------------------------------------------------------
00001464  48E7 F800                182              MOVEM.L D0-D4,-(A7)
00001468                           183              
00001468                           184              ;SET PEN COLOR
00001468  303C 0050                185              MOVE.W  #80,D0
0000146C  223C 000000FF            186              MOVE.L  #GSTCOL1,D1
00001472  4E4F                     187              TRAP    #15
00001474                           188              
00001474                           189              ;SET FILL COLOR
00001474  303C 0051                190              MOVE.W  #81,D0
00001478  223C 00FFFFFF            191              MOVE.L  #GSTFCOL1,D1
0000147E  4E4F                     192              TRAP    #15
00001480                           193              
00001480                           194              ;SET COORDS
00001480  3239 00002612            195              MOVE.W  (GSTPOSX),D1
00001486  5141                     196              SUB.W   #GSTRAD,D1
00001488  3439 00002614            197              MOVE.W  (GSTPOSY),D2
0000148E  5142                     198              SUB.W   #GSTRAD,D2
00001490                           199              
00001490  3601                     200              MOVE.W  D1,D3
00001492  0643 0010                201              ADD.W   #GSTRAD*2,D3
00001496  3802                     202              MOVE.W  D2,D4
00001498  0644 0010                203              ADD.W   #GSTRAD*2,D4
0000149C                           204              
0000149C                           205              ;DRAW GHOST
0000149C  303C 0058                206              MOVE.W  #88,D0
000014A0  4E4F                     207              TRAP    #15
000014A2                           208              
000014A2                           209              ;SET RANGE COORDS
000014A2  3239 00002612            210              MOVE.W  (GSTPOSX),D1
000014A8  0441 0100                211              SUB.W   #GSTRNG*16,D1
000014AC  3439 00002614            212              MOVE.W  (GSTPOSY),D2
000014B2  0442 0100                213              SUB.W   #GSTRNG*16,D2
000014B6                           214              
000014B6  3601                     215              MOVE.W  D1,D3
000014B8  0643 0200                216              ADD.W   #GSTRNG*16*2,D3
000014BC  3802                     217              MOVE.W  D2,D4
000014BE  0644 0200                218              ADD.W   #GSTRNG*16*2,D4
000014C2                           219              
000014C2                           220              ;DRAW GHOST RANGE
000014C2  303C 005B                221              MOVE.W  #91,D0
000014C6  4E4F                     222              TRAP    #15
000014C8                           223              
000014C8  4CDF 001F                224              MOVEM.L (A7)+,D0-D4
000014CC                           225              
000014CC                           226  
000014CC  4E75                     227              RTS
000014CE                           228  
000014CE                           229  
000014CE                           230  -------------------- end include --------------------
000014CE                           231              INCLUDE "PAC-MAN.X68"
000014CE                           232  ; ==============================================================================
000014CE                           233  ; PAC-MAN MANAGEMENT
000014CE                           234  ; ==============================================================================
000014CE                           235              
000014CE                           236  ; ------------------------------------------------------------------------------
000014CE                           237  PMINIT
000014CE                           238  ; INITIALIZE PAC-MAN.
000014CE                           239  ; INPUT    : NONE 
000014CE                           240  ; OUTPUT   : NONE
000014CE                           241  ; MODIFIES : NONE
000014CE                           242  ; ------------------------------------------------------------------------------
000014CE                           243  
000014CE  33FC 0140 00002608       244              MOVE.W  #SCRWIDTH/2,(PMPOSX)
000014D6  33FC 0140 0000260A       245              MOVE.W  #SCRHEIGH/2,(PMPOSY)
000014DE  5079 00002608            246              ADDQ.W  #8,(PMPOSX)
000014E4  5079 0000260A            247              ADDQ.W  #8,(PMPOSY)
000014EA  33FC 0002 0000260C       248              MOVE.W  #PMSPEED,(PMVELX)
000014F2  33FC 0002 0000260E       249              MOVE.W  #PMSPEED,(PMVELY)
000014FA  4239 00002611            250              CLR.B   (PMLAMO)
00001500                           251  
00001500  4E75                     252              RTS
00001502                           253              
00001502                           254  ; ------------------------------------------------------------------------------
00001502                           255  PMUPD
00001502                           256  ; UPDATES THE PAC-MAN.
00001502                           257  ; INPUT    : NONE 
00001502                           258  ; OUTPUT   : NONE
00001502                           259  ; MODIFIES : NONE
00001502                           260  ; ------------------------------------------------------------------------------
00001502                           261              
00001502  48E7 FE00                262              MOVEM.L D0-D6,-(A7)
00001506                           263              
00001506  303C 0002                264              MOVE.W  #PMSPEED,D0
0000150A                           265              
0000150A                           266              
0000150A  3439 00002608            267              MOVE.W  (PMPOSX),D2
00001510  3639 0000260A            268              MOVE.W  (PMPOSY),D3
00001516                           269              
00001516  5042                     270              ADDQ.W  #8,D2              
00001518  5043                     271              ADDQ.W  #8,D3  
0000151A                           272              
0000151A  1839 00002611            273              MOVE.B  (PMLAMO),D4
00001520                           274              
00001520                           275              ;MASK OF THE LAST NIBBLE        
00001520  C47C 000F                276              AND.W   #$000F,D2               ; COORDENADA X
00001524  C67C 000F                277              AND.W   #$000F,D3               ; COORDENADA Y
00001528                           278              
00001528                           279              ;CHECK IF COORDS ARE MULTIPLES OF 16
00001528  B47C 0000                280              CMP     #$0000,D2
0000152C  6600 00F6                281              BNE     .NOTMULT
00001530  B67C 0000                282              CMP     #$0000,D3
00001534  6600 00EE                283              BNE     .NOTMULT
00001538                           284              
00001538                           285              ;BRA     .ACTYUP
00001538                           286  
00001538                           287              ;CHECK THE DIRECTION
00001538  0839 0000 00002202       288              BTST.B  #0,(KBDVAL)             ;CHECK LEFT
00001540  6700 000C                289              BEQ     .NOTLEFT
00001544  4204                     290              CLR.B   D4
00001546  183C 0000                291              MOVE.B  #0,D4
0000154A  6000 0074                292              BRA     .ACTXLEFT
0000154E                           293  .NOTLEFT            
0000154E  0839 0002 00002202       294              BTST.B   #2,(KBDVAL)             ;CHECK RIGHT
00001556  6700 000C                295              BEQ     .NOTRIGHT
0000155A  4204                     296              CLR.B   D4
0000155C  183C 0001                297              MOVE.B   #1,D4
00001560  6000 0032                298              BRA     .ACTXRIGHT
00001564                           299  .NOTRIGHT            
00001564  0839 0001 00002202       300              BTST.B   #1,(KBDVAL)             ;CHECK UP
0000156C  6700 000C                301              BEQ     .NOTUP
00001570  4204                     302              CLR.B   D4
00001572  183C 0002                303              MOVE.B  #2,D4
00001576  6000 0090                304              BRA     .ACTYUP
0000157A                           305  .NOTUP            
0000157A  0839 0003 00002202       306              BTST.B   #3,(KBDVAL)             ;CHECK DOWN
00001582  6700 000C                307              BEQ     .NOTDOWN
00001586  4204                     308              CLR.B   D4
00001588  183C 0003                309              MOVE.B   #3,D4
0000158C  6000 005E                310              BRA     .ACTYDOWN
00001590                           311  .NOTDOWN
00001590  6000 00A8                312              BRA     .DONE
00001594                           313              
00001594                           314              
00001594                           315              ;UPDATE COORDS
00001594                           316              
00001594                           317  .ACTXRIGHT  
00001594  4EB9 000019B0            318              JSR     COLWALLRIGHT
0000159A  BA7C 0001                319              CMP     #1,D5
0000159E  6600 0006                320              BNE     .NOTCOLISION
000015A2  303C 0000                321              MOVE.W  #0,D0
000015A6                           322  .NOTCOLISION
000015A6  BA7C 0004                323              CMP     #4,D5
000015AA  6600 000A                324              BNE     .NOTTP
000015AE  0479 01E0 00002608       325              SUB.W   #30*16,(PMPOSX)
000015B6                           326  .NOTTP
000015B6  D179 00002608            327              ADD.W   D0,(PMPOSX)
000015BC  6000 007C                328              BRA     .DONE
000015C0                           329  .ACTXLEFT
000015C0  4EB9 000019F2            330              JSR     COLWALLLEFT
000015C6  BA7C 0001                331              CMP     #1,D5
000015CA  6600 0006                332              BNE     .NOTCOLISION2
000015CE  303C 0000                333              MOVE.W  #0,D0
000015D2                           334  .NOTCOLISION2
000015D2  BA7C 0004                335              CMP     #4,D5
000015D6  6600 000A                336              BNE     .NOTTP2
000015DA  0679 01E0 00002608       337              ADD.W   #30*16,(PMPOSX)
000015E2                           338  .NOTTP2
000015E2  9179 00002608            339              SUB.W   D0,(PMPOSX)
000015E8  6000 0050                340              BRA     .DONE
000015EC                           341      
000015EC                           342  .ACTYDOWN
000015EC  4EB9 00001A34            343              JSR     COLWALLDOWN
000015F2  BA7C 0001                344              CMP     #1,D5
000015F6  6600 0006                345              BNE     .NOTCOLISION3
000015FA  303C 0000                346              MOVE.W  #0,D0
000015FE                           347  .NOTCOLISION3
000015FE  D179 0000260A            348              ADD.W   D0,(PMPOSY)
00001604  6000 0034                349              BRA     .DONE
00001608                           350  .ACTYUP     
00001608  4EB9 00001A70            351              JSR     COLWALLUP
0000160E  BA7C 0001                352              CMP     #1,D5
00001612  6600 0006                353              BNE     .NOTCOLISION4
00001616  303C 0000                354              MOVE.W  #0,D0
0000161A                           355  .NOTCOLISION4
0000161A  9179 0000260A            356              SUB.W   D0,(PMPOSY)
00001620  6000 0018                357              BRA     .DONE
00001624                           358              
00001624                           359              
00001624                           360              ;IF NOT MULT DO
00001624                           361  .NOTMULT     
00001624  B83C 0000                362              CMP.B     #0,D4
00001628  6796                     363              BEQ     .ACTXLEFT
0000162A  B83C 0001                364              CMP.B     #1,D4
0000162E  6700 FF64                365              BEQ     .ACTXRIGHT
00001632  B83C 0002                366              CMP.B     #2,D4
00001636  67D0                     367              BEQ     .ACTYUP
00001638  60B2                     368              BRA     .ACTYDOWN
0000163A                           369  .DONE
0000163A                           370              ;RESTORE
0000163A  4EB9 00001AAE            371              JSR     GETPOINTS
00001640  13C4 00002611            372              MOVE.B  D4,(PMLAMO)
00001646                           373              
00001646  4CDF 007F                374              MOVEM.L (A7)+,D0-D6
0000164A                           375              
0000164A  4E75                     376              RTS
0000164C                           377                          
0000164C                           378  ; ------------------------------------------------------------------------------
0000164C                           379  PMPLOT
0000164C                           380  ; PLOT THE BALL.
0000164C                           381  ; INPUT    : NONE 
0000164C                           382  ; OUTPUT   : NONE
0000164C                           383  ; MODIFIES : NONE
0000164C                           384  ; ------------------------------------------------------------------------------
0000164C                           385  
0000164C  48E7 F800                386              MOVEM.L D0-D4,-(A7)
00001650                           387  
00001650                           388              ;SET PEN COLOR
00001650  303C 0050                389              MOVE.W  #80,D0
00001654  7200                     390              MOVE.L  #$0000,D1
00001656  4E4F                     391              TRAP    #15
00001658                           392              
00001658                           393              ;SET FILL COLOR
00001658  303C 0051                394              MOVE.W  #81,D0
0000165C  223C 0000FFFF            395              MOVE.L  #PMFCOL,D1
00001662  4E4F                     396              TRAP    #15
00001664                           397              
00001664                           398              ;DRAW QUIET
00001664  4EB9 000016EC            399              JSR     .FULLDRAW
0000166A                           400              
0000166A                           401              ;CHECK KBDVAL
0000166A  0839 0000 00002202       402              BTST.B  #0,(KBDVAL)             ;LEFT
00001672  6700 0026                403              BEQ     .DLEFT
00001676  0839 0001 00002202       404              BTST.B  #1,(KBDVAL)             :UP
0000167E  6700 0024                405              BEQ     .DUP
00001682  0839 0002 00002202       406              BTST.B  #2,(KBDVAL)             ;RIGHT
0000168A  6700 0022                407              BEQ     .DRIGHT
0000168E  0839 0003 00002202       408              BTST.B  #3,(KBDVAL)             ;DOWN
00001696  6700 0020                409              BEQ     .DDOWN
0000169A                           410              
0000169A                           411              ;DRAW MOVEMENT
0000169A                           412  .DLEFT
0000169A  4EB9 00001710            413              JSR     .LEFTDRAW
000016A0  6000 0020                414              BRA     .DRAW_MOUTH1
000016A4                           415  .DUP
000016A4  4EB9 00001774            416              JSR     .UPDRAW
000016AA  6000 0020                417              BRA     .DRAW_MOUTH2
000016AE                           418  
000016AE                           419  .DRIGHT
000016AE  4EB9 00001742            420              JSR     .RIGHTDRAW
000016B4  6000 0020                421              BRA     .DRAW_MOUTH3
000016B8                           422  
000016B8                           423  .DDOWN
000016B8  4EB9 000017A6            424              JSR     .DOWNDRAW
000016BE  6000 0020                425              BRA     .DRAW_MOUTH4
000016C2                           426              
000016C2                           427  .DRAW_MOUTH1            
000016C2  4EB9 000017D8            428              JSR     .SET_MOUTHLEFT
000016C8  6000 001C                429              BRA     .DDONE
000016CC                           430  .DRAW_MOUTH2            
000016CC  4EB9 00001814            431              JSR     .SET_MOUTHUP
000016D2  6000 0012                432              BRA     .DDONE
000016D6                           433  .DRAW_MOUTH3            
000016D6  4EB9 000017F6            434              JSR     .SET_MOUTHRIGHT
000016DC  6000 0008                435              BRA     .DDONE
000016E0                           436  .DRAW_MOUTH4            
000016E0  4EB9 00001832            437              JSR     .SET_MOUTHDOWN
000016E6                           438  .DDONE
000016E6  4CDF 001F                439              MOVEM.L (A7)+,D0-D4
000016EA                           440              
000016EA  4E75                     441              RTS
000016EC                           442  
000016EC                           443  
000016EC                           444  ;INTERNAL SUBRUTINES FOR PACMAN PLOT-------------------------------------------------------------
000016EC                           445  
000016EC                           446  .FULLDRAW
000016EC                           447              ;SET COORDS
000016EC  3239 00002608            448              MOVE.W  (PMPOSX),D1
000016F2  5141                     449              SUB.W   #PMRAD,D1
000016F4  3439 0000260A            450              MOVE.W  (PMPOSY),D2
000016FA  5142                     451              SUB.W   #PMRAD,D2
000016FC                           452              
000016FC  3601                     453              MOVE.W  D1,D3
000016FE  0643 0010                454              ADD.W   #PMRAD*2,D3
00001702  3802                     455              MOVE.W  D2,D4
00001704  0644 0010                456              ADD.W   #PMRAD*2,D4
00001708                           457              
00001708                           458              ;DRAW PAC-MAN
00001708  303C 0058                459              MOVE.W  #88,D0
0000170C  4E4F                     460              TRAP    #15
0000170E                           461              
0000170E  4E75                     462              RTS
00001710                           463  .LEFTDRAW
00001710                           464              
00001710                           465              
00001710  303C 0054                466              MOVE.W  #84,D0
00001714  3239 00002608            467              MOVE.W  (PMPOSX),D1                   ;FINAL COORD OF THE FIRST LINE
0000171A  5141                     468              SUB.W   #PMRAD,D1
0000171C  3439 0000260A            469              MOVE.W  (PMPOSY),D2
00001722  5142                     470              SUB.W   #PMRAD,D2
00001724                           471              
00001724  3639 00002608            472              MOVE.W  (PMPOSX),D3                   ;ORIGINAL COORD FIRST LINE
0000172A  3839 0000260A            473              MOVE.W  (PMPOSY),D4
00001730                           474              
00001730  4E4F                     475              TRAP    #15
00001732                           476             
00001732  303C 0055                477              MOVE.W  #85,D0                        ;DRAW SECOND LINE
00001736                           478              
00001736  3203                     479              MOVE.W  D3,D1
00001738  3404                     480              MOVE.W  D4,D2
0000173A  5042                     481              ADD.W   #PMRAD,D2
0000173C  5141                     482              SUB.W   #PMRAD,D1
0000173E                           483              
0000173E  4E4F                     484              TRAP    #15
00001740                           485              
00001740                           486              
00001740  4E75                     487              RTS
00001742                           488              
00001742                           489  .RIGHTDRAW
00001742                           490              
00001742                           491              
00001742  303C 0054                492              MOVE.W  #84,D0
00001746  3239 00002608            493              MOVE.W  (PMPOSX),D1                   ;FINAL COORD OF THE FIRST LINE
0000174C  5041                     494              ADD.W   #PMRAD,D1
0000174E  3439 0000260A            495              MOVE.W  (PMPOSY),D2
00001754  5042                     496              ADD.W   #PMRAD,D2
00001756                           497              
00001756  3639 00002608            498              MOVE.W  (PMPOSX),D3                   ;ORIGINAL COORD FIRST LINE
0000175C  3839 0000260A            499              MOVE.W  (PMPOSY),D4
00001762                           500              
00001762  4E4F                     501              TRAP    #15
00001764                           502             
00001764  303C 0055                503              MOVE.W  #85,D0                        ;DRAW SECOND LINE
00001768                           504              
00001768  3203                     505              MOVE.W  D3,D1
0000176A  3404                     506              MOVE.W  D4,D2
0000176C  5042                     507              ADD.W   #PMRAD,D2
0000176E  5041                     508              ADD.W   #PMRAD,D1
00001770                           509              
00001770  4E4F                     510              TRAP    #15
00001772                           511              
00001772                           512              
00001772  4E75                     513              RTS
00001774                           514  .UPDRAW
00001774                           515              
00001774                           516              
00001774  303C 0054                517              MOVE.W  #84,D0
00001778  3239 00002608            518              MOVE.W  (PMPOSX),D1                   ;FINAL COORD OF THE FIRST LINE
0000177E  5141                     519              SUB.W   #PMRAD,D1
00001780  3439 0000260A            520              MOVE.W  (PMPOSY),D2
00001786  5142                     521              SUB.W   #PMRAD,D2
00001788                           522              
00001788  3639 00002608            523              MOVE.W  (PMPOSX),D3                   ;ORIGINAL COORD FIRST LINE
0000178E  3839 0000260A            524              MOVE.W  (PMPOSY),D4
00001794                           525              
00001794  4E4F                     526              TRAP    #15
00001796                           527             
00001796  303C 0055                528              MOVE.W  #85,D0                        ;DRAW SECOND LINE
0000179A                           529              
0000179A  3203                     530              MOVE.W  D3,D1
0000179C  3404                     531              MOVE.W  D4,D2
0000179E  5142                     532              SUB.W   #PMRAD,D2
000017A0  5041                     533              ADD.W   #PMRAD,D1
000017A2                           534              
000017A2  4E4F                     535              TRAP    #15
000017A4                           536              
000017A4                           537              
000017A4  4E75                     538              RTS
000017A6                           539              
000017A6                           540  .DOWNDRAW
000017A6                           541              
000017A6                           542              
000017A6  303C 0054                543              MOVE.W  #84,D0
000017AA  3239 00002608            544              MOVE.W  (PMPOSX),D1                   ;FINAL COORD OF THE FIRST LINE
000017B0  5141                     545              SUB.W   #PMRAD,D1
000017B2  3439 0000260A            546              MOVE.W  (PMPOSY),D2
000017B8  5142                     547              SUB.W   #PMRAD,D2
000017BA                           548              
000017BA  3639 00002608            549              MOVE.W  (PMPOSX),D3                   ;ORIGINAL COORD FIRST LINE
000017C0  3839 0000260A            550              MOVE.W  (PMPOSY),D4
000017C6                           551              
000017C6  4E4F                     552              TRAP    #15
000017C8                           553             
000017C8  303C 0055                554              MOVE.W  #85,D0                        ;DRAW SECOND LINE
000017CC                           555              
000017CC  3203                     556              MOVE.W  D3,D1
000017CE  3404                     557              MOVE.W  D4,D2
000017D0  5042                     558              ADD.W   #PMRAD,D2
000017D2  5041                     559              ADD.W   #PMRAD,D1
000017D4                           560              
000017D4  4E4F                     561              TRAP    #15
000017D6                           562              
000017D6                           563              
000017D6  4E75                     564              RTS
000017D8                           565  
000017D8                           566              
000017D8                           567  .SET_MOUTHLEFT
000017D8                           568              
000017D8  303C 0051                569              MOVE.W  #81,D0                         ;SET BLACK
000017DC  7200                     570              MOVE.L  #$0000,D1
000017DE  4E4F                     571              TRAP    #15
000017E0                           572              
000017E0  303C 0059                573              MOVE.W  #89,D0                         ;FILL
000017E4  3239 00002608            574              MOVE.W  (PMPOSX),D1
000017EA  5541                     575              SUBQ.W   #2,D1
000017EC  3439 0000260A            576              MOVE.W  (PMPOSY),D2
000017F2  4E4F                     577              TRAP    #15
000017F4                           578  
000017F4  4E75                     579              RTS
000017F6                           580              
000017F6                           581  .SET_MOUTHRIGHT
000017F6                           582              
000017F6  303C 0051                583              MOVE.W  #81,D0                         ;SET BLACK
000017FA  7200                     584              MOVE.L  #$0000,D1
000017FC  4E4F                     585              TRAP    #15
000017FE                           586              
000017FE  303C 0059                587              MOVE.W  #89,D0                         ;FILL
00001802  3239 00002608            588              MOVE.W  (PMPOSX),D1
00001808  5441                     589              ADDQ.W   #2,D1
0000180A  3439 0000260A            590              MOVE.W  (PMPOSY),D2
00001810  4E4F                     591              TRAP    #15
00001812                           592  
00001812  4E75                     593              RTS
00001814                           594  
00001814                           595  .SET_MOUTHUP
00001814                           596              
00001814  303C 0051                597              MOVE.W  #81,D0                         ;SET BLACK
00001818  7200                     598              MOVE.L  #$0000,D1
0000181A  4E4F                     599              TRAP    #15
0000181C                           600              
0000181C  303C 0059                601              MOVE.W  #89,D0                         ;FILL
00001820  3239 00002608            602              MOVE.W  (PMPOSX),D1
00001826  3439 0000260A            603              MOVE.W  (PMPOSY),D2
0000182C  5542                     604              SUBQ.W   #2,D2
0000182E  4E4F                     605              TRAP    #15
00001830                           606  
00001830  4E75                     607              RTS
00001832                           608  
00001832                           609  .SET_MOUTHDOWN
00001832                           610              
00001832  303C 0051                611              MOVE.W  #81,D0                         ;SET BLACK
00001836  7200                     612              MOVE.L  #$0000,D1
00001838  4E4F                     613              TRAP    #15
0000183A                           614              
0000183A  303C 0059                615              MOVE.W  #89,D0                         ;FILL
0000183E  3239 00002608            616              MOVE.W  (PMPOSX),D1
00001844  3439 0000260A            617              MOVE.W  (PMPOSY),D2
0000184A  5442                     618              ADDQ.W   #2,D2
0000184C  4E4F                     619              TRAP    #15
0000184E                           620  
0000184E  4E75                     621              RTS
00001850                           622  
00001850                           623  
00001850                           624  
00001850                           625  
00001850                           626  
00001850                           627  
00001850                           628  
00001850                           629  
00001850                           630  
00001850                           631  
00001850                           632  
00001850                           633  
00001850                           634  
00001850                           635  
00001850                           636  
00001850                           637  
00001850                           638  
00001850                           639  
00001850                           640  
00001850                           641  
00001850                           642  
00001850                           643  
00001850                           644  
00001850                           645  
00001850                           646  
00001850                           647  
00001850                           648  -------------------- end include --------------------
00001850                           649              INCLUDE "SCORE.X68"
00001850                           650  ; ==============================================================================
00001850                           651  ; SCOREBOARD MANAGEMENT
00001850                           652  ; ==============================================================================
00001850                           653              
00001850                           654  ; ------------------------------------------------------------------------------
00001850                           655  SCOINIT
00001850                           656  ; INITIALIZE SCOREBOARD
00001850                           657  ; INPUT    : NONE 
00001850                           658  ; OUTPUT   : NONE
00001850                           659  ; MODIFIES : NONE
00001850                           660  ; ------------------------------------------------------------------------------
00001850  4279 0000261E            661              CLR.W   (SCOPOINTS)
00001856  33FC 0003 0000261C       662              MOVE.W  #3,(SCOLIFE)
0000185E  4E75                     663              RTS
00001860                           664              
00001860                           665  ; ------------------------------------------------------------------------------
00001860                           666  SCOPLOT
00001860                           667  ; PLOT THE SCOREBOARD
00001860                           668  ; INPUT    : NONE 
00001860                           669  ; OUTPUT   : NONE
00001860                           670  ; MODIFIES : NONE
00001860                           671  ; ------------------------------------------------------------------------------
00001860                           672              
00001860  48E7 C040                673               MOVEM.L D0-D1/A1,-(A7)
00001864                           674  
00001864                           675              ; SET BACKGROUND COLOR
00001864  103C 0051                676              MOVE.B  #81,D0
00001868  7200                     677              MOVE.L  #SCOFCOL,D1
0000186A  4E4F                     678              TRAP    #15
0000186C                           679              
0000186C                           680              ; SET FIRST LINE POSITION
0000186C  103C 000B                681              MOVE.B  #11,D0
00001870  323C 0101                682              MOVE.W  #SCOLINE1,D1
00001874  4E4F                     683              TRAP    #15
00001876                           684  
00001876                           685              ; PRINT FIRST LINE
00001876  43F9 000018AE            686              LEA     .TXT1,A1            ;PUT FIRST STRING IN A1
0000187C  4281                     687              CLR.L   D1
0000187E  3239 0000261E            688              MOVE.W  (SCOPOINTS),D1
00001884  103C 0011                689              MOVE.B  #17,D0
00001888  4E4F                     690              TRAP    #15
0000188A                           691  
0000188A                           692              ; SET SECOND LINE POSITION
0000188A  103C 000B                693              MOVE.B  #11,D0
0000188E  323C 0102                694              MOVE.W  #SCOLINE2,D1       
00001892  4E4F                     695              TRAP    #15
00001894                           696  
00001894                           697              ; PRINT SECOND LINE
00001894  43F9 000018B7            698              LEA     .TXT2,A1
0000189A  4281                     699              CLR.L   D1
0000189C  3239 0000261C            700              MOVE.W  (SCOLIFE),D1
000018A2  103C 0011                701              MOVE.B  #17,D0
000018A6  4E4F                     702              TRAP    #15
000018A8                           703              
000018A8  4CDF 0203                704              MOVEM.L (A7)+,D0-D1/A1
000018AC                           705              
000018AC  4E75                     706              RTS
000018AE                           707  
000018AE= 50 4F 49 4E 54 53 ...    708  .TXT1       DC.B    'POINTS :',0      ;0 IS END OF STRING
000018B7= 4C 49 46 45 53 20 ...    709  .TXT2       DC.B    'LIFES  :',0
000018C0                           710  
000018C0                           711  
000018C0  4E75                     712              RTS
000018C2                           713  
000018C2                           714  
000018C2                           715  -------------------- end include --------------------
000018C2                           716              INCLUDE "SYSCONST.X68"
000018C2                           717  ; ==============================================================================
000018C2                           718  ; SYSTEM CONSTANTS
000018C2                           719  ; ==============================================================================
000018C2                           720  
000018C2                           721  ; --- SCREEN RELATED CONSTANTS -------------------------------------------------
000018C2                           722  
000018C2  =00000280                723  SCRWIDTH    EQU     640                     ; SCREEN WIDTH
000018C2  =00000280                724  SCRHEIGH    EQU     640                     ; SCREEN HEIGHT
000018C2                           725  
000018C2                           726  ;---KEYCODES--------------------------------------------------------------------
000018C2                           727  
000018C2  =00000025                728  KBDLEFT     EQU     $25
000018C2  =00000026                729  KBDUP       EQU     $26
000018C2  =00000027                730  KBDRIGHT    EQU     $27
000018C2  =00000028                731  KBDDOWN     EQU     $28
000018C2  =00000020                732  KBDFIRE1    EQU     ' '
000018C2  =0000004D                733  KBDFIRE2    EQU     'M'                         
000018C2  =00000010                734  KBDFIRE3    EQU     $10
000018C2  =00000050                735  KBDPAUSE    EQU     'P'
000018C2                           736  
000018C2                           737  
000018C2                           738  
000018C2                           739  
000018C2                           740  
000018C2                           741  
000018C2                           742  
000018C2                           743  
000018C2                           744  
000018C2                           745  -------------------- end include --------------------
000018C2                           746              INCLUDE "SYSTEM.X68"
000018C2                           747  ; ==============================================================================
000018C2                           748  ; SYSTEM
000018C2                           749  ; ==============================================================================
000018C2                           750              
000018C2                           751  ; ------------------------------------------------------------------------------
000018C2                           752  SYSINIT
000018C2                           753  ; INITIALIZE SYSTEM.
000018C2                           754  ; INPUT    : NONE
000018C2                           755  ; OUTPUT   : NONE
000018C2                           756  ; MODIFIES : NONE
000018C2                           757  ; ------------------------------------------------------------------------------
000018C2                           758              
000018C2  21FC 00001932 0080       759              MOVE.L  #SCRUPD,($80+0*4)          ;INSTALL SUBRUTINE TO TRAP #0
000018CA  21FC 00001968 0084       760              MOVE.L  #KBDUPD,($80+1*4)          ;INSTALL SUBRUTINE TO TRAP #1
000018D2                           761              
000018D2                           762              
000018D2  21FC 0000194C 0064       763              MOVE.L  #SCRTIM,($60+1*4)          ;INSTALL INTERRUPT #1
000018DA                           764              
000018DA  4EB9 000018EE            765              JSR     SCRINIT
000018E0  4EB9 0000195A            766              JSR     KBDINIT
000018E6                           767              
000018E6                           768              
000018E6  40E7                     769              MOVE.W  SR,-(A7)
000018E8  0257 D8FF                770              ANDI.W  #$D8FF,(A7)                ;BIT SUPERVISOR TO O AND INTERRPUT MASK 000 (FOR REACTIVATE INTERRUPTIONS)             
000018EC  4E73                     771              RTE
000018EE                           772     
000018EE                           773  ; ------------------------------------------------------------------------------
000018EE                           774  SCRINIT
000018EE                           775  ; INIT SCREEN. SET SCREEN RESOLUTION, SET WINDOWED MODE, CLEAR SCREEN, ENABLE BUFFER
000018EE                           776  ; ENABLE TIMED INTERRUPTION
000018EE                           777  ; INPUT    : NONE
000018EE                           778  ; OUTPUT   : NONE
000018EE                           779  ; MODIFIES : NONE
000018EE                           780  ; ------------------------------------------------------------------------------
000018EE                           781  
000018EE  48E7 C000                782              MOVEM.L D0-D1,-(A7)                 ;SAFE REGISTERS IN STACK
000018F2                           783  
000018F2                           784              ; SET SCREEN RESOLUTION
000018F2  103C 0021                785              MOVE.B  #33,D0
000018F6  223C 02800280            786              MOVE.L  #SCRWIDTH<<16|SCRHEIGH,D1
000018FC  4E4F                     787              TRAP    #15
000018FE                           788              
000018FE                           789              ; SET WINDOWED MODE
000018FE  7201                     790              MOVE.L  #1,D1
00001900  4E4F                     791              TRAP    #15
00001902                           792              
00001902                           793              ; ENABLE DOUBLE BUFFER
00001902  103C 005C                794              MOVE.B  #92,D0
00001906  123C 0011                795              MOVE.B  #17,D1
0000190A  4E4F                     796              TRAP    #15
0000190C                           797              
0000190C                           798              ; CLEAR SCREEN
0000190C  103C 000B                799              MOVE.B  #11,D0
00001910  323C FF00                800              MOVE.W  #$FF00,D1
00001914  4E4F                     801              TRAP    #15
00001916                           802              
00001916                           803              ;ENABLE TIMED INTERRPUT
00001916  303C 0020                804              MOVE.W  #32,D0
0000191A  123C 0006                805              MOVE.B  #6,D1
0000191E  143C 0081                806              MOVE.B  #$81,D2                   ;INDICATE THAT INTERRUPT 1 IS ACTIVATED PERIODICALLY
00001922  7614                     807              MOVE.L  #20,D3                    ;INDICATE THE MILISECONDS FOR THAT PERIOD (20 ms == 50 FPS)
00001924  4E4F                     808              TRAP    #15
00001926                           809              
00001926                           810              ;CLEAR INTERRUPT COUNTER
00001926  4239 00002204            811              CLR.B   (SCRINTCT)
0000192C                           812              
0000192C  4CDF 0003                813              MOVEM.L (A7)+,D0-D1               ;RESTORE REGISTERS FROM STACK
00001930                           814              
00001930  4E75                     815              RTS
00001932                           816  
00001932                           817  
00001932                           818              
00001932                           819  ;------------------------------------------------------------------------------            
00001932                           820  SCRUPD
00001932                           821  ; UPDATES DOUBLE BUFFER
00001932                           822  ; INPUT    : NONE
00001932                           823  ; OUTPUT   : NONE
00001932                           824  ; MODIFIES : NONE
00001932                           825  ; ------------------------------------------------------------------------------
00001932                           826  
00001932  48E7 C000                827              MOVEM.L D0-D1,-(A7)
00001936                           828              
00001936                           829              ;SWITCH BUFFERS
00001936  103C 005E                830              MOVE.B #94,D0
0000193A  4E4F                     831              TRAP #15
0000193C                           832              
0000193C                           833              ;CLEAR HIDDEN BUFFER
0000193C  103C 000B                834              MOVE.B  #11,D0
00001940  323C FF00                835              MOVE.W  #$FF00,D1
00001944  4E4F                     836              TRAP    #15
00001946                           837              
00001946  4CDF 0003                838              MOVEM.L (A7)+,D0-D1
0000194A                           839              
0000194A  4E73                     840              RTE
0000194C                           841              
0000194C                           842  ; ------------------------------------------------------------------------------
0000194C                           843  SCRTIM
0000194C                           844  ; TIMED INTERRUPT SERVICE ROUTINE
0000194C                           845  ; INPUT    : NONE
0000194C                           846  ; OUTPUT   : NONE
0000194C                           847  ; MODIFIES : NONE
0000194C                           848  ; ------------------------------------------------------------------------------
0000194C  5239 00002204            849              ADDQ.B  #1,(SCRINTCT)
00001952  5239 00002205            850              ADDQ.B  #1,(SCRCYCCT)
00001958  4E73                     851              RTE
0000195A                           852              
0000195A                           853  ;------------------------------------------------------------------------------            
0000195A                           854  KBDINIT
0000195A                           855  ; INIT THE KEYBOARD
0000195A                           856  ; INPUT    : NONE
0000195A                           857  ; OUTPUT   : NONE
0000195A                           858  ; MODIFIES : NONE
0000195A                           859  ; ------------------------------------------------------------------------------
0000195A                           860  
0000195A  4239 00002202            861              CLR.B   (KBDVAL)
00001960  4239 00002203            862              CLR.B   (KBDEDGE)
00001966                           863  
00001966  4E75                     864              RTS
00001968                           865  
00001968                           866  ;------------------------------------------------------------------------------            
00001968                           867  KBDUPD
00001968                           868  ; UPDATES KEYBOARD INFO
00001968                           869  ; 3 -> DOWN
00001968                           870  ; 2 -> RIGHT
00001968                           871  ; 1 -> UP
00001968                           872  ; 0 -> LEFT
00001968                           873  ; ------------------------------------------------------------------------------
00001968                           874              
00001968  48E7 F800                875              MOVEM.L D0-D4,-(A7)
0000196C                           876              
0000196C  303C 0013                877              MOVE.W  #19,D0
00001970                           878              ;GET INFO OF THE KEYS
00001970  223C 28272625            879              MOVE.L  #KBDDOWN<<24|KBDRIGHT<<16|KBDUP<<8|KBDLEFT,D1
00001976  4E4F                     880              TRAP    #15
00001978                           881              
00001978                           882              ;CONVERT TO DESIRED FORMAT
00001978  4EB9 000019A2            883              JSR .CONVERT
0000197E                           884  
0000197E                           885              ;GET KBDEDGE (IF SOME KEY HAVE CHANGED THE VALUE)
0000197E  1039 00002202            886              MOVE.B  (KBDVAL),D0             ;D0 -> LAST KBDVAL
00001984  4600                     887              NOT.B   D0                      ;D2 -> ACTUAL KBDVAL
00001986  C002                     888              AND.B   D2,D0
00001988  13C0 00002203            889              MOVE.B  D0,(KBDEDGE)
0000198E                           890              
0000198E                           891         
0000198E  B03C 0000                892              CMP.B   #0,D0
00001992  6700 0008                893              BEQ     .NOACT          
00001996                           894              
00001996                           895              ;STORE NEW KBDVAL
00001996  13C2 00002202            896              MOVE.B  D2,(KBDVAL)
0000199C                           897  .NOACT
0000199C                           898              
0000199C  4CDF 001F                899              MOVEM.L (A7)+,D0-D4
000019A0                           900              
000019A0  4E73                     901              RTE    
000019A2                           902              
000019A2                           903  .CONVERT 
000019A2  363C 0003                904              MOVE.W  #3,D3
000019A6                           905              
000019A6  E189                     906  .LOOP       LSL.L   #8,D1
000019A8  E312                     907              ROXL.B  #1,D2
000019AA  51CB FFFA                908              DBRA.W  D3,.LOOP
000019AE  4E75                     909              RTS
000019B0                           910             
000019B0                           911  
000019B0                           912  ;------------------------------------------------------------------------------            
000019B0                           913  COLWALLRIGHT
000019B0                           914  ; COLLISION PAC-MAN WITH WALL
000019B0                           915  ; INPUT    : NONE
000019B0                           916  ; OUTPUT   : NONE
000019B0                           917  ; MODIFIES : NONE
000019B0                           918  ; ------------------------------------------------------------------------------
000019B0                           919  
000019B0  48E7 F800                920              MOVEM.L D0-D4,-(A7)
000019B4                           921  
000019B4  3039 00002608            922              MOVE.W  (PMPOSX),D0
000019BA  5140                     923              SUB.W   #8,D0
000019BC  3239 0000260A            924              MOVE.W  (PMPOSY),D1
000019C2  5041                     925              ADD.W   #8,D1
000019C4                           926              
000019C4  81FC 0010                927              DIVS.W  #16,D0
000019C8  83FC 0010                928              DIVS.W  #16,D1
000019CC                           929              
000019CC  5940                     930              SUB.W   #4,D0                   ;LI RESTAM 4 PERQUE LA MATRIU ESTA A UNA DISTANCIA DE 64 PIXELS DE LA PANTALLA
000019CE  5941                     931              SUB.W   #4,D1
000019D0                           932              
000019D0  41F9 00002206            933              LEA.L   MAPVAR,A0
000019D6                           934              
000019D6  5240                     935              ADD.W   #1,D0
000019D8  5341                     936              SUB.W   #1,D1
000019DA  C2FC 0020                937              MULU.W  #32,D1
000019DE  D041                     938              ADD.W   D1,D0
000019E0                           939              
000019E0  3240                     940              MOVE.W  D0,A1
000019E2  13C0 00002606            941              MOVE.B  D0,POSCON
000019E8                           942  
000019E8  1A29 2206                943              MOVE.B  MAPVAR(A1),D5
000019EC                           944              
000019EC  4CDF 001F                945              MOVEM.L (A7)+,D0-D4
000019F0                           946              
000019F0  4E75                     947              RTS
000019F2                           948  
000019F2                           949  
000019F2                           950  ;------------------------------------------------------------------------------            
000019F2                           951  COLWALLLEFT
000019F2                           952  ; COLLISION PAC-MAN WITH WALL
000019F2                           953  ; INPUT    : NONE
000019F2                           954  ; OUTPUT   : NONE
000019F2                           955  ; MODIFIES : NONE
000019F2                           956  ; ------------------------------------------------------------------------------
000019F2                           957  
000019F2  48E7 F800                958              MOVEM.L D0-D4,-(A7)
000019F6                           959  
000019F6  3039 00002608            960              MOVE.W  (PMPOSX),D0
000019FC  5C40                     961              ADD.W   #6,D0
000019FE  3239 0000260A            962              MOVE.W  (PMPOSY),D1
00001A04  5041                     963              ADD.W   #8,D1
00001A06                           964              
00001A06  81FC 0010                965              DIVS.W  #16,D0
00001A0A  83FC 0010                966              DIVS.W  #16,D1
00001A0E                           967              
00001A0E  5940                     968              SUB.W   #4,D0                   ;LI RESTAM 4 PERQUE LA MATRIU ESTA A UNA DISTANCIA DE 64 PIXELS DE LA PANTALLA
00001A10  5941                     969              SUB.W   #4,D1
00001A12                           970              
00001A12  41F9 00002206            971              LEA.L   MAPVAR,A0
00001A18                           972              
00001A18  5340                     973              SUB.W   #1,D0
00001A1A  5341                     974              SUB.W   #1,D1
00001A1C  C2FC 0020                975              MULU.W  #32,D1
00001A20  D041                     976              ADD.W   D1,D0
00001A22                           977  
00001A22  3240                     978              MOVE.W  D0,A1
00001A24  13C0 00002606            979              MOVE.B  D0,POSCON
00001A2A                           980  
00001A2A  1A29 2206                981              MOVE.B  MAPVAR(A1),D5               
00001A2E                           982  
00001A2E                           983              
00001A2E  4CDF 001F                984              MOVEM.L (A7)+,D0-D4
00001A32                           985              
00001A32  4E75                     986              RTS
00001A34                           987  
00001A34                           988  ;------------------------------------------------------------------------------            
00001A34                           989  COLWALLDOWN
00001A34                           990  ; COLLISION PAC-MAN WITH WALL
00001A34                           991  ; INPUT    : NONE
00001A34                           992  ; OUTPUT   : NONE
00001A34                           993  ; MODIFIES : NONE
00001A34                           994  ; ------------------------------------------------------------------------------
00001A34                           995  
00001A34  48E7 F800                996              MOVEM.L D0-D4,-(A7)
00001A38                           997  
00001A38  3039 00002608            998              MOVE.W  (PMPOSX),D0
00001A3E                           999              ;ADD.W   #8,D0
00001A3E  3239 0000260A           1000              MOVE.W  (PMPOSY),D1
00001A44  5041                    1001              ADD.W   #8,D1
00001A46                          1002              
00001A46  81FC 0010               1003              DIVS.W  #16,D0
00001A4A  83FC 0010               1004              DIVS.W  #16,D1
00001A4E                          1005              
00001A4E  5940                    1006              SUB.W   #4,D0                   ;LI RESTAM 4 PERQUE LA MATRIU ESTA A UNA DISTANCIA DE 64 PIXELS DE LA PANTALLA
00001A50  5941                    1007              SUB.W   #4,D1
00001A52                          1008              
00001A52  41F9 00002206           1009              LEA.L   MAPVAR,A0
00001A58                          1010              
00001A58  C2FC 0020               1011              MULU.W  #32,D1
00001A5C  D041                    1012              ADD.W   D1,D0
00001A5E                          1013  
00001A5E  3240                    1014              MOVE.W  D0,A1
00001A60  13C0 00002606           1015              MOVE.B  D0,POSCON
00001A66                          1016  
00001A66  1A29 2206               1017              MOVE.B  MAPVAR(A1),D5 
00001A6A                          1018  
00001A6A                          1019              
00001A6A  4CDF 001F               1020              MOVEM.L (A7)+,D0-D4
00001A6E                          1021              
00001A6E  4E75                    1022              RTS
00001A70                          1023  
00001A70                          1024  
00001A70                          1025  ;------------------------------------------------------------------------------            
00001A70                          1026  COLWALLUP
00001A70                          1027  ; COLLISION PAC-MAN WITH WALL
00001A70                          1028  ; INPUT    : NONE
00001A70                          1029  ; OUTPUT   : NONE
00001A70                          1030  ; MODIFIES : NONE
00001A70                          1031  ; ------------------------------------------------------------------------------
00001A70                          1032  
00001A70  48E7 F800               1033              MOVEM.L D0-D4,-(A7)
00001A74                          1034  
00001A74  3039 00002608           1035              MOVE.W  (PMPOSX),D0
00001A7A                          1036              ;SUB.W   #8,D0
00001A7A  3239 0000260A           1037              MOVE.W  (PMPOSY),D1
00001A80  5C41                    1038              ADD.W   #6,D1
00001A82                          1039              
00001A82                          1040              
00001A82  81FC 0010               1041              DIVS.W  #16,D0
00001A86  83FC 0010               1042              DIVS.W  #16,D1
00001A8A                          1043              
00001A8A  5940                    1044              SUB.W   #4,D0                   ;LI RESTAM 4 PERQUE LA MATRIU ESTA A UNA DISTANCIA DE 64 PIXELS DE LA PANTALLA
00001A8C  5941                    1045              SUB.W   #4,D1
00001A8E                          1046              
00001A8E  41F9 00002206           1047              LEA.L   MAPVAR,A0
00001A94                          1048              
00001A94  5341                    1049              SUB.W   #1,D1
00001A96                          1050              ;CMP     #1,D1
00001A96                          1051              ;BLO     BUCLE4
00001A96  C2FC 0020               1052              MULU.W  #32,D1
00001A9A  D041                    1053              ADD.W   D1,D0
00001A9C                          1054  
00001A9C                          1055  ;BUCLE4            
00001A9C  3240                    1056              MOVE.W  D0,A1
00001A9E  13C0 00002606           1057              MOVE.B  D0,POSCON
00001AA4                          1058  
00001AA4  1A29 2206               1059              MOVE.B  MAPVAR(A1),D5 
00001AA8                          1060  
00001AA8                          1061              ;MOVE.B  #0,D5
00001AA8                          1062              
00001AA8  4CDF 001F               1063              MOVEM.L (A7)+,D0-D4
00001AAC                          1064              
00001AAC  4E75                    1065              RTS
00001AAE                          1066  
00001AAE                          1067  
00001AAE                          1068  ;------------------------------------------------------------------------------            
00001AAE                          1069  GETPOINTS
00001AAE                          1070  ; COLLISION PAC-MAN WITH WALL
00001AAE                          1071  ; INPUT    : NONE
00001AAE                          1072  ; OUTPUT   : NONE
00001AAE                          1073  ; MODIFIES : NONE
00001AAE                          1074  ; ------------------------------------------------------------------------------
00001AAE                          1075  
00001AAE  48E7 F800               1076              MOVEM.L D0-D4,-(A7)
00001AB2                          1077  
00001AB2  3039 00002608           1078              MOVE.W  (PMPOSX),D0
00001AB8                          1079              ;SUB.W   #8,D0
00001AB8  3239 0000260A           1080              MOVE.W  (PMPOSY),D1
00001ABE  0641 0010               1081              ADD.W   #16,D1
00001AC2                          1082              
00001AC2                          1083              
00001AC2  81FC 0010               1084              DIVS.W  #16,D0
00001AC6  83FC 0010               1085              DIVS.W  #16,D1
00001ACA                          1086              
00001ACA  5940                    1087              SUB.W   #4,D0                   ;LI RESTAM 4 PERQUE LA MATRIU ESTA A UNA DISTANCIA DE 64 PIXELS DE LA PANTALLA
00001ACC  5941                    1088              SUB.W   #4,D1
00001ACE                          1089                          
00001ACE  5341                    1090              SUB.W   #1,D1
00001AD0  C2FC 0020               1091              MULU.W  #32,D1
00001AD4  D041                    1092              ADD.W   D1,D0
00001AD6                          1093  
00001AD6  3240                    1094              MOVE.W  D0,A1
00001AD8  1A29 2206               1095              MOVE.B  MAPVAR(A1),D5
00001ADC                          1096              
00001ADC  BA7C 0000               1097              CMP     #0,D5
00001AE0  6700 003A               1098              BEQ     .DONE
00001AE4  BA7C 0002               1099              CMP     #2,D5
00001AE8  6700 0020               1100              BEQ     .POINT
00001AEC  BA7C 0003               1101              CMP     #3,D5
00001AF0  6700 0006               1102              BEQ     .BPOINT
00001AF4  6600 0026               1103              BNE     .DONE
00001AF8                          1104  .BPOINT
00001AF8  137C 0000 2206          1105              MOVE.B  #0,MAPVAR(A1)
00001AFE  0679 0032 0000261E      1106              ADD.W   #50,(SCOPOINTS)
00001B06  6600 0014               1107              BNE     .DONE
00001B0A                          1108  .POINT
00001B0A  137C 0000 2206          1109              MOVE.B  #0,MAPVAR(A1)
00001B10  0679 000A 0000261E      1110              ADD.W   #10,(SCOPOINTS)
00001B18  6600 0002               1111              BNE     .DONE            
00001B1C                          1112  .DONE                        
00001B1C  4CDF 001F               1113              MOVEM.L (A7)+,D0-D4
00001B20                          1114              
00001B20  4E75                    1115              RTS
00001B22                          1116  
00001B22                          1117  
00001B22                          1118  
00001B22                          1119  
00001B22                          1120  -------------------- end include --------------------
00001B22                          1121              INCLUDE "MAP.X68"
00001B22                          1122  
00001B22                          1123  ; ------------------------------------------------------------------------------
00001B22                          1124  MAPINIT
00001B22                          1125  ; INIT MAP
00001B22                          1126  ; INPUT    : NONE
00001B22                          1127  ; OUTPUT   : NONE
00001B22                          1128  ; MODIFIES : NONE
00001B22                          1129  ; ------------------------------------------------------------------------------            
00001B22                          1130              
00001B22                          1131              ;MOVE.L  #DIBFIGWALL,($80+2*4)          ;INSTALL SUBRUTINE TO TRAP #2
00001B22                          1132              ;MOVE.L  #DIBFIGPOINT,($80+3*4)          ;INSTALL SUBRUTINE TO TRAP #3
00001B22                          1133              ;MOVE.L  #DIBFIGBPOINT,($80+4*4)          ;INSTALL SUBRUTINE TO TRAP #4
00001B22                          1134              
00001B22  48E7 FE00               1135              MOVEM.L D0-D6,-(A7)
00001B26  48E7 00C0               1136              MOVEM.L A0-A1,-(A7)
00001B2A                          1137              
00001B2A  41F8 1000               1138              LEA.L   MAPMAT,A0
00001B2E  43F9 00002206           1139              LEA.L   MAPVAR,A1
00001B34  3C3C 0030               1140              MOVE.W  #48,D6
00001B38  343C 001F               1141              MOVE.W  #31,D2
00001B3C                          1142  BUCLE_FILA
00001B3C  3A3C 0030               1143              MOVE.W  #48,D5
00001B40  323C 001F               1144              MOVE.W  #31,D1
00001B44  0646 0010               1145              ADD.W   #16,D6
00001B48                          1146  
00001B48                          1147  BUCLE_COLUMNA
00001B48  0645 0010               1148              ADD.W   #16,D5
00001B4C                          1149  
00001B4C  1018                    1150              MOVE.B  (A0)+,D0
00001B4E  12C0                    1151              MOVE.B  D0,(A1)+
00001B50                          1152               
00001B50  B07C 0000               1153              CMP     #0,D0
00001B54  6700 0034               1154              BEQ     ZERO
00001B58  B07C 0004               1155              CMP     #4,D0
00001B5C  6700 002C               1156              BEQ     ZERO
00001B60  B07C 0001               1157              CMP     #1,D0
00001B64  6600 0008               1158              BNE     NOTWALL
00001B68  4EB9 00001C10           1159              JSR     DIBFIGWALL
00001B6E                          1160  NOTWALL
00001B6E  B07C 0002               1161              CMP     #2,D0
00001B72  6600 0008               1162              BNE     NOTPOINT
00001B76  4EB9 00001C48           1163              JSR     DIBFIGPOINT
00001B7C                          1164  NOTPOINT
00001B7C  B07C 0003               1165              CMP     #3,D0
00001B80  6600 0008               1166              BNE     ZERO
00001B84  4EB9 00001C84           1167              JSR     DIBFIGBPOINT
00001B8A                          1168           
00001B8A                          1169  ZERO
00001B8A  51C9 FFBC               1170              DBRA    D1,BUCLE_COLUMNA  
00001B8E  51CA FFAC               1171              DBRA    D2,BUCLE_FILA
00001B92                          1172              
00001B92  4CDF 0300               1173              MOVEM.L (A7)+,A0-A1
00001B96  4CDF 007F               1174              MOVEM.L (A7)+,D0-D6
00001B9A                          1175  
00001B9A                          1176  
00001B9A                          1177              
00001B9A  4E75                    1178              RTS            
00001B9C                          1179  
00001B9C                          1180  ; ------------------------------------------------------------------------------
00001B9C                          1181  MAPPLOT
00001B9C                          1182  ; INIT MAP
00001B9C                          1183  ; INPUT    : NONE
00001B9C                          1184  ; OUTPUT   : NONE
00001B9C                          1185  ; MODIFIES : NONE
00001B9C                          1186  ; ------------------------------------------------------------------------------            
00001B9C                          1187  
00001B9C  48E7 FE00               1188              MOVEM.L D0-D6,-(A7)
00001BA0  48E7 0080               1189              MOVEM.L A0,-(A7)
00001BA4                          1190  
00001BA4  41F9 00002206           1191              LEA.L   MAPVAR,A0
00001BAA  3C3C 0030               1192              MOVE.W  #48,D6
00001BAE  343C 001F               1193              MOVE.W  #31,D2
00001BB2                          1194  BUCLE_FILA2
00001BB2  3A3C 0030               1195              MOVE.W  #48,D5
00001BB6  323C 001F               1196              MOVE.W  #31,D1
00001BBA  0646 0010               1197              ADD.W   #16,D6
00001BBE                          1198  
00001BBE                          1199  BUCLE_COLUMNA2
00001BBE  0645 0010               1200              ADD.W   #16,D5       
00001BC2                          1201  
00001BC2  1018                    1202              MOVE.B  (A0)+,D0
00001BC4                          1203  
00001BC4  B07C 0000               1204              CMP     #0,D0
00001BC8  6700 0034               1205              BEQ     ZERO2
00001BCC  B07C 0004               1206              CMP     #4,D0
00001BD0  6700 002C               1207              BEQ     ZERO2
00001BD4  B07C 0001               1208              CMP     #1,D0
00001BD8  6600 0008               1209              BNE     NOTWALL2
00001BDC  4EB9 00001C10           1210              JSR     DIBFIGWALL
00001BE2                          1211  NOTWALL2
00001BE2  B07C 0002               1212              CMP     #2,D0
00001BE6  6600 0008               1213              BNE     NOTPOINT2
00001BEA  4EB9 00001C48           1214              JSR     DIBFIGPOINT
00001BF0                          1215  NOTPOINT2
00001BF0  B07C 0003               1216              CMP     #3,D0
00001BF4  6600 0008               1217              BNE     ZERO2
00001BF8  4EB9 00001C84           1218              JSR     DIBFIGBPOINT
00001BFE                          1219  
00001BFE                          1220     
00001BFE                          1221  ZERO2
00001BFE  51C9 FFBE               1222              DBRA    D1,BUCLE_COLUMNA2
00001C02                          1223              
00001C02  51CA FFAE               1224              DBRA    D2,BUCLE_FILA2
00001C06                          1225              
00001C06  4CDF 0100               1226              MOVEM.L (A7)+,A0
00001C0A  4CDF 007F               1227              MOVEM.L (A7)+,D0-D6
00001C0E                          1228              
00001C0E                          1229              
00001C0E  4E75                    1230              RTS 
00001C10                          1231              
00001C10                          1232  ; -----------------------------------------------------------------------------
00001C10                          1233  DIBFIGWALL
00001C10                          1234  ; SUBRUTINE DRAW MAP
00001C10                          1235  ; INPUT    : D5=POSITION X, D6=POSITION Y
00001C10                          1236  ; OUTPUT   : NONE
00001C10                          1237  ; MODIFIES : NONE
00001C10                          1238  ; -----------------------------------------------------------------------------
00001C10  48E7 FE00               1239              MOVEM.L D0-D6,-(A7)
00001C14                          1240              ; SET CONTOURN COLOR
00001C14  103C 0050               1241              MOVE.B  #80,D0
00001C18  223C 00AA0000           1242              MOVE.L  #$00AA0000,D1
00001C1E  4E4F                    1243              TRAP    #15
00001C20                          1244              
00001C20                          1245              ; SET FILL COLOR
00001C20  103C 0051               1246              MOVE.B  #81,D0
00001C24  223C 00FF0000           1247              MOVE.L  #$00FF0000,D1
00001C2A  4E4F                    1248              TRAP    #15
00001C2C                          1249              
00001C2C                          1250              ; DEFINE COORDINATES RECTANGLE
00001C2C  3205                    1251              MOVE.W  D5,D1
00001C2E  3406                    1252              MOVE.W  D6,D2
00001C30  0645 0010               1253              ADD.W   #16,D5
00001C34  0646 0010               1254              ADD.W   #16,D6
00001C38  3605                    1255              MOVE.W  D5,D3
00001C3A  3806                    1256              MOVE.W  D6,D4
00001C3C                          1257              
00001C3C                          1258              ; DRAW RECTANGLE
00001C3C  103C 0057               1259              MOVE.B  #87,D0
00001C40  4E4F                    1260              TRAP    #15
00001C42                          1261              
00001C42  4CDF 007F               1262              MOVEM.L (A7)+,D0-D6
00001C46                          1263  
00001C46  4E75                    1264              RTS
00001C48                          1265              
00001C48                          1266  ; -----------------------------------------------------------------------------
00001C48                          1267  DIBFIGPOINT
00001C48                          1268  ; SUBRUTINE DRAW MAP
00001C48                          1269  ; INPUT    : D5=POSITION X, D6=POSITION Y
00001C48                          1270  ; OUTPUT   : NONE
00001C48                          1271  ; MODIFIES : NONE
00001C48                          1272  ; -----------------------------------------------------------------------------
00001C48  48E7 FE00               1273              MOVEM.L D0-D6,-(A7)
00001C4C                          1274              ; SET CONTOURN COLOR
00001C4C  103C 0050               1275              MOVE.B  #80,D0
00001C50  223C 0000AAAA           1276              MOVE.L  #$0000AAAA,D1
00001C56  4E4F                    1277              TRAP    #15
00001C58                          1278              
00001C58                          1279              ; SET FILL COLOR
00001C58  103C 0051               1280              MOVE.B  #81,D0
00001C5C  223C 0000FFFF           1281              MOVE.L  #$0000FFFF,D1
00001C62  4E4F                    1282              TRAP    #15
00001C64                          1283              
00001C64                          1284              ; DEFINE COORDINATES RECTANGLE
00001C64  3205                    1285              MOVE.W  D5,D1
00001C66  5041                    1286              ADD.W   #8,D1
00001C68  5541                    1287              SUB.W   #2,D1
00001C6A  3406                    1288              MOVE.W  D6,D2
00001C6C  5042                    1289              ADD.W   #8,D2
00001C6E  5542                    1290              SUB.W   #2,D2
00001C70                          1291              
00001C70  3601                    1292              MOVE.W  D1,D3
00001C72  5843                    1293              ADD.W   #2*2,D3
00001C74  3802                    1294              MOVE.W  D2,D4
00001C76  5844                    1295              ADD.W   #2*2,D4
00001C78                          1296              
00001C78                          1297              ; DRAW POINT
00001C78  103C 0058               1298              MOVE.B  #88,D0
00001C7C  4E4F                    1299              TRAP    #15
00001C7E                          1300              
00001C7E  4CDF 007F               1301              MOVEM.L (A7)+,D0-D6
00001C82                          1302              
00001C82  4E75                    1303              RTS
00001C84                          1304  
00001C84                          1305  
00001C84                          1306  ; -----------------------------------------------------------------------------
00001C84                          1307  DIBFIGBPOINT
00001C84                          1308  ; SUBRUTINE DRAW MAP
00001C84                          1309  ; INPUT    : D5=POSITION X, D6=POSITION Y
00001C84                          1310  ; OUTPUT   : NONE
00001C84                          1311  ; MODIFIES : NONE
00001C84                          1312  ; -----------------------------------------------------------------------------
00001C84  48E7 FE00               1313              MOVEM.L D0-D6,-(A7)
00001C88                          1314              ; SET CONTOURN COLOR
00001C88  103C 0050               1315              MOVE.B  #80,D0
00001C8C  223C 0000AAAA           1316              MOVE.L  #$0000AAAA,D1
00001C92  4E4F                    1317              TRAP    #15
00001C94                          1318              
00001C94                          1319              ; SET FILL COLOR
00001C94  103C 0051               1320              MOVE.B  #81,D0
00001C98  223C 0000FFFF           1321              MOVE.L  #$0000FFFF,D1
00001C9E  4E4F                    1322              TRAP    #15
00001CA0                          1323              
00001CA0                          1324              ; DEFINE COORDINATES RECTANGLE
00001CA0  3205                    1325              MOVE.W  D5,D1
00001CA2  5041                    1326              ADD.W   #8,D1
00001CA4  5941                    1327              SUB.W   #4,D1
00001CA6  3406                    1328              MOVE.W  D6,D2
00001CA8  5042                    1329              ADD.W   #8,D2
00001CAA  5942                    1330              SUB.W   #4,D2
00001CAC                          1331              
00001CAC  3601                    1332              MOVE.W  D1,D3
00001CAE  5043                    1333              ADD.W   #4*2,D3
00001CB0  3802                    1334              MOVE.W  D2,D4
00001CB2  5044                    1335              ADD.W   #4*2,D4
00001CB4                          1336              
00001CB4                          1337              ; DRAW BIG POINT
00001CB4  103C 0058               1338              MOVE.B  #88,D0
00001CB8  4E4F                    1339              TRAP    #15
00001CBA                          1340              
00001CBA  4CDF 007F               1341              MOVEM.L (A7)+,D0-D6
00001CBE                          1342              
00001CBE  4E75                    1343              RTS
00001CC0                          1344  
00001CC0                          1345  
00001CC0                          1346  
00001CC0                          1347  
00001CC0                          1348  
00001CC0                          1349  
00001CC0                          1350  
00001CC0                          1351  
00001CC0                          1352  
00001CC0                          1353  
00001CC0                          1354  
00001CC0                          1355  
00001CC0                          1356  -------------------- end include --------------------
00001CC0                          1357              INCLUDE "LIB/UTLCONST.X68"
00001CC0                          1358  ; ==============================================================================
00001CC0                          1359  ; UTIL CONSTANTS
00001CC0                          1360  ; ==============================================================================
00001CC0                          1361  
00001CC0  =00000008               1362  UTLCHRWD    EQU     8                       ; CHARACTER WIDTH IN PIXELS
00001CC0                          1363  
00001CC0                          1364  -------------------- end include --------------------
00001CC0                          1365              INCLUDE "LIB/UTLCODE.X68"
00001CC0                          1366  ; =============================================================================
00001CC0                          1367  ; UTILITY CODE
00001CC0                          1368  ; =============================================================================
00001CC0                          1369  
00001CC0                          1370  ; -----------------------------------------------------------------------------
00001CC0                          1371  UTLINIT
00001CC0                          1372  ; INITIALIZES UTILITY CODE
00001CC0                          1373  ; INPUT    - NONE
00001CC0                          1374  ; OUTPUT   - NONE
00001CC0                          1375  ; MODIFIES - NONE
00001CC0                          1376  ; -----------------------------------------------------------------------------
00001CC0  48E7 C000               1377              MOVEM.L D0-D1,-(A7)
00001CC4  103C 0008               1378              MOVE.B  #8,D0
00001CC8  4E4F                    1379              TRAP    #15
00001CCA  13C1 00002626           1380              MOVE.B  D1,(UTLRNDIX)
00001CD0  4CDF 0003               1381              MOVEM.L (A7)+,D0-D1
00001CD4  4E75                    1382              RTS
00001CD6                          1383  
00001CD6                          1384  ; -----------------------------------------------------------------------------
00001CD6                          1385  UTLPRINT
00001CD6                          1386  ; PRINT SCREEN CENTERED TEXT
00001CD6                          1387  ; INPUT    : A0 POINTER TO ZERO-TERMINATED STRING
00001CD6                          1388  ;            D0.B SCREEN ROW TO PRINT TEXT
00001CD6                          1389  ; OUTPUT   : D0.B NEXT ROW
00001CD6                          1390  ; MODIFIES : NONE (ASIDE OF OUTPUT)
00001CD6                          1391  ; -----------------------------------------------------------------------------
00001CD6  48E7 C0C0               1392              MOVEM.L D0-D1/A0-A1,-(A7)
00001CDA  4201                    1393              CLR.B   D1
00001CDC  2248                    1394              MOVE.L  A0,A1
00001CDE  4A18                    1395  .LOOP       TST.B   (A0)+
00001CE0  6700 0006               1396              BEQ     .ENDLOOP
00001CE4  5201                    1397              ADDQ.B  #1,D1
00001CE6  60F6                    1398              BRA     .LOOP
00001CE8  E209                    1399  .ENDLOOP    LSR.B   #1,D1
00001CEA  0401 0028               1400              SUB.B   #(SCRWIDTH/UTLCHRWD)/2,D1
00001CEE  4401                    1401              NEG.B   D1
00001CF0  E141                    1402              ASL.W   #8,D1
00001CF2  8240                    1403              OR.W    D0,D1
00001CF4  103C 000B               1404              MOVE.B  #11,D0
00001CF8  4E4F                    1405              TRAP    #15
00001CFA  103C 000D               1406              MOVE.B  #13,D0
00001CFE  4E4F                    1407              TRAP    #15
00001D00  4CDF 0303               1408              MOVEM.L (A7)+,D0-D1/A0-A1
00001D04  5200                    1409              ADDQ.B  #1,D0
00001D06  4E75                    1410              RTS
00001D08                          1411              
00001D08                          1412              
00001D08                          1413  
00001D08                          1414  
00001D08                          1415              ; (SCRWIDTH/UTLCHRWD)/2 - D1/2
00001D08                          1416  
00001D08                          1417  
00001D08                          1418  ; -----------------------------------------------------------------------------
00001D08                          1419  UTLRAND
00001D08                          1420  ; PROVIDES A PSEUDO-RANDOM BYTE
00001D08                          1421  ; INPUT    - NONE
00001D08                          1422  ; OUTPUT   - D0.L RANDOM VALUE (ONLY BYTE)
00001D08                          1423  ; MODIFIES - NONE (ASIDE OF OUTPUT)
00001D08                          1424  ; -----------------------------------------------------------------------------
00001D08  2F08                    1425              MOVE.L  A0,-(A7)
00001D0A  41F9 00001D26           1426              LEA     .RANDVEC,A0
00001D10  4280                    1427              CLR.L   D0
00001D12  1039 00002626           1428              MOVE.B  (UTLRNDIX),D0
00001D18  1030 0800               1429              MOVE.B  (A0,D0.L),D0
00001D1C  5239 00002626           1430              ADDQ.B  #1,(UTLRNDIX)
00001D22  205F                    1431              MOVE.L  (A7)+,A0
00001D24  4E75                    1432              RTS
00001D26                          1433  
00001D26                          1434  
00001D26= A2 EE 9A 0C F5 24 ...   1435  .RANDVEC    DC.B    162, 238, 154, 12 , 245, 36 , 32 , 103
00001D2E= 2A A3 51 26 E0 AC ...   1436              DC.B    42 , 163, 81 , 38 , 224, 172, 19 , 69
00001D36= 75 51 CA FD 33 EB ...   1437              DC.B    117, 81 , 202, 253, 51 , 235, 108, 154
00001D3E= 60 CC E7 B8 9A EB ...   1438              DC.B    96 , 204, 231, 184, 154, 235, 34 , 203
00001D46= 1D 76 B5 95 B0 89 ...   1439              DC.B    29 , 118, 181, 149, 176, 137, 62 , 108
00001D4E= 39 15 48 C9 6E CA ...   1440              DC.B    57 , 21 , 72 , 201, 110, 202, 159, 41
00001D56= 43 E7 E2 7C 37 25 ...   1441              DC.B    67 , 231, 226, 124, 55 , 37 , 84 , 62
00001D5E= E9 94 CE E9 E4 52 ...   1442              DC.B    233, 148, 206, 233, 228, 82 , 243, 78
00001D66= 37 6D 9A 84 A2 28 ...   1443              DC.B    55 , 109, 154, 132, 162, 40 , 30 , 39
00001D6E= 19 E2 C6 77 80 D4 ...   1444              DC.B    25 , 226, 198, 119, 128, 212, 232, 225
00001D76= 0A 5A 32 67 33 C2 ...   1445              DC.B    10 , 90 , 50 , 103, 51 , 194, 222, 40
00001D7E= 59 80 DC 0E 57 FC ...   1446              DC.B    89 , 128, 220, 14 , 87 , 252, 243, 252
00001D86= 8A AB BC F7 07 4D ...   1447              DC.B    138, 171, 188, 247, 7  , 77 , 29 , 234
00001D8E= EF D5 77 6E 1E BB ...   1448              DC.B    239, 213, 119, 110, 30 , 187, 131, 23
00001D96= D6 E0 2A 8F BD 28 ...   1449              DC.B    214, 224, 42 , 143, 189, 40 , 212, 130
00001D9E= 13 4F 66 EC 0A 64 ...   1450              DC.B    19 , 79 , 102, 236, 10 , 100, 122, 188
00001DA6= 56 52 9A 16 9B 90 ...   1451              DC.B    86 , 82 , 154, 22 , 155, 144, 7  , 199
00001DAE= 06 8A A4 F7 01 DA ...   1452              DC.B    6  , 138, 164, 247, 1  , 218, 166, 82
00001DB6= F2 E7 77 28 B1 76 ...   1453              DC.B    242, 231, 119, 40 , 177, 118, 220, 102
00001DBE= A4 42 E3 81 B1 67 ...   1454              DC.B    164, 66 , 227, 129, 177, 103, 165, 108
00001DC6= BF CE FA 16 BF 38 ...   1455              DC.B    191, 206, 250, 22 , 191, 56 , 30 , 161
00001DCE= D1 8B 50 0C 5F 49 ...   1456              DC.B    209, 139, 80 , 12 , 95 , 73 , 168, 56
00001DD6= DE 4C 14 A2 40 DC ...   1457              DC.B    222, 76 , 20 , 162, 64 , 220, 93 , 12
00001DDE= B6 9B 0A 38 5D AB ...   1458              DC.B    182, 155, 10 , 56 , 93 , 171, 89 , 6
00001DE6= E2 1B DD 75 15 82 ...   1459              DC.B    226, 27 , 221, 117, 21 , 130, 101, 18
00001DEE= 8A 26 51 30 9F 47 ...   1460              DC.B    138, 38 , 81 , 48 , 159, 71 , 57 , 21
00001DF6= 1E 8A BB 71 C6 6E ...   1461              DC.B    30 , 138, 187, 113, 198, 110, 185, 152
00001DFE= 9F 47 E5 34 94 27 ...   1462              DC.B    159, 71 , 229, 52 , 148, 39 , 77 , 6
00001E06= 7D 06 D6 BA 30 0F ...   1463              DC.B    125, 6  , 214, 186, 48 , 15 , 212, 22
00001E0E= EC 7F 7E 03 CF 2D ...   1464              DC.B    236, 127, 126, 3  , 207, 45 , 193, 2
00001E16= 94 5B 23 F2 8B CD ...   1465              DC.B    148, 91 , 35 , 242, 139, 205, 248, 237
00001E1E= 74 33 EC B9 0F D5 ...   1466              DC.B    116, 51 , 236, 185, 15 , 213, 221, 6
00001E26                          1467  
00001E26                          1468  
00001E26                          1469  
00001E26                          1470  
00001E26                          1471  -------------------- end include --------------------
00001E26                          1472              INCLUDE "INTRO.X68"
00001E26                          1473  ; ==============================================================================
00001E26                          1474  ; INTRO SCREEN
00001E26                          1475  ; ==============================================================================
00001E26                          1476  
00001E26                          1477  ; ------------------------------------------------------------------------------
00001E26                          1478  ISCINIT
00001E26                          1479  ; INTRO SCREEN INIT
00001E26                          1480  ; INPUT    : NONE
00001E26                          1481  ; OUTPUT   : NONE
00001E26                          1482  ; MODIFIES : NONE
00001E26                          1483  ; ------------------------------------------------------------------------------
00001E26  4279 00002620           1484              CLR.W   (ISCTIMER)
00001E2C  4E75                    1485              RTS
00001E2E                          1486  
00001E2E                          1487  ; ------------------------------------------------------------------------------
00001E2E                          1488  ISCUPD
00001E2E                          1489  ; INTRO SCREEN UPDATE
00001E2E                          1490  ; INPUT    : NONE
00001E2E                          1491  ; OUTPUT   : NONE
00001E2E                          1492  ; MODIFIES : NONE
00001E2E                          1493  ; ------------------------------------------------------------------------------
00001E2E  0839 0004 00002203      1494              BTST.B  #4,(KBDEDGE)
00001E36  6700 000A               1495              BEQ     .CONT
00001E3A  33FC 0002 00002624      1496              MOVE.W  #2,(STANEXT)
00001E42  5279 00002620           1497  .CONT       ADDQ.W  #1,(ISCTIMER)
00001E48  0C79 01F4 00002620      1498              CMP.W   #500,(ISCTIMER)
00001E50  6D00 000A               1499              BLT     .DONE
00001E54  33FC 0001 00002624      1500              MOVE.W  #1,(STANEXT)
00001E5C  4E75                    1501  .DONE       RTS
00001E5E                          1502  
00001E5E                          1503  ; ------------------------------------------------------------------------------
00001E5E                          1504  ISCPLOT
00001E5E                          1505  ; INTRO SCREEN PLOT
00001E5E                          1506  ; INPUT    : NONE
00001E5E                          1507  ; OUTPUT   : NONE
00001E5E                          1508  ; MODIFIES : NONE
00001E5E                          1509  ; ------------------------------------------------------------------------------
00001E5E  48E7 C080               1510              MOVEM.L D0-D1/A0,-(A7)
00001E62                          1511              
00001E62  4281                    1512              CLR.L   D1
00001E64  103C 0051               1513              MOVE.B  #81,D0
00001E68  4E4F                    1514              TRAP    #15
00001E6A                          1515              
00001E6A  41F9 00001E98           1516              LEA     .TXT1,A0
00001E70  103C 000A               1517              MOVE.B  #10,D0
00001E74  4EB8 1CD6               1518              JSR     UTLPRINT
00001E78                          1519              
00001E78  0839 0004 00002205      1520              BTST.B  #4,(SCRCYCCT)
00001E80  6700 0010               1521              BEQ     .DONE
00001E84                          1522              
00001E84  41F9 00001EA6           1523              LEA     .TXT2,A0
00001E8A  103C 0019               1524              MOVE.B  #25,D0
00001E8E  4EB8 1CD6               1525              JSR     UTLPRINT
00001E92                          1526              
00001E92  4CDF 0103               1527  .DONE       MOVEM.L (A7)+,D0-D1/A0
00001E96                          1528  
00001E96  4E75                    1529              RTS
00001E98= 50 41 43 2D 4D 41 ...   1530  .TXT1       DC.B    'PAC-MAN 68000',0
00001EA6= 50 52 45 53 53 20 ...   1531  .TXT2       DC.B    'PRESS FIRE1 TO START',0
00001EBC                          1532              DS.W    0
00001EBC                          1533  
00001EBC                          1534  
00001EBC                          1535  
00001EBC                          1536  
00001EBC                          1537  
00001EBC                          1538  
00001EBC                          1539  -------------------- end include --------------------
00001EBC                          1540              INCLUDE "INSTRUCTIONS.X68"
00001EBC                          1541  ; ==============================================================================
00001EBC                          1542  ; INSTRUCTIONS SCREEN
00001EBC                          1543  ; ==============================================================================
00001EBC                          1544  
00001EBC                          1545  ; ------------------------------------------------------------------------------
00001EBC                          1546  INSINIT
00001EBC                          1547  ; INSTRUCTIONS SCREEN INIT
00001EBC                          1548  ; INPUT    : NONE
00001EBC                          1549  ; OUTPUT   : NONE
00001EBC                          1550  ; MODIFIES : NONE
00001EBC                          1551  ; ------------------------------------------------------------------------------
00001EBC  4E75                    1552              RTS
00001EBE                          1553  
00001EBE                          1554  ; ------------------------------------------------------------------------------
00001EBE                          1555  INSUPD
00001EBE                          1556  ; INSTRUCTIONS SCREEN UPDATE
00001EBE                          1557  ; INPUT    : NONE
00001EBE                          1558  ; OUTPUT   : NONE
00001EBE                          1559  ; MODIFIES : NONE
00001EBE                          1560  ; ------------------------------------------------------------------------------
00001EBE  4E75                    1561              RTS
00001EC0                          1562  
00001EC0                          1563  ; ------------------------------------------------------------------------------
00001EC0                          1564  INSPLOT
00001EC0                          1565  ; INSTRUCTIONS SCREEN PLOT
00001EC0                          1566  ; INPUT    : NONE
00001EC0                          1567  ; OUTPUT   : NONE
00001EC0                          1568  ; MODIFIES : NONE
00001EC0                          1569  ; ------------------------------------------------------------------------------
00001EC0                          1570  
00001EC0  48E7 C0C0               1571              MOVEM.L D0-D1/A0-A1,-(A7)
00001EC4  4281                    1572              CLR.L   D1
00001EC6  103C 0051               1573              MOVE.B  #81,D0
00001ECA  4E4F                    1574              TRAP    #15
00001ECC  103C 000B               1575              MOVE.B  #11,D0
00001ED0  43F9 00002032           1576              LEA     .TXTLST,A1
00001ED6  2219                    1577  .LOOP       MOVE.L  (A1)+,D1
00001ED8  6700 000A               1578              BEQ     .DONE
00001EDC  2041                    1579              MOVE.L  D1,A0
00001EDE  4EB8 1CD6               1580              JSR     UTLPRINT
00001EE2  60F2                    1581              BRA     .LOOP
00001EE4  4CDF 0303               1582  .DONE       MOVEM.L (A7)+,D0-D1/A0-A1
00001EE8  4E75                    1583              RTS
00001EEA= 57 45 4C 43 4F 4D ...   1584  .TXT1       DC.B    'WELCOME TO THE WORLD OF MULTI-PONG 68000!',0
00001F14= 59 4F 55 52 20 47 ...   1585  .TXT2       DC.B    'YOUR GOAL IN THIS GAME IS TO AVOID MISSING THE BALLS',0
00001F49= 54 4F 20 54 48 49 ...   1586  .TXT3       DC.B    'TO THIS END, MOVE THE PAD USING THE KEYBOARD',0
00001F76= 48 4F 57 20 54 4F ...   1587  .TXT4       DC.B    'HOW TO DO IT? YOU MAY ASK.',0
00001F91= 49 54 20 49 53 20 ...   1588  .TXT5       DC.B    'IT IS EASY: JUST USE THE UP KEY TO MOVE THE PAD...',0
00001FC4= 55 50 21 00             1589  .TXT6       DC.B    'UP!',0
00001FC8= 41 4E 44 20 55 53 ...   1590  .TXT7       DC.B    'AND USE THE DOWN KEY TO MOVE THE PAD DOWN.',0
00001FF3= 57 48 41 54 20 41 ...   1591  .TXT8       DC.B    'WHAT ABOUT LEFT AND RIGHT?',0
0000200E= 4E 4F 2E 20 54 48 ...   1592  .TXT9       DC.B    'NO. THESE ARE FORBIDDEN DIRECTIONS',0
00002032                          1593              DS.W    0
00002032= 00001EEA 00001F14 ...   1594  .TXTLST     DC.L    .TXT1,.TXT2,.TXT3,.TXT4,.TXT5,.TXT6,.TXT7,.TXT8,.TXT9,0
0000205A                          1595  
0000205A                          1596  
0000205A                          1597  -------------------- end include --------------------
0000205A                          1598              INCLUDE "WIN.X68"
0000205A                          1599  ; ==============================================================================
0000205A                          1600  ; VICTORY SCREEN
0000205A                          1601  ; ==============================================================================
0000205A                          1602  
0000205A                          1603  ; ------------------------------------------------------------------------------
0000205A                          1604  WININIT
0000205A                          1605  ; VICTORY SCREEN INIT
0000205A                          1606  ; INPUT    : NONE
0000205A                          1607  ; OUTPUT   : NONE
0000205A                          1608  ; MODIFIES : NONE
0000205A                          1609  ; ------------------------------------------------------------------------------
0000205A  4E75                    1610              RTS
0000205C                          1611  
0000205C                          1612  ; ------------------------------------------------------------------------------
0000205C                          1613  WINUPD
0000205C                          1614  ; VICTORY SCREEN UPDATE
0000205C                          1615  ; INPUT    : NONE
0000205C                          1616  ; OUTPUT   : NONE
0000205C                          1617  ; MODIFIES : NONE
0000205C                          1618  ; ------------------------------------------------------------------------------
0000205C  4E75                    1619              RTS
0000205E                          1620  
0000205E                          1621  ; ------------------------------------------------------------------------------
0000205E                          1622  WINPLOT
0000205E                          1623  ; VICTORY SCREEN PLOT
0000205E                          1624  ; INPUT    : NONE
0000205E                          1625  ; OUTPUT   : NONE
0000205E                          1626  ; MODIFIES : NONE
0000205E                          1627  ; ------------------------------------------------------------------------------
0000205E  48E7 C080               1628              MOVEM.L D0-D1/A0,-(A7)
00002062                          1629              
00002062  4281                    1630              CLR.L   D1
00002064  103C 0051               1631              MOVE.B  #81,D0
00002068  4E4F                    1632              TRAP    #15
0000206A                          1633              
0000206A  41F9 00002098           1634              LEA     .TXT1,A0
00002070  103C 000A               1635              MOVE.B  #10,D0
00002074  4EB8 1CD6               1636              JSR     UTLPRINT
00002078                          1637              
00002078  0839 0004 00002205      1638              BTST.B  #4,(SCRCYCCT)
00002080  6700 0010               1639              BEQ     .DONE
00002084                          1640              
00002084  41F9 000020A1           1641              LEA     .TXT2,A0
0000208A  103C 0019               1642              MOVE.B  #25,D0
0000208E  4EB8 1CD6               1643              JSR     UTLPRINT
00002092                          1644              
00002092  4CDF 0103               1645  .DONE       MOVEM.L (A7)+,D0-D1/A0
00002096                          1646  
00002096  4E75                    1647              RTS
00002098= 59 4F 55 20 57 4F ...   1648  .TXT1       DC.B    'YOU WON!',0
000020A1= 50 52 45 53 53 20 ...   1649  .TXT2       DC.B    'PRESS FIRE1 TO CONTINUE',0
000020BA                          1650              DS.W    0
000020BA                          1651  
000020BA                          1652  
000020BA                          1653  
000020BA                          1654  -------------------- end include --------------------
000020BA                          1655              INCLUDE "GOVER.X68"
000020BA                          1656  ; ==============================================================================
000020BA                          1657  ; GAME OVER SCREEN
000020BA                          1658  ; ==============================================================================
000020BA                          1659  
000020BA                          1660  ; ------------------------------------------------------------------------------
000020BA                          1661  GOVINIT
000020BA                          1662  ; GAME OVER SCREEN INIT
000020BA                          1663  ; INPUT    : NONE
000020BA                          1664  ; OUTPUT   : NONE
000020BA                          1665  ; MODIFIES : NONE
000020BA                          1666  ; ------------------------------------------------------------------------------
000020BA  4E75                    1667              RTS
000020BC                          1668  
000020BC                          1669  ; ------------------------------------------------------------------------------
000020BC                          1670  GOVUPD
000020BC                          1671  ; GAME OVER SCREEN UPDATE
000020BC                          1672  ; INPUT    : NONE
000020BC                          1673  ; OUTPUT   : NONE
000020BC                          1674  ; MODIFIES : NONE
000020BC                          1675  ; ------------------------------------------------------------------------------
000020BC  4E75                    1676              RTS
000020BE                          1677  
000020BE                          1678  ; ------------------------------------------------------------------------------
000020BE                          1679  GOVPLOT
000020BE                          1680  ; GAME OVER SCREEN PLOT
000020BE                          1681  ; INPUT    : NONE
000020BE                          1682  ; OUTPUT   : NONE
000020BE                          1683  ; MODIFIES : NONE
000020BE                          1684  ; ------------------------------------------------------------------------------
000020BE  48E7 C080               1685              MOVEM.L D0-D1/A0,-(A7)
000020C2                          1686              
000020C2  4281                    1687              CLR.L   D1
000020C4  103C 0051               1688              MOVE.B  #81,D0
000020C8  4E4F                    1689              TRAP    #15
000020CA                          1690              
000020CA  41F9 000020F8           1691              LEA     .TXT1,A0
000020D0  103C 000A               1692              MOVE.B  #10,D0
000020D4  4EB8 1CD6               1693              JSR     UTLPRINT
000020D8                          1694              
000020D8  0839 0004 00002205      1695              BTST.B  #4,(SCRCYCCT)
000020E0  6700 0010               1696              BEQ     .DONE
000020E4                          1697              
000020E4  41F9 00002102           1698              LEA     .TXT2,A0
000020EA  103C 0019               1699              MOVE.B  #25,D0
000020EE  4EB8 1CD6               1700              JSR     UTLPRINT
000020F2                          1701              
000020F2  4CDF 0103               1702  .DONE       MOVEM.L (A7)+,D0-D1/A0
000020F6                          1703  
000020F6  4E75                    1704              RTS
000020F8= 47 41 4D 45 20 4F ...   1705  .TXT1       DC.B    'GAME OVER',0
00002102= 50 52 45 53 53 20 ...   1706  .TXT2       DC.B    'PRESS FIRE1 TO CONTINUE',0
0000211A                          1707              DS.W    0
0000211A                          1708  
0000211A                          1709  
0000211A                          1710  -------------------- end include --------------------
0000211A                          1711              INCLUDE "STATES.X68"
0000211A                          1712  ; =============================================================================
0000211A                          1713  ; GAME STATE MANAGEMENT
0000211A                          1714  ; =============================================================================
0000211A                          1715  
0000211A                          1716  ; -----------------------------------------------------------------------------
0000211A                          1717  STAINIT
0000211A                          1718  ; INITALIZES THE STATE MANAGER
0000211A                          1719  ; INPUT    - NONE
0000211A                          1720  ; OUTPUT   - NONE
0000211A                          1721  ; MODIFIES - NONE
0000211A                          1722  ; -----------------------------------------------------------------------------
0000211A  33FC FFFF 00002622      1723              MOVE.W  #STANONE,(STACUR)
00002122  4279 00002624           1724              CLR.W   (STANEXT)
00002128  4E75                    1725              RTS
0000212A                          1726  
0000212A                          1727  ; -----------------------------------------------------------------------------
0000212A                          1728  STAUPD
0000212A                          1729  ; PERFORMS STATE UPDATE AND INIT IF NECESSARY
0000212A                          1730  ; INPUT    - NONE
0000212A                          1731  ; OUTPUT   - NONE
0000212A                          1732  ; MODIFIES - NONE
0000212A                          1733  ; -----------------------------------------------------------------------------
0000212A  48E7 8080               1734              MOVEM.L D0/A0,-(A7)
0000212E  4280                    1735              CLR.L   D0
00002130  3039 00002624           1736              MOVE.W  (STANEXT),D0
00002136  B079 00002622           1737              CMP.W   (STACUR),D0
0000213C  6700 0012               1738              BEQ     .DOUPD
00002140  33C0 00002622           1739              MOVE.W  D0,(STACUR)             ; IF STATE CHANGED, DO INIT
00002146  E588                    1740              LSL.L   #2,D0
00002148  2040                    1741              MOVE.L  D0,A0
0000214A  2068 2168               1742              MOVE.L  .INITBL(A0),A0
0000214E  4E90                    1743              JSR     (A0)
00002150  4280                    1744  .DOUPD      CLR.L   D0                      ; IN ANY CASE, DO UPDATE
00002152  3039 00002622           1745              MOVE.W  (STACUR),D0
00002158  E588                    1746              LSL.L   #2,D0
0000215A  2040                    1747              MOVE.L  D0,A0
0000215C  2068 216C               1748              MOVE.L  .UPDTBL(A0),A0
00002160  4E90                    1749              JSR     (A0)
00002162  4CDF 0101               1750              MOVEM.L (A7)+,D0/A0
00002166  4E75                    1751              RTS
00002168= 00001E26                1752  .INITBL     DC.L    ISCINIT
0000216C= 00001E2E                1753  .UPDTBL     DC.L    ISCUPD
00002170                          1754  
00002170                          1755  ; -----------------------------------------------------------------------------
00002170                          1756  STAPLOT
00002170                          1757  ; PERFORMS STATE PLOT
00002170                          1758  ; INPUT    - NONE
00002170                          1759  ; OUTPUT   - NONE
00002170                          1760  ; MODIFIES - NONE
00002170                          1761  ; -----------------------------------------------------------------------------
00002170  48E7 8080               1762              MOVEM.L D0/A0,-(A7)
00002174  4280                    1763              CLR.L   D0
00002176  3039 00002622           1764              MOVE.W  (STACUR),D0
0000217C  E588                    1765              LSL.L   #2,D0
0000217E  2040                    1766              MOVE.L  D0,A0
00002180  2068 218C               1767              MOVE.L  .PLTTBL(A0),A0
00002184  4E90                    1768              JSR     (A0)
00002186  4CDF 0101               1769              MOVEM.L (A7)+,D0/A0
0000218A  4E75                    1770              RTS
0000218C= 00001E5E                1771  .PLTTBL     DC.L    ISCPLOT
00002190                          1772  
00002190                          1773  ; -----------------------------------------------------------------------------
00002190                          1774  STAEMPTY
00002190                          1775  ; EMPTY SUBROUTINE FOR CASES WITH NOTHING TO DO
00002190                          1776  ; INPUT    - NONE
00002190                          1777  ; OUTPUT   - NONE
00002190                          1778  ; MODIFIES - NONE
00002190                          1779  ; NOTE     - JUST A PLACEHOLDER. NOTHING TO DO.
00002190                          1780  ; -----------------------------------------------------------------------------
00002190  4E75                    1781              RTS
00002192                          1782  
00002192                          1783  
00002192                          1784  
00002192                          1785  
00002192                          1786  
00002192                          1787  
00002192                          1788  
00002192                          1789  
00002192                          1790  -------------------- end include --------------------
00002192                          1791              INCLUDE "GAME.X68"
00002192                          1792  ; ==============================================================================
00002192                          1793  ; GAME MANAGEMENT
00002192                          1794  ; ==============================================================================
00002192                          1795  
00002192                          1796  ; ------------------------------------------------------------------------------
00002192                          1797  GAMINIT
00002192                          1798  ; INITIALIZES GAME.
00002192                          1799  ; INPUT    : NONE
00002192                          1800  ; OUTPUT   : NONE
00002192                          1801  ; MODIFIES : NONE
00002192                          1802  ; ------------------------------------------------------------------------------
00002192  4EB8 18C2               1803              JSR     SYSINIT
00002196  4EB8 14CE               1804              JSR     PMINIT
0000219A  4EB8 1B22               1805              JSR     MAPINIT
0000219E  4EB8 1400               1806              JSR     GSTINIT
000021A2  6000 F6AC               1807              BRA     SCOINIT
000021A6                          1808  
000021A6                          1809  ; ------------------------------------------------------------------------------
000021A6                          1810  GAMUPD
000021A6                          1811  ; UPDATES THE GAME
000021A6                          1812  ; INPUT    : NONE
000021A6                          1813  ; OUTPUT   : NONE
000021A6                          1814  ; MODIFIES : NONE
000021A6                          1815  ; ------------------------------------------------------------------------------
000021A6  6000 F35A               1816              BRA     PMUPD
000021AA                          1817              
000021AA                          1818  ; ------------------------------------------------------------------------------
000021AA                          1819  GAMPLOT
000021AA                          1820  ; PLOTS THE GAME
000021AA                          1821  ; INPUT    : NONE
000021AA                          1822  ; OUTPUT   : NONE
000021AA                          1823  ; MODIFIES : NONE
000021AA                          1824  ; ------------------------------------------------------------------------------
000021AA  4EB8 1B9C               1825              JSR     MAPPLOT
000021AE  4EB8 1860               1826              JSR     SCOPLOT
000021B2  4EB8 164C               1827              JSR     PMPLOT
000021B6  6000 F2AC               1828              BRA     GSTPLOT
000021BA                          1829  
000021BA                          1830  -------------------- end include --------------------
000021BA                          1831              
000021BA                          1832      
000021BA                          1833  START:
000021BA                          1834  
000021BA                          1835  ;--- INITIALIZATION -----------------------------------------------------------
000021BA                          1836  
000021BA  007C 0700               1837              ORI.W   #$0700,SR               ;DISABLE INTERRUPTIONS
000021BE                          1838  
000021BE  4EB8 18C2               1839              JSR     SYSINIT
000021C2  4EB8 14CE               1840              JSR     PMINIT
000021C6  4EB8 1B22               1841              JSR     MAPINIT
000021CA  4EB8 1400               1842              JSR     GSTINIT
000021CE  4EB8 1850               1843              JSR     SCOINIT
000021D2  4EB8 1E26               1844              JSR     ISCINIT
000021D6                          1845              ;JSR     GAMINIT
000021D6                          1846  
000021D6                          1847  .LOOP
000021D6                          1848  
000021D6                          1849  ; --- UPDATE -------------------------------------------------------------------
000021D6                          1850  
000021D6                          1851  ; READ INPUT DEVICES
000021D6                          1852  
000021D6  4E41                    1853              TRAP    #1
000021D8                          1854  
000021D8                          1855  ; UPDATE GAME LOGIC
000021D8                          1856  
000021D8  4EB8 1502               1857             JSR     PMUPD
000021DC                          1858             ;JSR     GSTUPD
000021DC                          1859             ;JSR      ISCUPD
000021DC                          1860             ;JSR      GAMUPD
000021DC                          1861  
000021DC                          1862  ; --- SYNC ---------------------------------------------------------------------
000021DC                          1863              ;WHILE THERES NO INTERRUPTS IN THE COUNTER THE PROGRAM WILL BE IN
000021DC                          1864              ;THE BUCLE
000021DC                          1865              
000021DC  4A39 00002204           1866  .WAITINIT   TST.B   (SCRINTCT)
000021E2  67F8                    1867              BEQ     .WAITINIT
000021E4  4239 00002204           1868              CLR.B   (SCRINTCT)
000021EA                          1869  
000021EA                          1870  ; --- PLOT ---------------------------------------------------------------------
000021EA                          1871              
000021EA  4EB8 1B9C               1872              JSR     MAPPLOT
000021EE  4EB8 1860               1873              JSR     SCOPLOT
000021F2  4EB8 164C               1874              JSR     PMPLOT
000021F6  4EB8 1464               1875              JSR     GSTPLOT
000021FA                          1876              ;JSR     ISCPLOT
000021FA                          1877              ;JSR     GAMPLOT
000021FA                          1878              
000021FA                          1879              
000021FA  4E40                    1880              TRAP    #0                      ;CHANGE BUFFER
000021FC                          1881  
000021FC  60D8                    1882              BRA     .LOOP
000021FE                          1883  
000021FE  FFFF FFFF               1884              SIMHALT  
00002202                          1885             
00002202                          1886              INCLUDE "SYSVARS.X68"
00002202                          1887  ; ==============================================================================
00002202                          1888  ; SYSTEM VARIABLES
00002202                          1889  ; ==============================================================================
00002202                          1890   
00002202                          1891  ; --- KEYBOARD RELATED VARIABLES -----------------------------------------------
00002202                          1892  
00002202                          1893  KBDVAL      DS.B    1                       ; KEY STATE
00002203                          1894  KBDEDGE     DS.B    1                       ; KEY EDGE
00002204                          1895  
00002204                          1896  ; --- TIMED INTERRUPT RELATED VARIABLES ----------------------------------------
00002204                          1897  
00002204                          1898  SCRINTCT    DS.B    1                       ; INTERRUPT COUNTER
00002205                          1899  SCRCYCCT    DS.B    1                       ; CYCLE COUNTER
00002206                          1900              DS.W    0        
00002206                          1901              
00002206                          1902  ; --- MAP RELATED VARIABLE -----------------------------------------------------
00002206                          1903  
00002206                          1904  MAPVAR      DS.B    1024
00002606                          1905  
00002606                          1906              DS.B    0
00002606                          1907  
00002606                          1908  POSCON      DS.W    1
00002608                          1909  
00002608                          1910  
00002608                          1911  
00002608                          1912  
00002608                          1913  
00002608                          1914  
00002608                          1915  -------------------- end include --------------------
00002608                          1916              INCLUDE "VARS.X68"
00002608                          1917  ; ==============================================================================
00002608                          1918  ; GAME VARIABLES
00002608                          1919  ; ==============================================================================
00002608                          1920  
00002608                          1921  ; --- PAC-MAN RELATED VARIABLES ------------------------------------------------
00002608                          1922  
00002608                          1923  PMPOSX      DS.W    1                       ; PM X COORDINATE
0000260A                          1924  PMPOSY      DS.W    1                       ; PM Y COORDINATE
0000260C                          1925  PMVELX      DS.W    1                       ; PM X VELOCITY
0000260E                          1926  PMVELY      DS.W    1                       ; PM Y VELOCITY
00002610                          1927  PMEAT       DS.B    1                       ; PM BOOLEAN EAT GST
00002611                          1928  PMLAMO      DS.B    1                       ; PM SAVE LAST MOVEMENT X O Y
00002612                          1929              DS.B    0
00002612                          1930  
00002612                          1931  ; --- GHOST RELATED VARIABLES --------------------------------------------------
00002612                          1932  
00002612                          1933  GSTPOSX     DS.W    1                       ; GST X COORDINATE
00002614                          1934  GSTPOSY     DS.W    1                       ; GST Y COORDINATE
00002616                          1935  GSTVELX     DS.W    1                       ; GST X VELOCITY
00002618                          1936  GSTVELY     DS.W    1                       ; GST Y VELOCITY
0000261A                          1937  GSTDEAD     DS.B    1                       ; GST BOOLEAN DEAD
0000261B                          1938  GSTLAMO     DS.B    1                       ; GST LAST MOVEMENT (X OR Y)
0000261C                          1939              DS.B    0
0000261C                          1940  
0000261C                          1941  ; --- SCOREBOARD RELATED VARIABLES ---------------------------------------------
0000261C                          1942  
0000261C                          1943  SCOLIFE     DS.W    1                       ; NUMBER OF LIFES
0000261E                          1944  SCOPOINTS   DS.W    1                       ; NUMBER OF POINTS
00002620                          1945  
00002620                          1946  ; --- INTRO STATE RELATED VARIABLES --------------------------------------------
00002620                          1947  
00002620                          1948  ISCTIMER    DS.W    1                       ; INTRO TIMER
00002622                          1949  
00002622                          1950  ; --- STATE RELATED VARIABLES --------------------------------------------------
00002622                          1951  
00002622                          1952  STACUR      DS.W    1                       ; CURRENT STATE
00002624                          1953  STANEXT     DS.W    1                       ; NEXT STATE
00002626                          1954  
00002626                          1955  
00002626                          1956  
00002626                          1957  
00002626                          1958  
00002626                          1959  
00002626                          1960  
00002626                          1961  
00002626                          1962  -------------------- end include --------------------
00002626                          1963              INCLUDE "LIB/UTLVARS.X68"
00002626                          1964  ; =============================================================================
00002626                          1965  ; UTILITY VARIABLES
00002626                          1966  ; =============================================================================
00002626                          1967  
00002626                          1968  UTLRNDIX    DS.B    1                       ; NEXT INDEX TO RANDOM NUMBER
00002628                          1969              DS.W    0
00002628                          1970  -------------------- end include --------------------
00002628                          1971              
00002628                          1972              END    START        

No errors detected
No warnings generated


SYMBOL TABLE INFORMATION
Symbol-name         Value
-------------------------
BUCLE_COLUMNA       1B48
BUCLE_COLUMNA2      1BBE
BUCLE_FILA          1B3C
BUCLE_FILA2         1BB2
COLWALLDOWN         1A34
COLWALLLEFT         19F2
COLWALLRIGHT        19B0
COLWALLUP           1A70
DIBFIGBPOINT        1C84
DIBFIGPOINT         1C48
DIBFIGWALL          1C10
GAMINIT             2192
GAMPLOT             21AA
GAMUPD              21A6
GETPOINTS           1AAE
GETPOINTS:BPOINT    1AF8
GETPOINTS:DONE      1B1C
GETPOINTS:POINT     1B0A
GOVINIT             20BA
GOVPLOT             20BE
GOVPLOT:DONE        20F2
GOVPLOT:TXT1        20F8
GOVPLOT:TXT2        2102
GOVUPD              20BC
GSTCOL1             FF
GSTCOL2             FF0080
GSTCOL3             FFFF00
GSTCOL4             80FF
GSTCOL5             800000
GSTDEAD             261A
GSTFCOL1            FFFFFF
GSTFCOL2            0
GSTFCOL3            0
GSTFCOL4            0
GSTFCOL5            0
GSTINIT             1400
GSTINX1             2
GSTINX2             2
GSTINX3             1F
GSTINX4             1F
GSTINY1             2
GSTINY2             1F
GSTINY3             2
GSTINY4             1F
GSTLAMO             261B
GSTPLOT             1464
GSTPOSX             2612
GSTPOSY             2614
GSTRAD              8
GSTRNG              10
GSTSPEED            7
GSTSPEED2           5
GSTUPD              1428
GSTUPD:GSTNOTMULT   145E
GSTVELX             2616
GSTVELY             2618
INSINIT             1EBC
INSPLOT             1EC0
INSPLOT:DONE        1EE4
INSPLOT:LOOP        1ED6
INSPLOT:TXT1        1EEA
INSPLOT:TXT2        1F14
INSPLOT:TXT3        1F49
INSPLOT:TXT4        1F76
INSPLOT:TXT5        1F91
INSPLOT:TXT6        1FC4
INSPLOT:TXT7        1FC8
INSPLOT:TXT8        1FF3
INSPLOT:TXT9        200E
INSPLOT:TXTLST      2032
INSUPD              1EBE
ISCINIT             1E26
ISCPLOT             1E5E
ISCPLOT:DONE        1E92
ISCPLOT:TXT1        1E98
ISCPLOT:TXT2        1EA6
ISCTIMER            2620
ISCUPD              1E2E
ISCUPD:CONT         1E42
ISCUPD:DONE         1E5C
KBDDOWN             28
KBDEDGE             2203
KBDFIRE1            20
KBDFIRE2            4D
KBDFIRE3            10
KBDINIT             195A
KBDLEFT             25
KBDPAUSE            50
KBDRIGHT            27
KBDUP               26
KBDUPD              1968
KBDUPD:CONVERT      19A2
KBDUPD:LOOP         19A6
KBDUPD:NOACT        199C
KBDVAL              2202
MAPINIT             1B22
MAPMAT              1000
MAPPLOT             1B9C
MAPVAR              2206
NOTPOINT            1B7C
NOTPOINT2           1BF0
NOTWALL             1B6E
NOTWALL2            1BE2
PMEAT               2610
PMFCOL              FFFF
PMINIT              14CE
PMLAMO              2611
PMPCOL              FFFF
PMPLOT              164C
PMPLOT:DDONE        16E6
PMPLOT:DDOWN        16B8
PMPLOT:DLEFT        169A
PMPLOT:DOWNDRAW     17A6
PMPLOT:DRAW_MOUTH1  16C2
PMPLOT:DRAW_MOUTH2  16CC
PMPLOT:DRAW_MOUTH3  16D6
PMPLOT:DRAW_MOUTH4  16E0
PMPLOT:DRIGHT       16AE
PMPLOT:DUP          16A4
PMPLOT:FULLDRAW     16EC
PMPLOT:LEFTDRAW     1710
PMPLOT:RIGHTDRAW    1742
PMPLOT:SET_MOUTHDOWN  1832
PMPLOT:SET_MOUTHLEFT  17D8
PMPLOT:SET_MOUTHRIGHT  17F6
PMPLOT:SET_MOUTHUP  1814
PMPLOT:UPDRAW       1774
PMPOSX              2608
PMPOSY              260A
PMRAD               8
PMSPEED             2
PMUPD               1502
PMUPD:ACTXLEFT      15C0
PMUPD:ACTXRIGHT     1594
PMUPD:ACTYDOWN      15EC
PMUPD:ACTYUP        1608
PMUPD:DONE          163A
PMUPD:NOTCOLISION   15A6
PMUPD:NOTCOLISION2  15D2
PMUPD:NOTCOLISION3  15FE
PMUPD:NOTCOLISION4  161A
PMUPD:NOTDOWN       1590
PMUPD:NOTLEFT       154E
PMUPD:NOTMULT       1624
PMUPD:NOTRIGHT      1564
PMUPD:NOTTP         15B6
PMUPD:NOTTP2        15E2
PMUPD:NOTUP         157A
PMVELX              260C
PMVELY              260E
POSCON              2606
SCOFCOL             0
SCOINIT             1850
SCOLIFE             261C
SCOLINE1            101
SCOLINE2            102
SCOPLOT             1860
SCOPLOT:TXT1        18AE
SCOPLOT:TXT2        18B7
SCOPOINTS           261E
SCRCYCCT            2205
SCRHEIGH            280
SCRINIT             18EE
SCRINTCT            2204
SCRTIM              194C
SCRUPD              1932
SCRWIDTH            280
STACUR              2622
STAEMPTY            2190
STAINIT             211A
STANEXT             2624
STANONE             FFFFFFFF
STAPLOT             2170
STAPLOT:PLTTBL      218C
START               21BA
START:LOOP          21D6
START:WAITINIT      21DC
STAUPD              212A
STAUPD:DOUPD        2150
STAUPD:INITBL       2168
STAUPD:UPDTBL       216C
SYSINIT             18C2
UTLCHRWD            8
UTLINIT             1CC0
UTLPRINT            1CD6
UTLPRINT:ENDLOOP    1CE8
UTLPRINT:LOOP       1CDE
UTLRAND             1D08
UTLRAND:RANDVEC     1D26
UTLRNDIX            2626
WININIT             205A
WINPLOT             205E
WINPLOT:DONE        2092
WINPLOT:TXT1        2098
WINPLOT:TXT2        20A1
WINUPD              205C
ZERO                1B8A
ZERO2               1BFE
