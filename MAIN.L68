00002188 Starting Address
Assembler used: EASy68K Editor/Assembler v5.16.01
Created On: 22/12/2022 9:29:14

00000000                             1  ; ==============================================================================
00000000                             2  ; TITLE       : PAC-MAN 68000
00000000                             3  ; DESCRIPTION : GAME IN MOTOROLA 68000 BASED ON PAC-MAN GAME
00000000                             4  ; AUTHOR      : JORDI FLORIT ENSENYAT
00000000                             5  ;               JOSEP GABRIEL FORNES REYNES
00000000                             6  ;               PAU GIRON RODRIGUEZ
00000000                             7  ; ==============================================================================
00001000                             8              ORG    $1000
00001000                             9  
00001000                            10              INCLUDE "CONST.X68"
00001000                            11  ; ==============================================================================
00001000                            12  ; GAME CONSTANTS
00001000                            13  ; ==============================================================================
00001000                            14  
00001000                            15  ; --- PAC-MAN RELATED CONTANTS ----------------------------------------------------
00001000                            16  
00001000  =0000FFFF                 17  PMPCOL      EQU     $0000FFFF               ; PAC-MAN CONTOUR COLOR
00001000  =0000FFFF                 18  PMFCOL      EQU     $0000FFFF               ; PAC-MAN FILL COLOR
00001000  =00000002                 19  PMSPEED     EQU     2                       ; MAGNITUDE OF THE X AND Y VEL.
00001000  =00000008                 20  PMRAD       EQU     8                       ; PAC-MAN RADIUS
00001000                            21  
00001000                            22  ; --- GHOST RELATED CONSTANTS ----------------------------------------------------
00001000                            23  
00001000  =00000007                 24  GSTSPEED    EQU     7                       ; MAGNITUDE OF THE NORMAL DISPLACEMENT
00001000  =00000005                 25  GSTSPEED2   EQU     5                       ; MAGNITUDE OF THE ATACKED DISPLACEMENT
00001000                            26  
00001000  =000000FF                 27  GSTCOL1     EQU     $000000FF               ; GHOST 1 CONTOUR COLOR RED
00001000  =00FFFFFF                 28  GSTFCOL1    EQU     $00FFFFFF               ; GHOST 1 FILL COLOR WHITE
00001000  =00000002                 29  GSTINX1     EQU     2                       ; GHOST 1 INITIAL X
00001000  =00000002                 30  GSTINY1     EQU     2                       ; GHOST 1 INITIAL Y
00001000                            31  
00001000  =00FF0080                 32  GSTCOL2     EQU     $00FF0080               ; GHOST 2 CONTOUR COLOR PINK
00001000  =00000000                 33  GSTFCOL2    EQU     $00000000               ; GHOST 1 FILL COLOR
00001000  =00000002                 34  GSTINX2     EQU     2                       ; GHOST 2 INITIAL X
00001000  =0000001F                 35  GSTINY2     EQU     31                      ; GHOST 2 INITIAL Y
00001000                            36  
00001000  =00FFFF00                 37  GSTCOL3     EQU     $00FFFF00               ; GHOST 3 CONTOUR COLOR CYAN
00001000  =00000000                 38  GSTFCOL3    EQU     $00000000               ; GHOST 3 FILL COLOR
00001000  =0000001F                 39  GSTINX3     EQU     31                      ; GHOST 3 INITIAL X
00001000  =00000002                 40  GSTINY3     EQU     2                       ; GHOST 3 INITIAL Y
00001000                            41  
00001000  =000080FF                 42  GSTCOL4     EQU     $000080FF               ; GHOST 4 CONTOUR COLOR ORANGE
00001000  =00000000                 43  GSTFCOL4    EQU     $00000000               ; GHOST 4 FILL COLOR
00001000  =0000001F                 44  GSTINX4     EQU     31                      ; GHOST 4 INITIAL X
00001000  =0000001F                 45  GSTINY4     EQU     31                      ; GHOST 4 INITIAL Y 
00001000                            46  
00001000  =00800000                 47  GSTCOL5     EQU     $00800000               ; CONTOUR COLOR OF ATACKED MODE
00001000  =00000000                 48  GSTFCOL5    EQU     $00000000               ; FILL COLOR OF ATACKED MODE
00001000                            49  
00001000  =00000008                 50  GSTRAD      EQU     8                       ; GHOST RADIUS
00001000  =00000010                 51  GSTRNG      EQU     16                      ; GHOST DETECTING RANGE
00001000                            52              
00001000                            53  ; --- SCOREBOARD RELATED CONSTANTS ---------------------------------------------
00001000                            54  ;MODIFICATE
00001000                            55  
00001000  =00000000                 56  SCOFCOL     EQU     $00000000               ; TEXT BACKGROUND COLOR
00001000  =00000101                 57  SCOLINE1    EQU     $0101                   ; FIRST TEXT LINE COORDINATES
00001000  =00000102                 58  SCOLINE2    EQU     $0102                   ; SECOND TEXT LINE COORDINATES
00001000                            59  
00001000                            60  ; --- MAP RELATED CONSTANTS ----------------------------------------------------
00001000                            61  
00001000= 01 01 01 01 01 01 ...     62  MAPMAT      DC.B    $1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
00001020= 01 02 02 02 02 02 ...     63              DC.B    $1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1
00001040= 01 02 01 01 01 01 ...     64              DC.B    $1,2,1,1,1,1,1,2,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,2,1,1,1,1,1,2,1
00001060= 01 03 01 01 01 01 ...     65              DC.B    $1,3,1,1,1,1,1,2,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,2,1,1,1,1,1,3,1
00001080= 01 02 02 02 02 02 ...     66              DC.B    $1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1
000010A0= 01 02 01 01 01 01 ...     67              DC.B    $1,2,1,1,1,1,1,2,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,2,1,1,1,1,1,2,1
000010C0= 01 02 01 01 01 01 ...     68              DC.B    $1,2,1,1,1,1,1,2,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,2,1,1,1,1,1,2,1
000010E0= 01 02 02 02 02 02 ...     69              DC.B    $1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1
00001100= 01 02 01 01 01 01 ...     70              DC.B    $1,2,1,1,1,1,1,2,1,1,1,2,1,1,1,1,1,1,1,1,2,1,1,1,2,1,1,1,1,1,2,1
00001120= 01 02 01 00 00 00 ...     71              DC.B    $1,2,1,0,0,0,1,2,1,0,1,2,1,1,1,1,1,1,1,1,2,1,0,1,2,1,0,0,0,1,2,1
00001140= 01 02 01 01 01 01 ...     72              DC.B    $1,2,1,1,1,1,1,2,1,0,1,2,2,2,2,1,1,2,2,2,2,1,0,1,2,1,1,1,1,1,2,1
00001160= 01 02 02 02 02 02 ...     73              DC.B    $1,2,2,2,2,2,2,2,1,0,1,1,1,1,2,1,1,2,1,1,1,1,0,1,2,2,2,2,2,2,2,1
00001180= 01 01 01 01 01 01 ...     74              DC.B    $1,1,1,1,1,1,1,2,1,0,1,1,1,1,2,1,1,2,1,1,1,1,0,1,2,1,1,1,1,1,1,1
000011A0= 01 00 00 00 00 00 ...     75              DC.B    $1,0,0,0,0,0,1,2,1,0,1,0,0,0,0,0,0,0,0,0,0,1,0,1,2,1,0,0,0,0,0,1
000011C0= 01 00 00 00 00 00 ...     76              DC.B    $1,0,0,0,0,0,1,2,1,0,1,0,1,1,1,0,0,1,1,1,0,1,0,1,2,1,0,0,0,0,0,1
000011E0= 01 01 01 01 01 01 ...     77              DC.B    $1,1,1,1,1,1,1,2,1,1,1,0,1,0,0,0,0,0,0,1,0,1,1,1,2,1,1,1,1,1,1,1
00001200= 04 00 00 00 00 00 ...     78              DC.B    $4,0,0,0,0,0,0,2,2,2,2,0,1,0,0,0,0,0,0,1,0,2,2,2,2,0,0,0,0,0,0,4
00001220= 01 01 01 01 01 01 ...     79              DC.B    $1,1,1,1,1,1,1,2,1,1,1,0,1,0,0,0,0,0,0,1,0,1,1,1,2,1,1,1,1,1,1,1
00001240= 01 00 00 00 00 00 ...     80              DC.B    $1,0,0,0,0,0,1,2,1,0,1,0,1,1,1,1,1,1,1,1,0,1,0,1,2,1,0,0,0,0,0,1
00001260= 01 00 00 00 00 00 ...     81              DC.B    $1,0,0,0,0,0,1,2,1,0,1,0,0,0,0,0,0,0,0,0,0,1,0,1,2,1,0,0,0,0,0,1
00001280= 01 01 01 01 01 01 ...     82              DC.B    $1,1,1,1,1,1,1,2,1,1,1,0,1,1,1,1,1,1,1,1,0,1,1,1,2,1,1,1,1,1,1,1
000012A0= 01 02 02 02 02 02 ...     83              DC.B    $1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1
000012C0= 01 02 01 01 01 01 ...     84              DC.B    $1,2,1,1,1,1,1,2,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,2,1,1,1,1,1,2,1
000012E0= 01 02 01 01 01 01 ...     85              DC.B    $1,2,1,1,1,1,1,2,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,2,1,1,1,1,1,2,1
00001300= 01 02 02 02 02 01 ...     86              DC.B    $1,2,2,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,2,2,2,1
00001320= 01 01 01 01 02 01 ...     87              DC.B    $1,1,1,1,2,1,1,2,1,1,1,2,1,1,1,1,1,1,1,1,2,1,1,1,2,1,1,2,1,1,1,1
00001340= 01 01 01 01 02 01 ...     88              DC.B    $1,1,1,1,2,1,1,2,1,0,1,2,1,1,1,1,1,1,1,1,2,1,0,1,2,1,1,2,1,1,1,1
00001360= 01 02 02 02 02 02 ...     89              DC.B    $1,2,2,2,2,2,2,2,1,0,1,2,2,2,2,1,1,2,2,2,2,1,0,1,2,2,2,2,2,2,2,1
00001380= 01 02 01 01 01 01 ...     90              DC.B    $1,2,1,1,1,1,1,1,1,0,1,1,1,1,2,1,1,2,1,1,1,1,0,1,1,1,1,1,1,1,2,1
000013A0= 01 03 01 01 01 01 ...     91              DC.B    $1,3,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,3,1
000013C0= 01 02 02 02 02 02 ...     92              DC.B    $1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1
000013E0= 01 01 01 01 01 01 ...     93              DC.B    $1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
00001400                            94              
00001400                            95  ; --- STATE RELATED CONSTANTS --------------------------------------------------
00001400                            96  
00001400  =FFFFFFFF                 97  STANONE     EQU     -1                      ; NON-EXISTENT STATE NUMBER
00001400                            98  
00001400                            99  
00001400                           100  
00001400                           101  
00001400                           102  
00001400                           103  
00001400                           104  
00001400                           105  
00001400                           106  
00001400                           107  
00001400                           108  
00001400                           109  
00001400                           110  
00001400                           111  
00001400                           112  
00001400                           113  
00001400                           114  
00001400                           115  
00001400                           116  
00001400                           117  
00001400                           118  
00001400                           119  
00001400                           120  
00001400                           121  -------------------- end include --------------------
00001400                           122              INCLUDE "GHOST.X68"
00001400                           123  ; ==============================================================================
00001400                           124  ; GHOST MANAGEMENT
00001400                           125  ; ==============================================================================
00001400                           126              
00001400                           127  ; ------------------------------------------------------------------------------
00001400                           128  GSTINIT
00001400                           129  ; INITIALIZE GHOST.
00001400                           130  ; INPUT    : NONE 
00001400                           131  ; OUTPUT   : NONE
00001400                           132  ; MODIFIES : NONE
00001400                           133  ; ------------------------------------------------------------------------------
00001400  33FC 0058 000025E0       134              MOVE.W  #GSTINX1*16+64-8,(GSTPOSX)
00001408  33FC 0058 000025E2       135              MOVE.W  #GSTINY1*16+64-8,(GSTPOSY)
00001410  33FC 0007 000025E4       136              MOVE.W  #GSTSPEED,(GSTVELX)
00001418  33FC 0007 000025E6       137              MOVE.W  #GSTSPEED,(GSTVELY)
00001420  4239 000025E9            138              CLR.B   (GSTLAMO)
00001426  4E75                     139              RTS
00001428                           140              
00001428                           141  ; ------------------------------------------------------------------------------
00001428                           142  GSTUPD
00001428                           143  ; UPDATES THE GHOST.
00001428                           144  ; INPUT    : NONE 
00001428                           145  ; OUTPUT   : NONE
00001428                           146  ; MODIFIES : NONE
00001428                           147  ; ------------------------------------------------------------------------------
00001428  48E7 F800                148              MOVEM.L D0-D4,-(A7)
0000142C                           149                          
0000142C                           150  .GSTNOTMULT
0000142C                           151  
0000142C  4CDF 001F                152              MOVEM.L (A7)+,D0-D4
00001430                           153              
00001430  4E75                     154              RTS
00001432                           155              
00001432                           156  ; ------------------------------------------------------------------------------
00001432                           157  GSTPLOT
00001432                           158  ; PLOT THE GHOST.
00001432                           159  ; INPUT    : NONE 
00001432                           160  ; OUTPUT   : NONE
00001432                           161  ; MODIFIES : NONE
00001432                           162  ; ------------------------------------------------------------------------------
00001432  48E7 F800                163              MOVEM.L D0-D4,-(A7)
00001436                           164              
00001436                           165              ;SET PEN COLOR
00001436  303C 0050                166              MOVE.W  #80,D0
0000143A  223C 000000FF            167              MOVE.L  #GSTCOL1,D1
00001440  4E4F                     168              TRAP    #15
00001442                           169              
00001442                           170              ;SET FILL COLOR
00001442  303C 0051                171              MOVE.W  #81,D0
00001446  223C 00FFFFFF            172              MOVE.L  #GSTFCOL1,D1
0000144C  4E4F                     173              TRAP    #15
0000144E                           174              
0000144E                           175              ;SET COORDS
0000144E  3239 000025E0            176              MOVE.W  (GSTPOSX),D1
00001454  5141                     177              SUB.W   #GSTRAD,D1
00001456  3439 000025E2            178              MOVE.W  (GSTPOSY),D2
0000145C  5142                     179              SUB.W   #GSTRAD,D2
0000145E                           180              
0000145E  3601                     181              MOVE.W  D1,D3
00001460  0643 0010                182              ADD.W   #GSTRAD*2,D3
00001464  3802                     183              MOVE.W  D2,D4
00001466  0644 0010                184              ADD.W   #GSTRAD*2,D4
0000146A                           185              
0000146A                           186              ;DRAW GHOST
0000146A  303C 0058                187              MOVE.W  #88,D0
0000146E  4E4F                     188              TRAP    #15
00001470                           189              
00001470                           190              ;SET RANGE COORDS
00001470  3239 000025E0            191              MOVE.W  (GSTPOSX),D1
00001476  0441 0100                192              SUB.W   #GSTRNG*16,D1
0000147A  3439 000025E2            193              MOVE.W  (GSTPOSY),D2
00001480  0442 0100                194              SUB.W   #GSTRNG*16,D2
00001484                           195              
00001484  3601                     196              MOVE.W  D1,D3
00001486  0643 0200                197              ADD.W   #GSTRNG*16*2,D3
0000148A  3802                     198              MOVE.W  D2,D4
0000148C  0644 0200                199              ADD.W   #GSTRNG*16*2,D4
00001490                           200              
00001490                           201              ;DRAW GHOST RANGE
00001490  303C 005A                202              MOVE.W  #90,D0
00001494  4E4F                     203              TRAP    #15
00001496                           204              
00001496  4CDF 001F                205              MOVEM.L (A7)+,D0-D4
0000149A                           206              
0000149A                           207  
0000149A  4E75                     208              RTS
0000149C                           209  
0000149C                           210  
0000149C                           211  
0000149C                           212  -------------------- end include --------------------
0000149C                           213              INCLUDE "PAC-MAN.X68"
0000149C                           214  ; ==============================================================================
0000149C                           215  ; PAC-MAN MANAGEMENT
0000149C                           216  ; ==============================================================================
0000149C                           217              
0000149C                           218  ; ------------------------------------------------------------------------------
0000149C                           219  PMINIT
0000149C                           220  ; INITIALIZE PAC-MAN.
0000149C                           221  ; INPUT    : NONE 
0000149C                           222  ; OUTPUT   : NONE
0000149C                           223  ; MODIFIES : NONE
0000149C                           224  ; ------------------------------------------------------------------------------
0000149C                           225  
0000149C  33FC 0140 000025D6       226              MOVE.W  #SCRWIDTH/2,(PMPOSX)
000014A4  33FC 0140 000025D8       227              MOVE.W  #SCRHEIGH/2,(PMPOSY)
000014AC  5079 000025D6            228              ADDQ.W  #8,(PMPOSX)
000014B2  5079 000025D8            229              ADDQ.W  #8,(PMPOSY)
000014B8  33FC 0002 000025DA       230              MOVE.W  #PMSPEED,(PMVELX)
000014C0  33FC 0002 000025DC       231              MOVE.W  #PMSPEED,(PMVELY)
000014C8  4239 000025DF            232              CLR.B   (PMLAMO)
000014CE                           233  
000014CE  4E75                     234              RTS
000014D0                           235              
000014D0                           236  ; ------------------------------------------------------------------------------
000014D0                           237  PMUPD
000014D0                           238  ; UPDATES THE PAC-MAN.
000014D0                           239  ; INPUT    : NONE 
000014D0                           240  ; OUTPUT   : NONE
000014D0                           241  ; MODIFIES : NONE
000014D0                           242  ; ------------------------------------------------------------------------------
000014D0                           243              
000014D0  48E7 FE00                244              MOVEM.L D0-D6,-(A7)
000014D4                           245              
000014D4  303C 0002                246              MOVE.W  #PMSPEED,D0
000014D8                           247              
000014D8                           248              
000014D8  3439 000025D6            249              MOVE.W  (PMPOSX),D2
000014DE  3639 000025D8            250              MOVE.W  (PMPOSY),D3
000014E4                           251              
000014E4  5042                     252              ADDQ.W  #8,D2              
000014E6  5043                     253              ADDQ.W  #8,D3  
000014E8                           254              
000014E8  1839 000025DF            255              MOVE.B  (PMLAMO),D4
000014EE                           256              
000014EE                           257              ;MASK OF THE LAST NIBBLE        
000014EE  C47C 000F                258              AND.W   #$000F,D2               ; COORDENADA X
000014F2  C67C 000F                259              AND.W   #$000F,D3               ; COORDENADA Y
000014F6                           260              
000014F6                           261              ;CHECK IF COORDS ARE MULTIPLES OF 16
000014F6  B47C 0000                262              CMP     #$0000,D2
000014FA  6600 00F6                263              BNE     .NOTMULT
000014FE  B67C 0000                264              CMP     #$0000,D3
00001502  6600 00EE                265              BNE     .NOTMULT
00001506                           266              
00001506                           267              ;BRA     .ACTYUP
00001506                           268  
00001506                           269              ;CHECK THE DIRECTION
00001506  0839 0000 000021D0       270              BTST.B  #0,(KBDVAL)             ;CHECK LEFT
0000150E  6700 000C                271              BEQ     .NOTLEFT
00001512  4204                     272              CLR.B   D4
00001514  183C 0000                273              MOVE.B  #0,D4
00001518  6000 0074                274              BRA     .ACTXLEFT
0000151C                           275  .NOTLEFT            
0000151C  0839 0002 000021D0       276              BTST.B   #2,(KBDVAL)             ;CHECK RIGHT
00001524  6700 000C                277              BEQ     .NOTRIGHT
00001528  4204                     278              CLR.B   D4
0000152A  183C 0001                279              MOVE.B   #1,D4
0000152E  6000 0032                280              BRA     .ACTXRIGHT
00001532                           281  .NOTRIGHT            
00001532  0839 0001 000021D0       282              BTST.B   #1,(KBDVAL)             ;CHECK UP
0000153A  6700 000C                283              BEQ     .NOTUP
0000153E  4204                     284              CLR.B   D4
00001540  183C 0002                285              MOVE.B  #2,D4
00001544  6000 0090                286              BRA     .ACTYUP
00001548                           287  .NOTUP            
00001548  0839 0003 000021D0       288              BTST.B   #3,(KBDVAL)             ;CHECK DOWN
00001550  6700 000C                289              BEQ     .NOTDOWN
00001554  4204                     290              CLR.B   D4
00001556  183C 0003                291              MOVE.B   #3,D4
0000155A  6000 005E                292              BRA     .ACTYDOWN
0000155E                           293  .NOTDOWN
0000155E  6000 00A8                294              BRA     .DONE
00001562                           295              
00001562                           296              
00001562                           297              ;UPDATE COORDS
00001562                           298              
00001562                           299  .ACTXRIGHT  
00001562  4EB9 0000197E            300              JSR     COLWALLRIGHT
00001568  BA7C 0001                301              CMP     #1,D5
0000156C  6600 0006                302              BNE     .NOTCOLISION
00001570  303C 0000                303              MOVE.W  #0,D0
00001574                           304  .NOTCOLISION
00001574  BA7C 0004                305              CMP     #4,D5
00001578  6600 000A                306              BNE     .NOTTP
0000157C  0479 01E0 000025D6       307              SUB.W   #30*16,(PMPOSX)
00001584                           308  .NOTTP
00001584  D179 000025D6            309              ADD.W   D0,(PMPOSX)
0000158A  6000 007C                310              BRA     .DONE
0000158E                           311  .ACTXLEFT
0000158E  4EB9 000019C0            312              JSR     COLWALLLEFT
00001594  BA7C 0001                313              CMP     #1,D5
00001598  6600 0006                314              BNE     .NOTCOLISION2
0000159C  303C 0000                315              MOVE.W  #0,D0
000015A0                           316  .NOTCOLISION2
000015A0  BA7C 0004                317              CMP     #4,D5
000015A4  6600 000A                318              BNE     .NOTTP2
000015A8  0679 01E0 000025D6       319              ADD.W   #30*16,(PMPOSX)
000015B0                           320  .NOTTP2
000015B0  9179 000025D6            321              SUB.W   D0,(PMPOSX)
000015B6  6000 0050                322              BRA     .DONE
000015BA                           323      
000015BA                           324  .ACTYDOWN
000015BA  4EB9 00001A02            325              JSR     COLWALLDOWN
000015C0  BA7C 0001                326              CMP     #1,D5
000015C4  6600 0006                327              BNE     .NOTCOLISION3
000015C8  303C 0000                328              MOVE.W  #0,D0
000015CC                           329  .NOTCOLISION3
000015CC  D179 000025D8            330              ADD.W   D0,(PMPOSY)
000015D2  6000 0034                331              BRA     .DONE
000015D6                           332  .ACTYUP     
000015D6  4EB9 00001A3E            333              JSR     COLWALLUP
000015DC  BA7C 0001                334              CMP     #1,D5
000015E0  6600 0006                335              BNE     .NOTCOLISION4
000015E4  303C 0000                336              MOVE.W  #0,D0
000015E8                           337  .NOTCOLISION4
000015E8  9179 000025D8            338              SUB.W   D0,(PMPOSY)
000015EE  6000 0018                339              BRA     .DONE
000015F2                           340              
000015F2                           341              
000015F2                           342              ;IF NOT MULT DO
000015F2                           343  .NOTMULT     
000015F2  B83C 0000                344              CMP.B     #0,D4
000015F6  6796                     345              BEQ     .ACTXLEFT
000015F8  B83C 0001                346              CMP.B     #1,D4
000015FC  6700 FF64                347              BEQ     .ACTXRIGHT
00001600  B83C 0002                348              CMP.B     #2,D4
00001604  67D0                     349              BEQ     .ACTYUP
00001606  60B2                     350              BRA     .ACTYDOWN
00001608                           351  .DONE
00001608                           352              ;RESTORE
00001608  4EB9 00001A7C            353              JSR     GETPOINTS
0000160E  13C4 000025DF            354              MOVE.B  D4,(PMLAMO)
00001614                           355              
00001614  4CDF 007F                356              MOVEM.L (A7)+,D0-D6
00001618                           357              
00001618  4E75                     358              RTS
0000161A                           359                          
0000161A                           360  ; ------------------------------------------------------------------------------
0000161A                           361  PMPLOT
0000161A                           362  ; PLOT THE BALL.
0000161A                           363  ; INPUT    : NONE 
0000161A                           364  ; OUTPUT   : NONE
0000161A                           365  ; MODIFIES : NONE
0000161A                           366  ; ------------------------------------------------------------------------------
0000161A                           367  
0000161A  48E7 F800                368              MOVEM.L D0-D4,-(A7)
0000161E                           369  
0000161E                           370              ;SET PEN COLOR
0000161E  303C 0050                371              MOVE.W  #80,D0
00001622  7200                     372              MOVE.L  #$0000,D1
00001624  4E4F                     373              TRAP    #15
00001626                           374              
00001626                           375              ;SET FILL COLOR
00001626  303C 0051                376              MOVE.W  #81,D0
0000162A  223C 0000FFFF            377              MOVE.L  #PMFCOL,D1
00001630  4E4F                     378              TRAP    #15
00001632                           379              
00001632                           380              ;DRAW QUIET
00001632  4EB9 000016BA            381              JSR     .FULLDRAW
00001638                           382              
00001638                           383              ;CHECK KBDVAL
00001638  0839 0000 000021D0       384              BTST.B  #0,(KBDVAL)             ;LEFT
00001640  6700 0026                385              BEQ     .DLEFT
00001644  0839 0001 000021D0       386              BTST.B  #1,(KBDVAL)             :UP
0000164C  6700 0024                387              BEQ     .DUP
00001650  0839 0002 000021D0       388              BTST.B  #2,(KBDVAL)             ;RIGHT
00001658  6700 0022                389              BEQ     .DRIGHT
0000165C  0839 0003 000021D0       390              BTST.B  #3,(KBDVAL)             ;DOWN
00001664  6700 0020                391              BEQ     .DDOWN
00001668                           392              
00001668                           393              ;DRAW MOVEMENT
00001668                           394  .DLEFT
00001668  4EB9 000016DE            395              JSR     .LEFTDRAW
0000166E  6000 0020                396              BRA     .DRAW_MOUTH1
00001672                           397  .DUP
00001672  4EB9 00001742            398              JSR     .UPDRAW
00001678  6000 0020                399              BRA     .DRAW_MOUTH2
0000167C                           400  
0000167C                           401  .DRIGHT
0000167C  4EB9 00001710            402              JSR     .RIGHTDRAW
00001682  6000 0020                403              BRA     .DRAW_MOUTH3
00001686                           404  
00001686                           405  .DDOWN
00001686  4EB9 00001774            406              JSR     .DOWNDRAW
0000168C  6000 0020                407              BRA     .DRAW_MOUTH4
00001690                           408              
00001690                           409  .DRAW_MOUTH1            
00001690  4EB9 000017A6            410              JSR     .SET_MOUTHLEFT
00001696  6000 001C                411              BRA     .DDONE
0000169A                           412  .DRAW_MOUTH2            
0000169A  4EB9 000017E2            413              JSR     .SET_MOUTHUP
000016A0  6000 0012                414              BRA     .DDONE
000016A4                           415  .DRAW_MOUTH3            
000016A4  4EB9 000017C4            416              JSR     .SET_MOUTHRIGHT
000016AA  6000 0008                417              BRA     .DDONE
000016AE                           418  .DRAW_MOUTH4            
000016AE  4EB9 00001800            419              JSR     .SET_MOUTHDOWN
000016B4                           420  .DDONE
000016B4  4CDF 001F                421              MOVEM.L (A7)+,D0-D4
000016B8                           422              
000016B8  4E75                     423              RTS
000016BA                           424  
000016BA                           425  
000016BA                           426  ;INTERNAL SUBRUTINES FOR PACMAN PLOT-------------------------------------------------------------
000016BA                           427  
000016BA                           428  .FULLDRAW
000016BA                           429              ;SET COORDS
000016BA  3239 000025D6            430              MOVE.W  (PMPOSX),D1
000016C0  5141                     431              SUB.W   #PMRAD,D1
000016C2  3439 000025D8            432              MOVE.W  (PMPOSY),D2
000016C8  5142                     433              SUB.W   #PMRAD,D2
000016CA                           434              
000016CA  3601                     435              MOVE.W  D1,D3
000016CC  0643 0010                436              ADD.W   #PMRAD*2,D3
000016D0  3802                     437              MOVE.W  D2,D4
000016D2  0644 0010                438              ADD.W   #PMRAD*2,D4
000016D6                           439              
000016D6                           440              ;DRAW PAC-MAN
000016D6  303C 0058                441              MOVE.W  #88,D0
000016DA  4E4F                     442              TRAP    #15
000016DC                           443              
000016DC  4E75                     444              RTS
000016DE                           445  .LEFTDRAW
000016DE                           446              
000016DE                           447              
000016DE  303C 0054                448              MOVE.W  #84,D0
000016E2  3239 000025D6            449              MOVE.W  (PMPOSX),D1                   ;FINAL COORD OF THE FIRST LINE
000016E8  5141                     450              SUB.W   #PMRAD,D1
000016EA  3439 000025D8            451              MOVE.W  (PMPOSY),D2
000016F0  5142                     452              SUB.W   #PMRAD,D2
000016F2                           453              
000016F2  3639 000025D6            454              MOVE.W  (PMPOSX),D3                   ;ORIGINAL COORD FIRST LINE
000016F8  3839 000025D8            455              MOVE.W  (PMPOSY),D4
000016FE                           456              
000016FE  4E4F                     457              TRAP    #15
00001700                           458             
00001700  303C 0055                459              MOVE.W  #85,D0                        ;DRAW SECOND LINE
00001704                           460              
00001704  3203                     461              MOVE.W  D3,D1
00001706  3404                     462              MOVE.W  D4,D2
00001708  5042                     463              ADD.W   #PMRAD,D2
0000170A  5141                     464              SUB.W   #PMRAD,D1
0000170C                           465              
0000170C  4E4F                     466              TRAP    #15
0000170E                           467              
0000170E                           468              
0000170E  4E75                     469              RTS
00001710                           470              
00001710                           471  .RIGHTDRAW
00001710                           472              
00001710                           473              
00001710  303C 0054                474              MOVE.W  #84,D0
00001714  3239 000025D6            475              MOVE.W  (PMPOSX),D1                   ;FINAL COORD OF THE FIRST LINE
0000171A  5041                     476              ADD.W   #PMRAD,D1
0000171C  3439 000025D8            477              MOVE.W  (PMPOSY),D2
00001722  5042                     478              ADD.W   #PMRAD,D2
00001724                           479              
00001724  3639 000025D6            480              MOVE.W  (PMPOSX),D3                   ;ORIGINAL COORD FIRST LINE
0000172A  3839 000025D8            481              MOVE.W  (PMPOSY),D4
00001730                           482              
00001730  4E4F                     483              TRAP    #15
00001732                           484             
00001732  303C 0055                485              MOVE.W  #85,D0                        ;DRAW SECOND LINE
00001736                           486              
00001736  3203                     487              MOVE.W  D3,D1
00001738  3404                     488              MOVE.W  D4,D2
0000173A  5042                     489              ADD.W   #PMRAD,D2
0000173C  5041                     490              ADD.W   #PMRAD,D1
0000173E                           491              
0000173E  4E4F                     492              TRAP    #15
00001740                           493              
00001740                           494              
00001740  4E75                     495              RTS
00001742                           496  .UPDRAW
00001742                           497              
00001742                           498              
00001742  303C 0054                499              MOVE.W  #84,D0
00001746  3239 000025D6            500              MOVE.W  (PMPOSX),D1                   ;FINAL COORD OF THE FIRST LINE
0000174C  5141                     501              SUB.W   #PMRAD,D1
0000174E  3439 000025D8            502              MOVE.W  (PMPOSY),D2
00001754  5142                     503              SUB.W   #PMRAD,D2
00001756                           504              
00001756  3639 000025D6            505              MOVE.W  (PMPOSX),D3                   ;ORIGINAL COORD FIRST LINE
0000175C  3839 000025D8            506              MOVE.W  (PMPOSY),D4
00001762                           507              
00001762  4E4F                     508              TRAP    #15
00001764                           509             
00001764  303C 0055                510              MOVE.W  #85,D0                        ;DRAW SECOND LINE
00001768                           511              
00001768  3203                     512              MOVE.W  D3,D1
0000176A  3404                     513              MOVE.W  D4,D2
0000176C  5142                     514              SUB.W   #PMRAD,D2
0000176E  5041                     515              ADD.W   #PMRAD,D1
00001770                           516              
00001770  4E4F                     517              TRAP    #15
00001772                           518              
00001772                           519              
00001772  4E75                     520              RTS
00001774                           521              
00001774                           522  .DOWNDRAW
00001774                           523              
00001774                           524              
00001774  303C 0054                525              MOVE.W  #84,D0
00001778  3239 000025D6            526              MOVE.W  (PMPOSX),D1                   ;FINAL COORD OF THE FIRST LINE
0000177E  5141                     527              SUB.W   #PMRAD,D1
00001780  3439 000025D8            528              MOVE.W  (PMPOSY),D2
00001786  5142                     529              SUB.W   #PMRAD,D2
00001788                           530              
00001788  3639 000025D6            531              MOVE.W  (PMPOSX),D3                   ;ORIGINAL COORD FIRST LINE
0000178E  3839 000025D8            532              MOVE.W  (PMPOSY),D4
00001794                           533              
00001794  4E4F                     534              TRAP    #15
00001796                           535             
00001796  303C 0055                536              MOVE.W  #85,D0                        ;DRAW SECOND LINE
0000179A                           537              
0000179A  3203                     538              MOVE.W  D3,D1
0000179C  3404                     539              MOVE.W  D4,D2
0000179E  5042                     540              ADD.W   #PMRAD,D2
000017A0  5041                     541              ADD.W   #PMRAD,D1
000017A2                           542              
000017A2  4E4F                     543              TRAP    #15
000017A4                           544              
000017A4                           545              
000017A4  4E75                     546              RTS
000017A6                           547  
000017A6                           548              
000017A6                           549  .SET_MOUTHLEFT
000017A6                           550              
000017A6  303C 0051                551              MOVE.W  #81,D0                         ;SET BLACK
000017AA  7200                     552              MOVE.L  #$0000,D1
000017AC  4E4F                     553              TRAP    #15
000017AE                           554              
000017AE  303C 0059                555              MOVE.W  #89,D0                         ;FILL
000017B2  3239 000025D6            556              MOVE.W  (PMPOSX),D1
000017B8  5541                     557              SUBQ.W   #2,D1
000017BA  3439 000025D8            558              MOVE.W  (PMPOSY),D2
000017C0  4E4F                     559              TRAP    #15
000017C2                           560  
000017C2  4E75                     561              RTS
000017C4                           562              
000017C4                           563  .SET_MOUTHRIGHT
000017C4                           564              
000017C4  303C 0051                565              MOVE.W  #81,D0                         ;SET BLACK
000017C8  7200                     566              MOVE.L  #$0000,D1
000017CA  4E4F                     567              TRAP    #15
000017CC                           568              
000017CC  303C 0059                569              MOVE.W  #89,D0                         ;FILL
000017D0  3239 000025D6            570              MOVE.W  (PMPOSX),D1
000017D6  5441                     571              ADDQ.W   #2,D1
000017D8  3439 000025D8            572              MOVE.W  (PMPOSY),D2
000017DE  4E4F                     573              TRAP    #15
000017E0                           574  
000017E0  4E75                     575              RTS
000017E2                           576  
000017E2                           577  .SET_MOUTHUP
000017E2                           578              
000017E2  303C 0051                579              MOVE.W  #81,D0                         ;SET BLACK
000017E6  7200                     580              MOVE.L  #$0000,D1
000017E8  4E4F                     581              TRAP    #15
000017EA                           582              
000017EA  303C 0059                583              MOVE.W  #89,D0                         ;FILL
000017EE  3239 000025D6            584              MOVE.W  (PMPOSX),D1
000017F4  3439 000025D8            585              MOVE.W  (PMPOSY),D2
000017FA  5542                     586              SUBQ.W   #2,D2
000017FC  4E4F                     587              TRAP    #15
000017FE                           588  
000017FE  4E75                     589              RTS
00001800                           590  
00001800                           591  .SET_MOUTHDOWN
00001800                           592              
00001800  303C 0051                593              MOVE.W  #81,D0                         ;SET BLACK
00001804  7200                     594              MOVE.L  #$0000,D1
00001806  4E4F                     595              TRAP    #15
00001808                           596              
00001808  303C 0059                597              MOVE.W  #89,D0                         ;FILL
0000180C  3239 000025D6            598              MOVE.W  (PMPOSX),D1
00001812  3439 000025D8            599              MOVE.W  (PMPOSY),D2
00001818  5442                     600              ADDQ.W   #2,D2
0000181A  4E4F                     601              TRAP    #15
0000181C                           602  
0000181C  4E75                     603              RTS
0000181E                           604  
0000181E                           605  
0000181E                           606  
0000181E                           607  
0000181E                           608  
0000181E                           609  
0000181E                           610  
0000181E                           611  
0000181E                           612  
0000181E                           613  
0000181E                           614  
0000181E                           615  
0000181E                           616  
0000181E                           617  
0000181E                           618  
0000181E                           619  
0000181E                           620  
0000181E                           621  
0000181E                           622  
0000181E                           623  
0000181E                           624  
0000181E                           625  
0000181E                           626  
0000181E                           627  
0000181E                           628  
0000181E                           629  
0000181E                           630  -------------------- end include --------------------
0000181E                           631              INCLUDE "SCORE.X68"
0000181E                           632  ; ==============================================================================
0000181E                           633  ; SCOREBOARD MANAGEMENT
0000181E                           634  ; ==============================================================================
0000181E                           635              
0000181E                           636  ; ------------------------------------------------------------------------------
0000181E                           637  SCOINIT
0000181E                           638  ; INITIALIZE SCOREBOARD
0000181E                           639  ; INPUT    : NONE 
0000181E                           640  ; OUTPUT   : NONE
0000181E                           641  ; MODIFIES : NONE
0000181E                           642  ; ------------------------------------------------------------------------------
0000181E  4279 000025EE            643              CLR.W   (SCOPOINTS)
00001824  33FC 0003 000025EC       644              MOVE.W  #3,(SCOLIFE)
0000182C  4E75                     645              RTS
0000182E                           646              
0000182E                           647  ; ------------------------------------------------------------------------------
0000182E                           648  SCOPLOT
0000182E                           649  ; PLOT THE SCOREBOARD
0000182E                           650  ; INPUT    : NONE 
0000182E                           651  ; OUTPUT   : NONE
0000182E                           652  ; MODIFIES : NONE
0000182E                           653  ; ------------------------------------------------------------------------------
0000182E                           654              
0000182E  48E7 C040                655               MOVEM.L D0-D1/A1,-(A7)
00001832                           656  
00001832                           657              ; SET BACKGROUND COLOR
00001832  103C 0051                658              MOVE.B  #81,D0
00001836  7200                     659              MOVE.L  #SCOFCOL,D1
00001838  4E4F                     660              TRAP    #15
0000183A                           661              
0000183A                           662              ; SET FIRST LINE POSITION
0000183A  103C 000B                663              MOVE.B  #11,D0
0000183E  323C 0101                664              MOVE.W  #SCOLINE1,D1
00001842  4E4F                     665              TRAP    #15
00001844                           666  
00001844                           667              ; PRINT FIRST LINE
00001844  43F9 0000187C            668              LEA     .TXT1,A1            ;PUT FIRST STRING IN A1
0000184A  4281                     669              CLR.L   D1
0000184C  3239 000025EE            670              MOVE.W  (SCOPOINTS),D1
00001852  103C 0011                671              MOVE.B  #17,D0
00001856  4E4F                     672              TRAP    #15
00001858                           673  
00001858                           674              ; SET SECOND LINE POSITION
00001858  103C 000B                675              MOVE.B  #11,D0
0000185C  323C 0102                676              MOVE.W  #SCOLINE2,D1       
00001860  4E4F                     677              TRAP    #15
00001862                           678  
00001862                           679              ; PRINT SECOND LINE
00001862  43F9 00001885            680              LEA     .TXT2,A1
00001868  4281                     681              CLR.L   D1
0000186A  3239 000025EC            682              MOVE.W  (SCOLIFE),D1
00001870  103C 0011                683              MOVE.B  #17,D0
00001874  4E4F                     684              TRAP    #15
00001876                           685              
00001876  4CDF 0203                686              MOVEM.L (A7)+,D0-D1/A1
0000187A                           687              
0000187A  4E75                     688              RTS
0000187C                           689  
0000187C= 50 4F 49 4E 54 53 ...    690  .TXT1       DC.B    'POINTS :',0      ;0 IS END OF STRING
00001885= 4C 49 46 45 53 20 ...    691  .TXT2       DC.B    'LIFES  :',0
0000188E                           692  
0000188E                           693  
0000188E  4E75                     694              RTS
00001890                           695  
00001890                           696  
00001890                           697  -------------------- end include --------------------
00001890                           698              INCLUDE "SYSCONST.X68"
00001890                           699  ; ==============================================================================
00001890                           700  ; SYSTEM CONSTANTS
00001890                           701  ; ==============================================================================
00001890                           702  
00001890                           703  ; --- SCREEN RELATED CONSTANTS -------------------------------------------------
00001890                           704  
00001890  =00000280                705  SCRWIDTH    EQU     640                     ; SCREEN WIDTH
00001890  =00000280                706  SCRHEIGH    EQU     640                     ; SCREEN HEIGHT
00001890                           707  
00001890                           708  ;---KEYCODES--------------------------------------------------------------------
00001890                           709  
00001890  =00000025                710  KBDLEFT     EQU     $25
00001890  =00000026                711  KBDUP       EQU     $26
00001890  =00000027                712  KBDRIGHT    EQU     $27
00001890  =00000028                713  KBDDOWN     EQU     $28
00001890  =00000020                714  KBDFIRE1    EQU     ' '
00001890  =0000004D                715  KBDFIRE2    EQU     'M'                         
00001890  =00000010                716  KBDFIRE3    EQU     $10
00001890  =00000050                717  KBDPAUSE    EQU     'P'
00001890                           718  
00001890                           719  
00001890                           720  
00001890                           721  
00001890                           722  
00001890                           723  
00001890                           724  
00001890                           725  
00001890                           726  
00001890                           727  -------------------- end include --------------------
00001890                           728              INCLUDE "SYSTEM.X68"
00001890                           729  ; ==============================================================================
00001890                           730  ; SYSTEM
00001890                           731  ; ==============================================================================
00001890                           732              
00001890                           733  ; ------------------------------------------------------------------------------
00001890                           734  SYSINIT
00001890                           735  ; INITIALIZE SYSTEM.
00001890                           736  ; INPUT    : NONE
00001890                           737  ; OUTPUT   : NONE
00001890                           738  ; MODIFIES : NONE
00001890                           739  ; ------------------------------------------------------------------------------
00001890                           740              
00001890  21FC 00001900 0080       741              MOVE.L  #SCRUPD,($80+0*4)          ;INSTALL SUBRUTINE TO TRAP #0
00001898  21FC 00001936 0084       742              MOVE.L  #KBDUPD,($80+1*4)          ;INSTALL SUBRUTINE TO TRAP #1
000018A0                           743              
000018A0                           744              
000018A0  21FC 0000191A 0064       745              MOVE.L  #SCRTIM,($60+1*4)          ;INSTALL INTERRUPT #1
000018A8                           746              
000018A8  4EB9 000018BC            747              JSR     SCRINIT
000018AE  4EB9 00001928            748              JSR     KBDINIT
000018B4                           749              
000018B4                           750              
000018B4  40E7                     751              MOVE.W  SR,-(A7)
000018B6  0257 D8FF                752              ANDI.W  #$D8FF,(A7)                ;BIT SUPERVISOR TO O AND INTERRPUT MASK 000 (FOR REACTIVATE INTERRUPTIONS)             
000018BA  4E73                     753              RTE
000018BC                           754     
000018BC                           755  ; ------------------------------------------------------------------------------
000018BC                           756  SCRINIT
000018BC                           757  ; INIT SCREEN. SET SCREEN RESOLUTION, SET WINDOWED MODE, CLEAR SCREEN, ENABLE BUFFER
000018BC                           758  ; ENABLE TIMED INTERRUPTION
000018BC                           759  ; INPUT    : NONE
000018BC                           760  ; OUTPUT   : NONE
000018BC                           761  ; MODIFIES : NONE
000018BC                           762  ; ------------------------------------------------------------------------------
000018BC                           763  
000018BC  48E7 C000                764              MOVEM.L D0-D1,-(A7)                 ;SAFE REGISTERS IN STACK
000018C0                           765  
000018C0                           766              ; SET SCREEN RESOLUTION
000018C0  103C 0021                767              MOVE.B  #33,D0
000018C4  223C 02800280            768              MOVE.L  #SCRWIDTH<<16|SCRHEIGH,D1
000018CA  4E4F                     769              TRAP    #15
000018CC                           770              
000018CC                           771              ; SET WINDOWED MODE
000018CC  7201                     772              MOVE.L  #1,D1
000018CE  4E4F                     773              TRAP    #15
000018D0                           774              
000018D0                           775              ; ENABLE DOUBLE BUFFER
000018D0  103C 005C                776              MOVE.B  #92,D0
000018D4  123C 0011                777              MOVE.B  #17,D1
000018D8  4E4F                     778              TRAP    #15
000018DA                           779              
000018DA                           780              ; CLEAR SCREEN
000018DA  103C 000B                781              MOVE.B  #11,D0
000018DE  323C FF00                782              MOVE.W  #$FF00,D1
000018E2  4E4F                     783              TRAP    #15
000018E4                           784              
000018E4                           785              ;ENABLE TIMED INTERRPUT
000018E4  303C 0020                786              MOVE.W  #32,D0
000018E8  123C 0006                787              MOVE.B  #6,D1
000018EC  143C 0081                788              MOVE.B  #$81,D2                   ;INDICATE THAT INTERRUPT 1 IS ACTIVATED PERIODICALLY
000018F0  7614                     789              MOVE.L  #20,D3                    ;INDICATE THE MILISECONDS FOR THAT PERIOD (20 ms == 50 FPS)
000018F2  4E4F                     790              TRAP    #15
000018F4                           791              
000018F4                           792              ;CLEAR INTERRUPT COUNTER
000018F4  4239 000021D2            793              CLR.B   (SCRINTCT)
000018FA                           794              
000018FA  4CDF 0003                795              MOVEM.L (A7)+,D0-D1               ;RESTORE REGISTERS FROM STACK
000018FE                           796              
000018FE  4E75                     797              RTS
00001900                           798  
00001900                           799  
00001900                           800              
00001900                           801  ;------------------------------------------------------------------------------            
00001900                           802  SCRUPD
00001900                           803  ; UPDATES DOUBLE BUFFER
00001900                           804  ; INPUT    : NONE
00001900                           805  ; OUTPUT   : NONE
00001900                           806  ; MODIFIES : NONE
00001900                           807  ; ------------------------------------------------------------------------------
00001900                           808  
00001900  48E7 C000                809              MOVEM.L D0-D1,-(A7)
00001904                           810              
00001904                           811              ;SWITCH BUFFERS
00001904  103C 005E                812              MOVE.B #94,D0
00001908  4E4F                     813              TRAP #15
0000190A                           814              
0000190A                           815              ;CLEAR HIDDEN BUFFER
0000190A  103C 000B                816              MOVE.B  #11,D0
0000190E  323C FF00                817              MOVE.W  #$FF00,D1
00001912  4E4F                     818              TRAP    #15
00001914                           819              
00001914  4CDF 0003                820              MOVEM.L (A7)+,D0-D1
00001918                           821              
00001918  4E73                     822              RTE
0000191A                           823              
0000191A                           824  ; ------------------------------------------------------------------------------
0000191A                           825  SCRTIM
0000191A                           826  ; TIMED INTERRUPT SERVICE ROUTINE
0000191A                           827  ; INPUT    : NONE
0000191A                           828  ; OUTPUT   : NONE
0000191A                           829  ; MODIFIES : NONE
0000191A                           830  ; ------------------------------------------------------------------------------
0000191A  5239 000021D2            831              ADDQ.B  #1,(SCRINTCT)
00001920  5239 000021D3            832              ADDQ.B  #1,(SCRCYCCT)
00001926  4E73                     833              RTE
00001928                           834              
00001928                           835  ;------------------------------------------------------------------------------            
00001928                           836  KBDINIT
00001928                           837  ; INIT THE KEYBOARD
00001928                           838  ; INPUT    : NONE
00001928                           839  ; OUTPUT   : NONE
00001928                           840  ; MODIFIES : NONE
00001928                           841  ; ------------------------------------------------------------------------------
00001928                           842  
00001928  4239 000021D0            843              CLR.B   (KBDVAL)
0000192E  4239 000021D1            844              CLR.B   (KBDEDGE)
00001934                           845  
00001934  4E75                     846              RTS
00001936                           847  
00001936                           848  ;------------------------------------------------------------------------------            
00001936                           849  KBDUPD
00001936                           850  ; UPDATES KEYBOARD INFO
00001936                           851  ; 3 -> DOWN
00001936                           852  ; 2 -> RIGHT
00001936                           853  ; 1 -> UP
00001936                           854  ; 0 -> LEFT
00001936                           855  ; ------------------------------------------------------------------------------
00001936                           856              
00001936  48E7 F800                857              MOVEM.L D0-D4,-(A7)
0000193A                           858              
0000193A  303C 0013                859              MOVE.W  #19,D0
0000193E                           860              ;GET INFO OF THE KEYS
0000193E  223C 28272625            861              MOVE.L  #KBDDOWN<<24|KBDRIGHT<<16|KBDUP<<8|KBDLEFT,D1
00001944  4E4F                     862              TRAP    #15
00001946                           863              
00001946                           864              ;CONVERT TO DESIRED FORMAT
00001946  4EB9 00001970            865              JSR .CONVERT
0000194C                           866  
0000194C                           867              ;GET KBDEDGE (IF SOME KEY HAVE CHANGED THE VALUE)
0000194C  1039 000021D0            868              MOVE.B  (KBDVAL),D0             ;D0 -> LAST KBDVAL
00001952  4600                     869              NOT.B   D0                      ;D2 -> ACTUAL KBDVAL
00001954  C002                     870              AND.B   D2,D0
00001956  13C0 000021D1            871              MOVE.B  D0,(KBDEDGE)
0000195C                           872              
0000195C                           873         
0000195C  B03C 0000                874              CMP.B   #0,D0
00001960  6700 0008                875              BEQ     .NOACT          
00001964                           876              
00001964                           877              ;STORE NEW KBDVAL
00001964  13C2 000021D0            878              MOVE.B  D2,(KBDVAL)
0000196A                           879  .NOACT
0000196A                           880              
0000196A  4CDF 001F                881              MOVEM.L (A7)+,D0-D4
0000196E                           882              
0000196E  4E73                     883              RTE    
00001970                           884              
00001970                           885  .CONVERT 
00001970  363C 0003                886              MOVE.W  #3,D3
00001974                           887              
00001974  E189                     888  .LOOP       LSL.L   #8,D1
00001976  E312                     889              ROXL.B  #1,D2
00001978  51CB FFFA                890              DBRA.W  D3,.LOOP
0000197C  4E75                     891              RTS
0000197E                           892             
0000197E                           893  
0000197E                           894  ;------------------------------------------------------------------------------            
0000197E                           895  COLWALLRIGHT
0000197E                           896  ; COLLISION PAC-MAN WITH WALL
0000197E                           897  ; INPUT    : NONE
0000197E                           898  ; OUTPUT   : NONE
0000197E                           899  ; MODIFIES : NONE
0000197E                           900  ; ------------------------------------------------------------------------------
0000197E                           901  
0000197E  48E7 F800                902              MOVEM.L D0-D4,-(A7)
00001982                           903  
00001982  3039 000025D6            904              MOVE.W  (PMPOSX),D0
00001988  5140                     905              SUB.W   #8,D0
0000198A  3239 000025D8            906              MOVE.W  (PMPOSY),D1
00001990  5041                     907              ADD.W   #8,D1
00001992                           908              
00001992  81FC 0010                909              DIVS.W  #16,D0
00001996  83FC 0010                910              DIVS.W  #16,D1
0000199A                           911              
0000199A  5940                     912              SUB.W   #4,D0                   ;LI RESTAM 4 PERQUE LA MATRIU ESTA A UNA DISTANCIA DE 64 PIXELS DE LA PANTALLA
0000199C  5941                     913              SUB.W   #4,D1
0000199E                           914              
0000199E  41F9 000021D4            915              LEA.L   MAPVAR,A0
000019A4                           916              
000019A4  5240                     917              ADD.W   #1,D0
000019A6  5341                     918              SUB.W   #1,D1
000019A8  C2FC 0020                919              MULU.W  #32,D1
000019AC  D041                     920              ADD.W   D1,D0
000019AE                           921              
000019AE  3240                     922              MOVE.W  D0,A1
000019B0  13C0 000025D4            923              MOVE.B  D0,POSCON
000019B6                           924  
000019B6  1A29 21D4                925              MOVE.B  MAPVAR(A1),D5
000019BA                           926              
000019BA  4CDF 001F                927              MOVEM.L (A7)+,D0-D4
000019BE                           928              
000019BE  4E75                     929              RTS
000019C0                           930  
000019C0                           931  
000019C0                           932  ;------------------------------------------------------------------------------            
000019C0                           933  COLWALLLEFT
000019C0                           934  ; COLLISION PAC-MAN WITH WALL
000019C0                           935  ; INPUT    : NONE
000019C0                           936  ; OUTPUT   : NONE
000019C0                           937  ; MODIFIES : NONE
000019C0                           938  ; ------------------------------------------------------------------------------
000019C0                           939  
000019C0  48E7 F800                940              MOVEM.L D0-D4,-(A7)
000019C4                           941  
000019C4  3039 000025D6            942              MOVE.W  (PMPOSX),D0
000019CA  5C40                     943              ADD.W   #6,D0
000019CC  3239 000025D8            944              MOVE.W  (PMPOSY),D1
000019D2  5041                     945              ADD.W   #8,D1
000019D4                           946              
000019D4  81FC 0010                947              DIVS.W  #16,D0
000019D8  83FC 0010                948              DIVS.W  #16,D1
000019DC                           949              
000019DC  5940                     950              SUB.W   #4,D0                   ;LI RESTAM 4 PERQUE LA MATRIU ESTA A UNA DISTANCIA DE 64 PIXELS DE LA PANTALLA
000019DE  5941                     951              SUB.W   #4,D1
000019E0                           952              
000019E0  41F9 000021D4            953              LEA.L   MAPVAR,A0
000019E6                           954              
000019E6  5340                     955              SUB.W   #1,D0
000019E8  5341                     956              SUB.W   #1,D1
000019EA  C2FC 0020                957              MULU.W  #32,D1
000019EE  D041                     958              ADD.W   D1,D0
000019F0                           959  
000019F0  3240                     960              MOVE.W  D0,A1
000019F2  13C0 000025D4            961              MOVE.B  D0,POSCON
000019F8                           962  
000019F8  1A29 21D4                963              MOVE.B  MAPVAR(A1),D5               
000019FC                           964  
000019FC                           965              
000019FC  4CDF 001F                966              MOVEM.L (A7)+,D0-D4
00001A00                           967              
00001A00  4E75                     968              RTS
00001A02                           969  
00001A02                           970  ;------------------------------------------------------------------------------            
00001A02                           971  COLWALLDOWN
00001A02                           972  ; COLLISION PAC-MAN WITH WALL
00001A02                           973  ; INPUT    : NONE
00001A02                           974  ; OUTPUT   : NONE
00001A02                           975  ; MODIFIES : NONE
00001A02                           976  ; ------------------------------------------------------------------------------
00001A02                           977  
00001A02  48E7 F800                978              MOVEM.L D0-D4,-(A7)
00001A06                           979  
00001A06  3039 000025D6            980              MOVE.W  (PMPOSX),D0
00001A0C                           981              ;ADD.W   #8,D0
00001A0C  3239 000025D8            982              MOVE.W  (PMPOSY),D1
00001A12  5041                     983              ADD.W   #8,D1
00001A14                           984              
00001A14  81FC 0010                985              DIVS.W  #16,D0
00001A18  83FC 0010                986              DIVS.W  #16,D1
00001A1C                           987              
00001A1C  5940                     988              SUB.W   #4,D0                   ;LI RESTAM 4 PERQUE LA MATRIU ESTA A UNA DISTANCIA DE 64 PIXELS DE LA PANTALLA
00001A1E  5941                     989              SUB.W   #4,D1
00001A20                           990              
00001A20  41F9 000021D4            991              LEA.L   MAPVAR,A0
00001A26                           992              
00001A26  C2FC 0020                993              MULU.W  #32,D1
00001A2A  D041                     994              ADD.W   D1,D0
00001A2C                           995  
00001A2C  3240                     996              MOVE.W  D0,A1
00001A2E  13C0 000025D4            997              MOVE.B  D0,POSCON
00001A34                           998  
00001A34  1A29 21D4                999              MOVE.B  MAPVAR(A1),D5 
00001A38                          1000  
00001A38                          1001              
00001A38  4CDF 001F               1002              MOVEM.L (A7)+,D0-D4
00001A3C                          1003              
00001A3C  4E75                    1004              RTS
00001A3E                          1005  
00001A3E                          1006  
00001A3E                          1007  ;------------------------------------------------------------------------------            
00001A3E                          1008  COLWALLUP
00001A3E                          1009  ; COLLISION PAC-MAN WITH WALL
00001A3E                          1010  ; INPUT    : NONE
00001A3E                          1011  ; OUTPUT   : NONE
00001A3E                          1012  ; MODIFIES : NONE
00001A3E                          1013  ; ------------------------------------------------------------------------------
00001A3E                          1014  
00001A3E  48E7 F800               1015              MOVEM.L D0-D4,-(A7)
00001A42                          1016  
00001A42  3039 000025D6           1017              MOVE.W  (PMPOSX),D0
00001A48                          1018              ;SUB.W   #8,D0
00001A48  3239 000025D8           1019              MOVE.W  (PMPOSY),D1
00001A4E  5C41                    1020              ADD.W   #6,D1
00001A50                          1021              
00001A50                          1022              
00001A50  81FC 0010               1023              DIVS.W  #16,D0
00001A54  83FC 0010               1024              DIVS.W  #16,D1
00001A58                          1025              
00001A58  5940                    1026              SUB.W   #4,D0                   ;LI RESTAM 4 PERQUE LA MATRIU ESTA A UNA DISTANCIA DE 64 PIXELS DE LA PANTALLA
00001A5A  5941                    1027              SUB.W   #4,D1
00001A5C                          1028              
00001A5C  41F9 000021D4           1029              LEA.L   MAPVAR,A0
00001A62                          1030              
00001A62  5341                    1031              SUB.W   #1,D1
00001A64                          1032              ;CMP     #1,D1
00001A64                          1033              ;BLO     BUCLE4
00001A64  C2FC 0020               1034              MULU.W  #32,D1
00001A68  D041                    1035              ADD.W   D1,D0
00001A6A                          1036  
00001A6A                          1037  ;BUCLE4            
00001A6A  3240                    1038              MOVE.W  D0,A1
00001A6C  13C0 000025D4           1039              MOVE.B  D0,POSCON
00001A72                          1040  
00001A72  1A29 21D4               1041              MOVE.B  MAPVAR(A1),D5 
00001A76                          1042  
00001A76                          1043              ;MOVE.B  #0,D5
00001A76                          1044              
00001A76  4CDF 001F               1045              MOVEM.L (A7)+,D0-D4
00001A7A                          1046              
00001A7A  4E75                    1047              RTS
00001A7C                          1048  
00001A7C                          1049  
00001A7C                          1050  ;------------------------------------------------------------------------------            
00001A7C                          1051  GETPOINTS
00001A7C                          1052  ; COLLISION PAC-MAN WITH WALL
00001A7C                          1053  ; INPUT    : NONE
00001A7C                          1054  ; OUTPUT   : NONE
00001A7C                          1055  ; MODIFIES : NONE
00001A7C                          1056  ; ------------------------------------------------------------------------------
00001A7C                          1057  
00001A7C  48E7 F800               1058              MOVEM.L D0-D4,-(A7)
00001A80                          1059  
00001A80  3039 000025D6           1060              MOVE.W  (PMPOSX),D0
00001A86                          1061              ;SUB.W   #8,D0
00001A86  3239 000025D8           1062              MOVE.W  (PMPOSY),D1
00001A8C  0641 0010               1063              ADD.W   #16,D1
00001A90                          1064              
00001A90                          1065              
00001A90  81FC 0010               1066              DIVS.W  #16,D0
00001A94  83FC 0010               1067              DIVS.W  #16,D1
00001A98                          1068              
00001A98  5940                    1069              SUB.W   #4,D0                   ;LI RESTAM 4 PERQUE LA MATRIU ESTA A UNA DISTANCIA DE 64 PIXELS DE LA PANTALLA
00001A9A  5941                    1070              SUB.W   #4,D1
00001A9C                          1071                          
00001A9C  5341                    1072              SUB.W   #1,D1
00001A9E  C2FC 0020               1073              MULU.W  #32,D1
00001AA2  D041                    1074              ADD.W   D1,D0
00001AA4                          1075  
00001AA4  3240                    1076              MOVE.W  D0,A1
00001AA6  1A29 21D4               1077              MOVE.B  MAPVAR(A1),D5
00001AAA                          1078              
00001AAA  BA7C 0000               1079              CMP     #0,D5
00001AAE  6700 003A               1080              BEQ     .DONE
00001AB2  BA7C 0002               1081              CMP     #2,D5
00001AB6  6700 0020               1082              BEQ     .POINT
00001ABA  BA7C 0003               1083              CMP     #3,D5
00001ABE  6700 0006               1084              BEQ     .BPOINT
00001AC2  6600 0026               1085              BNE     .DONE
00001AC6                          1086  .BPOINT
00001AC6  137C 0000 21D4          1087              MOVE.B  #0,MAPVAR(A1)
00001ACC  0679 0032 000025EE      1088              ADD.W   #50,(SCOPOINTS)
00001AD4  6600 0014               1089              BNE     .DONE
00001AD8                          1090  .POINT
00001AD8  137C 0000 21D4          1091              MOVE.B  #0,MAPVAR(A1)
00001ADE  0679 000A 000025EE      1092              ADD.W   #10,(SCOPOINTS)
00001AE6  6600 0002               1093              BNE     .DONE            
00001AEA                          1094  .DONE                        
00001AEA  4CDF 001F               1095              MOVEM.L (A7)+,D0-D4
00001AEE                          1096              
00001AEE  4E75                    1097              RTS
00001AF0                          1098  
00001AF0                          1099  
00001AF0                          1100  
00001AF0                          1101  
00001AF0                          1102  -------------------- end include --------------------
00001AF0                          1103              INCLUDE "MAP.X68"
00001AF0                          1104  
00001AF0                          1105  ; ------------------------------------------------------------------------------
00001AF0                          1106  MAPINIT
00001AF0                          1107  ; INIT MAP
00001AF0                          1108  ; INPUT    : NONE
00001AF0                          1109  ; OUTPUT   : NONE
00001AF0                          1110  ; MODIFIES : NONE
00001AF0                          1111  ; ------------------------------------------------------------------------------            
00001AF0                          1112              
00001AF0                          1113              ;MOVE.L  #DIBFIGWALL,($80+2*4)          ;INSTALL SUBRUTINE TO TRAP #2
00001AF0                          1114              ;MOVE.L  #DIBFIGPOINT,($80+3*4)          ;INSTALL SUBRUTINE TO TRAP #3
00001AF0                          1115              ;MOVE.L  #DIBFIGBPOINT,($80+4*4)          ;INSTALL SUBRUTINE TO TRAP #4
00001AF0                          1116              
00001AF0  48E7 FE00               1117              MOVEM.L D0-D6,-(A7)
00001AF4  48E7 00C0               1118              MOVEM.L A0-A1,-(A7)
00001AF8                          1119              
00001AF8  41F8 1000               1120              LEA.L   MAPMAT,A0
00001AFC  43F9 000021D4           1121              LEA.L   MAPVAR,A1
00001B02  3C3C 0030               1122              MOVE.W  #48,D6
00001B06  343C 001F               1123              MOVE.W  #31,D2
00001B0A                          1124  BUCLE_FILA
00001B0A  3A3C 0030               1125              MOVE.W  #48,D5
00001B0E  323C 001F               1126              MOVE.W  #31,D1
00001B12  0646 0010               1127              ADD.W   #16,D6
00001B16                          1128  
00001B16                          1129  BUCLE_COLUMNA
00001B16  0645 0010               1130              ADD.W   #16,D5
00001B1A                          1131  
00001B1A  1018                    1132              MOVE.B  (A0)+,D0
00001B1C  12C0                    1133              MOVE.B  D0,(A1)+
00001B1E                          1134               
00001B1E  B07C 0000               1135              CMP     #0,D0
00001B22  6700 0034               1136              BEQ     ZERO
00001B26  B07C 0004               1137              CMP     #4,D0
00001B2A  6700 002C               1138              BEQ     ZERO
00001B2E  B07C 0001               1139              CMP     #1,D0
00001B32  6600 0008               1140              BNE     NOTWALL
00001B36  4EB9 00001BDE           1141              JSR     DIBFIGWALL
00001B3C                          1142  NOTWALL
00001B3C  B07C 0002               1143              CMP     #2,D0
00001B40  6600 0008               1144              BNE     NOTPOINT
00001B44  4EB9 00001C16           1145              JSR     DIBFIGPOINT
00001B4A                          1146  NOTPOINT
00001B4A  B07C 0003               1147              CMP     #3,D0
00001B4E  6600 0008               1148              BNE     ZERO
00001B52  4EB9 00001C52           1149              JSR     DIBFIGBPOINT
00001B58                          1150           
00001B58                          1151  ZERO
00001B58  51C9 FFBC               1152              DBRA    D1,BUCLE_COLUMNA  
00001B5C  51CA FFAC               1153              DBRA    D2,BUCLE_FILA
00001B60                          1154              
00001B60  4CDF 0300               1155              MOVEM.L (A7)+,A0-A1
00001B64  4CDF 007F               1156              MOVEM.L (A7)+,D0-D6
00001B68                          1157  
00001B68                          1158  
00001B68                          1159              
00001B68  4E75                    1160              RTS            
00001B6A                          1161  
00001B6A                          1162  ; ------------------------------------------------------------------------------
00001B6A                          1163  MAPPLOT
00001B6A                          1164  ; INIT MAP
00001B6A                          1165  ; INPUT    : NONE
00001B6A                          1166  ; OUTPUT   : NONE
00001B6A                          1167  ; MODIFIES : NONE
00001B6A                          1168  ; ------------------------------------------------------------------------------            
00001B6A                          1169  
00001B6A  48E7 FE00               1170              MOVEM.L D0-D6,-(A7)
00001B6E  48E7 0080               1171              MOVEM.L A0,-(A7)
00001B72                          1172  
00001B72  41F9 000021D4           1173              LEA.L   MAPVAR,A0
00001B78  3C3C 0030               1174              MOVE.W  #48,D6
00001B7C  343C 001F               1175              MOVE.W  #31,D2
00001B80                          1176  BUCLE_FILA2
00001B80  3A3C 0030               1177              MOVE.W  #48,D5
00001B84  323C 001F               1178              MOVE.W  #31,D1
00001B88  0646 0010               1179              ADD.W   #16,D6
00001B8C                          1180  
00001B8C                          1181  BUCLE_COLUMNA2
00001B8C  0645 0010               1182              ADD.W   #16,D5       
00001B90                          1183  
00001B90  1018                    1184              MOVE.B  (A0)+,D0
00001B92                          1185  
00001B92  B07C 0000               1186              CMP     #0,D0
00001B96  6700 0034               1187              BEQ     ZERO2
00001B9A  B07C 0004               1188              CMP     #4,D0
00001B9E  6700 002C               1189              BEQ     ZERO2
00001BA2  B07C 0001               1190              CMP     #1,D0
00001BA6  6600 0008               1191              BNE     NOTWALL2
00001BAA  4EB9 00001BDE           1192              JSR     DIBFIGWALL
00001BB0                          1193  NOTWALL2
00001BB0  B07C 0002               1194              CMP     #2,D0
00001BB4  6600 0008               1195              BNE     NOTPOINT2
00001BB8  4EB9 00001C16           1196              JSR     DIBFIGPOINT
00001BBE                          1197  NOTPOINT2
00001BBE  B07C 0003               1198              CMP     #3,D0
00001BC2  6600 0008               1199              BNE     ZERO2
00001BC6  4EB9 00001C52           1200              JSR     DIBFIGBPOINT
00001BCC                          1201  
00001BCC                          1202     
00001BCC                          1203  ZERO2
00001BCC  51C9 FFBE               1204              DBRA    D1,BUCLE_COLUMNA2
00001BD0                          1205              
00001BD0  51CA FFAE               1206              DBRA    D2,BUCLE_FILA2
00001BD4                          1207              
00001BD4  4CDF 0100               1208              MOVEM.L (A7)+,A0
00001BD8  4CDF 007F               1209              MOVEM.L (A7)+,D0-D6
00001BDC                          1210              
00001BDC                          1211              
00001BDC  4E75                    1212              RTS 
00001BDE                          1213              
00001BDE                          1214  ; -----------------------------------------------------------------------------
00001BDE                          1215  DIBFIGWALL
00001BDE                          1216  ; SUBRUTINE DRAW MAP
00001BDE                          1217  ; INPUT    : D5=POSITION X, D6=POSITION Y
00001BDE                          1218  ; OUTPUT   : NONE
00001BDE                          1219  ; MODIFIES : NONE
00001BDE                          1220  ; -----------------------------------------------------------------------------
00001BDE  48E7 FE00               1221              MOVEM.L D0-D6,-(A7)
00001BE2                          1222              ; SET CONTOURN COLOR
00001BE2  103C 0050               1223              MOVE.B  #80,D0
00001BE6  223C 00AA0000           1224              MOVE.L  #$00AA0000,D1
00001BEC  4E4F                    1225              TRAP    #15
00001BEE                          1226              
00001BEE                          1227              ; SET FILL COLOR
00001BEE  103C 0051               1228              MOVE.B  #81,D0
00001BF2  223C 00FF0000           1229              MOVE.L  #$00FF0000,D1
00001BF8  4E4F                    1230              TRAP    #15
00001BFA                          1231              
00001BFA                          1232              ; DEFINE COORDINATES RECTANGLE
00001BFA  3205                    1233              MOVE.W  D5,D1
00001BFC  3406                    1234              MOVE.W  D6,D2
00001BFE  0645 0010               1235              ADD.W   #16,D5
00001C02  0646 0010               1236              ADD.W   #16,D6
00001C06  3605                    1237              MOVE.W  D5,D3
00001C08  3806                    1238              MOVE.W  D6,D4
00001C0A                          1239              
00001C0A                          1240              ; DRAW RECTANGLE
00001C0A  103C 0057               1241              MOVE.B  #87,D0
00001C0E  4E4F                    1242              TRAP    #15
00001C10                          1243              
00001C10  4CDF 007F               1244              MOVEM.L (A7)+,D0-D6
00001C14                          1245  
00001C14  4E75                    1246              RTS
00001C16                          1247              
00001C16                          1248  ; -----------------------------------------------------------------------------
00001C16                          1249  DIBFIGPOINT
00001C16                          1250  ; SUBRUTINE DRAW MAP
00001C16                          1251  ; INPUT    : D5=POSITION X, D6=POSITION Y
00001C16                          1252  ; OUTPUT   : NONE
00001C16                          1253  ; MODIFIES : NONE
00001C16                          1254  ; -----------------------------------------------------------------------------
00001C16  48E7 FE00               1255              MOVEM.L D0-D6,-(A7)
00001C1A                          1256              ; SET CONTOURN COLOR
00001C1A  103C 0050               1257              MOVE.B  #80,D0
00001C1E  223C 0000AAAA           1258              MOVE.L  #$0000AAAA,D1
00001C24  4E4F                    1259              TRAP    #15
00001C26                          1260              
00001C26                          1261              ; SET FILL COLOR
00001C26  103C 0051               1262              MOVE.B  #81,D0
00001C2A  223C 0000FFFF           1263              MOVE.L  #$0000FFFF,D1
00001C30  4E4F                    1264              TRAP    #15
00001C32                          1265              
00001C32                          1266              ; DEFINE COORDINATES RECTANGLE
00001C32  3205                    1267              MOVE.W  D5,D1
00001C34  5041                    1268              ADD.W   #8,D1
00001C36  5541                    1269              SUB.W   #2,D1
00001C38  3406                    1270              MOVE.W  D6,D2
00001C3A  5042                    1271              ADD.W   #8,D2
00001C3C  5542                    1272              SUB.W   #2,D2
00001C3E                          1273              
00001C3E  3601                    1274              MOVE.W  D1,D3
00001C40  5843                    1275              ADD.W   #2*2,D3
00001C42  3802                    1276              MOVE.W  D2,D4
00001C44  5844                    1277              ADD.W   #2*2,D4
00001C46                          1278              
00001C46                          1279              ; DRAW POINT
00001C46  103C 0058               1280              MOVE.B  #88,D0
00001C4A  4E4F                    1281              TRAP    #15
00001C4C                          1282              
00001C4C  4CDF 007F               1283              MOVEM.L (A7)+,D0-D6
00001C50                          1284              
00001C50  4E75                    1285              RTS
00001C52                          1286  
00001C52                          1287  
00001C52                          1288  ; -----------------------------------------------------------------------------
00001C52                          1289  DIBFIGBPOINT
00001C52                          1290  ; SUBRUTINE DRAW MAP
00001C52                          1291  ; INPUT    : D5=POSITION X, D6=POSITION Y
00001C52                          1292  ; OUTPUT   : NONE
00001C52                          1293  ; MODIFIES : NONE
00001C52                          1294  ; -----------------------------------------------------------------------------
00001C52  48E7 FE00               1295              MOVEM.L D0-D6,-(A7)
00001C56                          1296              ; SET CONTOURN COLOR
00001C56  103C 0050               1297              MOVE.B  #80,D0
00001C5A  223C 0000AAAA           1298              MOVE.L  #$0000AAAA,D1
00001C60  4E4F                    1299              TRAP    #15
00001C62                          1300              
00001C62                          1301              ; SET FILL COLOR
00001C62  103C 0051               1302              MOVE.B  #81,D0
00001C66  223C 0000FFFF           1303              MOVE.L  #$0000FFFF,D1
00001C6C  4E4F                    1304              TRAP    #15
00001C6E                          1305              
00001C6E                          1306              ; DEFINE COORDINATES RECTANGLE
00001C6E  3205                    1307              MOVE.W  D5,D1
00001C70  5041                    1308              ADD.W   #8,D1
00001C72  5941                    1309              SUB.W   #4,D1
00001C74  3406                    1310              MOVE.W  D6,D2
00001C76  5042                    1311              ADD.W   #8,D2
00001C78  5942                    1312              SUB.W   #4,D2
00001C7A                          1313              
00001C7A  3601                    1314              MOVE.W  D1,D3
00001C7C  5043                    1315              ADD.W   #4*2,D3
00001C7E  3802                    1316              MOVE.W  D2,D4
00001C80  5044                    1317              ADD.W   #4*2,D4
00001C82                          1318              
00001C82                          1319              ; DRAW BIG POINT
00001C82  103C 0058               1320              MOVE.B  #88,D0
00001C86  4E4F                    1321              TRAP    #15
00001C88                          1322              
00001C88  4CDF 007F               1323              MOVEM.L (A7)+,D0-D6
00001C8C                          1324              
00001C8C  4E75                    1325              RTS
00001C8E                          1326  
00001C8E                          1327  
00001C8E                          1328  
00001C8E                          1329  
00001C8E                          1330  
00001C8E                          1331  
00001C8E                          1332  
00001C8E                          1333  
00001C8E                          1334  
00001C8E                          1335  
00001C8E                          1336  
00001C8E                          1337  
00001C8E                          1338  -------------------- end include --------------------
00001C8E                          1339              INCLUDE "LIB/UTLCONST.X68"
00001C8E                          1340  ; ==============================================================================
00001C8E                          1341  ; UTIL CONSTANTS
00001C8E                          1342  ; ==============================================================================
00001C8E                          1343  
00001C8E  =00000008               1344  UTLCHRWD    EQU     8                       ; CHARACTER WIDTH IN PIXELS
00001C8E                          1345  
00001C8E                          1346  -------------------- end include --------------------
00001C8E                          1347              INCLUDE "LIB/UTLCODE.X68"
00001C8E                          1348  ; =============================================================================
00001C8E                          1349  ; UTILITY CODE
00001C8E                          1350  ; =============================================================================
00001C8E                          1351  
00001C8E                          1352  ; -----------------------------------------------------------------------------
00001C8E                          1353  UTLINIT
00001C8E                          1354  ; INITIALIZES UTILITY CODE
00001C8E                          1355  ; INPUT    - NONE
00001C8E                          1356  ; OUTPUT   - NONE
00001C8E                          1357  ; MODIFIES - NONE
00001C8E                          1358  ; -----------------------------------------------------------------------------
00001C8E  48E7 C000               1359              MOVEM.L D0-D1,-(A7)
00001C92  103C 0008               1360              MOVE.B  #8,D0
00001C96  4E4F                    1361              TRAP    #15
00001C98  13C1 000025F6           1362              MOVE.B  D1,(UTLRNDIX)
00001C9E  4CDF 0003               1363              MOVEM.L (A7)+,D0-D1
00001CA2  4E75                    1364              RTS
00001CA4                          1365  
00001CA4                          1366  ; -----------------------------------------------------------------------------
00001CA4                          1367  UTLPRINT
00001CA4                          1368  ; PRINT SCREEN CENTERED TEXT
00001CA4                          1369  ; INPUT    : A0 POINTER TO ZERO-TERMINATED STRING
00001CA4                          1370  ;            D0.B SCREEN ROW TO PRINT TEXT
00001CA4                          1371  ; OUTPUT   : D0.B NEXT ROW
00001CA4                          1372  ; MODIFIES : NONE (ASIDE OF OUTPUT)
00001CA4                          1373  ; -----------------------------------------------------------------------------
00001CA4  48E7 C0C0               1374              MOVEM.L D0-D1/A0-A1,-(A7)
00001CA8  4201                    1375              CLR.B   D1
00001CAA  2248                    1376              MOVE.L  A0,A1
00001CAC  4A18                    1377  .LOOP       TST.B   (A0)+
00001CAE  6700 0006               1378              BEQ     .ENDLOOP
00001CB2  5201                    1379              ADDQ.B  #1,D1
00001CB4  60F6                    1380              BRA     .LOOP
00001CB6  E209                    1381  .ENDLOOP    LSR.B   #1,D1
00001CB8  0401 0028               1382              SUB.B   #(SCRWIDTH/UTLCHRWD)/2,D1
00001CBC  4401                    1383              NEG.B   D1
00001CBE  E141                    1384              ASL.W   #8,D1
00001CC0  8240                    1385              OR.W    D0,D1
00001CC2  103C 000B               1386              MOVE.B  #11,D0
00001CC6  4E4F                    1387              TRAP    #15
00001CC8  103C 000D               1388              MOVE.B  #13,D0
00001CCC  4E4F                    1389              TRAP    #15
00001CCE  4CDF 0303               1390              MOVEM.L (A7)+,D0-D1/A0-A1
00001CD2  5200                    1391              ADDQ.B  #1,D0
00001CD4  4E75                    1392              RTS
00001CD6                          1393              
00001CD6                          1394              
00001CD6                          1395  
00001CD6                          1396  
00001CD6                          1397              ; (SCRWIDTH/UTLCHRWD)/2 - D1/2
00001CD6                          1398  
00001CD6                          1399  
00001CD6                          1400  ; -----------------------------------------------------------------------------
00001CD6                          1401  UTLRAND
00001CD6                          1402  ; PROVIDES A PSEUDO-RANDOM BYTE
00001CD6                          1403  ; INPUT    - NONE
00001CD6                          1404  ; OUTPUT   - D0.L RANDOM VALUE (ONLY BYTE)
00001CD6                          1405  ; MODIFIES - NONE (ASIDE OF OUTPUT)
00001CD6                          1406  ; -----------------------------------------------------------------------------
00001CD6  2F08                    1407              MOVE.L  A0,-(A7)
00001CD8  41F9 00001CF4           1408              LEA     .RANDVEC,A0
00001CDE  4280                    1409              CLR.L   D0
00001CE0  1039 000025F6           1410              MOVE.B  (UTLRNDIX),D0
00001CE6  1030 0800               1411              MOVE.B  (A0,D0.L),D0
00001CEA  5239 000025F6           1412              ADDQ.B  #1,(UTLRNDIX)
00001CF0  205F                    1413              MOVE.L  (A7)+,A0
00001CF2  4E75                    1414              RTS
00001CF4                          1415  
00001CF4                          1416  
00001CF4= A2 EE 9A 0C F5 24 ...   1417  .RANDVEC    DC.B    162, 238, 154, 12 , 245, 36 , 32 , 103
00001CFC= 2A A3 51 26 E0 AC ...   1418              DC.B    42 , 163, 81 , 38 , 224, 172, 19 , 69
00001D04= 75 51 CA FD 33 EB ...   1419              DC.B    117, 81 , 202, 253, 51 , 235, 108, 154
00001D0C= 60 CC E7 B8 9A EB ...   1420              DC.B    96 , 204, 231, 184, 154, 235, 34 , 203
00001D14= 1D 76 B5 95 B0 89 ...   1421              DC.B    29 , 118, 181, 149, 176, 137, 62 , 108
00001D1C= 39 15 48 C9 6E CA ...   1422              DC.B    57 , 21 , 72 , 201, 110, 202, 159, 41
00001D24= 43 E7 E2 7C 37 25 ...   1423              DC.B    67 , 231, 226, 124, 55 , 37 , 84 , 62
00001D2C= E9 94 CE E9 E4 52 ...   1424              DC.B    233, 148, 206, 233, 228, 82 , 243, 78
00001D34= 37 6D 9A 84 A2 28 ...   1425              DC.B    55 , 109, 154, 132, 162, 40 , 30 , 39
00001D3C= 19 E2 C6 77 80 D4 ...   1426              DC.B    25 , 226, 198, 119, 128, 212, 232, 225
00001D44= 0A 5A 32 67 33 C2 ...   1427              DC.B    10 , 90 , 50 , 103, 51 , 194, 222, 40
00001D4C= 59 80 DC 0E 57 FC ...   1428              DC.B    89 , 128, 220, 14 , 87 , 252, 243, 252
00001D54= 8A AB BC F7 07 4D ...   1429              DC.B    138, 171, 188, 247, 7  , 77 , 29 , 234
00001D5C= EF D5 77 6E 1E BB ...   1430              DC.B    239, 213, 119, 110, 30 , 187, 131, 23
00001D64= D6 E0 2A 8F BD 28 ...   1431              DC.B    214, 224, 42 , 143, 189, 40 , 212, 130
00001D6C= 13 4F 66 EC 0A 64 ...   1432              DC.B    19 , 79 , 102, 236, 10 , 100, 122, 188
00001D74= 56 52 9A 16 9B 90 ...   1433              DC.B    86 , 82 , 154, 22 , 155, 144, 7  , 199
00001D7C= 06 8A A4 F7 01 DA ...   1434              DC.B    6  , 138, 164, 247, 1  , 218, 166, 82
00001D84= F2 E7 77 28 B1 76 ...   1435              DC.B    242, 231, 119, 40 , 177, 118, 220, 102
00001D8C= A4 42 E3 81 B1 67 ...   1436              DC.B    164, 66 , 227, 129, 177, 103, 165, 108
00001D94= BF CE FA 16 BF 38 ...   1437              DC.B    191, 206, 250, 22 , 191, 56 , 30 , 161
00001D9C= D1 8B 50 0C 5F 49 ...   1438              DC.B    209, 139, 80 , 12 , 95 , 73 , 168, 56
00001DA4= DE 4C 14 A2 40 DC ...   1439              DC.B    222, 76 , 20 , 162, 64 , 220, 93 , 12
00001DAC= B6 9B 0A 38 5D AB ...   1440              DC.B    182, 155, 10 , 56 , 93 , 171, 89 , 6
00001DB4= E2 1B DD 75 15 82 ...   1441              DC.B    226, 27 , 221, 117, 21 , 130, 101, 18
00001DBC= 8A 26 51 30 9F 47 ...   1442              DC.B    138, 38 , 81 , 48 , 159, 71 , 57 , 21
00001DC4= 1E 8A BB 71 C6 6E ...   1443              DC.B    30 , 138, 187, 113, 198, 110, 185, 152
00001DCC= 9F 47 E5 34 94 27 ...   1444              DC.B    159, 71 , 229, 52 , 148, 39 , 77 , 6
00001DD4= 7D 06 D6 BA 30 0F ...   1445              DC.B    125, 6  , 214, 186, 48 , 15 , 212, 22
00001DDC= EC 7F 7E 03 CF 2D ...   1446              DC.B    236, 127, 126, 3  , 207, 45 , 193, 2
00001DE4= 94 5B 23 F2 8B CD ...   1447              DC.B    148, 91 , 35 , 242, 139, 205, 248, 237
00001DEC= 74 33 EC B9 0F D5 ...   1448              DC.B    116, 51 , 236, 185, 15 , 213, 221, 6
00001DF4                          1449  
00001DF4                          1450  
00001DF4                          1451  
00001DF4                          1452  
00001DF4                          1453  -------------------- end include --------------------
00001DF4                          1454              INCLUDE "INTRO.X68"
00001DF4                          1455  ; ==============================================================================
00001DF4                          1456  ; INTRO SCREEN
00001DF4                          1457  ; ==============================================================================
00001DF4                          1458  
00001DF4                          1459  ; ------------------------------------------------------------------------------
00001DF4                          1460  ISCINIT
00001DF4                          1461  ; INTRO SCREEN INIT
00001DF4                          1462  ; INPUT    : NONE
00001DF4                          1463  ; OUTPUT   : NONE
00001DF4                          1464  ; MODIFIES : NONE
00001DF4                          1465  ; ------------------------------------------------------------------------------
00001DF4  4279 000025F0           1466              CLR.W   (ISCTIMER)
00001DFA  4E75                    1467              RTS
00001DFC                          1468  
00001DFC                          1469  ; ------------------------------------------------------------------------------
00001DFC                          1470  ISCUPD
00001DFC                          1471  ; INTRO SCREEN UPDATE
00001DFC                          1472  ; INPUT    : NONE
00001DFC                          1473  ; OUTPUT   : NONE
00001DFC                          1474  ; MODIFIES : NONE
00001DFC                          1475  ; ------------------------------------------------------------------------------
00001DFC  0839 0004 000021D1      1476              BTST.B  #4,(KBDEDGE)
00001E04  6700 000A               1477              BEQ     .CONT
00001E08  33FC 0002 000025F4      1478              MOVE.W  #2,(STANEXT)
00001E10  5279 000025F0           1479  .CONT       ADDQ.W  #1,(ISCTIMER)
00001E16  0C79 01F4 000025F0      1480              CMP.W   #500,(ISCTIMER)
00001E1E  6D00 000A               1481              BLT     .DONE
00001E22  33FC 0001 000025F4      1482              MOVE.W  #1,(STANEXT)
00001E2A  4E75                    1483  .DONE       RTS
00001E2C                          1484  
00001E2C                          1485  ; ------------------------------------------------------------------------------
00001E2C                          1486  ISCPLOT
00001E2C                          1487  ; INTRO SCREEN PLOT
00001E2C                          1488  ; INPUT    : NONE
00001E2C                          1489  ; OUTPUT   : NONE
00001E2C                          1490  ; MODIFIES : NONE
00001E2C                          1491  ; ------------------------------------------------------------------------------
00001E2C  48E7 C080               1492              MOVEM.L D0-D1/A0,-(A7)
00001E30                          1493              
00001E30  4281                    1494              CLR.L   D1
00001E32  103C 0051               1495              MOVE.B  #81,D0
00001E36  4E4F                    1496              TRAP    #15
00001E38                          1497              
00001E38  41F9 00001E66           1498              LEA     .TXT1,A0
00001E3E  103C 000A               1499              MOVE.B  #10,D0
00001E42  4EB8 1CA4               1500              JSR     UTLPRINT
00001E46                          1501              
00001E46  0839 0004 000021D3      1502              BTST.B  #4,(SCRCYCCT)
00001E4E  6700 0010               1503              BEQ     .DONE
00001E52                          1504              
00001E52  41F9 00001E74           1505              LEA     .TXT2,A0
00001E58  103C 0019               1506              MOVE.B  #25,D0
00001E5C  4EB8 1CA4               1507              JSR     UTLPRINT
00001E60                          1508              
00001E60  4CDF 0103               1509  .DONE       MOVEM.L (A7)+,D0-D1/A0
00001E64                          1510  
00001E64  4E75                    1511              RTS
00001E66= 50 41 43 2D 4D 41 ...   1512  .TXT1       DC.B    'PAC-MAN 68000',0
00001E74= 50 52 45 53 53 20 ...   1513  .TXT2       DC.B    'PRESS FIRE1 TO START',0
00001E8A                          1514              DS.W    0
00001E8A                          1515  
00001E8A                          1516  
00001E8A                          1517  
00001E8A                          1518  
00001E8A                          1519  
00001E8A                          1520  
00001E8A                          1521  -------------------- end include --------------------
00001E8A                          1522              INCLUDE "INSTRUCTIONS.X68"
00001E8A                          1523  ; ==============================================================================
00001E8A                          1524  ; INSTRUCTIONS SCREEN
00001E8A                          1525  ; ==============================================================================
00001E8A                          1526  
00001E8A                          1527  ; ------------------------------------------------------------------------------
00001E8A                          1528  INSINIT
00001E8A                          1529  ; INSTRUCTIONS SCREEN INIT
00001E8A                          1530  ; INPUT    : NONE
00001E8A                          1531  ; OUTPUT   : NONE
00001E8A                          1532  ; MODIFIES : NONE
00001E8A                          1533  ; ------------------------------------------------------------------------------
00001E8A  4E75                    1534              RTS
00001E8C                          1535  
00001E8C                          1536  ; ------------------------------------------------------------------------------
00001E8C                          1537  INSUPD
00001E8C                          1538  ; INSTRUCTIONS SCREEN UPDATE
00001E8C                          1539  ; INPUT    : NONE
00001E8C                          1540  ; OUTPUT   : NONE
00001E8C                          1541  ; MODIFIES : NONE
00001E8C                          1542  ; ------------------------------------------------------------------------------
00001E8C  4E75                    1543              RTS
00001E8E                          1544  
00001E8E                          1545  ; ------------------------------------------------------------------------------
00001E8E                          1546  INSPLOT
00001E8E                          1547  ; INSTRUCTIONS SCREEN PLOT
00001E8E                          1548  ; INPUT    : NONE
00001E8E                          1549  ; OUTPUT   : NONE
00001E8E                          1550  ; MODIFIES : NONE
00001E8E                          1551  ; ------------------------------------------------------------------------------
00001E8E                          1552  
00001E8E  48E7 C0C0               1553              MOVEM.L D0-D1/A0-A1,-(A7)
00001E92  4281                    1554              CLR.L   D1
00001E94  103C 0051               1555              MOVE.B  #81,D0
00001E98  4E4F                    1556              TRAP    #15
00001E9A  103C 000B               1557              MOVE.B  #11,D0
00001E9E  43F9 00002000           1558              LEA     .TXTLST,A1
00001EA4  2219                    1559  .LOOP       MOVE.L  (A1)+,D1
00001EA6  6700 000A               1560              BEQ     .DONE
00001EAA  2041                    1561              MOVE.L  D1,A0
00001EAC  4EB8 1CA4               1562              JSR     UTLPRINT
00001EB0  60F2                    1563              BRA     .LOOP
00001EB2  4CDF 0303               1564  .DONE       MOVEM.L (A7)+,D0-D1/A0-A1
00001EB6  4E75                    1565              RTS
00001EB8= 57 45 4C 43 4F 4D ...   1566  .TXT1       DC.B    'WELCOME TO THE WORLD OF MULTI-PONG 68000!',0
00001EE2= 59 4F 55 52 20 47 ...   1567  .TXT2       DC.B    'YOUR GOAL IN THIS GAME IS TO AVOID MISSING THE BALLS',0
00001F17= 54 4F 20 54 48 49 ...   1568  .TXT3       DC.B    'TO THIS END, MOVE THE PAD USING THE KEYBOARD',0
00001F44= 48 4F 57 20 54 4F ...   1569  .TXT4       DC.B    'HOW TO DO IT? YOU MAY ASK.',0
00001F5F= 49 54 20 49 53 20 ...   1570  .TXT5       DC.B    'IT IS EASY: JUST USE THE UP KEY TO MOVE THE PAD...',0
00001F92= 55 50 21 00             1571  .TXT6       DC.B    'UP!',0
00001F96= 41 4E 44 20 55 53 ...   1572  .TXT7       DC.B    'AND USE THE DOWN KEY TO MOVE THE PAD DOWN.',0
00001FC1= 57 48 41 54 20 41 ...   1573  .TXT8       DC.B    'WHAT ABOUT LEFT AND RIGHT?',0
00001FDC= 4E 4F 2E 20 54 48 ...   1574  .TXT9       DC.B    'NO. THESE ARE FORBIDDEN DIRECTIONS',0
00002000                          1575              DS.W    0
00002000= 00001EB8 00001EE2 ...   1576  .TXTLST     DC.L    .TXT1,.TXT2,.TXT3,.TXT4,.TXT5,.TXT6,.TXT7,.TXT8,.TXT9,0
00002028                          1577  
00002028                          1578  
00002028                          1579  -------------------- end include --------------------
00002028                          1580              INCLUDE "WIN.X68"
00002028                          1581  ; ==============================================================================
00002028                          1582  ; VICTORY SCREEN
00002028                          1583  ; ==============================================================================
00002028                          1584  
00002028                          1585  ; ------------------------------------------------------------------------------
00002028                          1586  WININIT
00002028                          1587  ; VICTORY SCREEN INIT
00002028                          1588  ; INPUT    : NONE
00002028                          1589  ; OUTPUT   : NONE
00002028                          1590  ; MODIFIES : NONE
00002028                          1591  ; ------------------------------------------------------------------------------
00002028  4E75                    1592              RTS
0000202A                          1593  
0000202A                          1594  ; ------------------------------------------------------------------------------
0000202A                          1595  WINUPD
0000202A                          1596  ; VICTORY SCREEN UPDATE
0000202A                          1597  ; INPUT    : NONE
0000202A                          1598  ; OUTPUT   : NONE
0000202A                          1599  ; MODIFIES : NONE
0000202A                          1600  ; ------------------------------------------------------------------------------
0000202A  4E75                    1601              RTS
0000202C                          1602  
0000202C                          1603  ; ------------------------------------------------------------------------------
0000202C                          1604  WINPLOT
0000202C                          1605  ; VICTORY SCREEN PLOT
0000202C                          1606  ; INPUT    : NONE
0000202C                          1607  ; OUTPUT   : NONE
0000202C                          1608  ; MODIFIES : NONE
0000202C                          1609  ; ------------------------------------------------------------------------------
0000202C  48E7 C080               1610              MOVEM.L D0-D1/A0,-(A7)
00002030                          1611              
00002030  4281                    1612              CLR.L   D1
00002032  103C 0051               1613              MOVE.B  #81,D0
00002036  4E4F                    1614              TRAP    #15
00002038                          1615              
00002038  41F9 00002066           1616              LEA     .TXT1,A0
0000203E  103C 000A               1617              MOVE.B  #10,D0
00002042  4EB8 1CA4               1618              JSR     UTLPRINT
00002046                          1619              
00002046  0839 0004 000021D3      1620              BTST.B  #4,(SCRCYCCT)
0000204E  6700 0010               1621              BEQ     .DONE
00002052                          1622              
00002052  41F9 0000206F           1623              LEA     .TXT2,A0
00002058  103C 0019               1624              MOVE.B  #25,D0
0000205C  4EB8 1CA4               1625              JSR     UTLPRINT
00002060                          1626              
00002060  4CDF 0103               1627  .DONE       MOVEM.L (A7)+,D0-D1/A0
00002064                          1628  
00002064  4E75                    1629              RTS
00002066= 59 4F 55 20 57 4F ...   1630  .TXT1       DC.B    'YOU WON!',0
0000206F= 50 52 45 53 53 20 ...   1631  .TXT2       DC.B    'PRESS FIRE1 TO CONTINUE',0
00002088                          1632              DS.W    0
00002088                          1633  
00002088                          1634  
00002088                          1635  
00002088                          1636  -------------------- end include --------------------
00002088                          1637              INCLUDE "GOVER.X68"
00002088                          1638  ; ==============================================================================
00002088                          1639  ; GAME OVER SCREEN
00002088                          1640  ; ==============================================================================
00002088                          1641  
00002088                          1642  ; ------------------------------------------------------------------------------
00002088                          1643  GOVINIT
00002088                          1644  ; GAME OVER SCREEN INIT
00002088                          1645  ; INPUT    : NONE
00002088                          1646  ; OUTPUT   : NONE
00002088                          1647  ; MODIFIES : NONE
00002088                          1648  ; ------------------------------------------------------------------------------
00002088  4E75                    1649              RTS
0000208A                          1650  
0000208A                          1651  ; ------------------------------------------------------------------------------
0000208A                          1652  GOVUPD
0000208A                          1653  ; GAME OVER SCREEN UPDATE
0000208A                          1654  ; INPUT    : NONE
0000208A                          1655  ; OUTPUT   : NONE
0000208A                          1656  ; MODIFIES : NONE
0000208A                          1657  ; ------------------------------------------------------------------------------
0000208A  4E75                    1658              RTS
0000208C                          1659  
0000208C                          1660  ; ------------------------------------------------------------------------------
0000208C                          1661  GOVPLOT
0000208C                          1662  ; GAME OVER SCREEN PLOT
0000208C                          1663  ; INPUT    : NONE
0000208C                          1664  ; OUTPUT   : NONE
0000208C                          1665  ; MODIFIES : NONE
0000208C                          1666  ; ------------------------------------------------------------------------------
0000208C  48E7 C080               1667              MOVEM.L D0-D1/A0,-(A7)
00002090                          1668              
00002090  4281                    1669              CLR.L   D1
00002092  103C 0051               1670              MOVE.B  #81,D0
00002096  4E4F                    1671              TRAP    #15
00002098                          1672              
00002098  41F9 000020C6           1673              LEA     .TXT1,A0
0000209E  103C 000A               1674              MOVE.B  #10,D0
000020A2  4EB8 1CA4               1675              JSR     UTLPRINT
000020A6                          1676              
000020A6  0839 0004 000021D3      1677              BTST.B  #4,(SCRCYCCT)
000020AE  6700 0010               1678              BEQ     .DONE
000020B2                          1679              
000020B2  41F9 000020D0           1680              LEA     .TXT2,A0
000020B8  103C 0019               1681              MOVE.B  #25,D0
000020BC  4EB8 1CA4               1682              JSR     UTLPRINT
000020C0                          1683              
000020C0  4CDF 0103               1684  .DONE       MOVEM.L (A7)+,D0-D1/A0
000020C4                          1685  
000020C4  4E75                    1686              RTS
000020C6= 47 41 4D 45 20 4F ...   1687  .TXT1       DC.B    'GAME OVER',0
000020D0= 50 52 45 53 53 20 ...   1688  .TXT2       DC.B    'PRESS FIRE1 TO CONTINUE',0
000020E8                          1689              DS.W    0
000020E8                          1690  
000020E8                          1691  
000020E8                          1692  -------------------- end include --------------------
000020E8                          1693              INCLUDE "STATES.X68"
000020E8                          1694  ; =============================================================================
000020E8                          1695  ; GAME STATE MANAGEMENT
000020E8                          1696  ; =============================================================================
000020E8                          1697  
000020E8                          1698  ; -----------------------------------------------------------------------------
000020E8                          1699  STAINIT
000020E8                          1700  ; INITALIZES THE STATE MANAGER
000020E8                          1701  ; INPUT    - NONE
000020E8                          1702  ; OUTPUT   - NONE
000020E8                          1703  ; MODIFIES - NONE
000020E8                          1704  ; -----------------------------------------------------------------------------
000020E8  33FC FFFF 000025F2      1705              MOVE.W  #STANONE,(STACUR)
000020F0  4279 000025F4           1706              CLR.W   (STANEXT)
000020F6  4E75                    1707              RTS
000020F8                          1708  
000020F8                          1709  ; -----------------------------------------------------------------------------
000020F8                          1710  STAUPD
000020F8                          1711  ; PERFORMS STATE UPDATE AND INIT IF NECESSARY
000020F8                          1712  ; INPUT    - NONE
000020F8                          1713  ; OUTPUT   - NONE
000020F8                          1714  ; MODIFIES - NONE
000020F8                          1715  ; -----------------------------------------------------------------------------
000020F8  48E7 8080               1716              MOVEM.L D0/A0,-(A7)
000020FC  4280                    1717              CLR.L   D0
000020FE  3039 000025F4           1718              MOVE.W  (STANEXT),D0
00002104  B079 000025F2           1719              CMP.W   (STACUR),D0
0000210A  6700 0012               1720              BEQ     .DOUPD
0000210E  33C0 000025F2           1721              MOVE.W  D0,(STACUR)             ; IF STATE CHANGED, DO INIT
00002114  E588                    1722              LSL.L   #2,D0
00002116  2040                    1723              MOVE.L  D0,A0
00002118  2068 2136               1724              MOVE.L  .INITBL(A0),A0
0000211C  4E90                    1725              JSR     (A0)
0000211E  4280                    1726  .DOUPD      CLR.L   D0                      ; IN ANY CASE, DO UPDATE
00002120  3039 000025F2           1727              MOVE.W  (STACUR),D0
00002126  E588                    1728              LSL.L   #2,D0
00002128  2040                    1729              MOVE.L  D0,A0
0000212A  2068 213A               1730              MOVE.L  .UPDTBL(A0),A0
0000212E  4E90                    1731              JSR     (A0)
00002130  4CDF 0101               1732              MOVEM.L (A7)+,D0/A0
00002134  4E75                    1733              RTS
00002136= 00001DF4                1734  .INITBL     DC.L    ISCINIT
0000213A= 00001DFC                1735  .UPDTBL     DC.L    ISCUPD
0000213E                          1736  
0000213E                          1737  ; -----------------------------------------------------------------------------
0000213E                          1738  STAPLOT
0000213E                          1739  ; PERFORMS STATE PLOT
0000213E                          1740  ; INPUT    - NONE
0000213E                          1741  ; OUTPUT   - NONE
0000213E                          1742  ; MODIFIES - NONE
0000213E                          1743  ; -----------------------------------------------------------------------------
0000213E  48E7 8080               1744              MOVEM.L D0/A0,-(A7)
00002142  4280                    1745              CLR.L   D0
00002144  3039 000025F2           1746              MOVE.W  (STACUR),D0
0000214A  E588                    1747              LSL.L   #2,D0
0000214C  2040                    1748              MOVE.L  D0,A0
0000214E  2068 215A               1749              MOVE.L  .PLTTBL(A0),A0
00002152  4E90                    1750              JSR     (A0)
00002154  4CDF 0101               1751              MOVEM.L (A7)+,D0/A0
00002158  4E75                    1752              RTS
0000215A= 00001E2C                1753  .PLTTBL     DC.L    ISCPLOT
0000215E                          1754  
0000215E                          1755  ; -----------------------------------------------------------------------------
0000215E                          1756  STAEMPTY
0000215E                          1757  ; EMPTY SUBROUTINE FOR CASES WITH NOTHING TO DO
0000215E                          1758  ; INPUT    - NONE
0000215E                          1759  ; OUTPUT   - NONE
0000215E                          1760  ; MODIFIES - NONE
0000215E                          1761  ; NOTE     - JUST A PLACEHOLDER. NOTHING TO DO.
0000215E                          1762  ; -----------------------------------------------------------------------------
0000215E  4E75                    1763              RTS
00002160                          1764  
00002160                          1765  
00002160                          1766  
00002160                          1767  
00002160                          1768  
00002160                          1769  
00002160                          1770  
00002160                          1771  
00002160                          1772  -------------------- end include --------------------
00002160                          1773              INCLUDE "GAME.X68"
00002160                          1774  ; ==============================================================================
00002160                          1775  ; GAME MANAGEMENT
00002160                          1776  ; ==============================================================================
00002160                          1777  
00002160                          1778  ; ------------------------------------------------------------------------------
00002160                          1779  GAMINIT
00002160                          1780  ; INITIALIZES GAME.
00002160                          1781  ; INPUT    : NONE
00002160                          1782  ; OUTPUT   : NONE
00002160                          1783  ; MODIFIES : NONE
00002160                          1784  ; ------------------------------------------------------------------------------
00002160  4EB8 1890               1785              JSR     SYSINIT
00002164  4EB8 149C               1786              JSR     PMINIT
00002168  4EB8 1AF0               1787              JSR     MAPINIT
0000216C  4EB8 1400               1788              JSR     GSTINIT
00002170  6000 F6AC               1789              BRA     SCOINIT
00002174                          1790  
00002174                          1791  ; ------------------------------------------------------------------------------
00002174                          1792  GAMUPD
00002174                          1793  ; UPDATES THE GAME
00002174                          1794  ; INPUT    : NONE
00002174                          1795  ; OUTPUT   : NONE
00002174                          1796  ; MODIFIES : NONE
00002174                          1797  ; ------------------------------------------------------------------------------
00002174  6000 F35A               1798              BRA     PMUPD
00002178                          1799              
00002178                          1800  ; ------------------------------------------------------------------------------
00002178                          1801  GAMPLOT
00002178                          1802  ; PLOTS THE GAME
00002178                          1803  ; INPUT    : NONE
00002178                          1804  ; OUTPUT   : NONE
00002178                          1805  ; MODIFIES : NONE
00002178                          1806  ; ------------------------------------------------------------------------------
00002178  4EB8 1B6A               1807              JSR     MAPPLOT
0000217C  4EB8 182E               1808              JSR     SCOPLOT
00002180  4EB8 161A               1809              JSR     PMPLOT
00002184  6000 F2AC               1810              BRA     GSTPLOT
00002188                          1811  
00002188                          1812  -------------------- end include --------------------
00002188                          1813              
00002188                          1814      
00002188                          1815  START:
00002188                          1816  
00002188                          1817  ;--- INITIALIZATION -----------------------------------------------------------
00002188                          1818  
00002188  007C 0700               1819              ORI.W   #$0700,SR               ;DISABLE INTERRUPTIONS
0000218C                          1820  
0000218C  4EB8 1890               1821              JSR     SYSINIT
00002190  4EB8 149C               1822              JSR     PMINIT
00002194  4EB8 1AF0               1823              JSR     MAPINIT
00002198  4EB8 1400               1824              JSR     GSTINIT
0000219C  4EB8 181E               1825              JSR     SCOINIT
000021A0  4EB8 1DF4               1826              JSR     ISCINIT
000021A4                          1827              ;JSR     GAMINIT
000021A4                          1828  
000021A4                          1829  .LOOP
000021A4                          1830  
000021A4                          1831  ; --- UPDATE -------------------------------------------------------------------
000021A4                          1832  
000021A4                          1833  ; READ INPUT DEVICES
000021A4                          1834  
000021A4  4E41                    1835              TRAP    #1
000021A6                          1836  
000021A6                          1837  ; UPDATE GAME LOGIC
000021A6                          1838  
000021A6  4EB8 14D0               1839             JSR     PMUPD
000021AA                          1840             ;JSR     GSTUPD
000021AA                          1841             ;JSR      ISCUPD
000021AA                          1842             ;JSR      GAMUPD
000021AA                          1843  
000021AA                          1844  ; --- SYNC ---------------------------------------------------------------------
000021AA                          1845              ;WHILE THERES NO INTERRUPTS IN THE COUNTER THE PROGRAM WILL BE IN
000021AA                          1846              ;THE BUCLE
000021AA                          1847              
000021AA  4A39 000021D2           1848  .WAITINIT   TST.B   (SCRINTCT)
000021B0  67F8                    1849              BEQ     .WAITINIT
000021B2  4239 000021D2           1850              CLR.B   (SCRINTCT)
000021B8                          1851  
000021B8                          1852  ; --- PLOT ---------------------------------------------------------------------
000021B8                          1853              
000021B8  4EB8 1B6A               1854              JSR     MAPPLOT
000021BC  4EB8 182E               1855              JSR     SCOPLOT
000021C0  4EB8 161A               1856              JSR     PMPLOT
000021C4  4EB8 1432               1857              JSR     GSTPLOT
000021C8                          1858              ;JSR     ISCPLOT
000021C8                          1859              ;JSR     GAMPLOT
000021C8                          1860              
000021C8                          1861              
000021C8  4E40                    1862              TRAP    #0                      ;CHANGE BUFFER
000021CA                          1863  
000021CA  60D8                    1864              BRA     .LOOP
000021CC                          1865  
000021CC  FFFF FFFF               1866              SIMHALT  
000021D0                          1867             
000021D0                          1868              INCLUDE "SYSVARS.X68"
000021D0                          1869  ; ==============================================================================
000021D0                          1870  ; SYSTEM VARIABLES
000021D0                          1871  ; ==============================================================================
000021D0                          1872   
000021D0                          1873  ; --- KEYBOARD RELATED VARIABLES -----------------------------------------------
000021D0                          1874  
000021D0                          1875  KBDVAL      DS.B    1                       ; KEY STATE
000021D1                          1876  KBDEDGE     DS.B    1                       ; KEY EDGE
000021D2                          1877  
000021D2                          1878  ; --- TIMED INTERRUPT RELATED VARIABLES ----------------------------------------
000021D2                          1879  
000021D2                          1880  SCRINTCT    DS.B    1                       ; INTERRUPT COUNTER
000021D3                          1881  SCRCYCCT    DS.B    1                       ; CYCLE COUNTER
000021D4                          1882              DS.W    0        
000021D4                          1883              
000021D4                          1884  ; --- MAP RELATED VARIABLE -----------------------------------------------------
000021D4                          1885  
000021D4                          1886  MAPVAR      DS.B    1024
000025D4                          1887  
000025D4                          1888              DS.B    0
000025D4                          1889  
000025D4                          1890  POSCON      DS.W    1
000025D6                          1891  
000025D6                          1892  
000025D6                          1893  
000025D6                          1894  
000025D6                          1895  
000025D6                          1896  
000025D6                          1897  -------------------- end include --------------------
000025D6                          1898              INCLUDE "VARS.X68"
000025D6                          1899  ; ==============================================================================
000025D6                          1900  ; GAME VARIABLES
000025D6                          1901  ; ==============================================================================
000025D6                          1902  
000025D6                          1903  ; --- PAC-MAN RELATED VARIABLES ------------------------------------------------
000025D6                          1904  
000025D6                          1905  PMPOSX      DS.W    1                       ; PM X COORDINATE
000025D8                          1906  PMPOSY      DS.W    1                       ; PM Y COORDINATE
000025DA                          1907  PMVELX      DS.W    1                       ; PM X VELOCITY
000025DC                          1908  PMVELY      DS.W    1                       ; PM Y VELOCITY
000025DE                          1909  PMEAT       DS.B    1                       ; PM BOOLEAN EAT GST
000025DF                          1910  PMLAMO      DS.B    1                       ; PM SAVE LAST MOVEMENT X O Y
000025E0                          1911              DS.B    0
000025E0                          1912  
000025E0                          1913  ; --- GHOST RELATED VARIABLES --------------------------------------------------
000025E0                          1914  
000025E0                          1915  GSTPOSX     DS.W    1                       ; GST X COORDINATE
000025E2                          1916  GSTPOSY     DS.W    1                       ; GST Y COORDINATE
000025E4                          1917  GSTVELX     DS.W    1                       ; GST X VELOCITY
000025E6                          1918  GSTVELY     DS.W    1                       ; GST Y VELOCITY
000025E8                          1919  GSTDEAD     DS.B    1                       ; GST BOOLEAN DEAD
000025E9                          1920  GSTLAMO     DS.B    1                       ; GST LAST MOVEMENT (X OR Y)
000025EA                          1921  GSTINRNG    DS.B    1                       ; GST IS IN RANGE
000025EB                          1922  GSTTARG     DS.B    1                       ; GST TARGET (0-PACMAN, 1-RANDOM)
000025EC                          1923              DS.B    0
000025EC                          1924  
000025EC                          1925  ; --- SCOREBOARD RELATED VARIABLES ---------------------------------------------
000025EC                          1926  
000025EC                          1927  SCOLIFE     DS.W    1                       ; NUMBER OF LIFES
000025EE                          1928  SCOPOINTS   DS.W    1                       ; NUMBER OF POINTS
000025F0                          1929  
000025F0                          1930  ; --- INTRO STATE RELATED VARIABLES --------------------------------------------
000025F0                          1931  
000025F0                          1932  ISCTIMER    DS.W    1                       ; INTRO TIMER
000025F2                          1933  
000025F2                          1934  ; --- STATE RELATED VARIABLES --------------------------------------------------
000025F2                          1935  
000025F2                          1936  STACUR      DS.W    1                       ; CURRENT STATE
000025F4                          1937  STANEXT     DS.W    1                       ; NEXT STATE
000025F6                          1938  
000025F6                          1939  
000025F6                          1940  
000025F6                          1941  
000025F6                          1942  
000025F6                          1943  
000025F6                          1944  
000025F6                          1945  
000025F6                          1946  
000025F6                          1947  -------------------- end include --------------------
000025F6                          1948              INCLUDE "LIB/UTLVARS.X68"
000025F6                          1949  ; =============================================================================
000025F6                          1950  ; UTILITY VARIABLES
000025F6                          1951  ; =============================================================================
000025F6                          1952  
000025F6                          1953  UTLRNDIX    DS.B    1                       ; NEXT INDEX TO RANDOM NUMBER
000025F8                          1954              DS.W    0
000025F8                          1955  -------------------- end include --------------------
000025F8                          1956              
000025F8                          1957              END    START        

No errors detected
No warnings generated


SYMBOL TABLE INFORMATION
Symbol-name         Value
-------------------------
BUCLE_COLUMNA       1B16
BUCLE_COLUMNA2      1B8C
BUCLE_FILA          1B0A
BUCLE_FILA2         1B80
COLWALLDOWN         1A02
COLWALLLEFT         19C0
COLWALLRIGHT        197E
COLWALLUP           1A3E
DIBFIGBPOINT        1C52
DIBFIGPOINT         1C16
DIBFIGWALL          1BDE
GAMINIT             2160
GAMPLOT             2178
GAMUPD              2174
GETPOINTS           1A7C
GETPOINTS:BPOINT    1AC6
GETPOINTS:DONE      1AEA
GETPOINTS:POINT     1AD8
GOVINIT             2088
GOVPLOT             208C
GOVPLOT:DONE        20C0
GOVPLOT:TXT1        20C6
GOVPLOT:TXT2        20D0
GOVUPD              208A
GSTCOL1             FF
GSTCOL2             FF0080
GSTCOL3             FFFF00
GSTCOL4             80FF
GSTCOL5             800000
GSTDEAD             25E8
GSTFCOL1            FFFFFF
GSTFCOL2            0
GSTFCOL3            0
GSTFCOL4            0
GSTFCOL5            0
GSTINIT             1400
GSTINRNG            25EA
GSTINX1             2
GSTINX2             2
GSTINX3             1F
GSTINX4             1F
GSTINY1             2
GSTINY2             1F
GSTINY3             2
GSTINY4             1F
GSTLAMO             25E9
GSTPLOT             1432
GSTPOSX             25E0
GSTPOSY             25E2
GSTRAD              8
GSTRNG              10
GSTSPEED            7
GSTSPEED2           5
GSTTARG             25EB
GSTUPD              1428
GSTUPD:GSTNOTMULT   142C
GSTVELX             25E4
GSTVELY             25E6
INSINIT             1E8A
INSPLOT             1E8E
INSPLOT:DONE        1EB2
INSPLOT:LOOP        1EA4
INSPLOT:TXT1        1EB8
INSPLOT:TXT2        1EE2
INSPLOT:TXT3        1F17
INSPLOT:TXT4        1F44
INSPLOT:TXT5        1F5F
INSPLOT:TXT6        1F92
INSPLOT:TXT7        1F96
INSPLOT:TXT8        1FC1
INSPLOT:TXT9        1FDC
INSPLOT:TXTLST      2000
INSUPD              1E8C
ISCINIT             1DF4
ISCPLOT             1E2C
ISCPLOT:DONE        1E60
ISCPLOT:TXT1        1E66
ISCPLOT:TXT2        1E74
ISCTIMER            25F0
ISCUPD              1DFC
ISCUPD:CONT         1E10
ISCUPD:DONE         1E2A
KBDDOWN             28
KBDEDGE             21D1
KBDFIRE1            20
KBDFIRE2            4D
KBDFIRE3            10
KBDINIT             1928
KBDLEFT             25
KBDPAUSE            50
KBDRIGHT            27
KBDUP               26
KBDUPD              1936
KBDUPD:CONVERT      1970
KBDUPD:LOOP         1974
KBDUPD:NOACT        196A
KBDVAL              21D0
MAPINIT             1AF0
MAPMAT              1000
MAPPLOT             1B6A
MAPVAR              21D4
NOTPOINT            1B4A
NOTPOINT2           1BBE
NOTWALL             1B3C
NOTWALL2            1BB0
PMEAT               25DE
PMFCOL              FFFF
PMINIT              149C
PMLAMO              25DF
PMPCOL              FFFF
PMPLOT              161A
PMPLOT:DDONE        16B4
PMPLOT:DDOWN        1686
PMPLOT:DLEFT        1668
PMPLOT:DOWNDRAW     1774
PMPLOT:DRAW_MOUTH1  1690
PMPLOT:DRAW_MOUTH2  169A
PMPLOT:DRAW_MOUTH3  16A4
PMPLOT:DRAW_MOUTH4  16AE
PMPLOT:DRIGHT       167C
PMPLOT:DUP          1672
PMPLOT:FULLDRAW     16BA
PMPLOT:LEFTDRAW     16DE
PMPLOT:RIGHTDRAW    1710
PMPLOT:SET_MOUTHDOWN  1800
PMPLOT:SET_MOUTHLEFT  17A6
PMPLOT:SET_MOUTHRIGHT  17C4
PMPLOT:SET_MOUTHUP  17E2
PMPLOT:UPDRAW       1742
PMPOSX              25D6
PMPOSY              25D8
PMRAD               8
PMSPEED             2
PMUPD               14D0
PMUPD:ACTXLEFT      158E
PMUPD:ACTXRIGHT     1562
PMUPD:ACTYDOWN      15BA
PMUPD:ACTYUP        15D6
PMUPD:DONE          1608
PMUPD:NOTCOLISION   1574
PMUPD:NOTCOLISION2  15A0
PMUPD:NOTCOLISION3  15CC
PMUPD:NOTCOLISION4  15E8
PMUPD:NOTDOWN       155E
PMUPD:NOTLEFT       151C
PMUPD:NOTMULT       15F2
PMUPD:NOTRIGHT      1532
PMUPD:NOTTP         1584
PMUPD:NOTTP2        15B0
PMUPD:NOTUP         1548
PMVELX              25DA
PMVELY              25DC
POSCON              25D4
SCOFCOL             0
SCOINIT             181E
SCOLIFE             25EC
SCOLINE1            101
SCOLINE2            102
SCOPLOT             182E
SCOPLOT:TXT1        187C
SCOPLOT:TXT2        1885
SCOPOINTS           25EE
SCRCYCCT            21D3
SCRHEIGH            280
SCRINIT             18BC
SCRINTCT            21D2
SCRTIM              191A
SCRUPD              1900
SCRWIDTH            280
STACUR              25F2
STAEMPTY            215E
STAINIT             20E8
STANEXT             25F4
STANONE             FFFFFFFF
STAPLOT             213E
STAPLOT:PLTTBL      215A
START               2188
START:LOOP          21A4
START:WAITINIT      21AA
STAUPD              20F8
STAUPD:DOUPD        211E
STAUPD:INITBL       2136
STAUPD:UPDTBL       213A
SYSINIT             1890
UTLCHRWD            8
UTLINIT             1C8E
UTLPRINT            1CA4
UTLPRINT:ENDLOOP    1CB6
UTLPRINT:LOOP       1CAC
UTLRAND             1CD6
UTLRAND:RANDVEC     1CF4
UTLRNDIX            25F6
WININIT             2028
WINPLOT             202C
WINPLOT:DONE        2060
WINPLOT:TXT1        2066
WINPLOT:TXT2        206F
WINUPD              202A
ZERO                1B58
ZERO2               1BCC
