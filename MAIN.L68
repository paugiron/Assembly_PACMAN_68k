0000246A Starting Address
Assembler used: EASy68K Editor/Assembler v5.16.01
Created On: 24/12/2022 18:39:36

00000000                             1  ; ==============================================================================
00000000                             2  ; TITLE       : PAC-MAN 68000
00000000                             3  ; DESCRIPTION : GAME IN MOTOROLA 68000 BASED ON PAC-MAN GAME
00000000                             4  ; AUTHOR      : JORDI FLORIT ENSENYAT
00000000                             5  ;               JOSEP GABRIEL FORNES REYNES
00000000                             6  ;               PAU GIRON RODRIGUEZ
00000000                             7  ; ==============================================================================
00001000                             8              ORG    $1000
00001000                             9  
00001000                            10              INCLUDE "CONST.X68"
00001000                            11  ; ==============================================================================
00001000                            12  ; GAME CONSTANTS
00001000                            13  ; ==============================================================================
00001000                            14  
00001000                            15  ; --- PAC-MAN RELATED CONTANTS ----------------------------------------------------
00001000                            16  
00001000  =0000FFFF                 17  PMPCOL      EQU     $0000FFFF               ; PAC-MAN CONTOUR COLOR
00001000  =0000FFFF                 18  PMFCOL      EQU     $0000FFFF               ; PAC-MAN FILL COLOR
00001000  =00000002                 19  PMSPEED     EQU     2                       ; MAGNITUDE OF THE X AND Y VEL.
00001000  =00000008                 20  PMRAD       EQU     8                       ; PAC-MAN RADIUS
00001000                            21  
00001000                            22  ; --- GHOST RELATED CONSTANTS ----------------------------------------------------
00001000                            23  
00001000  =00000007                 24  GSTSPEED    EQU     7                       ; MAGNITUDE OF THE NORMAL DISPLACEMENT
00001000  =00000005                 25  GSTSPEED2   EQU     5                       ; MAGNITUDE OF THE ATACKED DISPLACEMENT
00001000                            26  
00001000  =000000FF                 27  GSTCOL1     EQU     $000000FF               ; GHOST 1 CONTOUR COLOR RED
00001000  =00FFFFFF                 28  GSTFCOL1    EQU     $00FFFFFF               ; GHOST 1 FILL COLOR WHITE
00001000  =00000002                 29  GSTINX1     EQU     2                       ; GHOST 1 INITIAL X
00001000  =00000002                 30  GSTINY1     EQU     2                       ; GHOST 1 INITIAL Y
00001000                            31  
00001000  =00FF0080                 32  GSTCOL2     EQU     $00FF0080               ; GHOST 2 CONTOUR COLOR PINK
00001000  =00000000                 33  GSTFCOL2    EQU     $00000000               ; GHOST 1 FILL COLOR
00001000  =00000002                 34  GSTINX2     EQU     2                       ; GHOST 2 INITIAL X
00001000  =0000001F                 35  GSTINY2     EQU     31                      ; GHOST 2 INITIAL Y
00001000                            36  
00001000  =00FFFF00                 37  GSTCOL3     EQU     $00FFFF00               ; GHOST 3 CONTOUR COLOR CYAN
00001000  =00000000                 38  GSTFCOL3    EQU     $00000000               ; GHOST 3 FILL COLOR
00001000  =0000001F                 39  GSTINX3     EQU     31                      ; GHOST 3 INITIAL X
00001000  =00000002                 40  GSTINY3     EQU     2                       ; GHOST 3 INITIAL Y
00001000                            41  
00001000  =000080FF                 42  GSTCOL4     EQU     $000080FF               ; GHOST 4 CONTOUR COLOR ORANGE
00001000  =00000000                 43  GSTFCOL4    EQU     $00000000               ; GHOST 4 FILL COLOR
00001000  =0000001F                 44  GSTINX4     EQU     31                      ; GHOST 4 INITIAL X
00001000  =0000001F                 45  GSTINY4     EQU     31                      ; GHOST 4 INITIAL Y 
00001000                            46  
00001000  =00800000                 47  GSTCOL5     EQU     $00800000               ; CONTOUR COLOR OF ATACKED MODE
00001000  =00000000                 48  GSTFCOL5    EQU     $00000000               ; FILL COLOR OF ATACKED MODE
00001000                            49  
00001000  =00000008                 50  GSTRAD      EQU     8                       ; GHOST RADIUS
00001000  =00000010                 51  GSTRNG      EQU     16                      ; GHOST DETECTING RANGE
00001000                            52              
00001000                            53  ; --- SCOREBOARD RELATED CONSTANTS ---------------------------------------------
00001000                            54  ;MODIFICATE
00001000                            55  
00001000  =00000000                 56  SCOFCOL     EQU     $00000000               ; TEXT BACKGROUND COLOR
00001000  =00000101                 57  SCOLINE1    EQU     $0101                   ; FIRST TEXT LINE COORDINATES
00001000  =00000102                 58  SCOLINE2    EQU     $0102                   ; SECOND TEXT LINE COORDINATES
00001000                            59  
00001000                            60  ; --- MAP RELATED CONSTANTS ----------------------------------------------------
00001000                            61  
00001000= 01 01 01 01 01 01 ...     62  MAPMAT      DC.B    $1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
00001020= 01 02 02 02 02 02 ...     63              DC.B    $1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1
00001040= 01 02 01 01 01 01 ...     64              DC.B    $1,2,1,1,1,1,1,2,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,2,1,1,1,1,1,2,1
00001060= 01 03 01 01 01 01 ...     65              DC.B    $1,3,1,1,1,1,1,2,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,2,1,1,1,1,1,3,1
00001080= 01 02 02 02 02 02 ...     66              DC.B    $1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1
000010A0= 01 02 01 01 01 01 ...     67              DC.B    $1,2,1,1,1,1,1,2,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,2,1,1,1,1,1,2,1
000010C0= 01 02 01 01 01 01 ...     68              DC.B    $1,2,1,1,1,1,1,2,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,2,1,1,1,1,1,2,1
000010E0= 01 02 02 02 02 02 ...     69              DC.B    $1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1
00001100= 01 02 01 01 01 01 ...     70              DC.B    $1,2,1,1,1,1,1,2,1,1,1,2,1,1,1,1,1,1,1,1,2,1,1,1,2,1,1,1,1,1,2,1
00001120= 01 02 01 00 00 00 ...     71              DC.B    $1,2,1,0,0,0,1,2,1,0,1,2,1,1,1,1,1,1,1,1,2,1,0,1,2,1,0,0,0,1,2,1
00001140= 01 02 01 01 01 01 ...     72              DC.B    $1,2,1,1,1,1,1,2,1,0,1,2,2,2,2,1,1,2,2,2,2,1,0,1,2,1,1,1,1,1,2,1
00001160= 01 02 02 02 02 02 ...     73              DC.B    $1,2,2,2,2,2,2,2,1,0,1,1,1,1,2,1,1,2,1,1,1,1,0,1,2,2,2,2,2,2,2,1
00001180= 01 01 01 01 01 01 ...     74              DC.B    $1,1,1,1,1,1,1,2,1,0,1,1,1,1,2,1,1,2,1,1,1,1,0,1,2,1,1,1,1,1,1,1
000011A0= 01 00 00 00 00 00 ...     75              DC.B    $1,0,0,0,0,0,1,2,1,0,1,0,0,0,0,0,0,0,0,0,0,1,0,1,2,1,0,0,0,0,0,1
000011C0= 01 00 00 00 00 00 ...     76              DC.B    $1,0,0,0,0,0,1,2,1,0,1,0,1,1,1,0,0,1,1,1,0,1,0,1,2,1,0,0,0,0,0,1
000011E0= 01 01 01 01 01 01 ...     77              DC.B    $1,1,1,1,1,1,1,2,1,1,1,0,1,0,0,0,0,0,0,1,0,1,1,1,2,1,1,1,1,1,1,1
00001200= 04 00 00 00 00 00 ...     78              DC.B    $4,0,0,0,0,0,0,2,2,2,2,0,1,0,0,0,0,0,0,1,0,2,2,2,2,0,0,0,0,0,0,4
00001220= 01 01 01 01 01 01 ...     79              DC.B    $1,1,1,1,1,1,1,2,1,1,1,0,1,0,0,0,0,0,0,1,0,1,1,1,2,1,1,1,1,1,1,1
00001240= 01 00 00 00 00 00 ...     80              DC.B    $1,0,0,0,0,0,1,2,1,0,1,0,1,1,1,1,1,1,1,1,0,1,0,1,2,1,0,0,0,0,0,1
00001260= 01 00 00 00 00 00 ...     81              DC.B    $1,0,0,0,0,0,1,2,1,0,1,0,0,0,0,0,0,0,0,0,0,1,0,1,2,1,0,0,0,0,0,1
00001280= 01 01 01 01 01 01 ...     82              DC.B    $1,1,1,1,1,1,1,2,1,1,1,0,1,1,1,1,1,1,1,1,0,1,1,1,2,1,1,1,1,1,1,1
000012A0= 01 02 02 02 02 02 ...     83              DC.B    $1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1
000012C0= 01 02 01 01 01 01 ...     84              DC.B    $1,2,1,1,1,1,1,2,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,2,1,1,1,1,1,2,1
000012E0= 01 02 01 01 01 01 ...     85              DC.B    $1,2,1,1,1,1,1,2,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,2,1,1,1,1,1,2,1
00001300= 01 02 02 02 02 01 ...     86              DC.B    $1,2,2,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,2,2,2,1
00001320= 01 01 01 01 02 01 ...     87              DC.B    $1,1,1,1,2,1,1,2,1,1,1,2,1,1,1,1,1,1,1,1,2,1,1,1,2,1,1,2,1,1,1,1
00001340= 01 01 01 01 02 01 ...     88              DC.B    $1,1,1,1,2,1,1,2,1,0,1,2,1,1,1,1,1,1,1,1,2,1,0,1,2,1,1,2,1,1,1,1
00001360= 01 02 02 02 02 02 ...     89              DC.B    $1,2,2,2,2,2,2,2,1,0,1,2,2,2,2,1,1,2,2,2,2,1,0,1,2,2,2,2,2,2,2,1
00001380= 01 02 01 01 01 01 ...     90              DC.B    $1,2,1,1,1,1,1,1,1,0,1,1,1,1,2,1,1,2,1,1,1,1,0,1,1,1,1,1,1,1,2,1
000013A0= 01 03 01 01 01 01 ...     91              DC.B    $1,3,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,3,1
000013C0= 01 02 02 02 02 02 ...     92              DC.B    $1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1
000013E0= 01 01 01 01 01 01 ...     93              DC.B    $1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
00001400                            94              
00001400                            95  ; --- STATE RELATED CONSTANTS --------------------------------------------------
00001400                            96  
00001400  =FFFFFFFF                 97  STANONE     EQU     -1                      ; NON-EXISTENT STATE NUMBER
00001400                            98  
00001400                            99  
00001400                           100  
00001400                           101  
00001400                           102  
00001400                           103  
00001400                           104  
00001400                           105  
00001400                           106  
00001400                           107  
00001400                           108  
00001400                           109  
00001400                           110  
00001400                           111  
00001400                           112  
00001400                           113  
00001400                           114  
00001400                           115  
00001400                           116  
00001400                           117  
00001400                           118  
00001400                           119  
00001400                           120  
00001400                           121  -------------------- end include --------------------
00001400                           122              INCLUDE "GHOST.X68"
00001400                           123  ; ==============================================================================
00001400                           124  ; GHOST MANAGEMENT
00001400                           125  ; ==============================================================================
00001400                           126              
00001400                           127  ; ------------------------------------------------------------------------------
00001400                           128  GSTINIT
00001400                           129  ; INITIALIZE GHOST.
00001400                           130  ; INPUT    : NONE 
00001400                           131  ; OUTPUT   : NONE
00001400                           132  ; MODIFIES : NONE
00001400                           133  ; ------------------------------------------------------------------------------
00001400  33FC 0058 00003332       134              MOVE.W  #GSTINX1*16+64-8,(GSTPOSX)
00001408  33FC 0058 00003334       135              MOVE.W  #GSTINY1*16+64-8,(GSTPOSY)
00001410  33FC 0007 00003336       136              MOVE.W  #GSTSPEED,(GSTVELX)
00001418  33FC 0007 00003338       137              MOVE.W  #GSTSPEED,(GSTVELY)
00001420  13FC 0001 0000333B       138              MOVE.B  #1,(GSTLAMO)
00001428  4E75                     139              RTS
0000142A                           140              
0000142A                           141  ; ------------------------------------------------------------------------------
0000142A                           142  GSTUPD
0000142A                           143  ; UPDATES THE GHOST.
0000142A                           144  ; INPUT    : NONE 
0000142A                           145  ; OUTPUT   : NONE
0000142A                           146  ; MODIFIES : NONE
0000142A                           147  ; ------------------------------------------------------------------------------
0000142A  48E7 FC00                148              MOVEM.L D0-D5,-(A7)
0000142E                           149              
0000142E  3039 00146F20            150              MOVE.W  (PMPOSX)/16*(PMPOSX)/16+(PMPOSY)/16*(PMPOSY)/16,D0
00001434  323C 0010                151              MOVE.W  #GSTRNG,D1
00001438  C2FC 0010                152              MULU.W  #GSTRNG,D1
0000143C  9240                     153              SUB.W   D0,D1
0000143E  6600 000E                154              BNE     .GSTINRNG
00001442                           155  .GSTNOTINRNG
00001442  13FC 0001 0000333C       156              MOVE.B  #1,(GSTINRNG)
0000144A  6000 000A                157              BRA     .GSTMOVE
0000144E                           158  .GSTINRNG
0000144E  13FC 0000 0000333C       159              MOVE.B  #0,(GSTINRNG)
00001456                           160  .GSTMOVE
00001456  1839 0000333B            161              MOVE.B  (GSTLAMO),D4
0000145C                           162              ;MASK OF THE LAST NIBBLE        
0000145C  C47C 000F                163              AND.W   #$000F,D2               ; COORDENADA X
00001460  C67C 000F                164              AND.W   #$000F,D3               ; COORDENADA Y
00001464                           165              
00001464                           166              ;CHECK IF COORDS ARE MULTIPLES OF 16
00001464  B47C 0000                167              CMP     #$0000,D2
00001468  6600 000C                168              BNE     .GSTNOTMULT
0000146C  B67C 0000                169              CMP     #$0000,D3
00001470                           170              ;BNE     .GSTNOTMULT
00001470                           171  .GSTMULT
00001470  4EB9 00001BD4            172              JSR     GSTCOLWALLRIGHT
00001476                           173  .GSTNOTMULT            
00001476  B87C 0001                174              CMP     #1,D4
0000147A  6700 0016                175              BEQ     .GSTRIGHTMOVE
0000147E  B87C 0002                176              CMP     #2,D4
00001482  6700 003A                177              BEQ     .GSTLEFTMOVE
00001486  B87C 0003                178              CMP     #3,D4
0000148A  6700 005E                179              BEQ     .GSTDOWNMOVE
0000148E  6000 0076                180              BRA     .GSTUPMOVE
00001492                           181  
00001492                           182              ;UPDATE COORDS
00001492                           183              
00001492                           184  .GSTRIGHTMOVE
00001492  4EB9 00001BD4            185              JSR     GSTCOLWALLRIGHT
00001498  BA7C 0001                186              CMP     #1,D5
0000149C  6600 0006                187              BNE     .GSTNOTCOLISION
000014A0  303C 0000                188              MOVE.W  #0,D0
000014A4                           189  .GSTNOTCOLISION
000014A4  BA7C 0004                190              CMP     #4,D5
000014A8  6600 000A                191              BNE     .GSTNOTTP
000014AC  0479 01E0 00003332       192              SUB.W   #30*16,(GSTPOSX)
000014B4                           193  .GSTNOTTP
000014B4  D179 00003332            194              ADD.W   D0,(GSTPOSX)
000014BA  6000 0066                195              BRA     .GSTDONE
000014BE                           196  .GSTLEFTMOVE
000014BE  4EB9 00001C10            197              JSR     GSTCOLWALLLEFT
000014C4  BA7C 0001                198              CMP     #1,D5
000014C8  6600 0006                199              BNE     .GSTNOTCOLISION2
000014CC  303C 0000                200              MOVE.W  #0,D0
000014D0                           201  .GSTNOTCOLISION2
000014D0  BA7C 0004                202              CMP     #4,D5
000014D4  6600 000A                203              BNE     .GSTNOTTP2
000014D8  0679 01E0 00003332       204              ADD.W   #30*16,(GSTPOSX)
000014E0                           205  .GSTNOTTP2
000014E0  9179 00003332            206              SUB.W   D0,(GSTPOSX)
000014E6  6000 003A                207              BRA     .GSTDONE
000014EA                           208      
000014EA                           209  .GSTDOWNMOVE
000014EA  4EB9 00001C4C            210              JSR     GSTCOLWALLDOWN
000014F0  BA7C 0001                211              CMP     #1,D5
000014F4  6600 0006                212              BNE     .GSTNOTCOLISION3
000014F8  303C 0000                213              MOVE.W  #0,D0
000014FC                           214  .GSTNOTCOLISION3
000014FC  D179 00003334            215              ADD.W   D0,(GSTPOSY)
00001502  6000 001E                216              BRA     .GSTDONE
00001506                           217  .GSTUPMOVE    
00001506  4EB9 00001C82            218              JSR     GSTCOLWALLUP
0000150C  BA7C 0001                219              CMP     #1,D5
00001510  6600 0006                220              BNE     .GSTNOTCOLISION4
00001514  303C 0000                221              MOVE.W  #0,D0
00001518                           222  .GSTNOTCOLISION4
00001518  9179 00003334            223              SUB.W   D0,(GSTPOSY)
0000151E  6000 0002                224              BRA     .GSTDONE
00001522                           225  
00001522                           226  .GSTDONE
00001522  13C4 0000333B            227              MOVE.B  D4,(GSTLAMO)
00001528                           228  
00001528  4CDF 003F                229              MOVEM.L (A7)+,D0-D5
0000152C                           230              
0000152C  4E75                     231              RTS
0000152E                           232              
0000152E                           233  ; ------------------------------------------------------------------------------
0000152E                           234  GSTPLOT
0000152E                           235  ; PLOT THE GHOST.
0000152E                           236  ; INPUT    : NONE 
0000152E                           237  ; OUTPUT   : NONE
0000152E                           238  ; MODIFIES : NONE
0000152E                           239  ; ------------------------------------------------------------------------------
0000152E  48E7 F800                240              MOVEM.L D0-D4,-(A7)
00001532                           241              
00001532                           242              ;SET PEN COLOR
00001532  303C 0050                243              MOVE.W  #80,D0
00001536  223C 000000FF            244              MOVE.L  #GSTCOL1,D1
0000153C  4E4F                     245              TRAP    #15
0000153E                           246              
0000153E                           247              ;SET FILL COLOR
0000153E  303C 0051                248              MOVE.W  #81,D0
00001542  223C 00FFFFFF            249              MOVE.L  #GSTFCOL1,D1
00001548  4E4F                     250              TRAP    #15
0000154A                           251              
0000154A                           252              ;SET COORDS
0000154A  3239 00003332            253              MOVE.W  (GSTPOSX),D1
00001550  5141                     254              SUB.W   #GSTRAD,D1
00001552  3439 00003334            255              MOVE.W  (GSTPOSY),D2
00001558  5142                     256              SUB.W   #GSTRAD,D2
0000155A                           257              
0000155A  3601                     258              MOVE.W  D1,D3
0000155C  0643 0010                259              ADD.W   #GSTRAD*2,D3
00001560  3802                     260              MOVE.W  D2,D4
00001562  0644 0010                261              ADD.W   #GSTRAD*2,D4
00001566                           262              
00001566                           263              ;DRAW GHOST
00001566  303C 0058                264              MOVE.W  #88,D0
0000156A  4E4F                     265              TRAP    #15
0000156C                           266              
0000156C                           267              ;SET RANGE COORDS
0000156C  3239 00003332            268              MOVE.W  (GSTPOSX),D1
00001572  0441 0100                269              SUB.W   #GSTRNG*16,D1
00001576  3439 00003334            270              MOVE.W  (GSTPOSY),D2
0000157C  0442 0100                271              SUB.W   #GSTRNG*16,D2
00001580                           272              
00001580  3601                     273              MOVE.W  D1,D3
00001582  0643 0200                274              ADD.W   #GSTRNG*16*2,D3
00001586  3802                     275              MOVE.W  D2,D4
00001588  0644 0200                276              ADD.W   #GSTRNG*16*2,D4
0000158C                           277              
0000158C                           278              ;DRAW GHOST RANGE
0000158C  303C 005B                279              MOVE.W  #91,D0
00001590  4E4F                     280              TRAP    #15
00001592                           281              
00001592  4CDF 001F                282              MOVEM.L (A7)+,D0-D4
00001596                           283              
00001596                           284  
00001596  4E75                     285              RTS
00001598                           286  
00001598                           287  
00001598                           288  
00001598                           289  
00001598                           290  
00001598                           291  
00001598                           292  -------------------- end include --------------------
00001598                           293              INCLUDE "PAC-MAN.X68"
00001598                           294  ; ==============================================================================
00001598                           295  ; PAC-MAN MANAGEMENT
00001598                           296  ; ==============================================================================
00001598                           297              
00001598                           298  ; ------------------------------------------------------------------------------
00001598                           299  PMINIT
00001598                           300  ; INITIALIZE PAC-MAN.
00001598                           301  ; INPUT    : NONE 
00001598                           302  ; OUTPUT   : NONE
00001598                           303  ; MODIFIES : NONE
00001598                           304  ; ------------------------------------------------------------------------------
00001598                           305  
00001598  33FC 0140 00003328       306              MOVE.W  #SCRWIDTH/2,(PMPOSX)
000015A0  33FC 0140 0000332A       307              MOVE.W  #SCRHEIGH/2,(PMPOSY)
000015A8  5079 00003328            308              ADDQ.W  #8,(PMPOSX)
000015AE  5079 0000332A            309              ADDQ.W  #8,(PMPOSY)
000015B4  33FC 0002 0000332C       310              MOVE.W  #PMSPEED,(PMVELX)
000015BC  33FC 0002 0000332E       311              MOVE.W  #PMSPEED,(PMVELY)
000015C4  4239 00003331            312              CLR.B   (PMLAMO)
000015CA                           313  
000015CA  4E75                     314              RTS
000015CC                           315              
000015CC                           316  ; ------------------------------------------------------------------------------
000015CC                           317  PMUPD
000015CC                           318  ; UPDATES THE PAC-MAN.
000015CC                           319  ; INPUT    : NONE 
000015CC                           320  ; OUTPUT   : NONE
000015CC                           321  ; MODIFIES : NONE
000015CC                           322  ; ------------------------------------------------------------------------------
000015CC                           323              
000015CC  48E7 FE00                324              MOVEM.L D0-D6,-(A7)
000015D0                           325              
000015D0  303C 0002                326              MOVE.W  #PMSPEED,D0
000015D4                           327              
000015D4                           328              
000015D4  3439 00003328            329              MOVE.W  (PMPOSX),D2
000015DA  3639 0000332A            330              MOVE.W  (PMPOSY),D3
000015E0                           331              
000015E0  5042                     332              ADDQ.W  #8,D2              
000015E2  5043                     333              ADDQ.W  #8,D3  
000015E4                           334              
000015E4  1839 00003331            335              MOVE.B  (PMLAMO),D4
000015EA                           336              
000015EA                           337              ;MASK OF THE LAST NIBBLE        
000015EA  C47C 000F                338              AND.W   #$000F,D2               ; COORDENADA X
000015EE  C67C 000F                339              AND.W   #$000F,D3               ; COORDENADA Y
000015F2                           340              
000015F2                           341              ;CHECK IF COORDS ARE MULTIPLES OF 16
000015F2  B47C 0000                342              CMP     #$0000,D2
000015F6  6600 0116                343              BNE     .NOTMULT
000015FA  B67C 0000                344              CMP     #$0000,D3
000015FE  6600 010E                345              BNE     .NOTMULT
00001602                           346              
00001602                           347              ;BRA     .ACTYUP
00001602                           348  
00001602                           349              ;CHECK THE DIRECTION
00001602  0839 0000 00002496       350              BTST.B  #0,(KBDVAL)             ;CHECK LEFT
0000160A  6700 000C                351              BEQ     .NOTLEFT
0000160E  4204                     352              CLR.B   D4
00001610  183C 0000                353              MOVE.B  #0,D4
00001614  6000 007C                354              BRA     .ACTXLEFT
00001618                           355  .NOTLEFT            
00001618  0839 0002 00002496       356              BTST.B   #2,(KBDVAL)             ;CHECK RIGHT
00001620  6700 000C                357              BEQ     .NOTRIGHT
00001624  4204                     358              CLR.B   D4
00001626  183C 0001                359              MOVE.B   #1,D4
0000162A  6000 0032                360              BRA     .ACTXRIGHT
0000162E                           361  .NOTRIGHT            
0000162E  0839 0001 00002496       362              BTST.B   #1,(KBDVAL)             ;CHECK UP
00001636  6700 000C                363              BEQ     .NOTUP
0000163A  4204                     364              CLR.B   D4
0000163C  183C 0002                365              MOVE.B  #2,D4
00001640  6000 00A8                366              BRA     .ACTYUP
00001644                           367  .NOTUP            
00001644  0839 0003 00002496       368              BTST.B   #3,(KBDVAL)             ;CHECK DOWN
0000164C  6700 000C                369              BEQ     .NOTDOWN
00001650  4204                     370              CLR.B   D4
00001652  183C 0003                371              MOVE.B   #3,D4
00001656  6000 006E                372              BRA     .ACTYDOWN
0000165A                           373  .NOTDOWN
0000165A  6000 00CA                374              BRA     .DONE
0000165E                           375              
0000165E                           376              
0000165E                           377              ;UPDATE COORDS
0000165E                           378              
0000165E                           379  .ACTXRIGHT  
0000165E  4EB9 00001AD6            380              JSR     COLWALLRIGHT
00001664  BA7C 0001                381              CMP     #1,D5
00001668  6600 000E                382              BNE     .NOTCOLISION
0000166C  13FC 0000 00002496       383              MOVE.B  #0,(KBDVAL)
00001674  303C 0000                384              MOVE.W  #0,D0
00001678                           385  .NOTCOLISION
00001678  BA7C 0004                386              CMP     #4,D5
0000167C  6600 000A                387              BNE     .NOTTP
00001680  0479 01E0 00003328       388              SUB.W   #30*16,(PMPOSX)
00001688                           389  .NOTTP
00001688  D179 00003328            390              ADD.W   D0,(PMPOSX)
0000168E  6000 0096                391              BRA     .DONE
00001692                           392  .ACTXLEFT
00001692  4EB9 00001B18            393              JSR     COLWALLLEFT
00001698  BA7C 0001                394              CMP     #1,D5
0000169C  6600 000E                395              BNE     .NOTCOLISION2
000016A0  13FC 0000 00002496       396              MOVE.B  #0,(KBDVAL)
000016A8  303C 0000                397              MOVE.W  #0,D0
000016AC                           398  .NOTCOLISION2
000016AC  BA7C 0004                399              CMP     #4,D5
000016B0  6600 000A                400              BNE     .NOTTP2
000016B4  0679 01E0 00003328       401              ADD.W   #30*16,(PMPOSX)
000016BC                           402  .NOTTP2
000016BC  9179 00003328            403              SUB.W   D0,(PMPOSX)
000016C2  6000 0062                404              BRA     .DONE
000016C6                           405      
000016C6                           406  .ACTYDOWN
000016C6  4EB9 00001B5A            407              JSR     COLWALLDOWN
000016CC  BA7C 0001                408              CMP     #1,D5
000016D0  6600 000E                409              BNE     .NOTCOLISION3
000016D4  13FC 0000 00002496       410              MOVE.B  #0,(KBDVAL)
000016DC  303C 0000                411              MOVE.W  #0,D0
000016E0                           412  .NOTCOLISION3
000016E0  D179 0000332A            413              ADD.W   D0,(PMPOSY)
000016E6  6000 003E                414              BRA     .DONE
000016EA                           415  .ACTYUP     
000016EA  4EB9 00001B96            416              JSR     COLWALLUP
000016F0  BA7C 0001                417              CMP     #1,D5
000016F4  6600 000E                418              BNE     .NOTCOLISION4
000016F8  13FC 0000 00002496       419              MOVE.B  #0,(KBDVAL)
00001700  303C 0000                420              MOVE.W  #0,D0
00001704                           421  .NOTCOLISION4
00001704  9179 0000332A            422              SUB.W   D0,(PMPOSY)
0000170A  6000 001A                423              BRA     .DONE
0000170E                           424              
0000170E                           425              
0000170E                           426              ;IF NOT MULT DO
0000170E                           427  .NOTMULT     
0000170E  B83C 0000                428              CMP.B     #0,D4
00001712  6700 FF7E                429              BEQ     .ACTXLEFT
00001716  B83C 0001                430              CMP.B     #1,D4
0000171A  6700 FF42                431              BEQ     .ACTXRIGHT
0000171E  B83C 0002                432              CMP.B     #2,D4
00001722  67C6                     433              BEQ     .ACTYUP
00001724  60A0                     434              BRA     .ACTYDOWN
00001726                           435  .DONE
00001726                           436              ;RESTORE
00001726  4EB9 00001CBA            437              JSR     GETPOINTS
0000172C  13C4 00003331            438              MOVE.B  D4,(PMLAMO)
00001732                           439              
00001732  4CDF 007F                440              MOVEM.L (A7)+,D0-D6
00001736                           441              
00001736  4E75                     442              RTS
00001738                           443                          
00001738                           444  ; ------------------------------------------------------------------------------
00001738                           445  PMPLOT
00001738                           446  ; PLOT THE BALL.
00001738                           447  ; INPUT    : NONE 
00001738                           448  ; OUTPUT   : NONE
00001738                           449  ; MODIFIES : NONE
00001738                           450  ; ------------------------------------------------------------------------------
00001738                           451  
00001738  48E7 FC00                452              MOVEM.L D0-D5,-(A7)
0000173C                           453  
0000173C                           454              ;SET PEN COLOR
0000173C  303C 0050                455              MOVE.W  #80,D0
00001740  7200                     456              MOVE.L  #$0000,D1
00001742  4E4F                     457              TRAP    #15
00001744                           458              
00001744                           459              ;SET FILL COLOR
00001744  303C 0051                460              MOVE.W  #81,D0
00001748  223C 0000FFFF            461              MOVE.L  #PMFCOL,D1
0000174E  4E4F                     462              TRAP    #15
00001750                           463              
00001750  0839 0003 00002499       464              BTST.B  #3,(SCRCYCCT)
00001758  6700 000C                465              BEQ     .MOUTHOPEN
0000175C                           466              
0000175C                           467              ;DRAW QUIET
0000175C  4EB9 000017FA            468              JSR     .FULLDRAW
00001762  6000 0090                469              BRA     .DDONE
00001766                           470              
00001766                           471  .MOUTHOPEN     
00001766  4EB9 000017FA            472              JSR     .FULLDRAW       
0000176C  1A39 00002496            473              MOVE.B  (KBDVAL),D5
00001772  CA3C 000F                474              AND.B   #$0F,D5
00001776                           475   
00001776                           476              ;CHECK KBDVAL
00001776  BA3C 0000                477              CMP.B   #$0,D5
0000177A  6700 0022                478              BEQ     .NOTMOVE
0000177E  BA3C 0001                479              CMP.B  #$1,D5             ;LEFT
00001782  6700 0038                480              BEQ     .DLEFT
00001786  BA3C 0002                481              CMP.B  #$2,D5             ;UP
0000178A  6700 0026                482              BEQ     .DUP
0000178E  BA3C 0004                483              CMP.B  #$4,D5             ;RIGHT
00001792  6700 0014                484              BEQ     .DRIGHT
00001796  BA3C 0008                485              CMP.B  #$8,D5             ;DOWN
0000179A  6700 002A                486              BEQ     .DDOWN
0000179E                           487              
0000179E                           488              ;DRAW MOVEMENT
0000179E  4EB9 000017FA            489  .NOTMOVE    JSR     .FULLDRAW
000017A4  6000 004E                490              BRA     .DDONE
000017A8                           491  .DRIGHT
000017A8  4EB9 00001850            492              JSR     .RIGHTDRAW
000017AE  6000 0034                493              BRA     .DRAW_MOUTH3
000017B2                           494  .DUP
000017B2  4EB9 00001882            495              JSR     .UPDRAW
000017B8  6000 0020                496              BRA     .DRAW_MOUTH2
000017BC                           497  
000017BC                           498  .DLEFT
000017BC  4EB9 0000181E            499              JSR     .LEFTDRAW
000017C2  6000 000C                500              BRA     .DRAW_MOUTH1
000017C6                           501  
000017C6                           502  .DDOWN
000017C6  4EB9 000018B4            503              JSR     .DOWNDRAW
000017CC  6000 0020                504              BRA     .DRAW_MOUTH4
000017D0                           505              
000017D0                           506  .DRAW_MOUTH1            
000017D0  4EB9 000018E6            507              JSR     .SET_MOUTHLEFT
000017D6  6000 001C                508              BRA     .DDONE
000017DA                           509  .DRAW_MOUTH2            
000017DA  4EB9 00001922            510              JSR     .SET_MOUTHUP
000017E0  6000 0012                511              BRA     .DDONE
000017E4                           512  .DRAW_MOUTH3            
000017E4  4EB9 00001904            513              JSR     .SET_MOUTHRIGHT
000017EA  6000 0008                514              BRA     .DDONE
000017EE                           515  .DRAW_MOUTH4            
000017EE  4EB9 00001940            516              JSR     .SET_MOUTHDOWN
000017F4                           517  .DDONE
000017F4  4CDF 003F                518              MOVEM.L (A7)+,D0-D5
000017F8                           519              
000017F8  4E75                     520              RTS
000017FA                           521  
000017FA                           522  
000017FA                           523  ;INTERNAL SUBRUTINES FOR PACMAN PLOT-------------------------------------------------------------
000017FA                           524  
000017FA                           525  .FULLDRAW
000017FA                           526              ;SET COORDS
000017FA  3239 00003328            527              MOVE.W  (PMPOSX),D1
00001800  5141                     528              SUB.W   #PMRAD,D1
00001802  3439 0000332A            529              MOVE.W  (PMPOSY),D2
00001808  5142                     530              SUB.W   #PMRAD,D2
0000180A                           531              
0000180A  3601                     532              MOVE.W  D1,D3
0000180C  0643 0010                533              ADD.W   #PMRAD*2,D3
00001810  3802                     534              MOVE.W  D2,D4
00001812  0644 0010                535              ADD.W   #PMRAD*2,D4
00001816                           536              
00001816                           537              ;DRAW PAC-MAN
00001816  303C 0058                538              MOVE.W  #88,D0
0000181A  4E4F                     539              TRAP    #15
0000181C                           540              
0000181C  4E75                     541              RTS
0000181E                           542  .LEFTDRAW
0000181E                           543              
0000181E                           544              
0000181E  303C 0054                545              MOVE.W  #84,D0
00001822  3239 00003328            546              MOVE.W  (PMPOSX),D1                   ;FINAL COORD OF THE FIRST LINE
00001828  5141                     547              SUB.W   #PMRAD,D1
0000182A  3439 0000332A            548              MOVE.W  (PMPOSY),D2
00001830  5142                     549              SUB.W   #PMRAD,D2
00001832                           550              
00001832  3639 00003328            551              MOVE.W  (PMPOSX),D3                   ;ORIGINAL COORD FIRST LINE
00001838  3839 0000332A            552              MOVE.W  (PMPOSY),D4
0000183E                           553              
0000183E  4E4F                     554              TRAP    #15
00001840                           555             
00001840  303C 0055                556              MOVE.W  #85,D0                        ;DRAW SECOND LINE
00001844                           557              
00001844  3203                     558              MOVE.W  D3,D1
00001846  3404                     559              MOVE.W  D4,D2
00001848  5042                     560              ADD.W   #PMRAD,D2
0000184A  5141                     561              SUB.W   #PMRAD,D1
0000184C                           562              
0000184C  4E4F                     563              TRAP    #15
0000184E                           564              
0000184E                           565              
0000184E  4E75                     566              RTS
00001850                           567              
00001850                           568  .RIGHTDRAW
00001850                           569              
00001850                           570              
00001850  303C 0054                571              MOVE.W  #84,D0
00001854  3239 00003328            572              MOVE.W  (PMPOSX),D1                   ;FINAL COORD OF THE FIRST LINE
0000185A  5041                     573              ADD.W   #PMRAD,D1
0000185C  3439 0000332A            574              MOVE.W  (PMPOSY),D2
00001862  5042                     575              ADD.W   #PMRAD,D2
00001864                           576              
00001864  3639 00003328            577              MOVE.W  (PMPOSX),D3                   ;ORIGINAL COORD FIRST LINE
0000186A  3839 0000332A            578              MOVE.W  (PMPOSY),D4
00001870                           579              
00001870  4E4F                     580              TRAP    #15
00001872                           581             
00001872  303C 0055                582              MOVE.W  #85,D0                        ;DRAW SECOND LINE
00001876                           583              
00001876  3203                     584              MOVE.W  D3,D1
00001878  3404                     585              MOVE.W  D4,D2
0000187A  5142                     586              SUB.W   #PMRAD,D2
0000187C  5041                     587              ADD.W   #PMRAD,D1
0000187E                           588              
0000187E  4E4F                     589              TRAP    #15
00001880                           590              
00001880                           591              
00001880  4E75                     592              RTS
00001882                           593  .UPDRAW
00001882                           594              
00001882                           595              
00001882  303C 0054                596              MOVE.W  #84,D0
00001886  3239 00003328            597              MOVE.W  (PMPOSX),D1                   ;FINAL COORD OF THE FIRST LINE
0000188C  5141                     598              SUB.W   #PMRAD,D1
0000188E  3439 0000332A            599              MOVE.W  (PMPOSY),D2
00001894  5142                     600              SUB.W   #PMRAD,D2
00001896                           601              
00001896  3639 00003328            602              MOVE.W  (PMPOSX),D3                   ;ORIGINAL COORD FIRST LINE
0000189C  3839 0000332A            603              MOVE.W  (PMPOSY),D4
000018A2                           604              
000018A2  4E4F                     605              TRAP    #15
000018A4                           606             
000018A4  303C 0055                607              MOVE.W  #85,D0                        ;DRAW SECOND LINE
000018A8                           608              
000018A8  3203                     609              MOVE.W  D3,D1
000018AA  3404                     610              MOVE.W  D4,D2
000018AC  5142                     611              SUB.W   #PMRAD,D2
000018AE  5041                     612              ADD.W   #PMRAD,D1
000018B0                           613              
000018B0  4E4F                     614              TRAP    #15
000018B2                           615              
000018B2                           616              
000018B2  4E75                     617              RTS
000018B4                           618              
000018B4                           619  .DOWNDRAW
000018B4                           620              
000018B4                           621              
000018B4  303C 0054                622              MOVE.W  #84,D0
000018B8  3239 00003328            623              MOVE.W  (PMPOSX),D1                   ;FINAL COORD OF THE FIRST LINE
000018BE  5141                     624              SUB.W   #PMRAD,D1
000018C0  3439 0000332A            625              MOVE.W  (PMPOSY),D2
000018C6  5042                     626              ADD.W   #PMRAD,D2
000018C8                           627              
000018C8  3639 00003328            628              MOVE.W  (PMPOSX),D3                   ;ORIGINAL COORD FIRST LINE
000018CE  3839 0000332A            629              MOVE.W  (PMPOSY),D4
000018D4                           630              
000018D4  4E4F                     631              TRAP    #15
000018D6                           632             
000018D6  303C 0055                633              MOVE.W  #85,D0                        ;DRAW SECOND LINE
000018DA                           634              
000018DA  3203                     635              MOVE.W  D3,D1
000018DC  3404                     636              MOVE.W  D4,D2
000018DE  5042                     637              ADD.W   #PMRAD,D2
000018E0  5041                     638              ADD.W   #PMRAD,D1
000018E2                           639              
000018E2  4E4F                     640              TRAP    #15
000018E4                           641              
000018E4                           642              
000018E4  4E75                     643              RTS
000018E6                           644  
000018E6                           645              
000018E6                           646  .SET_MOUTHLEFT
000018E6                           647              
000018E6  303C 0051                648              MOVE.W  #81,D0                         ;SET BLACK
000018EA  7200                     649              MOVE.L  #$0000,D1
000018EC  4E4F                     650              TRAP    #15
000018EE                           651              
000018EE  303C 0059                652              MOVE.W  #89,D0                         ;FILL
000018F2  3239 00003328            653              MOVE.W  (PMPOSX),D1
000018F8  5541                     654              SUBQ.W   #2,D1
000018FA  3439 0000332A            655              MOVE.W  (PMPOSY),D2
00001900  4E4F                     656              TRAP    #15
00001902                           657  
00001902  4E75                     658              RTS
00001904                           659              
00001904                           660  .SET_MOUTHRIGHT
00001904                           661              
00001904  303C 0051                662              MOVE.W  #81,D0                         ;SET BLACK
00001908  7200                     663              MOVE.L  #$0000,D1
0000190A  4E4F                     664              TRAP    #15
0000190C                           665              
0000190C  303C 0059                666              MOVE.W  #89,D0                         ;FILL
00001910  3239 00003328            667              MOVE.W  (PMPOSX),D1
00001916  5441                     668              ADDQ.W   #2,D1
00001918  3439 0000332A            669              MOVE.W  (PMPOSY),D2
0000191E  4E4F                     670              TRAP    #15
00001920                           671  
00001920  4E75                     672              RTS
00001922                           673  
00001922                           674  .SET_MOUTHUP
00001922                           675              
00001922  303C 0051                676              MOVE.W  #81,D0                         ;SET BLACK
00001926  7200                     677              MOVE.L  #$0000,D1
00001928  4E4F                     678              TRAP    #15
0000192A                           679              
0000192A  303C 0059                680              MOVE.W  #89,D0                         ;FILL
0000192E  3239 00003328            681              MOVE.W  (PMPOSX),D1
00001934  3439 0000332A            682              MOVE.W  (PMPOSY),D2
0000193A  5542                     683              SUBQ.W   #2,D2
0000193C  4E4F                     684              TRAP    #15
0000193E                           685  
0000193E  4E75                     686              RTS
00001940                           687  
00001940                           688  .SET_MOUTHDOWN
00001940                           689              
00001940  303C 0051                690              MOVE.W  #81,D0                         ;SET BLACK
00001944  7200                     691              MOVE.L  #$0000,D1
00001946  4E4F                     692              TRAP    #15
00001948                           693              
00001948  303C 0059                694              MOVE.W  #89,D0                         ;FILL
0000194C  3239 00003328            695              MOVE.W  (PMPOSX),D1
00001952  3439 0000332A            696              MOVE.W  (PMPOSY),D2
00001958  5442                     697              ADDQ.W   #2,D2
0000195A  4E4F                     698              TRAP    #15
0000195C                           699  
0000195C  4E75                     700              RTS
0000195E                           701  
0000195E                           702  
0000195E                           703  
0000195E                           704  
0000195E                           705  
0000195E                           706  
0000195E                           707  
0000195E                           708  
0000195E                           709  
0000195E                           710  
0000195E                           711  
0000195E                           712  
0000195E                           713  
0000195E                           714  
0000195E                           715  
0000195E                           716  
0000195E                           717  
0000195E                           718  
0000195E                           719  
0000195E                           720  
0000195E                           721  
0000195E                           722  
0000195E                           723  
0000195E                           724  
0000195E                           725  
0000195E                           726  
0000195E                           727  
0000195E                           728  -------------------- end include --------------------
0000195E                           729              INCLUDE "SCORE.X68"
0000195E                           730  ; ==============================================================================
0000195E                           731  ; SCOREBOARD MANAGEMENT
0000195E                           732  ; ==============================================================================
0000195E                           733              
0000195E                           734  ; ------------------------------------------------------------------------------
0000195E                           735  SCOINIT
0000195E                           736  ; INITIALIZE SCOREBOARD
0000195E                           737  ; INPUT    : NONE 
0000195E                           738  ; OUTPUT   : NONE
0000195E                           739  ; MODIFIES : NONE
0000195E                           740  ; ------------------------------------------------------------------------------
0000195E  4279 00003340            741              CLR.W   (SCOPOINTS)
00001964  33FC 0003 0000333E       742              MOVE.W  #3,(SCOLIFE)
0000196C  4E75                     743              RTS
0000196E                           744              
0000196E                           745  ; ------------------------------------------------------------------------------
0000196E                           746  SCOPLOT
0000196E                           747  ; PLOT THE SCOREBOARD
0000196E                           748  ; INPUT    : NONE 
0000196E                           749  ; OUTPUT   : NONE
0000196E                           750  ; MODIFIES : NONE
0000196E                           751  ; ------------------------------------------------------------------------------
0000196E                           752              
0000196E  48E7 C040                753               MOVEM.L D0-D1/A1,-(A7)
00001972                           754  
00001972                           755              ; SET BACKGROUND COLOR
00001972  103C 0051                756              MOVE.B  #81,D0
00001976  7200                     757              MOVE.L  #SCOFCOL,D1
00001978  4E4F                     758              TRAP    #15
0000197A                           759              
0000197A                           760              ; SET FIRST LINE POSITION
0000197A  103C 000B                761              MOVE.B  #11,D0
0000197E  323C 0101                762              MOVE.W  #SCOLINE1,D1
00001982  4E4F                     763              TRAP    #15
00001984                           764  
00001984                           765              ; PRINT FIRST LINE
00001984  43F9 000019BC            766              LEA     .TXT1,A1            ;PUT FIRST STRING IN A1
0000198A  4281                     767              CLR.L   D1
0000198C  3239 00003340            768              MOVE.W  (SCOPOINTS),D1
00001992  103C 0011                769              MOVE.B  #17,D0
00001996  4E4F                     770              TRAP    #15
00001998                           771  
00001998                           772              ; SET SECOND LINE POSITION
00001998  103C 000B                773              MOVE.B  #11,D0
0000199C  323C 0102                774              MOVE.W  #SCOLINE2,D1       
000019A0  4E4F                     775              TRAP    #15
000019A2                           776  
000019A2                           777              ; PRINT SECOND LINE
000019A2  43F9 000019C5            778              LEA     .TXT2,A1
000019A8  4281                     779              CLR.L   D1
000019AA  3239 0000333E            780              MOVE.W  (SCOLIFE),D1
000019B0  103C 0011                781              MOVE.B  #17,D0
000019B4  4E4F                     782              TRAP    #15
000019B6                           783              
000019B6  4CDF 0203                784              MOVEM.L (A7)+,D0-D1/A1
000019BA                           785              
000019BA  4E75                     786              RTS
000019BC                           787  
000019BC= 50 4F 49 4E 54 53 ...    788  .TXT1       DC.B    'POINTS :',0      ;0 IS END OF STRING
000019C5= 4C 49 46 45 53 20 ...    789  .TXT2       DC.B    'LIFES  :',0
000019CE                           790  
000019CE                           791  
000019CE  4E75                     792              RTS
000019D0                           793  
000019D0                           794  
000019D0                           795  -------------------- end include --------------------
000019D0                           796              INCLUDE "SYSCONST.X68"
000019D0                           797  ; ==============================================================================
000019D0                           798  ; SYSTEM CONSTANTS
000019D0                           799  ; ==============================================================================
000019D0                           800  
000019D0                           801  ; --- SCREEN RELATED CONSTANTS -------------------------------------------------
000019D0                           802  
000019D0  =00000280                803  SCRWIDTH    EQU     640                     ; SCREEN WIDTH
000019D0  =00000280                804  SCRHEIGH    EQU     640                     ; SCREEN HEIGHT
000019D0                           805  
000019D0                           806  ;--- TITLE RELATED CONSTANTS ---------------------------------------------------
000019D0= 74 69 74 6C 65 2E ...    807  FILENAME    DC.B    'title.txt',0
000019DA  =00000A8C                808  FILESIZE    EQU     2700
000019DA                           809              DS.B    0                       
000019DA                           810  ;---KEYCODES--------------------------------------------------------------------
000019DA                           811  
000019DA  =00000025                812  KBDLEFT     EQU     $25
000019DA  =00000026                813  KBDUP       EQU     $26
000019DA  =00000027                814  KBDRIGHT    EQU     $27
000019DA  =00000028                815  KBDDOWN     EQU     $28
000019DA  =00000020                816  KBDFIRE1    EQU     ' '
000019DA  =0000004D                817  KBDFIRE2    EQU     'M'                         
000019DA  =00000010                818  KBDFIRE3    EQU     $10
000019DA  =00000050                819  KBDPAUSE    EQU     'P'
000019DA                           820  
000019DA                           821  
000019DA                           822  
000019DA                           823  
000019DA                           824  
000019DA                           825  
000019DA                           826  
000019DA                           827  
000019DA                           828  
000019DA                           829  
000019DA                           830  -------------------- end include --------------------
000019DA                           831              INCLUDE "SYSTEM.X68"
000019DA                           832  ; ==============================================================================
000019DA                           833  ; SYSTEM
000019DA                           834  ; ==============================================================================
000019DA                           835              
000019DA                           836  ; ------------------------------------------------------------------------------
000019DA                           837  SYSINIT
000019DA                           838  ; INITIALIZE SYSTEM.
000019DA                           839  ; INPUT    : NONE
000019DA                           840  ; OUTPUT   : NONE
000019DA                           841  ; MODIFIES : NONE
000019DA                           842  ; ------------------------------------------------------------------------------
000019DA                           843              
000019DA  21FC 00001A4A 0080       844              MOVE.L  #SCRUPD,($80+0*4)          ;INSTALL SUBRUTINE TO TRAP #0
000019E2  21FC 00001A80 0084       845              MOVE.L  #KBDUPD,($80+1*4)          ;INSTALL SUBRUTINE TO TRAP #1
000019EA                           846              
000019EA                           847              
000019EA  21FC 00001A64 0064       848              MOVE.L  #SCRTIM,($60+1*4)          ;INSTALL INTERRUPT #1
000019F2                           849              
000019F2  4EB9 00001A06            850              JSR     SCRINIT
000019F8  4EB9 00001A72            851              JSR     KBDINIT
000019FE                           852              
000019FE                           853              
000019FE  40E7                     854              MOVE.W  SR,-(A7)
00001A00  0257 D8FF                855              ANDI.W  #$D8FF,(A7)                ;BIT SUPERVISOR TO O AND INTERRPUT MASK 000 (FOR REACTIVATE INTERRUPTIONS)             
00001A04  4E73                     856              RTE
00001A06                           857     
00001A06                           858  ; ------------------------------------------------------------------------------
00001A06                           859  SCRINIT
00001A06                           860  ; INIT SCREEN. SET SCREEN RESOLUTION, SET WINDOWED MODE, CLEAR SCREEN, ENABLE BUFFER
00001A06                           861  ; ENABLE TIMED INTERRUPTION
00001A06                           862  ; INPUT    : NONE
00001A06                           863  ; OUTPUT   : NONE
00001A06                           864  ; MODIFIES : NONE
00001A06                           865  ; ------------------------------------------------------------------------------
00001A06                           866  
00001A06  48E7 C000                867              MOVEM.L D0-D1,-(A7)                 ;SAFE REGISTERS IN STACK
00001A0A                           868  
00001A0A                           869              ; SET SCREEN RESOLUTION
00001A0A  103C 0021                870              MOVE.B  #33,D0
00001A0E  223C 02800280            871              MOVE.L  #SCRWIDTH<<16|SCRHEIGH,D1
00001A14  4E4F                     872              TRAP    #15
00001A16                           873              
00001A16                           874              ; SET WINDOWED MODE
00001A16  7201                     875              MOVE.L  #1,D1
00001A18  4E4F                     876              TRAP    #15
00001A1A                           877              
00001A1A                           878              ; ENABLE DOUBLE BUFFER
00001A1A  103C 005C                879              MOVE.B  #92,D0
00001A1E  123C 0011                880              MOVE.B  #17,D1
00001A22  4E4F                     881              TRAP    #15
00001A24                           882              
00001A24                           883              ; CLEAR SCREEN
00001A24  103C 000B                884              MOVE.B  #11,D0
00001A28  323C FF00                885              MOVE.W  #$FF00,D1
00001A2C  4E4F                     886              TRAP    #15
00001A2E                           887              
00001A2E                           888              ;ENABLE TIMED INTERRPUT
00001A2E  303C 0020                889              MOVE.W  #32,D0
00001A32  123C 0006                890              MOVE.B  #6,D1
00001A36  143C 0081                891              MOVE.B  #$81,D2                   ;INDICATE THAT INTERRUPT 1 IS ACTIVATED PERIODICALLY
00001A3A  7614                     892              MOVE.L  #20,D3                    ;INDICATE THE MILISECONDS FOR THAT PERIOD (20 ms == 50 FPS)
00001A3C  4E4F                     893              TRAP    #15
00001A3E                           894              
00001A3E                           895              ;CLEAR INTERRUPT COUNTER
00001A3E  4239 00002498            896              CLR.B   (SCRINTCT)
00001A44                           897              
00001A44  4CDF 0003                898              MOVEM.L (A7)+,D0-D1               ;RESTORE REGISTERS FROM STACK
00001A48                           899              
00001A48  4E75                     900              RTS
00001A4A                           901  
00001A4A                           902  
00001A4A                           903              
00001A4A                           904  ;------------------------------------------------------------------------------            
00001A4A                           905  SCRUPD
00001A4A                           906  ; UPDATES DOUBLE BUFFER
00001A4A                           907  ; INPUT    : NONE
00001A4A                           908  ; OUTPUT   : NONE
00001A4A                           909  ; MODIFIES : NONE
00001A4A                           910  ; ------------------------------------------------------------------------------
00001A4A                           911  
00001A4A  48E7 C000                912              MOVEM.L D0-D1,-(A7)
00001A4E                           913              
00001A4E                           914              ;SWITCH BUFFERS
00001A4E  103C 005E                915              MOVE.B #94,D0
00001A52  4E4F                     916              TRAP #15
00001A54                           917              
00001A54                           918              ;CLEAR HIDDEN BUFFER
00001A54  103C 000B                919              MOVE.B  #11,D0
00001A58  323C FF00                920              MOVE.W  #$FF00,D1
00001A5C  4E4F                     921              TRAP    #15
00001A5E                           922              
00001A5E  4CDF 0003                923              MOVEM.L (A7)+,D0-D1
00001A62                           924              
00001A62  4E73                     925              RTE
00001A64                           926              
00001A64                           927  ; ------------------------------------------------------------------------------
00001A64                           928  SCRTIM
00001A64                           929  ; TIMED INTERRUPT SERVICE ROUTINE
00001A64                           930  ; INPUT    : NONE
00001A64                           931  ; OUTPUT   : NONE
00001A64                           932  ; MODIFIES : NONE
00001A64                           933  ; ------------------------------------------------------------------------------
00001A64  5239 00002498            934              ADDQ.B  #1,(SCRINTCT)
00001A6A  5239 00002499            935              ADDQ.B  #1,(SCRCYCCT)
00001A70  4E73                     936              RTE
00001A72                           937              
00001A72                           938  ;------------------------------------------------------------------------------            
00001A72                           939  KBDINIT
00001A72                           940  ; INIT THE KEYBOARD
00001A72                           941  ; INPUT    : NONE
00001A72                           942  ; OUTPUT   : NONE
00001A72                           943  ; MODIFIES : NONE
00001A72                           944  ; ------------------------------------------------------------------------------
00001A72                           945  
00001A72  4239 00002496            946              CLR.B   (KBDVAL)
00001A78  4239 00002497            947              CLR.B   (KBDEDGE)
00001A7E                           948  
00001A7E  4E75                     949              RTS
00001A80                           950  
00001A80                           951  ;------------------------------------------------------------------------------            
00001A80                           952  KBDUPD
00001A80                           953  ; UPDATES KEYBOARD INFO
00001A80                           954  ; 3 -> DOWN     (HEX: 8)
00001A80                           955  ; 2 -> RIGHT    (HEX: 4)
00001A80                           956  ; 1 -> UP       (HEX: 2)
00001A80                           957  ; 0 -> LEFT     (HEX: 1)
00001A80                           958  ; ------------------------------------------------------------------------------
00001A80                           959              
00001A80  48E7 F800                960              MOVEM.L D0-D4,-(A7)
00001A84                           961              
00001A84                           962              ; READ FIRST PART
00001A84  103C 0013                963              MOVE.B  #19,D0
00001A88  223C 50104D20            964              MOVE.L  #KBDPAUSE<<24|KBDFIRE3<<16|KBDFIRE2<<8|KBDFIRE1,D1
00001A8E  4E4F                     965              TRAP    #15
00001A90                           966  
00001A90                           967              ; CONVERT TO DESIRED FORMAT
00001A90  4EB9 00001AC8            968              JSR     .CONVERT
00001A96                           969  
00001A96                           970              ; READ SECOND PART
00001A96  223C 28272625            971              MOVE.L  #KBDDOWN<<24|KBDRIGHT<<16|KBDUP<<8|KBDLEFT,D1
00001A9C  4E4F                     972              TRAP    #15
00001A9E                           973              
00001A9E                           974              ;CONVERT TO DESIRED FORMAT
00001A9E  4EB9 00001AC8            975              JSR .CONVERT
00001AA4                           976  
00001AA4                           977              ;GET KBDEDGE (IF SOME KEY HAVE CHANGED THE VALUE)
00001AA4  1039 00002496            978              MOVE.B  (KBDVAL),D0             ;D0 -> LAST KBDVAL
00001AAA  4600                     979              NOT.B   D0                      ;D2 -> ACTUAL KBDVAL
00001AAC  C002                     980              AND.B   D2,D0
00001AAE  13C0 00002497            981              MOVE.B  D0,(KBDEDGE)
00001AB4                           982              
00001AB4                           983         
00001AB4  B03C 0000                984              CMP.B   #0,D0
00001AB8  6700 0008                985              BEQ     .NOACT          
00001ABC                           986              
00001ABC                           987              ;STORE NEW KBDVAL
00001ABC  13C2 00002496            988              MOVE.B  D2,(KBDVAL)
00001AC2                           989  .NOACT
00001AC2                           990              
00001AC2  4CDF 001F                991              MOVEM.L (A7)+,D0-D4
00001AC6                           992              
00001AC6  4E73                     993              RTE    
00001AC8                           994              
00001AC8                           995  .CONVERT 
00001AC8  363C 0003                996              MOVE.W  #3,D3
00001ACC                           997              
00001ACC  E189                     998  .LOOP       LSL.L   #8,D1
00001ACE  E312                     999              ROXL.B  #1,D2
00001AD0  51CB FFFA               1000              DBRA.W  D3,.LOOP
00001AD4  4E75                    1001              RTS
00001AD6                          1002             
00001AD6                          1003  
00001AD6                          1004  ;------------------------------------------------------------------------------            
00001AD6                          1005  COLWALLRIGHT
00001AD6                          1006  ; COLLISION PAC-MAN WITH WALL
00001AD6                          1007  ; INPUT    : NONE
00001AD6                          1008  ; OUTPUT   : NONE
00001AD6                          1009  ; MODIFIES : NONE
00001AD6                          1010  ; ------------------------------------------------------------------------------
00001AD6                          1011  
00001AD6  48E7 F800               1012              MOVEM.L D0-D4,-(A7)
00001ADA                          1013  
00001ADA  3039 00003328           1014              MOVE.W  (PMPOSX),D0
00001AE0  5140                    1015              SUB.W   #8,D0
00001AE2  3239 0000332A           1016              MOVE.W  (PMPOSY),D1
00001AE8  5041                    1017              ADD.W   #8,D1
00001AEA                          1018              
00001AEA  81FC 0010               1019              DIVS.W  #16,D0
00001AEE  83FC 0010               1020              DIVS.W  #16,D1
00001AF2                          1021              
00001AF2  5940                    1022              SUB.W   #4,D0                   ;LI RESTAM 4 PERQUE LA MATRIU ESTA A UNA DISTANCIA DE 64 PIXELS DE LA PANTALLA
00001AF4  5941                    1023              SUB.W   #4,D1
00001AF6                          1024              
00001AF6  41F9 0000249A           1025              LEA.L   MAPVAR,A0
00001AFC                          1026              
00001AFC  5240                    1027              ADD.W   #1,D0
00001AFE  5341                    1028              SUB.W   #1,D1
00001B00  C2FC 0020               1029              MULU.W  #32,D1
00001B04  D041                    1030              ADD.W   D1,D0
00001B06                          1031              
00001B06  3240                    1032              MOVE.W  D0,A1
00001B08  13C0 0000289A           1033              MOVE.B  D0,POSCON
00001B0E                          1034  
00001B0E  1A29 249A               1035              MOVE.B  MAPVAR(A1),D5
00001B12                          1036              
00001B12  4CDF 001F               1037              MOVEM.L (A7)+,D0-D4
00001B16                          1038              
00001B16  4E75                    1039              RTS
00001B18                          1040  
00001B18                          1041  
00001B18                          1042  ;------------------------------------------------------------------------------            
00001B18                          1043  COLWALLLEFT
00001B18                          1044  ; COLLISION PAC-MAN WITH WALL
00001B18                          1045  ; INPUT    : NONE
00001B18                          1046  ; OUTPUT   : NONE
00001B18                          1047  ; MODIFIES : NONE
00001B18                          1048  ; ------------------------------------------------------------------------------
00001B18                          1049  
00001B18  48E7 F800               1050              MOVEM.L D0-D4,-(A7)
00001B1C                          1051  
00001B1C  3039 00003328           1052              MOVE.W  (PMPOSX),D0
00001B22  5C40                    1053              ADD.W   #6,D0
00001B24  3239 0000332A           1054              MOVE.W  (PMPOSY),D1
00001B2A  5041                    1055              ADD.W   #8,D1
00001B2C                          1056              
00001B2C  81FC 0010               1057              DIVS.W  #16,D0
00001B30  83FC 0010               1058              DIVS.W  #16,D1
00001B34                          1059              
00001B34  5940                    1060              SUB.W   #4,D0                   ;LI RESTAM 4 PERQUE LA MATRIU ESTA A UNA DISTANCIA DE 64 PIXELS DE LA PANTALLA
00001B36  5941                    1061              SUB.W   #4,D1
00001B38                          1062              
00001B38  41F9 0000249A           1063              LEA.L   MAPVAR,A0
00001B3E                          1064              
00001B3E  5340                    1065              SUB.W   #1,D0
00001B40  5341                    1066              SUB.W   #1,D1
00001B42  C2FC 0020               1067              MULU.W  #32,D1
00001B46  D041                    1068              ADD.W   D1,D0
00001B48                          1069  
00001B48  3240                    1070              MOVE.W  D0,A1
00001B4A  13C0 0000289A           1071              MOVE.B  D0,POSCON
00001B50                          1072  
00001B50  1A29 249A               1073              MOVE.B  MAPVAR(A1),D5               
00001B54                          1074  
00001B54                          1075              
00001B54  4CDF 001F               1076              MOVEM.L (A7)+,D0-D4
00001B58                          1077              
00001B58  4E75                    1078              RTS
00001B5A                          1079  
00001B5A                          1080  ;------------------------------------------------------------------------------            
00001B5A                          1081  COLWALLDOWN
00001B5A                          1082  ; COLLISION PAC-MAN WITH WALL
00001B5A                          1083  ; INPUT    : NONE
00001B5A                          1084  ; OUTPUT   : NONE
00001B5A                          1085  ; MODIFIES : NONE
00001B5A                          1086  ; ------------------------------------------------------------------------------
00001B5A                          1087  
00001B5A  48E7 F800               1088              MOVEM.L D0-D4,-(A7)
00001B5E                          1089  
00001B5E  3039 00003328           1090              MOVE.W  (PMPOSX),D0
00001B64                          1091              ;ADD.W   #8,D0
00001B64  3239 0000332A           1092              MOVE.W  (PMPOSY),D1
00001B6A  5041                    1093              ADD.W   #8,D1
00001B6C                          1094              
00001B6C  81FC 0010               1095              DIVS.W  #16,D0
00001B70  83FC 0010               1096              DIVS.W  #16,D1
00001B74                          1097              
00001B74  5940                    1098              SUB.W   #4,D0                   ;LI RESTAM 4 PERQUE LA MATRIU ESTA A UNA DISTANCIA DE 64 PIXELS DE LA PANTALLA
00001B76  5941                    1099              SUB.W   #4,D1
00001B78                          1100              
00001B78  41F9 0000249A           1101              LEA.L   MAPVAR,A0
00001B7E                          1102              
00001B7E  C2FC 0020               1103              MULU.W  #32,D1
00001B82  D041                    1104              ADD.W   D1,D0
00001B84                          1105  
00001B84  3240                    1106              MOVE.W  D0,A1
00001B86  13C0 0000289A           1107              MOVE.B  D0,POSCON
00001B8C                          1108  
00001B8C  1A29 249A               1109              MOVE.B  MAPVAR(A1),D5 
00001B90                          1110  
00001B90                          1111              
00001B90  4CDF 001F               1112              MOVEM.L (A7)+,D0-D4
00001B94                          1113              
00001B94  4E75                    1114              RTS
00001B96                          1115  
00001B96                          1116  
00001B96                          1117  ;------------------------------------------------------------------------------            
00001B96                          1118  COLWALLUP
00001B96                          1119  ; COLLISION PAC-MAN WITH WALL
00001B96                          1120  ; INPUT    : NONE
00001B96                          1121  ; OUTPUT   : NONE
00001B96                          1122  ; MODIFIES : NONE
00001B96                          1123  ; ------------------------------------------------------------------------------
00001B96                          1124  
00001B96  48E7 F800               1125              MOVEM.L D0-D4,-(A7)
00001B9A                          1126  
00001B9A  3039 00003328           1127              MOVE.W  (PMPOSX),D0
00001BA0                          1128              ;SUB.W   #8,D0
00001BA0  3239 0000332A           1129              MOVE.W  (PMPOSY),D1
00001BA6  5C41                    1130              ADD.W   #6,D1
00001BA8                          1131              
00001BA8                          1132              
00001BA8  81FC 0010               1133              DIVS.W  #16,D0
00001BAC  83FC 0010               1134              DIVS.W  #16,D1
00001BB0                          1135              
00001BB0  5940                    1136              SUB.W   #4,D0                   ;LI RESTAM 4 PERQUE LA MATRIU ESTA A UNA DISTANCIA DE 64 PIXELS DE LA PANTALLA
00001BB2  5941                    1137              SUB.W   #4,D1
00001BB4                          1138              
00001BB4  41F9 0000249A           1139              LEA.L   MAPVAR,A0
00001BBA                          1140              
00001BBA  5341                    1141              SUB.W   #1,D1
00001BBC                          1142              ;CMP     #1,D1
00001BBC                          1143              ;BLO     BUCLE4
00001BBC  C2FC 0020               1144              MULU.W  #32,D1
00001BC0  D041                    1145              ADD.W   D1,D0
00001BC2                          1146  
00001BC2                          1147  ;BUCLE4            
00001BC2  3240                    1148              MOVE.W  D0,A1
00001BC4  13C0 0000289A           1149              MOVE.B  D0,POSCON
00001BCA                          1150  
00001BCA  1A29 249A               1151              MOVE.B  MAPVAR(A1),D5 
00001BCE                          1152  
00001BCE                          1153              ;MOVE.B  #0,D5
00001BCE                          1154              
00001BCE  4CDF 001F               1155              MOVEM.L (A7)+,D0-D4
00001BD2                          1156              
00001BD2  4E75                    1157              RTS
00001BD4                          1158  
00001BD4                          1159  ;------------------------------------------------------------------------------            
00001BD4                          1160  GSTCOLWALLRIGHT
00001BD4                          1161  ; COLLISION PAC-MAN WITH WALL
00001BD4                          1162  ; INPUT    : NONE
00001BD4                          1163  ; OUTPUT   : NONE
00001BD4                          1164  ; MODIFIES : NONE
00001BD4                          1165  ; ------------------------------------------------------------------------------
00001BD4                          1166  
00001BD4  48E7 F800               1167              MOVEM.L D0-D4,-(A7)
00001BD8                          1168  
00001BD8  3039 00003332           1169              MOVE.W  (GSTPOSX),D0
00001BDE  5140                    1170              SUB.W   #8,D0
00001BE0  3239 00003334           1171              MOVE.W  (GSTPOSY),D1
00001BE6  5041                    1172              ADD.W   #8,D1
00001BE8                          1173              
00001BE8  81FC 0010               1174              DIVS.W  #16,D0
00001BEC  83FC 0010               1175              DIVS.W  #16,D1
00001BF0                          1176              
00001BF0  5940                    1177              SUB.W   #4,D0                   ;LI RESTAM 4 PERQUE LA MATRIU ESTA A UNA DISTANCIA DE 64 PIXELS DE LA PANTALLA
00001BF2  5941                    1178              SUB.W   #4,D1
00001BF4                          1179              
00001BF4  41F9 0000249A           1180              LEA.L   MAPVAR,A0
00001BFA                          1181              
00001BFA  5240                    1182              ADD.W   #1,D0
00001BFC  5341                    1183              SUB.W   #1,D1
00001BFE  C2FC 0020               1184              MULU.W  #32,D1
00001C02  D041                    1185              ADD.W   D1,D0
00001C04                          1186              
00001C04  3240                    1187              MOVE.W  D0,A1
00001C06                          1188  
00001C06  1A29 249A               1189              MOVE.B  MAPVAR(A1),D5
00001C0A                          1190              
00001C0A  4CDF 001F               1191              MOVEM.L (A7)+,D0-D4
00001C0E                          1192              
00001C0E  4E75                    1193              RTS
00001C10                          1194  
00001C10                          1195  
00001C10                          1196  ;------------------------------------------------------------------------------            
00001C10                          1197  GSTCOLWALLLEFT
00001C10                          1198  ; COLLISION PAC-MAN WITH WALL
00001C10                          1199  ; INPUT    : NONE
00001C10                          1200  ; OUTPUT   : NONE
00001C10                          1201  ; MODIFIES : NONE
00001C10                          1202  ; ------------------------------------------------------------------------------
00001C10                          1203  
00001C10  48E7 F800               1204              MOVEM.L D0-D4,-(A7)
00001C14                          1205  
00001C14  3039 00003332           1206              MOVE.W  (GSTPOSX),D0
00001C1A  5C40                    1207              ADD.W   #6,D0
00001C1C  3239 00003334           1208              MOVE.W  (GSTPOSY),D1
00001C22  5041                    1209              ADD.W   #8,D1
00001C24                          1210              
00001C24  81FC 0010               1211              DIVS.W  #16,D0
00001C28  83FC 0010               1212              DIVS.W  #16,D1
00001C2C                          1213              
00001C2C  5940                    1214              SUB.W   #4,D0                   ;LI RESTAM 4 PERQUE LA MATRIU ESTA A UNA DISTANCIA DE 64 PIXELS DE LA PANTALLA
00001C2E  5941                    1215              SUB.W   #4,D1
00001C30                          1216              
00001C30  41F9 0000249A           1217              LEA.L   MAPVAR,A0
00001C36                          1218              
00001C36  5340                    1219              SUB.W   #1,D0
00001C38  5341                    1220              SUB.W   #1,D1
00001C3A  C2FC 0020               1221              MULU.W  #32,D1
00001C3E  D041                    1222              ADD.W   D1,D0
00001C40                          1223  
00001C40  3240                    1224              MOVE.W  D0,A1
00001C42  1A29 249A               1225              MOVE.B  MAPVAR(A1),D5               
00001C46                          1226  
00001C46                          1227              
00001C46  4CDF 001F               1228              MOVEM.L (A7)+,D0-D4
00001C4A                          1229              
00001C4A  4E75                    1230              RTS
00001C4C                          1231  
00001C4C                          1232  ;------------------------------------------------------------------------------            
00001C4C                          1233  GSTCOLWALLDOWN
00001C4C                          1234  ; COLLISION PAC-MAN WITH WALL
00001C4C                          1235  ; INPUT    : NONE
00001C4C                          1236  ; OUTPUT   : NONE
00001C4C                          1237  ; MODIFIES : NONE
00001C4C                          1238  ; ------------------------------------------------------------------------------
00001C4C                          1239  
00001C4C  48E7 F800               1240              MOVEM.L D0-D4,-(A7)
00001C50                          1241  
00001C50  3039 00003332           1242              MOVE.W  (GSTPOSX),D0
00001C56                          1243              ;ADD.W   #8,D0
00001C56  3239 00003334           1244              MOVE.W  (GSTPOSY),D1
00001C5C  5041                    1245              ADD.W   #8,D1
00001C5E                          1246              
00001C5E  81FC 0010               1247              DIVS.W  #16,D0
00001C62  83FC 0010               1248              DIVS.W  #16,D1
00001C66                          1249              
00001C66  5940                    1250              SUB.W   #4,D0                   ;LI RESTAM 4 PERQUE LA MATRIU ESTA A UNA DISTANCIA DE 64 PIXELS DE LA PANTALLA
00001C68  5941                    1251              SUB.W   #4,D1
00001C6A                          1252              
00001C6A  41F9 0000249A           1253              LEA.L   MAPVAR,A0
00001C70                          1254              
00001C70  C2FC 0020               1255              MULU.W  #32,D1
00001C74  D041                    1256              ADD.W   D1,D0
00001C76                          1257  
00001C76  3240                    1258              MOVE.W  D0,A1
00001C78  1A29 249A               1259              MOVE.B  MAPVAR(A1),D5 
00001C7C                          1260  
00001C7C                          1261              
00001C7C  4CDF 001F               1262              MOVEM.L (A7)+,D0-D4
00001C80                          1263              
00001C80  4E75                    1264              RTS
00001C82                          1265  
00001C82                          1266  
00001C82                          1267  ;------------------------------------------------------------------------------            
00001C82                          1268  GSTCOLWALLUP
00001C82                          1269  ; COLLISION PAC-MAN WITH WALL
00001C82                          1270  ; INPUT    : NONE
00001C82                          1271  ; OUTPUT   : NONE
00001C82                          1272  ; MODIFIES : NONE
00001C82                          1273  ; ------------------------------------------------------------------------------
00001C82                          1274  
00001C82  48E7 F800               1275              MOVEM.L D0-D4,-(A7)
00001C86                          1276  
00001C86  3039 00003332           1277              MOVE.W  (GSTPOSX),D0
00001C8C                          1278              ;SUB.W   #8,D0
00001C8C  3239 00003334           1279              MOVE.W  (GSTPOSY),D1
00001C92  5C41                    1280              ADD.W   #6,D1
00001C94                          1281              
00001C94                          1282              
00001C94  81FC 0010               1283              DIVS.W  #16,D0
00001C98  83FC 0010               1284              DIVS.W  #16,D1
00001C9C                          1285              
00001C9C  5940                    1286              SUB.W   #4,D0                   ;LI RESTAM 4 PERQUE LA MATRIU ESTA A UNA DISTANCIA DE 64 PIXELS DE LA PANTALLA
00001C9E  5941                    1287              SUB.W   #4,D1
00001CA0                          1288              
00001CA0  41F9 0000249A           1289              LEA.L   MAPVAR,A0
00001CA6                          1290              
00001CA6  5341                    1291              SUB.W   #1,D1
00001CA8                          1292  
00001CA8  C2FC 0020               1293              MULU.W  #32,D1
00001CAC  D041                    1294              ADD.W   D1,D0
00001CAE                          1295  
00001CAE  3240                    1296              MOVE.W  D0,A1
00001CB0                          1297  
00001CB0  1A29 249A               1298              MOVE.B  MAPVAR(A1),D5 
00001CB4                          1299  
00001CB4                          1300              ;MOVE.B  #0,D5
00001CB4                          1301              
00001CB4  4CDF 001F               1302              MOVEM.L (A7)+,D0-D4
00001CB8                          1303              
00001CB8  4E75                    1304              RTS
00001CBA                          1305  ;------------------------------------------------------------------------------            
00001CBA                          1306  GETPOINTS
00001CBA                          1307  ; COLLISION PAC-MAN WITH WALL
00001CBA                          1308  ; INPUT    : NONE
00001CBA                          1309  ; OUTPUT   : NONE
00001CBA                          1310  ; MODIFIES : NONE
00001CBA                          1311  ; ------------------------------------------------------------------------------
00001CBA                          1312  
00001CBA  48E7 F800               1313              MOVEM.L D0-D4,-(A7)
00001CBE                          1314  
00001CBE  3039 00003328           1315              MOVE.W  (PMPOSX),D0
00001CC4                          1316              ;SUB.W   #8,D0
00001CC4  3239 0000332A           1317              MOVE.W  (PMPOSY),D1
00001CCA  0641 0010               1318              ADD.W   #16,D1
00001CCE                          1319              
00001CCE                          1320              
00001CCE  81FC 0010               1321              DIVS.W  #16,D0
00001CD2  83FC 0010               1322              DIVS.W  #16,D1
00001CD6                          1323              
00001CD6  5940                    1324              SUB.W   #4,D0                   ;LI RESTAM 4 PERQUE LA MATRIU ESTA A UNA DISTANCIA DE 64 PIXELS DE LA PANTALLA
00001CD8  5941                    1325              SUB.W   #4,D1
00001CDA                          1326                          
00001CDA  5341                    1327              SUB.W   #1,D1
00001CDC  C2FC 0020               1328              MULU.W  #32,D1
00001CE0  D041                    1329              ADD.W   D1,D0
00001CE2                          1330  
00001CE2  3240                    1331              MOVE.W  D0,A1
00001CE4  1A29 249A               1332              MOVE.B  MAPVAR(A1),D5
00001CE8                          1333              
00001CE8  BA7C 0000               1334              CMP     #0,D5
00001CEC  6700 003A               1335              BEQ     .DONE
00001CF0  BA7C 0002               1336              CMP     #2,D5
00001CF4  6700 0020               1337              BEQ     .POINT
00001CF8  BA7C 0003               1338              CMP     #3,D5
00001CFC  6700 0006               1339              BEQ     .BPOINT
00001D00  6600 0026               1340              BNE     .DONE
00001D04                          1341  .BPOINT
00001D04  137C 0000 249A          1342              MOVE.B  #0,MAPVAR(A1)
00001D0A  0679 0032 00003340      1343              ADD.W   #50,(SCOPOINTS)
00001D12  6600 0014               1344              BNE     .DONE
00001D16                          1345  .POINT
00001D16  137C 0000 249A          1346              MOVE.B  #0,MAPVAR(A1)
00001D1C  0679 000A 00003340      1347              ADD.W   #10,(SCOPOINTS)
00001D24  6600 0002               1348              BNE     .DONE            
00001D28                          1349  .DONE                        
00001D28  4CDF 001F               1350              MOVEM.L (A7)+,D0-D4
00001D2C                          1351              
00001D2C  4E75                    1352              RTS
00001D2E                          1353  
00001D2E                          1354  
00001D2E                          1355  
00001D2E                          1356  
00001D2E                          1357  
00001D2E                          1358  
00001D2E                          1359  -------------------- end include --------------------
00001D2E                          1360              INCLUDE "MAP.X68"
00001D2E                          1361  
00001D2E                          1362  ; ------------------------------------------------------------------------------
00001D2E                          1363  MAPINIT
00001D2E                          1364  ; INIT MAP
00001D2E                          1365  ; INPUT    : NONE
00001D2E                          1366  ; OUTPUT   : NONE
00001D2E                          1367  ; MODIFIES : NONE
00001D2E                          1368  ; ------------------------------------------------------------------------------            
00001D2E                          1369              
00001D2E                          1370              ;MOVE.L  #DIBFIGWALL,($80+2*4)          ;INSTALL SUBRUTINE TO TRAP #2
00001D2E                          1371              ;MOVE.L  #DIBFIGPOINT,($80+3*4)          ;INSTALL SUBRUTINE TO TRAP #3
00001D2E                          1372              ;MOVE.L  #DIBFIGBPOINT,($80+4*4)          ;INSTALL SUBRUTINE TO TRAP #4
00001D2E                          1373              
00001D2E  48E7 FE00               1374              MOVEM.L D0-D6,-(A7)
00001D32  48E7 00C0               1375              MOVEM.L A0-A1,-(A7)
00001D36                          1376              
00001D36  41F8 1000               1377              LEA.L   MAPMAT,A0
00001D3A  43F9 0000249A           1378              LEA.L   MAPVAR,A1
00001D40  3C3C 0030               1379              MOVE.W  #48,D6
00001D44  343C 001F               1380              MOVE.W  #31,D2
00001D48                          1381  BUCLE_FILA
00001D48  3A3C 0030               1382              MOVE.W  #48,D5
00001D4C  323C 001F               1383              MOVE.W  #31,D1
00001D50  0646 0010               1384              ADD.W   #16,D6
00001D54                          1385  
00001D54                          1386  BUCLE_COLUMNA
00001D54  0645 0010               1387              ADD.W   #16,D5
00001D58                          1388  
00001D58  1018                    1389              MOVE.B  (A0)+,D0
00001D5A  12C0                    1390              MOVE.B  D0,(A1)+
00001D5C                          1391               
00001D5C  B07C 0000               1392              CMP     #0,D0
00001D60  6700 0034               1393              BEQ     ZERO
00001D64  B07C 0004               1394              CMP     #4,D0
00001D68  6700 002C               1395              BEQ     ZERO
00001D6C  B07C 0001               1396              CMP     #1,D0
00001D70  6600 0008               1397              BNE     NOTWALL
00001D74  4EB9 00001E1C           1398              JSR     DIBFIGWALL
00001D7A                          1399  NOTWALL
00001D7A  B07C 0002               1400              CMP     #2,D0
00001D7E  6600 0008               1401              BNE     NOTPOINT
00001D82  4EB9 00001E54           1402              JSR     DIBFIGPOINT
00001D88                          1403  NOTPOINT
00001D88  B07C 0003               1404              CMP     #3,D0
00001D8C  6600 0008               1405              BNE     ZERO
00001D90  4EB9 00001E90           1406              JSR     DIBFIGBPOINT
00001D96                          1407           
00001D96                          1408  ZERO
00001D96  51C9 FFBC               1409              DBRA    D1,BUCLE_COLUMNA  
00001D9A  51CA FFAC               1410              DBRA    D2,BUCLE_FILA
00001D9E                          1411              
00001D9E  4CDF 0300               1412              MOVEM.L (A7)+,A0-A1
00001DA2  4CDF 007F               1413              MOVEM.L (A7)+,D0-D6
00001DA6                          1414  
00001DA6                          1415  
00001DA6                          1416              
00001DA6  4E75                    1417              RTS            
00001DA8                          1418  
00001DA8                          1419  ; ------------------------------------------------------------------------------
00001DA8                          1420  MAPPLOT
00001DA8                          1421  ; INIT MAP
00001DA8                          1422  ; INPUT    : NONE
00001DA8                          1423  ; OUTPUT   : NONE
00001DA8                          1424  ; MODIFIES : NONE
00001DA8                          1425  ; ------------------------------------------------------------------------------            
00001DA8                          1426  
00001DA8  48E7 FE00               1427              MOVEM.L D0-D6,-(A7)
00001DAC  48E7 0080               1428              MOVEM.L A0,-(A7)
00001DB0                          1429  
00001DB0  41F9 0000249A           1430              LEA.L   MAPVAR,A0
00001DB6  3C3C 0030               1431              MOVE.W  #48,D6
00001DBA  343C 001F               1432              MOVE.W  #31,D2
00001DBE                          1433  BUCLE_FILA2
00001DBE  3A3C 0030               1434              MOVE.W  #48,D5
00001DC2  323C 001F               1435              MOVE.W  #31,D1
00001DC6  0646 0010               1436              ADD.W   #16,D6
00001DCA                          1437  
00001DCA                          1438  BUCLE_COLUMNA2
00001DCA  0645 0010               1439              ADD.W   #16,D5       
00001DCE                          1440  
00001DCE  1018                    1441              MOVE.B  (A0)+,D0
00001DD0                          1442  
00001DD0  B07C 0000               1443              CMP     #0,D0
00001DD4  6700 0034               1444              BEQ     ZERO2
00001DD8  B07C 0004               1445              CMP     #4,D0
00001DDC  6700 002C               1446              BEQ     ZERO2
00001DE0  B07C 0001               1447              CMP     #1,D0
00001DE4  6600 0008               1448              BNE     NOTWALL2
00001DE8  4EB9 00001E1C           1449              JSR     DIBFIGWALL
00001DEE                          1450  NOTWALL2
00001DEE  B07C 0002               1451              CMP     #2,D0
00001DF2  6600 0008               1452              BNE     NOTPOINT2
00001DF6  4EB9 00001E54           1453              JSR     DIBFIGPOINT
00001DFC                          1454  NOTPOINT2
00001DFC  B07C 0003               1455              CMP     #3,D0
00001E00  6600 0008               1456              BNE     ZERO2
00001E04  4EB9 00001E90           1457              JSR     DIBFIGBPOINT
00001E0A                          1458  
00001E0A                          1459     
00001E0A                          1460  ZERO2
00001E0A  51C9 FFBE               1461              DBRA    D1,BUCLE_COLUMNA2
00001E0E                          1462              
00001E0E  51CA FFAE               1463              DBRA    D2,BUCLE_FILA2
00001E12                          1464              
00001E12  4CDF 0100               1465              MOVEM.L (A7)+,A0
00001E16  4CDF 007F               1466              MOVEM.L (A7)+,D0-D6
00001E1A                          1467              
00001E1A                          1468              
00001E1A  4E75                    1469              RTS 
00001E1C                          1470              
00001E1C                          1471  ; -----------------------------------------------------------------------------
00001E1C                          1472  DIBFIGWALL
00001E1C                          1473  ; SUBRUTINE DRAW MAP
00001E1C                          1474  ; INPUT    : D5=POSITION X, D6=POSITION Y
00001E1C                          1475  ; OUTPUT   : NONE
00001E1C                          1476  ; MODIFIES : NONE
00001E1C                          1477  ; -----------------------------------------------------------------------------
00001E1C  48E7 FE00               1478              MOVEM.L D0-D6,-(A7)
00001E20                          1479              ; SET CONTOURN COLOR
00001E20  103C 0050               1480              MOVE.B  #80,D0
00001E24  223C 00AA0000           1481              MOVE.L  #$00AA0000,D1
00001E2A  4E4F                    1482              TRAP    #15
00001E2C                          1483              
00001E2C                          1484              ; SET FILL COLOR
00001E2C  103C 0051               1485              MOVE.B  #81,D0
00001E30  223C 00FF0000           1486              MOVE.L  #$00FF0000,D1
00001E36  4E4F                    1487              TRAP    #15
00001E38                          1488              
00001E38                          1489              ; DEFINE COORDINATES RECTANGLE
00001E38  3205                    1490              MOVE.W  D5,D1
00001E3A  3406                    1491              MOVE.W  D6,D2
00001E3C  0645 0010               1492              ADD.W   #16,D5
00001E40  0646 0010               1493              ADD.W   #16,D6
00001E44  3605                    1494              MOVE.W  D5,D3
00001E46  3806                    1495              MOVE.W  D6,D4
00001E48                          1496              
00001E48                          1497              ; DRAW RECTANGLE
00001E48  103C 0057               1498              MOVE.B  #87,D0
00001E4C  4E4F                    1499              TRAP    #15
00001E4E                          1500              
00001E4E  4CDF 007F               1501              MOVEM.L (A7)+,D0-D6
00001E52                          1502  
00001E52  4E75                    1503              RTS
00001E54                          1504              
00001E54                          1505  ; -----------------------------------------------------------------------------
00001E54                          1506  DIBFIGPOINT
00001E54                          1507  ; SUBRUTINE DRAW MAP
00001E54                          1508  ; INPUT    : D5=POSITION X, D6=POSITION Y
00001E54                          1509  ; OUTPUT   : NONE
00001E54                          1510  ; MODIFIES : NONE
00001E54                          1511  ; -----------------------------------------------------------------------------
00001E54  48E7 FE00               1512              MOVEM.L D0-D6,-(A7)
00001E58                          1513              ; SET CONTOURN COLOR
00001E58  103C 0050               1514              MOVE.B  #80,D0
00001E5C  223C 0000AAAA           1515              MOVE.L  #$0000AAAA,D1
00001E62  4E4F                    1516              TRAP    #15
00001E64                          1517              
00001E64                          1518              ; SET FILL COLOR
00001E64  103C 0051               1519              MOVE.B  #81,D0
00001E68  223C 0000FFFF           1520              MOVE.L  #$0000FFFF,D1
00001E6E  4E4F                    1521              TRAP    #15
00001E70                          1522              
00001E70                          1523              ; DEFINE COORDINATES RECTANGLE
00001E70  3205                    1524              MOVE.W  D5,D1
00001E72  5041                    1525              ADD.W   #8,D1
00001E74  5541                    1526              SUB.W   #2,D1
00001E76  3406                    1527              MOVE.W  D6,D2
00001E78  5042                    1528              ADD.W   #8,D2
00001E7A  5542                    1529              SUB.W   #2,D2
00001E7C                          1530              
00001E7C  3601                    1531              MOVE.W  D1,D3
00001E7E  5843                    1532              ADD.W   #2*2,D3
00001E80  3802                    1533              MOVE.W  D2,D4
00001E82  5844                    1534              ADD.W   #2*2,D4
00001E84                          1535              
00001E84                          1536              ; DRAW POINT
00001E84  103C 0058               1537              MOVE.B  #88,D0
00001E88  4E4F                    1538              TRAP    #15
00001E8A                          1539              
00001E8A  4CDF 007F               1540              MOVEM.L (A7)+,D0-D6
00001E8E                          1541              
00001E8E  4E75                    1542              RTS
00001E90                          1543  
00001E90                          1544  
00001E90                          1545  ; -----------------------------------------------------------------------------
00001E90                          1546  DIBFIGBPOINT
00001E90                          1547  ; SUBRUTINE DRAW MAP
00001E90                          1548  ; INPUT    : D5=POSITION X, D6=POSITION Y
00001E90                          1549  ; OUTPUT   : NONE
00001E90                          1550  ; MODIFIES : NONE
00001E90                          1551  ; -----------------------------------------------------------------------------
00001E90  48E7 FE00               1552              MOVEM.L D0-D6,-(A7)
00001E94                          1553              ; SET CONTOURN COLOR
00001E94  103C 0050               1554              MOVE.B  #80,D0
00001E98  223C 0000AAAA           1555              MOVE.L  #$0000AAAA,D1
00001E9E  4E4F                    1556              TRAP    #15
00001EA0                          1557              
00001EA0                          1558              ; SET FILL COLOR
00001EA0  103C 0051               1559              MOVE.B  #81,D0
00001EA4  223C 0000FFFF           1560              MOVE.L  #$0000FFFF,D1
00001EAA  4E4F                    1561              TRAP    #15
00001EAC                          1562              
00001EAC                          1563              ; DEFINE COORDINATES RECTANGLE
00001EAC  3205                    1564              MOVE.W  D5,D1
00001EAE  5041                    1565              ADD.W   #8,D1
00001EB0  5941                    1566              SUB.W   #4,D1
00001EB2  3406                    1567              MOVE.W  D6,D2
00001EB4  5042                    1568              ADD.W   #8,D2
00001EB6  5942                    1569              SUB.W   #4,D2
00001EB8                          1570              
00001EB8  3601                    1571              MOVE.W  D1,D3
00001EBA  5043                    1572              ADD.W   #4*2,D3
00001EBC  3802                    1573              MOVE.W  D2,D4
00001EBE  5044                    1574              ADD.W   #4*2,D4
00001EC0                          1575              
00001EC0                          1576              ; DRAW BIG POINT
00001EC0  103C 0058               1577              MOVE.B  #88,D0
00001EC4  4E4F                    1578              TRAP    #15
00001EC6                          1579              
00001EC6  4CDF 007F               1580              MOVEM.L (A7)+,D0-D6
00001ECA                          1581              
00001ECA  4E75                    1582              RTS
00001ECC                          1583  
00001ECC                          1584  
00001ECC                          1585  
00001ECC                          1586  
00001ECC                          1587  
00001ECC                          1588  
00001ECC                          1589  
00001ECC                          1590  
00001ECC                          1591  
00001ECC                          1592  
00001ECC                          1593  
00001ECC                          1594  
00001ECC                          1595  -------------------- end include --------------------
00001ECC                          1596              INCLUDE "LIB/UTLCONST.X68"
00001ECC                          1597  ; ==============================================================================
00001ECC                          1598  ; UTIL CONSTANTS
00001ECC                          1599  ; ==============================================================================
00001ECC                          1600  
00001ECC  =00000008               1601  UTLCHRWD    EQU     8                       ; CHARACTER WIDTH IN PIXELS
00001ECC                          1602  
00001ECC                          1603  -------------------- end include --------------------
00001ECC                          1604              INCLUDE "LIB/UTLCODE.X68"
00001ECC                          1605  ; =============================================================================
00001ECC                          1606  ; UTILITY CODE
00001ECC                          1607  ; =============================================================================
00001ECC                          1608  
00001ECC                          1609  ; -----------------------------------------------------------------------------
00001ECC                          1610  UTLINIT
00001ECC                          1611  ; INITIALIZES UTILITY CODE
00001ECC                          1612  ; INPUT    - NONE
00001ECC                          1613  ; OUTPUT   - NONE
00001ECC                          1614  ; MODIFIES - NONE
00001ECC                          1615  ; -----------------------------------------------------------------------------
00001ECC  48E7 C000               1616              MOVEM.L D0-D1,-(A7)
00001ED0  103C 0008               1617              MOVE.B  #8,D0
00001ED4  4E4F                    1618              TRAP    #15
00001ED6  13C1 00003348           1619              MOVE.B  D1,(UTLRNDIX)
00001EDC  4CDF 0003               1620              MOVEM.L (A7)+,D0-D1
00001EE0  4E75                    1621              RTS
00001EE2                          1622  
00001EE2                          1623  ; -----------------------------------------------------------------------------
00001EE2                          1624  UTLPRINT
00001EE2                          1625  ; PRINT SCREEN CENTERED TEXT
00001EE2                          1626  ; INPUT    : A0 POINTER TO ZERO-TERMINATED STRING
00001EE2                          1627  ;            D0.B SCREEN ROW TO PRINT TEXT
00001EE2                          1628  ; OUTPUT   : D0.B NEXT ROW
00001EE2                          1629  ; MODIFIES : NONE (ASIDE OF OUTPUT)
00001EE2                          1630  ; -----------------------------------------------------------------------------
00001EE2  48E7 C0C0               1631              MOVEM.L D0-D1/A0-A1,-(A7)
00001EE6  4201                    1632              CLR.B   D1
00001EE8  2248                    1633              MOVE.L  A0,A1
00001EEA  4A18                    1634  .LOOP       TST.B   (A0)+
00001EEC  6700 0006               1635              BEQ     .ENDLOOP
00001EF0  5201                    1636              ADDQ.B  #1,D1
00001EF2  60F6                    1637              BRA     .LOOP
00001EF4  E209                    1638  .ENDLOOP    LSR.B   #1,D1
00001EF6  0401 0028               1639              SUB.B   #(SCRWIDTH/UTLCHRWD)/2,D1
00001EFA  4401                    1640              NEG.B   D1
00001EFC  E141                    1641              ASL.W   #8,D1
00001EFE  8240                    1642              OR.W    D0,D1
00001F00  103C 000B               1643              MOVE.B  #11,D0
00001F04  4E4F                    1644              TRAP    #15
00001F06  103C 000D               1645              MOVE.B  #13,D0
00001F0A  4E4F                    1646              TRAP    #15
00001F0C  4CDF 0303               1647              MOVEM.L (A7)+,D0-D1/A0-A1
00001F10  5200                    1648              ADDQ.B  #1,D0
00001F12  4E75                    1649              RTS
00001F14                          1650              
00001F14                          1651              
00001F14                          1652  
00001F14                          1653  
00001F14                          1654              ; (SCRWIDTH/UTLCHRWD)/2 - D1/2
00001F14                          1655  
00001F14                          1656  
00001F14                          1657  ; -----------------------------------------------------------------------------
00001F14                          1658  UTLRAND
00001F14                          1659  ; PROVIDES A PSEUDO-RANDOM BYTE
00001F14                          1660  ; INPUT    - NONE
00001F14                          1661  ; OUTPUT   - D0.L RANDOM VALUE (ONLY BYTE)
00001F14                          1662  ; MODIFIES - NONE (ASIDE OF OUTPUT)
00001F14                          1663  ; -----------------------------------------------------------------------------
00001F14  2F08                    1664              MOVE.L  A0,-(A7)
00001F16  41F9 00001F32           1665              LEA     .RANDVEC,A0
00001F1C  4280                    1666              CLR.L   D0
00001F1E  1039 00003348           1667              MOVE.B  (UTLRNDIX),D0
00001F24  1030 0800               1668              MOVE.B  (A0,D0.L),D0
00001F28  5239 00003348           1669              ADDQ.B  #1,(UTLRNDIX)
00001F2E  205F                    1670              MOVE.L  (A7)+,A0
00001F30  4E75                    1671              RTS
00001F32                          1672  
00001F32                          1673  
00001F32= A2 EE 9A 0C F5 24 ...   1674  .RANDVEC    DC.B    162, 238, 154, 12 , 245, 36 , 32 , 103
00001F3A= 2A A3 51 26 E0 AC ...   1675              DC.B    42 , 163, 81 , 38 , 224, 172, 19 , 69
00001F42= 75 51 CA FD 33 EB ...   1676              DC.B    117, 81 , 202, 253, 51 , 235, 108, 154
00001F4A= 60 CC E7 B8 9A EB ...   1677              DC.B    96 , 204, 231, 184, 154, 235, 34 , 203
00001F52= 1D 76 B5 95 B0 89 ...   1678              DC.B    29 , 118, 181, 149, 176, 137, 62 , 108
00001F5A= 39 15 48 C9 6E CA ...   1679              DC.B    57 , 21 , 72 , 201, 110, 202, 159, 41
00001F62= 43 E7 E2 7C 37 25 ...   1680              DC.B    67 , 231, 226, 124, 55 , 37 , 84 , 62
00001F6A= E9 94 CE E9 E4 52 ...   1681              DC.B    233, 148, 206, 233, 228, 82 , 243, 78
00001F72= 37 6D 9A 84 A2 28 ...   1682              DC.B    55 , 109, 154, 132, 162, 40 , 30 , 39
00001F7A= 19 E2 C6 77 80 D4 ...   1683              DC.B    25 , 226, 198, 119, 128, 212, 232, 225
00001F82= 0A 5A 32 67 33 C2 ...   1684              DC.B    10 , 90 , 50 , 103, 51 , 194, 222, 40
00001F8A= 59 80 DC 0E 57 FC ...   1685              DC.B    89 , 128, 220, 14 , 87 , 252, 243, 252
00001F92= 8A AB BC F7 07 4D ...   1686              DC.B    138, 171, 188, 247, 7  , 77 , 29 , 234
00001F9A= EF D5 77 6E 1E BB ...   1687              DC.B    239, 213, 119, 110, 30 , 187, 131, 23
00001FA2= D6 E0 2A 8F BD 28 ...   1688              DC.B    214, 224, 42 , 143, 189, 40 , 212, 130
00001FAA= 13 4F 66 EC 0A 64 ...   1689              DC.B    19 , 79 , 102, 236, 10 , 100, 122, 188
00001FB2= 56 52 9A 16 9B 90 ...   1690              DC.B    86 , 82 , 154, 22 , 155, 144, 7  , 199
00001FBA= 06 8A A4 F7 01 DA ...   1691              DC.B    6  , 138, 164, 247, 1  , 218, 166, 82
00001FC2= F2 E7 77 28 B1 76 ...   1692              DC.B    242, 231, 119, 40 , 177, 118, 220, 102
00001FCA= A4 42 E3 81 B1 67 ...   1693              DC.B    164, 66 , 227, 129, 177, 103, 165, 108
00001FD2= BF CE FA 16 BF 38 ...   1694              DC.B    191, 206, 250, 22 , 191, 56 , 30 , 161
00001FDA= D1 8B 50 0C 5F 49 ...   1695              DC.B    209, 139, 80 , 12 , 95 , 73 , 168, 56
00001FE2= DE 4C 14 A2 40 DC ...   1696              DC.B    222, 76 , 20 , 162, 64 , 220, 93 , 12
00001FEA= B6 9B 0A 38 5D AB ...   1697              DC.B    182, 155, 10 , 56 , 93 , 171, 89 , 6
00001FF2= E2 1B DD 75 15 82 ...   1698              DC.B    226, 27 , 221, 117, 21 , 130, 101, 18
00001FFA= 8A 26 51 30 9F 47 ...   1699              DC.B    138, 38 , 81 , 48 , 159, 71 , 57 , 21
00002002= 1E 8A BB 71 C6 6E ...   1700              DC.B    30 , 138, 187, 113, 198, 110, 185, 152
0000200A= 9F 47 E5 34 94 27 ...   1701              DC.B    159, 71 , 229, 52 , 148, 39 , 77 , 6
00002012= 7D 06 D6 BA 30 0F ...   1702              DC.B    125, 6  , 214, 186, 48 , 15 , 212, 22
0000201A= EC 7F 7E 03 CF 2D ...   1703              DC.B    236, 127, 126, 3  , 207, 45 , 193, 2
00002022= 94 5B 23 F2 8B CD ...   1704              DC.B    148, 91 , 35 , 242, 139, 205, 248, 237
0000202A= 74 33 EC B9 0F D5 ...   1705              DC.B    116, 51 , 236, 185, 15 , 213, 221, 6
00002032                          1706  
00002032                          1707  
00002032                          1708  
00002032                          1709  
00002032                          1710  -------------------- end include --------------------
00002032                          1711              INCLUDE "INTRO.X68"
00002032                          1712  ; ==============================================================================
00002032                          1713  ; INTRO SCREEN
00002032                          1714  ; ==============================================================================
00002032                          1715  
00002032                          1716  ; ------------------------------------------------------------------------------
00002032                          1717  ISCINIT
00002032                          1718  ; INTRO SCREEN INIT
00002032                          1719  ; INPUT    : NONE
00002032                          1720  ; OUTPUT   : NONE
00002032                          1721  ; MODIFIES : NONE
00002032                          1722  ; ------------------------------------------------------------------------------
00002032  4279 00003342           1723              CLR.W   (ISCTIMER)
00002038  4EB9 000020B2           1724              JSR     OPENFILE
0000203E  4E75                    1725              RTS
00002040                          1726  
00002040                          1727  ; ------------------------------------------------------------------------------
00002040                          1728  ISCUPD
00002040                          1729  ; INTRO SCREEN UPDATE
00002040                          1730  ; INPUT    : NONE
00002040                          1731  ; OUTPUT   : NONE
00002040                          1732  ; MODIFIES : NONE
00002040                          1733  ; ------------------------------------------------------------------------------
00002040  0839 0004 00002496      1734              BTST.B  #4,(KBDVAL)
00002048  6700 000A               1735              BEQ     .CONT
0000204C  33FC 0001 00003346      1736              MOVE.W  #1,(STANEXT)
00002054                          1737  .CONT       ;ADDQ.W  #1,(ISCTIMER)
00002054                          1738  ;            CMP.W   #500,(ISCTIMER)
00002054                          1739  ;            BLT     .DONE
00002054                          1740  ;            MOVE.W  #1,(STANEXT)
00002054  4E75                    1741  .DONE       RTS
00002056                          1742  
00002056                          1743  ; ------------------------------------------------------------------------------
00002056                          1744  ISCPLOT
00002056                          1745  ; INTRO SCREEN PLOT
00002056                          1746  ; INPUT    : NONE
00002056                          1747  ; OUTPUT   : NONE
00002056                          1748  ; MODIFIES : NONE
00002056                          1749  ; ------------------------------------------------------------------------------
00002056  48E7 C080               1750              MOVEM.L D0-D1/A0,-(A7)
0000205A                          1751              
0000205A  4281                    1752              CLR.L   D1
0000205C  103C 0051               1753              MOVE.B  #81,D0
00002060  4E4F                    1754              TRAP    #15
00002062                          1755              
00002062  4EB9 000020E4           1756              JSR     IMGPLOT
00002068                          1757              
00002068  0839 0004 00002499      1758              BTST.B  #4,(SCRCYCCT)
00002070  6700 0010               1759              BEQ     .DONE
00002074                          1760              
00002074  41F9 00002096           1761              LEA     .TXT2,A0
0000207A  103C 0019               1762              MOVE.B  #25,D0
0000207E  4EB8 1EE2               1763              JSR     UTLPRINT
00002082                          1764              
00002082  4CDF 0103               1765  .DONE       MOVEM.L (A7)+,D0-D1/A0
00002086                          1766  
00002086  4E75                    1767              RTS
00002088= 50 41 43 2D 4D 41 ...   1768  .TXT1       DC.B    'PAC-MAN 68000',0
00002096= 50 52 45 53 53 20 ...   1769  .TXT2       DC.B    'PRESS SPACE BUTTON TO START',0
000020B2                          1770              DS.W    0
000020B2                          1771              
000020B2                          1772  ;------------------------------------------------------------------------
000020B2                          1773              
000020B2                          1774  OPENFILE                 
000020B2                          1775              ;OPEN FILE
000020B2  43F8 19D0               1776              LEA     FILENAME,A1
000020B6  303C 0033               1777              MOVE    #51,D0
000020BA  4E4F                    1778              TRAP    #15
000020BC                          1779              
000020BC                          1780              ;READ FILE
000020BC  243C 00000A8C           1781              MOVE.L  #FILESIZE,D2
000020C2  43F9 0000289C           1782              LEA     BUFFER,A1
000020C8  303C 0035               1783              MOVE    #53,D0
000020CC  4E4F                    1784              TRAP    #15
000020CE                          1785              
000020CE  263C 00000A8C           1786              MOVE.L  #FILESIZE,D3
000020D4                          1787              
000020D4                          1788  .convert_loop 
000020D4  4A03                    1789              TST.B   D3
000020D6  6700 000A               1790              BEQ     .END
000020DA  0419 0030               1791              SUB.B   #$30,(A1)+
000020DE  5303                    1792              SUB.B   #1,D3
000020E0  60F2                    1793              BRA     .convert_loop           
000020E2                          1794  .END        
000020E2                          1795  
000020E2                          1796           
000020E2                          1797            
000020E2                          1798              
000020E2  4E75                    1799              RTS
000020E4                          1800  ; ------------------------------------------------------------------------------
000020E4                          1801  IMGPLOT
000020E4                          1802  ; TITLE IMAGE PLOT
000020E4                          1803  ; INPUT    : NONE
000020E4                          1804  ; OUTPUT   : NONE
000020E4                          1805  ; MODIFIES : NONE
000020E4                          1806  ; ------------------------------------------------------------------------------
000020E4  48E7 FE00               1807              MOVEM.L D0-D6,-(A7)
000020E8  48E7 00C0               1808              MOVEM.L A0-A1,-(A7)
000020EC                          1809              
000020EC                          1810              ;PLOT
000020EC                          1811   
000020EC  41F9 0000289C           1812              LEA.L   BUFFER,A0
000020F2  3C3C 00DC               1813              MOVE.W  #220,D6
000020F6  343C 001C               1814              MOVE.W  #28,D2
000020FA                          1815  BUCLE_FILA3
000020FA  3A3C 0064               1816              MOVE.W  #100,D5
000020FE  323C 0065               1817              MOVE.W  #101,D1
00002102  5846                    1818              ADD.W   #4,D6
00002104                          1819  
00002104                          1820  BUCLE_COLUMNA3
00002104  5845                    1821              ADD.W   #4,D5
00002106                          1822  
00002106  1018                    1823              MOVE.B  (A0)+,D0
00002108                          1824               
00002108  B07C 0001               1825              CMP     #1,D0
0000210C  6700 000C               1826              BEQ     ZERO3
00002110  B07C 0000               1827              CMP     #0,D0
00002114  4EB9 0000212C           1828              JSR     DRAW
0000211A                          1829  ZERO3
0000211A  51C9 FFE8               1830              DBRA    D1,BUCLE_COLUMNA3
0000211E  51CA FFDA               1831              DBRA    D2,BUCLE_FILA3
00002122                          1832              
00002122  4CDF 0300               1833              MOVEM.L (A7)+,A0-A1
00002126  4CDF 007F               1834              MOVEM.L (A7)+,D0-D6
0000212A                          1835          
0000212A                          1836  
0000212A  4E75                    1837              RTS
0000212C                          1838  
0000212C                          1839  
0000212C                          1840  ; -----------------------------------------------------------------------------
0000212C                          1841  DRAW
0000212C                          1842  ; SUBRUTINE DRAW 
0000212C                          1843  ; INPUT    : D5=POSITION X, D6=POSITION Y
0000212C                          1844  ; OUTPUT   : NONE
0000212C                          1845  ; MODIFIES : NONE
0000212C                          1846  ; -----------------------------------------------------------------------------
0000212C  48E7 FE00               1847              MOVEM.L D0-D6,-(A7)
00002130                          1848              ; SET CONTOURN COLOR
00002130  103C 0050               1849              MOVE.B  #80,D0
00002134  223C 00AA0000           1850              MOVE.L  #$00AA0000,D1
0000213A  4E4F                    1851              TRAP    #15
0000213C                          1852              
0000213C                          1853              ; SET FILL COLOR
0000213C  103C 0051               1854              MOVE.B  #81,D0
00002140  223C 00FF0000           1855              MOVE.L  #$00FF0000,D1
00002146  4E4F                    1856              TRAP    #15
00002148                          1857              
00002148                          1858              ; DEFINE COORDINATES RECTANGLE
00002148  3205                    1859              MOVE.W  D5,D1
0000214A  3406                    1860              MOVE.W  D6,D2
0000214C  5845                    1861              ADD.W   #4,D5
0000214E  5846                    1862              ADD.W   #4,D6
00002150  3605                    1863              MOVE.W  D5,D3
00002152  3806                    1864              MOVE.W  D6,D4
00002154                          1865              
00002154                          1866              ; DRAW RECTANGLE
00002154  103C 0057               1867              MOVE.B  #87,D0
00002158  4E4F                    1868              TRAP    #15
0000215A                          1869              
0000215A  4CDF 007F               1870              MOVEM.L (A7)+,D0-D6
0000215E                          1871  
0000215E  4E75                    1872              RTS
00002160                          1873  
00002160                          1874  
00002160                          1875  
00002160                          1876  
00002160                          1877  
00002160                          1878  
00002160                          1879  -------------------- end include --------------------
00002160                          1880              INCLUDE "INSTRUCTIONS.X68"
00002160                          1881  ; ==============================================================================
00002160                          1882  ; INSTRUCTIONS SCREEN
00002160                          1883  ; ==============================================================================
00002160                          1884  
00002160                          1885  ; ------------------------------------------------------------------------------
00002160                          1886  INSINIT
00002160                          1887  ; INSTRUCTIONS SCREEN INIT
00002160                          1888  ; INPUT    : NONE
00002160                          1889  ; OUTPUT   : NONE
00002160                          1890  ; MODIFIES : NONE
00002160                          1891  ; ------------------------------------------------------------------------------
00002160  4E75                    1892              RTS
00002162                          1893  
00002162                          1894  ; ------------------------------------------------------------------------------
00002162                          1895  INSUPD
00002162                          1896  ; INSTRUCTIONS SCREEN UPDATE
00002162                          1897  ; INPUT    : NONE
00002162                          1898  ; OUTPUT   : NONE
00002162                          1899  ; MODIFIES : NONE
00002162                          1900  ; ------------------------------------------------------------------------------
00002162  4E75                    1901              RTS
00002164                          1902  
00002164                          1903  ; ------------------------------------------------------------------------------
00002164                          1904  INSPLOT
00002164                          1905  ; INSTRUCTIONS SCREEN PLOT
00002164                          1906  ; INPUT    : NONE
00002164                          1907  ; OUTPUT   : NONE
00002164                          1908  ; MODIFIES : NONE
00002164                          1909  ; ------------------------------------------------------------------------------
00002164                          1910  
00002164  48E7 C0C0               1911              MOVEM.L D0-D1/A0-A1,-(A7)
00002168  4281                    1912              CLR.L   D1
0000216A  103C 0051               1913              MOVE.B  #81,D0
0000216E  4E4F                    1914              TRAP    #15
00002170  103C 000B               1915              MOVE.B  #11,D0
00002174  43F9 000022D6           1916              LEA     .TXTLST,A1
0000217A  2219                    1917  .LOOP       MOVE.L  (A1)+,D1
0000217C  6700 000A               1918              BEQ     .DONE
00002180  2041                    1919              MOVE.L  D1,A0
00002182  4EB8 1EE2               1920              JSR     UTLPRINT
00002186  60F2                    1921              BRA     .LOOP
00002188  4CDF 0303               1922  .DONE       MOVEM.L (A7)+,D0-D1/A0-A1
0000218C  4E75                    1923              RTS
0000218E= 57 45 4C 43 4F 4D ...   1924  .TXT1       DC.B    'WELCOME TO THE WORLD OF MULTI-PONG 68000!',0
000021B8= 59 4F 55 52 20 47 ...   1925  .TXT2       DC.B    'YOUR GOAL IN THIS GAME IS TO AVOID MISSING THE BALLS',0
000021ED= 54 4F 20 54 48 49 ...   1926  .TXT3       DC.B    'TO THIS END, MOVE THE PAD USING THE KEYBOARD',0
0000221A= 48 4F 57 20 54 4F ...   1927  .TXT4       DC.B    'HOW TO DO IT? YOU MAY ASK.',0
00002235= 49 54 20 49 53 20 ...   1928  .TXT5       DC.B    'IT IS EASY: JUST USE THE UP KEY TO MOVE THE PAD...',0
00002268= 55 50 21 00             1929  .TXT6       DC.B    'UP!',0
0000226C= 41 4E 44 20 55 53 ...   1930  .TXT7       DC.B    'AND USE THE DOWN KEY TO MOVE THE PAD DOWN.',0
00002297= 57 48 41 54 20 41 ...   1931  .TXT8       DC.B    'WHAT ABOUT LEFT AND RIGHT?',0
000022B2= 4E 4F 2E 20 54 48 ...   1932  .TXT9       DC.B    'NO. THESE ARE FORBIDDEN DIRECTIONS',0
000022D6                          1933              DS.W    0
000022D6= 0000218E 000021B8 ...   1934  .TXTLST     DC.L    .TXT1,.TXT2,.TXT3,.TXT4,.TXT5,.TXT6,.TXT7,.TXT8,.TXT9,0
000022FE                          1935  
000022FE                          1936  
000022FE                          1937  -------------------- end include --------------------
000022FE                          1938              INCLUDE "WIN.X68"
000022FE                          1939  ; ==============================================================================
000022FE                          1940  ; VICTORY SCREEN
000022FE                          1941  ; ==============================================================================
000022FE                          1942  
000022FE                          1943  ; ------------------------------------------------------------------------------
000022FE                          1944  WININIT
000022FE                          1945  ; VICTORY SCREEN INIT
000022FE                          1946  ; INPUT    : NONE
000022FE                          1947  ; OUTPUT   : NONE
000022FE                          1948  ; MODIFIES : NONE
000022FE                          1949  ; ------------------------------------------------------------------------------
000022FE  4E75                    1950              RTS
00002300                          1951  
00002300                          1952  ; ------------------------------------------------------------------------------
00002300                          1953  WINUPD
00002300                          1954  ; VICTORY SCREEN UPDATE
00002300                          1955  ; INPUT    : NONE
00002300                          1956  ; OUTPUT   : NONE
00002300                          1957  ; MODIFIES : NONE
00002300                          1958  ; ------------------------------------------------------------------------------
00002300  4E75                    1959              RTS
00002302                          1960  
00002302                          1961  ; ------------------------------------------------------------------------------
00002302                          1962  WINPLOT
00002302                          1963  ; VICTORY SCREEN PLOT
00002302                          1964  ; INPUT    : NONE
00002302                          1965  ; OUTPUT   : NONE
00002302                          1966  ; MODIFIES : NONE
00002302                          1967  ; ------------------------------------------------------------------------------
00002302  48E7 C080               1968              MOVEM.L D0-D1/A0,-(A7)
00002306                          1969              
00002306  4281                    1970              CLR.L   D1
00002308  103C 0051               1971              MOVE.B  #81,D0
0000230C  4E4F                    1972              TRAP    #15
0000230E                          1973              
0000230E  41F9 0000233C           1974              LEA     .TXT1,A0
00002314  103C 000A               1975              MOVE.B  #10,D0
00002318  4EB8 1EE2               1976              JSR     UTLPRINT
0000231C                          1977              
0000231C  0839 0004 00002499      1978              BTST.B  #4,(SCRCYCCT)
00002324  6700 0010               1979              BEQ     .DONE
00002328                          1980              
00002328  41F9 00002345           1981              LEA     .TXT2,A0
0000232E  103C 0019               1982              MOVE.B  #25,D0
00002332  4EB8 1EE2               1983              JSR     UTLPRINT
00002336                          1984              
00002336  4CDF 0103               1985  .DONE       MOVEM.L (A7)+,D0-D1/A0
0000233A                          1986  
0000233A  4E75                    1987              RTS
0000233C= 59 4F 55 20 57 4F ...   1988  .TXT1       DC.B    'YOU WON!',0
00002345= 50 52 45 53 53 20 ...   1989  .TXT2       DC.B    'PRESS FIRE1 TO CONTINUE',0
0000235E                          1990              DS.W    0
0000235E                          1991  
0000235E                          1992  
0000235E                          1993  
0000235E                          1994  -------------------- end include --------------------
0000235E                          1995              INCLUDE "GOVER.X68"
0000235E                          1996  ; ==============================================================================
0000235E                          1997  ; GAME OVER SCREEN
0000235E                          1998  ; ==============================================================================
0000235E                          1999  
0000235E                          2000  ; ------------------------------------------------------------------------------
0000235E                          2001  GOVINIT
0000235E                          2002  ; GAME OVER SCREEN INIT
0000235E                          2003  ; INPUT    : NONE
0000235E                          2004  ; OUTPUT   : NONE
0000235E                          2005  ; MODIFIES : NONE
0000235E                          2006  ; ------------------------------------------------------------------------------
0000235E  4E75                    2007              RTS
00002360                          2008  
00002360                          2009  ; ------------------------------------------------------------------------------
00002360                          2010  GOVUPD
00002360                          2011  ; GAME OVER SCREEN UPDATE
00002360                          2012  ; INPUT    : NONE
00002360                          2013  ; OUTPUT   : NONE
00002360                          2014  ; MODIFIES : NONE
00002360                          2015  ; ------------------------------------------------------------------------------
00002360  4E75                    2016              RTS
00002362                          2017  
00002362                          2018  ; ------------------------------------------------------------------------------
00002362                          2019  GOVPLOT
00002362                          2020  ; GAME OVER SCREEN PLOT
00002362                          2021  ; INPUT    : NONE
00002362                          2022  ; OUTPUT   : NONE
00002362                          2023  ; MODIFIES : NONE
00002362                          2024  ; ------------------------------------------------------------------------------
00002362  48E7 C080               2025              MOVEM.L D0-D1/A0,-(A7)
00002366                          2026              
00002366  4281                    2027              CLR.L   D1
00002368  103C 0051               2028              MOVE.B  #81,D0
0000236C  4E4F                    2029              TRAP    #15
0000236E                          2030              
0000236E  41F9 0000239C           2031              LEA     .TXT1,A0
00002374  103C 000A               2032              MOVE.B  #10,D0
00002378  4EB8 1EE2               2033              JSR     UTLPRINT
0000237C                          2034              
0000237C  0839 0004 00002499      2035              BTST.B  #4,(SCRCYCCT)
00002384  6700 0010               2036              BEQ     .DONE
00002388                          2037              
00002388  41F9 000023A6           2038              LEA     .TXT2,A0
0000238E  103C 0019               2039              MOVE.B  #25,D0
00002392  4EB8 1EE2               2040              JSR     UTLPRINT
00002396                          2041              
00002396  4CDF 0103               2042  .DONE       MOVEM.L (A7)+,D0-D1/A0
0000239A                          2043  
0000239A  4E75                    2044              RTS
0000239C= 47 41 4D 45 20 4F ...   2045  .TXT1       DC.B    'GAME OVER',0
000023A6= 50 52 45 53 53 20 ...   2046  .TXT2       DC.B    'PRESS FIRE1 TO CONTINUE',0
000023BE                          2047              DS.W    0
000023BE                          2048  
000023BE                          2049  
000023BE                          2050  -------------------- end include --------------------
000023BE                          2051              INCLUDE "STATES.X68"
000023BE                          2052  ; =============================================================================
000023BE                          2053  ; GAME STATE MANAGEMENT
000023BE                          2054  ; =============================================================================
000023BE                          2055  
000023BE                          2056  ; -----------------------------------------------------------------------------
000023BE                          2057  STAINIT
000023BE                          2058  ; INITALIZES THE STATE MANAGER
000023BE                          2059  ; INPUT    - NONE
000023BE                          2060  ; OUTPUT   - NONE
000023BE                          2061  ; MODIFIES - NONE
000023BE                          2062  ; -----------------------------------------------------------------------------
000023BE  33FC FFFF 00003344      2063              MOVE.W  #STANONE,(STACUR)
000023C6  4279 00003346           2064              CLR.W   (STANEXT)
000023CC  4E75                    2065              RTS
000023CE                          2066  
000023CE                          2067  ; -----------------------------------------------------------------------------
000023CE                          2068  STAUPD
000023CE                          2069  ; PERFORMS STATE UPDATE AND INIT IF NECESSARY
000023CE                          2070  ; INPUT    - NONE
000023CE                          2071  ; OUTPUT   - NONE
000023CE                          2072  ; MODIFIES - NONE
000023CE                          2073  ; -----------------------------------------------------------------------------
000023CE  48E7 8080               2074              MOVEM.L D0/A0,-(A7)
000023D2  4280                    2075              CLR.L   D0
000023D4  3039 00003346           2076              MOVE.W  (STANEXT),D0
000023DA  B079 00003344           2077              CMP.W   (STACUR),D0
000023E0  6700 0012               2078              BEQ     .DOUPD
000023E4  33C0 00003344           2079              MOVE.W  D0,(STACUR)             ; IF STATE CHANGED, DO INIT
000023EA  E588                    2080              LSL.L   #2,D0
000023EC  2040                    2081              MOVE.L  D0,A0
000023EE  2068 240C               2082              MOVE.L  .INITBL(A0),A0
000023F2  4E90                    2083              JSR     (A0)
000023F4  4280                    2084  .DOUPD      CLR.L   D0                      ; IN ANY CASE, DO UPDATE
000023F6  3039 00003344           2085              MOVE.W  (STACUR),D0
000023FC  E588                    2086              LSL.L   #2,D0
000023FE  2040                    2087              MOVE.L  D0,A0
00002400  2068 2414               2088              MOVE.L  .UPDTBL(A0),A0
00002404  4E90                    2089              JSR     (A0)
00002406  4CDF 0101               2090              MOVEM.L (A7)+,D0/A0
0000240A  4E75                    2091              RTS
0000240C= 00002032 00002442       2092  .INITBL     DC.L    ISCINIT,GAMINIT
00002414= 00002040 00002452       2093  .UPDTBL     DC.L    ISCUPD,GAMUPD
0000241C                          2094  
0000241C                          2095  ; -----------------------------------------------------------------------------
0000241C                          2096  STAPLOT
0000241C                          2097  ; PERFORMS STATE PLOT
0000241C                          2098  ; INPUT    - NONE
0000241C                          2099  ; OUTPUT   - NONE
0000241C                          2100  ; MODIFIES - NONE
0000241C                          2101  ; -----------------------------------------------------------------------------
0000241C  48E7 8080               2102              MOVEM.L D0/A0,-(A7)
00002420  4280                    2103              CLR.L   D0
00002422  3039 00003344           2104              MOVE.W  (STACUR),D0
00002428  E588                    2105              LSL.L   #2,D0
0000242A  2040                    2106              MOVE.L  D0,A0
0000242C  2068 2438               2107              MOVE.L  .PLTTBL(A0),A0
00002430  4E90                    2108              JSR     (A0)
00002432  4CDF 0101               2109              MOVEM.L (A7)+,D0/A0
00002436  4E75                    2110              RTS
00002438= 00002056 0000245A       2111  .PLTTBL     DC.L    ISCPLOT,GAMPLOT
00002440                          2112  
00002440                          2113  ; -----------------------------------------------------------------------------
00002440                          2114  STAEMPTY
00002440                          2115  ; EMPTY SUBROUTINE FOR CASES WITH NOTHING TO DO
00002440                          2116  ; INPUT    - NONE
00002440                          2117  ; OUTPUT   - NONE
00002440                          2118  ; MODIFIES - NONE
00002440                          2119  ; NOTE     - JUST A PLACEHOLDER. NOTHING TO DO.
00002440                          2120  ; -----------------------------------------------------------------------------
00002440  4E75                    2121              RTS
00002442                          2122  
00002442                          2123  
00002442                          2124  
00002442                          2125  
00002442                          2126  
00002442                          2127  
00002442                          2128  
00002442                          2129  
00002442                          2130  
00002442                          2131  -------------------- end include --------------------
00002442                          2132              INCLUDE "GAME.X68"
00002442                          2133  ; ==============================================================================
00002442                          2134  ; GAME MANAGEMENT
00002442                          2135  ; ==============================================================================
00002442                          2136  
00002442                          2137  ; ------------------------------------------------------------------------------
00002442                          2138  GAMINIT
00002442                          2139  ; INITIALIZES GAME.
00002442                          2140  ; INPUT    : NONE
00002442                          2141  ; OUTPUT   : NONE
00002442                          2142  ; MODIFIES : NONE
00002442                          2143  ; ------------------------------------------------------------------------------
00002442  4EB8 1598               2144              JSR     PMINIT
00002446  4EB8 1D2E               2145              JSR     MAPINIT
0000244A  4EB8 1400               2146              JSR     GSTINIT
0000244E  6000 F50E               2147              BRA     SCOINIT
00002452                          2148  
00002452                          2149  ; ------------------------------------------------------------------------------
00002452                          2150  GAMUPD
00002452                          2151  ; UPDATES THE GAME
00002452                          2152  ; INPUT    : NONE
00002452                          2153  ; OUTPUT   : NONE
00002452                          2154  ; MODIFIES : NONE
00002452                          2155  ; ------------------------------------------------------------------------------
00002452                          2156              
00002452  4EB8 142A               2157              JSR     GSTUPD
00002456  6000 F174               2158              BRA     PMUPD
0000245A                          2159              
0000245A                          2160  ; ------------------------------------------------------------------------------
0000245A                          2161  GAMPLOT
0000245A                          2162  ; PLOTS THE GAME
0000245A                          2163  ; INPUT    : NONE
0000245A                          2164  ; OUTPUT   : NONE
0000245A                          2165  ; MODIFIES : NONE
0000245A                          2166  ; ------------------------------------------------------------------------------
0000245A  4EB8 1DA8               2167              JSR     MAPPLOT
0000245E  4EB8 196E               2168              JSR     SCOPLOT
00002462  4EB8 1738               2169              JSR     PMPLOT
00002466  6000 F0C6               2170              BRA     GSTPLOT
0000246A                          2171  
0000246A                          2172  
0000246A                          2173  -------------------- end include --------------------
0000246A                          2174        
0000246A                          2175              
0000246A                          2176      
0000246A                          2177  START:
0000246A                          2178  
0000246A                          2179  ;--- INITIALIZATION -----------------------------------------------------------
0000246A                          2180  
0000246A  007C 0700               2181              ORI.W   #$0700,SR               ;DISABLE INTERRUPTIONS
0000246E                          2182  
0000246E  4EB8 19DA               2183              JSR     SYSINIT
00002472  4EB8 23BE               2184              JSR     STAINIT
00002476                          2185  
00002476                          2186  .LOOP
00002476                          2187  
00002476                          2188  ; --- UPDATE -------------------------------------------------------------------
00002476                          2189  
00002476                          2190  ; READ INPUT DEVICES
00002476                          2191  
00002476  4E41                    2192              TRAP    #1
00002478                          2193  
00002478                          2194  ; UPDATE GAME LOGIC
00002478                          2195  
00002478  4EB8 23CE               2196             JSR     STAUPD
0000247C                          2197  
0000247C                          2198  ; --- SYNC ---------------------------------------------------------------------
0000247C                          2199              ;WHILE THERES NO INTERRUPTS IN THE COUNTER THE PROGRAM WILL BE IN
0000247C                          2200              ;THE BUCLE
0000247C                          2201              
0000247C  4A39 00002498           2202  .WAITINIT   TST.B   (SCRINTCT)
00002482  67F8                    2203              BEQ     .WAITINIT
00002484  4239 00002498           2204              CLR.B   (SCRINTCT)
0000248A                          2205  
0000248A                          2206  ; --- PLOT ---------------------------------------------------------------------
0000248A                          2207              
0000248A  4EB8 241C               2208              JSR     STAPLOT
0000248E                          2209              
0000248E                          2210              
0000248E  4E40                    2211              TRAP    #0                      ;CHANGE BUFFER
00002490                          2212  
00002490  60E4                    2213              BRA     .LOOP
00002492                          2214  
00002492  FFFF FFFF               2215              SIMHALT  
00002496                          2216             
00002496                          2217              INCLUDE "SYSVARS.X68"
00002496                          2218  ; ==============================================================================
00002496                          2219  ; SYSTEM VARIABLES
00002496                          2220  ; ==============================================================================
00002496                          2221   
00002496                          2222  ; --- KEYBOARD RELATED VARIABLES -----------------------------------------------
00002496                          2223  
00002496                          2224  KBDVAL      DS.B    1                       ; KEY STATE
00002497                          2225  KBDEDGE     DS.B    1                       ; KEY EDGE
00002498                          2226              DS.W    0 
00002498                          2227  
00002498                          2228  ; --- TIMED INTERRUPT RELATED VARIABLES ----------------------------------------
00002498                          2229  
00002498                          2230  SCRINTCT    DS.B    1                       ; INTERRUPT COUNTER
00002499                          2231  SCRCYCCT    DS.B    1                       ; CYCLE COUNTER
0000249A                          2232              DS.W    0        
0000249A                          2233              
0000249A                          2234  ; --- MAP RELATED VARIABLE -----------------------------------------------------
0000249A                          2235  
0000249A                          2236  MAPVAR      DS.B    1024
0000289A                          2237  
0000289A                          2238              DS.B    0
0000289A                          2239  
0000289A                          2240  POSCON      DS.W    1
0000289C                          2241  
0000289C                          2242  ; --- TITLE RELATED VARIABLE -----------------------------------------------------
0000289C                          2243  
0000289C                          2244  BUFFER      DS.B    2700
00003328                          2245              DS.B    0
00003328                          2246              
00003328                          2247  
00003328                          2248  
00003328                          2249  
00003328                          2250  
00003328                          2251  
00003328                          2252  
00003328                          2253  
00003328                          2254  -------------------- end include --------------------
00003328                          2255              INCLUDE "VARS.X68"
00003328                          2256  ; ==============================================================================
00003328                          2257  ; GAME VARIABLES
00003328                          2258  ; ==============================================================================
00003328                          2259  
00003328                          2260  ; --- PAC-MAN RELATED VARIABLES ------------------------------------------------
00003328                          2261  
00003328                          2262  PMPOSX      DS.W    1                       ; PM X COORDINATE
0000332A                          2263  PMPOSY      DS.W    1                       ; PM Y COORDINATE
0000332C                          2264  PMVELX      DS.W    1                       ; PM X VELOCITY
0000332E                          2265  PMVELY      DS.W    1                       ; PM Y VELOCITY
00003330                          2266  PMEAT       DS.B    1                       ; PM BOOLEAN EAT GST
00003331                          2267  PMLAMO      DS.B    1                       ; PM SAVE LAST MOVEMENT X O Y
00003332                          2268              DS.B    0
00003332                          2269  
00003332                          2270  ; --- GHOST RELATED VARIABLES --------------------------------------------------
00003332                          2271  
00003332                          2272  GSTPOSX     DS.W    1                       ; GST X COORDINATE
00003334                          2273  GSTPOSY     DS.W    1                       ; GST Y COORDINATE
00003336                          2274  GSTVELX     DS.W    1                       ; GST X VELOCITY
00003338                          2275  GSTVELY     DS.W    1                       ; GST Y VELOCITY
0000333A                          2276  GSTDEAD     DS.B    1                       ; GST BOOLEAN DEAD
0000333B                          2277  GSTLAMO     DS.B    1                       ; GST LAST MOVEMENT (X OR Y)
0000333C                          2278  GSTINRNG    DS.B    1                       ; GST IS IN RANGE
0000333D                          2279  GSTTARG     DS.B    1                       ; GST TARGET (0-PACMAN, 1-RANDOM)
0000333E                          2280              DS.B    0
0000333E                          2281  
0000333E                          2282  ; --- SCOREBOARD RELATED VARIABLES ---------------------------------------------
0000333E                          2283  
0000333E                          2284  SCOLIFE     DS.W    1                       ; NUMBER OF LIFES
00003340                          2285  SCOPOINTS   DS.W    1                       ; NUMBER OF POINTS
00003342                          2286  
00003342                          2287  ; --- INTRO STATE RELATED VARIABLES --------------------------------------------
00003342                          2288  
00003342                          2289  ISCTIMER    DS.W    1                       ; INTRO TIMER
00003344                          2290  
00003344                          2291  ; --- STATE RELATED VARIABLES --------------------------------------------------
00003344                          2292  
00003344                          2293  STACUR      DS.W    1                       ; CURRENT STATE
00003346                          2294  STANEXT     DS.W    1                       ; NEXT STATE
00003348                          2295  
00003348                          2296  
00003348                          2297  
00003348                          2298  
00003348                          2299  
00003348                          2300  
00003348                          2301  
00003348                          2302  
00003348                          2303  
00003348                          2304  -------------------- end include --------------------
00003348                          2305              INCLUDE "LIB/UTLVARS.X68"
00003348                          2306  ; =============================================================================
00003348                          2307  ; UTILITY VARIABLES
00003348                          2308  ; =============================================================================
00003348                          2309  
00003348                          2310  UTLRNDIX    DS.B    1                       ; NEXT INDEX TO RANDOM NUMBER
0000334A                          2311              DS.W    0
0000334A                          2312  -------------------- end include --------------------
0000334A                          2313              
0000334A                          2314              END    START        

No errors detected
No warnings generated


SYMBOL TABLE INFORMATION
Symbol-name         Value
-------------------------
BUCLE_COLUMNA       1D54
BUCLE_COLUMNA2      1DCA
BUCLE_COLUMNA3      2104
BUCLE_FILA          1D48
BUCLE_FILA2         1DBE
BUCLE_FILA3         20FA
BUFFER              289C
COLWALLDOWN         1B5A
COLWALLLEFT         1B18
COLWALLRIGHT        1AD6
COLWALLUP           1B96
DIBFIGBPOINT        1E90
DIBFIGPOINT         1E54
DIBFIGWALL          1E1C
DRAW                212C
FILENAME            19D0
FILESIZE            A8C
GAMINIT             2442
GAMPLOT             245A
GAMUPD              2452
GETPOINTS           1CBA
GETPOINTS:BPOINT    1D04
GETPOINTS:DONE      1D28
GETPOINTS:POINT     1D16
GOVINIT             235E
GOVPLOT             2362
GOVPLOT:DONE        2396
GOVPLOT:TXT1        239C
GOVPLOT:TXT2        23A6
GOVUPD              2360
GSTCOL1             FF
GSTCOL2             FF0080
GSTCOL3             FFFF00
GSTCOL4             80FF
GSTCOL5             800000
GSTCOLWALLDOWN      1C4C
GSTCOLWALLLEFT      1C10
GSTCOLWALLRIGHT     1BD4
GSTCOLWALLUP        1C82
GSTDEAD             333A
GSTFCOL1            FFFFFF
GSTFCOL2            0
GSTFCOL3            0
GSTFCOL4            0
GSTFCOL5            0
GSTINIT             1400
GSTINRNG            333C
GSTINX1             2
GSTINX2             2
GSTINX3             1F
GSTINX4             1F
GSTINY1             2
GSTINY2             1F
GSTINY3             2
GSTINY4             1F
GSTLAMO             333B
GSTPLOT             152E
GSTPOSX             3332
GSTPOSY             3334
GSTRAD              8
GSTRNG              10
GSTSPEED            7
GSTSPEED2           5
GSTTARG             333D
GSTUPD              142A
GSTUPD:GSTDONE      1522
GSTUPD:GSTDOWNMOVE  14EA
GSTUPD:GSTINRNG     144E
GSTUPD:GSTLEFTMOVE  14BE
GSTUPD:GSTMOVE      1456
GSTUPD:GSTMULT      1470
GSTUPD:GSTNOTCOLISION  14A4
GSTUPD:GSTNOTCOLISION2  14D0
GSTUPD:GSTNOTCOLISION3  14FC
GSTUPD:GSTNOTCOLISION4  1518
GSTUPD:GSTNOTINRNG  1442
GSTUPD:GSTNOTMULT   1476
GSTUPD:GSTNOTTP     14B4
GSTUPD:GSTNOTTP2    14E0
GSTUPD:GSTRIGHTMOVE  1492
GSTUPD:GSTUPMOVE    1506
GSTVELX             3336
GSTVELY             3338
IMGPLOT             20E4
INSINIT             2160
INSPLOT             2164
INSPLOT:DONE        2188
INSPLOT:LOOP        217A
INSPLOT:TXT1        218E
INSPLOT:TXT2        21B8
INSPLOT:TXT3        21ED
INSPLOT:TXT4        221A
INSPLOT:TXT5        2235
INSPLOT:TXT6        2268
INSPLOT:TXT7        226C
INSPLOT:TXT8        2297
INSPLOT:TXT9        22B2
INSPLOT:TXTLST      22D6
INSUPD              2162
ISCINIT             2032
ISCPLOT             2056
ISCPLOT:DONE        2082
ISCPLOT:TXT1        2088
ISCPLOT:TXT2        2096
ISCTIMER            3342
ISCUPD              2040
ISCUPD:CONT         2054
ISCUPD:DONE         2054
KBDDOWN             28
KBDEDGE             2497
KBDFIRE1            20
KBDFIRE2            4D
KBDFIRE3            10
KBDINIT             1A72
KBDLEFT             25
KBDPAUSE            50
KBDRIGHT            27
KBDUP               26
KBDUPD              1A80
KBDUPD:CONVERT      1AC8
KBDUPD:LOOP         1ACC
KBDUPD:NOACT        1AC2
KBDVAL              2496
MAPINIT             1D2E
MAPMAT              1000
MAPPLOT             1DA8
MAPVAR              249A
NOTPOINT            1D88
NOTPOINT2           1DFC
NOTWALL             1D7A
NOTWALL2            1DEE
OPENFILE            20B2
OPENFILE:CONVERT_LOOP  20D4
OPENFILE:END        20E2
PMEAT               3330
PMFCOL              FFFF
PMINIT              1598
PMLAMO              3331
PMPCOL              FFFF
PMPLOT              1738
PMPLOT:DDONE        17F4
PMPLOT:DDOWN        17C6
PMPLOT:DLEFT        17BC
PMPLOT:DOWNDRAW     18B4
PMPLOT:DRAW_MOUTH1  17D0
PMPLOT:DRAW_MOUTH2  17DA
PMPLOT:DRAW_MOUTH3  17E4
PMPLOT:DRAW_MOUTH4  17EE
PMPLOT:DRIGHT       17A8
PMPLOT:DUP          17B2
PMPLOT:FULLDRAW     17FA
PMPLOT:LEFTDRAW     181E
PMPLOT:MOUTHOPEN    1766
PMPLOT:NOTMOVE      179E
PMPLOT:RIGHTDRAW    1850
PMPLOT:SET_MOUTHDOWN  1940
PMPLOT:SET_MOUTHLEFT  18E6
PMPLOT:SET_MOUTHRIGHT  1904
PMPLOT:SET_MOUTHUP  1922
PMPLOT:UPDRAW       1882
PMPOSX              3328
PMPOSY              332A
PMRAD               8
PMSPEED             2
PMUPD               15CC
PMUPD:ACTXLEFT      1692
PMUPD:ACTXRIGHT     165E
PMUPD:ACTYDOWN      16C6
PMUPD:ACTYUP        16EA
PMUPD:DONE          1726
PMUPD:NOTCOLISION   1678
PMUPD:NOTCOLISION2  16AC
PMUPD:NOTCOLISION3  16E0
PMUPD:NOTCOLISION4  1704
PMUPD:NOTDOWN       165A
PMUPD:NOTLEFT       1618
PMUPD:NOTMULT       170E
PMUPD:NOTRIGHT      162E
PMUPD:NOTTP         1688
PMUPD:NOTTP2        16BC
PMUPD:NOTUP         1644
PMVELX              332C
PMVELY              332E
POSCON              289A
SCOFCOL             0
SCOINIT             195E
SCOLIFE             333E
SCOLINE1            101
SCOLINE2            102
SCOPLOT             196E
SCOPLOT:TXT1        19BC
SCOPLOT:TXT2        19C5
SCOPOINTS           3340
SCRCYCCT            2499
SCRHEIGH            280
SCRINIT             1A06
SCRINTCT            2498
SCRTIM              1A64
SCRUPD              1A4A
SCRWIDTH            280
STACUR              3344
STAEMPTY            2440
STAINIT             23BE
STANEXT             3346
STANONE             FFFFFFFF
STAPLOT             241C
STAPLOT:PLTTBL      2438
START               246A
START:LOOP          2476
START:WAITINIT      247C
STAUPD              23CE
STAUPD:DOUPD        23F4
STAUPD:INITBL       240C
STAUPD:UPDTBL       2414
SYSINIT             19DA
UTLCHRWD            8
UTLINIT             1ECC
UTLPRINT            1EE2
UTLPRINT:ENDLOOP    1EF4
UTLPRINT:LOOP       1EEA
UTLRAND             1F14
UTLRAND:RANDVEC     1F32
UTLRNDIX            3348
WININIT             22FE
WINPLOT             2302
WINPLOT:DONE        2336
WINPLOT:TXT1        233C
WINPLOT:TXT2        2345
WINUPD              2300
ZERO                1D96
ZERO2               1E0A
ZERO3               211A
