00001CBA Starting Address
Assembler used: EASy68K Editor/Assembler v5.16.01
Created On: 16/12/2022 10:17:49

00000000                             1  ; ==============================================================================
00000000                             2  ; TITLE       : PAC-MAN 68000
00000000                             3  ; DESCRIPTION : GAME IN MOTOROLA 68000 BASED ON PAC-MAN GAME
00000000                             4  ; AUTHOR      : JORDI FLORIT ENSENYAT
00000000                             5  ;               JOSEP GABRIEL FORNES REYNES
00000000                             6  ;               PAU GIRON RODRIGUEZ
00000000                             7  ; ==============================================================================
00001000                             8              ORG    $1000
00001000                             9  
00001000                            10              INCLUDE "CONST.X68"
00001000                            11  ; ==============================================================================
00001000                            12  ; GAME CONSTANTS
00001000                            13  ; ==============================================================================
00001000                            14  
00001000                            15  ; --- PAC-MAN RELATED CONTANTS ----------------------------------------------------
00001000                            16  
00001000  =0000FFFF                 17  PMPCOL      EQU     $0000FFFF               ; PAC-MAN CONTOUR COLOR
00001000  =0000FFFF                 18  PMFCOL      EQU     $0000FFFF               ; PAC-MAN FILL COLOR
00001000  =00000002                 19  PMSPEED     EQU     2                       ; MAGNITUDE OF THE X AND Y VEL.
00001000  =00000008                 20  PMRAD       EQU     8                       ; PAC-MAN RADIUS
00001000                            21  
00001000                            22  ; --- GHOST RELATED CONSTANTS ----------------------------------------------------
00001000                            23  
00001000  =00000007                 24  GSTSPEED    EQU     7                       ; MAGNITUDE OF THE NORMAL DISPLACEMENT
00001000  =00000005                 25  GSTSPEED2   EQU     5                       ; MAGNITUDE OF THE ATACKED DISPLACEMENT
00001000                            26  
00001000  =000000FF                 27  GSTCOL1     EQU     $000000FF               ; GHOST 1 CONTOUR COLOR RED
00001000  =00FFFFFF                 28  GSTFCOL1    EQU     $00FFFFFF               ; GHOST 1 FILL COLOR WHITE
00001000  =00000002                 29  GSTINX1     EQU     2                       ; GHOST 1 INITIAL X
00001000  =00000002                 30  GSTINY1     EQU     2                       ; GHOST 1 INITIAL Y
00001000                            31  
00001000  =00FF0080                 32  GSTCOL2     EQU     $00FF0080               ; GHOST 2 CONTOUR COLOR PINK
00001000  =00000000                 33  GSTFCOL2    EQU     $00000000               ; GHOST 1 FILL COLOR
00001000  =00000002                 34  GSTINX2     EQU     2                       ; GHOST 2 INITIAL X
00001000  =0000001F                 35  GSTINY2     EQU     31                      ; GHOST 2 INITIAL Y
00001000                            36  
00001000  =00FFFF00                 37  GSTCOL3     EQU     $00FFFF00               ; GHOST 3 CONTOUR COLOR CYAN
00001000  =00000000                 38  GSTFCOL3    EQU     $00000000               ; GHOST 3 FILL COLOR
00001000  =0000001F                 39  GSTINX3     EQU     31                      ; GHOST 3 INITIAL X
00001000  =00000002                 40  GSTINY3     EQU     2                       ; GHOST 3 INITIAL Y
00001000                            41  
00001000  =000080FF                 42  GSTCOL4     EQU     $000080FF               ; GHOST 4 CONTOUR COLOR ORANGE
00001000  =00000000                 43  GSTFCOL4    EQU     $00000000               ; GHOST 4 FILL COLOR
00001000  =0000001F                 44  GSTINX4     EQU     31                      ; GHOST 4 INITIAL X
00001000  =0000001F                 45  GSTINY4     EQU     31                      ; GHOST 4 INITIAL Y 
00001000                            46  
00001000  =00800000                 47  GSTCOL5     EQU     $00800000               ; CONTOUR COLOR OF ATACKED MODE
00001000  =00000000                 48  GSTFCOL5    EQU     $00000000               ; FILL COLOR OF ATACKED MODE
00001000                            49  
00001000  =00000008                 50  GSTRAD      EQU     8                       ; GHOST RADIUS
00001000  =00000010                 51  GSTRNG      EQU     16                      ; GHOST DETECTING RANGE
00001000                            52              
00001000                            53  ; --- SCOREBOARD RELATED CONSTANTS ---------------------------------------------
00001000                            54  ;MODIFICATE
00001000                            55  
00001000  =00000000                 56  SCOFCOL     EQU     $00000000               ; TEXT BACKGROUND COLOR
00001000  =00000101                 57  SCOLINE1    EQU     $0101                   ; FIRST TEXT LINE COORDINATES
00001000  =00000102                 58  SCOLINE2    EQU     $0102                   ; SECOND TEXT LINE COORDINATES
00001000                            59  
00001000                            60  ; --- MAP RELATED CONSTANTS ----------------------------------------------------
00001000                            61  
00001000= 01 01 01 01 01 01 ...     62  MAPMAT      DC.B    $1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
00001020= 01 02 02 02 02 02 ...     63              DC.B    $1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1
00001040= 01 02 01 01 01 01 ...     64              DC.B    $1,2,1,1,1,1,1,2,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,2,1,1,1,1,1,2,1
00001060= 01 03 01 01 01 01 ...     65              DC.B    $1,3,1,1,1,1,1,2,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,2,1,1,1,1,1,3,1
00001080= 01 02 02 02 02 02 ...     66              DC.B    $1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1
000010A0= 01 02 01 01 01 01 ...     67              DC.B    $1,2,1,1,1,1,1,2,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,2,1,1,1,1,1,2,1
000010C0= 01 02 01 01 01 01 ...     68              DC.B    $1,2,1,1,1,1,1,2,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,2,1,1,1,1,1,2,1
000010E0= 01 02 02 02 02 02 ...     69              DC.B    $1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1
00001100= 01 02 01 01 01 01 ...     70              DC.B    $1,2,1,1,1,1,1,2,1,1,1,2,1,1,1,1,1,1,1,1,2,1,1,1,2,1,1,1,1,1,2,1
00001120= 01 02 01 00 00 00 ...     71              DC.B    $1,2,1,0,0,0,1,2,1,0,1,2,1,1,1,1,1,1,1,1,2,1,0,1,2,1,0,0,0,1,2,1
00001140= 01 02 01 01 01 01 ...     72              DC.B    $1,2,1,1,1,1,1,2,1,0,1,2,2,2,2,1,1,2,2,2,2,1,0,1,2,1,1,1,1,1,2,1
00001160= 01 02 02 02 02 02 ...     73              DC.B    $1,2,2,2,2,2,2,2,1,0,1,1,1,1,2,1,1,2,1,1,1,1,0,1,2,2,2,2,2,2,2,1
00001180= 01 01 01 01 01 01 ...     74              DC.B    $1,1,1,1,1,1,1,2,1,0,1,1,1,1,2,1,1,2,1,1,1,1,0,1,2,1,1,1,1,1,1,1
000011A0= 01 00 00 00 00 00 ...     75              DC.B    $1,0,0,0,0,0,1,2,1,0,1,0,0,0,0,0,0,0,0,0,0,1,0,1,2,1,0,0,0,0,0,1
000011C0= 01 00 00 00 00 00 ...     76              DC.B    $1,0,0,0,0,0,1,2,1,0,1,0,1,1,1,0,0,1,1,1,0,1,0,1,2,1,0,0,0,0,0,1
000011E0= 01 01 01 01 01 01 ...     77              DC.B    $1,1,1,1,1,1,1,2,1,1,1,0,1,0,0,0,0,0,0,1,0,1,1,1,2,1,1,1,1,1,1,1
00001200= 04 00 00 00 00 00 ...     78              DC.B    $4,0,0,0,0,0,0,2,2,2,2,0,1,0,0,0,0,0,0,1,0,2,2,2,2,0,0,0,0,0,0,4
00001220= 01 01 01 01 01 01 ...     79              DC.B    $1,1,1,1,1,1,1,2,1,1,1,0,1,0,0,0,0,0,0,1,0,1,1,1,2,1,1,1,1,1,1,1
00001240= 01 00 00 00 00 00 ...     80              DC.B    $1,0,0,0,0,0,1,2,1,0,1,0,1,1,1,1,1,1,1,1,0,1,0,1,2,1,0,0,0,0,0,1
00001260= 01 00 00 00 00 00 ...     81              DC.B    $1,0,0,0,0,0,1,2,1,0,1,0,0,0,0,0,0,0,0,0,0,1,0,1,2,1,0,0,0,0,0,1
00001280= 01 01 01 01 01 01 ...     82              DC.B    $1,1,1,1,1,1,1,2,1,1,1,0,1,1,1,1,1,1,1,1,0,1,1,1,2,1,1,1,1,1,1,1
000012A0= 01 02 02 02 02 02 ...     83              DC.B    $1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1
000012C0= 01 02 01 01 01 01 ...     84              DC.B    $1,2,1,1,1,1,1,2,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,2,1,1,1,1,1,2,1
000012E0= 01 02 01 01 01 01 ...     85              DC.B    $1,2,1,1,1,1,1,2,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,2,1,1,1,1,1,2,1
00001300= 01 02 02 02 02 01 ...     86              DC.B    $1,2,2,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,2,2,2,1
00001320= 01 01 01 01 02 01 ...     87              DC.B    $1,1,1,1,2,1,1,2,1,1,1,2,1,1,1,1,1,1,1,1,2,1,1,1,2,1,1,2,1,1,1,1
00001340= 01 01 01 01 02 01 ...     88              DC.B    $1,1,1,1,2,1,1,2,1,0,1,2,1,1,1,1,1,1,1,1,2,1,0,1,2,1,1,2,1,1,1,1
00001360= 01 02 02 02 02 02 ...     89              DC.B    $1,2,2,2,2,2,2,2,1,0,1,2,2,2,2,1,1,2,2,2,2,1,0,1,2,2,2,2,2,2,2,1
00001380= 01 02 01 01 01 01 ...     90              DC.B    $1,2,1,1,1,1,1,1,1,0,1,1,1,1,2,1,1,2,1,1,1,1,0,1,1,1,1,1,1,1,2,1
000013A0= 01 03 01 01 01 01 ...     91              DC.B    $1,3,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,3,1
000013C0= 01 02 02 02 02 02 ...     92              DC.B    $1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1
000013E0= 01 01 01 01 01 01 ...     93              DC.B    $1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
00001400                            94  
00001400                            95  
00001400                            96  
00001400                            97  
00001400                            98  
00001400                            99  
00001400                           100  
00001400                           101  
00001400                           102  
00001400                           103  
00001400                           104  
00001400                           105  
00001400                           106  
00001400                           107  
00001400                           108  
00001400                           109  
00001400                           110  
00001400                           111  
00001400                           112  
00001400                           113  
00001400                           114  
00001400                           115  -------------------- end include --------------------
00001400                           116              INCLUDE "GHOST.X68"
00001400                           117  ; ==============================================================================
00001400                           118  ; GHOST MANAGEMENT
00001400                           119  ; ==============================================================================
00001400                           120              
00001400                           121  ; ------------------------------------------------------------------------------
00001400                           122  GSTINIT
00001400                           123  ; INITIALIZE GHOST.
00001400                           124  ; INPUT    : NONE 
00001400                           125  ; OUTPUT   : NONE
00001400                           126  ; MODIFIES : NONE
00001400                           127  ; ------------------------------------------------------------------------------
00001400  33FC 0058 0000210E       128              MOVE.W  #GSTINX1*16+64-8,(GSTPOSX)
00001408  33FC 0058 00002110       129              MOVE.W  #GSTINY1*16+64-8,(GSTPOSY)
00001410  33FC 0007 00002112       130              MOVE.W  #GSTSPEED,(GSTVELX)
00001418  33FC 0007 00002114       131              MOVE.W  #GSTSPEED,(GSTVELY)
00001420  4239 00002117            132              CLR.B   (GSTLAMO)
00001426  4E75                     133              RTS
00001428                           134              
00001428                           135  ; ------------------------------------------------------------------------------
00001428                           136  GSTUPD
00001428                           137  ; UPDATES THE GHOST.
00001428                           138  ; INPUT    : NONE 
00001428                           139  ; OUTPUT   : NONE
00001428                           140  ; MODIFIES : NONE
00001428                           141  ; ------------------------------------------------------------------------------
00001428  48E7 F800                142              MOVEM.L D0-D4,-(A7)
0000142C                           143              
0000142C  303C 0007                144              MOVE.W  #GSTSPEED,D0
00001430                           145              
00001430  3439 0000210E            146              MOVE.W  (GSTPOSX),D2
00001436  3639 00002110            147              MOVE.W  (GSTPOSY),D3
0000143C  5042                     148              ADDQ.W  #8,D2
0000143E  5043                     149              ADDQ.W  #8,D3
00001440                           150              
00001440  1839 00002117            151              MOVE.B  (GSTLAMO),D4
00001446                           152              
00001446                           153              ;MASK OF THE LAST NIBBLE
00001446  C47C 000F                154              AND.W   #$000F,D2
0000144A  C67C 000F                155              AND.W   #$000F,D3
0000144E                           156              
0000144E                           157              ;CHECK IF COORDS ARE MULTIPLES OF 16
0000144E  B47C 0000                158              CMP     #$0000,D2
00001452  6600 000A                159              BNE     .GSTNOTMULT
00001456  B67C 0000                160              CMP     #$0000,D3
0000145A  6600 0002                161              BNE     .GSTNOTMULT
0000145E                           162              
0000145E                           163  .GSTNOTMULT
0000145E                           164  
0000145E  4CDF 001F                165              MOVEM.L (A7)+,D0-D4
00001462                           166              
00001462  4E75                     167              RTS
00001464                           168              
00001464                           169  ; ------------------------------------------------------------------------------
00001464                           170  GSTPLOT
00001464                           171  ; PLOT THE GHOST.
00001464                           172  ; INPUT    : NONE 
00001464                           173  ; OUTPUT   : NONE
00001464                           174  ; MODIFIES : NONE
00001464                           175  ; ------------------------------------------------------------------------------
00001464  48E7 F800                176              MOVEM.L D0-D4,-(A7)
00001468                           177              
00001468                           178              ;SET PEN COLOR
00001468  303C 0050                179              MOVE.W  #80,D0
0000146C  223C 000000FF            180              MOVE.L  #GSTCOL1,D1
00001472  4E4F                     181              TRAP    #15
00001474                           182              
00001474                           183              ;SET FILL COLOR
00001474  303C 0051                184              MOVE.W  #81,D0
00001478  223C 00FFFFFF            185              MOVE.L  #GSTFCOL1,D1
0000147E  4E4F                     186              TRAP    #15
00001480                           187              
00001480                           188              ;SET COORDS
00001480  3239 0000210E            189              MOVE.W  (GSTPOSX),D1
00001486  5141                     190              SUB.W   #GSTRAD,D1
00001488  3439 00002110            191              MOVE.W  (GSTPOSY),D2
0000148E  5142                     192              SUB.W   #GSTRAD,D2
00001490                           193              
00001490  3601                     194              MOVE.W  D1,D3
00001492  0643 0010                195              ADD.W   #GSTRAD*2,D3
00001496  3802                     196              MOVE.W  D2,D4
00001498  0644 0010                197              ADD.W   #GSTRAD*2,D4
0000149C                           198              
0000149C                           199              ;DRAW GHOST
0000149C  303C 0058                200              MOVE.W  #88,D0
000014A0  4E4F                     201              TRAP    #15
000014A2                           202              
000014A2                           203              ;SET RANGE COORDS
000014A2  3239 0000210E            204              MOVE.W  (GSTPOSX),D1
000014A8  0441 0100                205              SUB.W   #GSTRNG*16,D1
000014AC  3439 00002110            206              MOVE.W  (GSTPOSY),D2
000014B2  0442 0100                207              SUB.W   #GSTRNG*16,D2
000014B6                           208              
000014B6  3601                     209              MOVE.W  D1,D3
000014B8  0643 0200                210              ADD.W   #GSTRNG*16*2,D3
000014BC  3802                     211              MOVE.W  D2,D4
000014BE  0644 0200                212              ADD.W   #GSTRNG*16*2,D4
000014C2                           213              
000014C2                           214              ;DRAW GHOST RANGE
000014C2  303C 005B                215              MOVE.W  #91,D0
000014C6  4E4F                     216              TRAP    #15
000014C8                           217              
000014C8  4CDF 001F                218              MOVEM.L (A7)+,D0-D4
000014CC                           219              
000014CC                           220  
000014CC  4E75                     221              RTS
000014CE                           222  
000014CE                           223  
000014CE                           224  -------------------- end include --------------------
000014CE                           225              INCLUDE "PAC-MAN.X68"
000014CE                           226  ; ==============================================================================
000014CE                           227  ; PAC-MAN MANAGEMENT
000014CE                           228  ; ==============================================================================
000014CE                           229              
000014CE                           230  ; ------------------------------------------------------------------------------
000014CE                           231  PMINIT
000014CE                           232  ; INITIALIZE PAC-MAN.
000014CE                           233  ; INPUT    : NONE 
000014CE                           234  ; OUTPUT   : NONE
000014CE                           235  ; MODIFIES : NONE
000014CE                           236  ; ------------------------------------------------------------------------------
000014CE                           237  
000014CE  33FC 0140 00002104       238              MOVE.W  #SCRWIDTH/2,(PMPOSX)
000014D6  33FC 0140 00002106       239              MOVE.W  #SCRHEIGH/2,(PMPOSY)
000014DE  5079 00002104            240              ADDQ.W  #8,(PMPOSX)
000014E4  5079 00002106            241              ADDQ.W  #8,(PMPOSY)
000014EA  33FC 0002 00002108       242              MOVE.W  #PMSPEED,(PMVELX)
000014F2  33FC 0002 0000210A       243              MOVE.W  #PMSPEED,(PMVELY)
000014FA  4239 0000210D            244              CLR.B   (PMLAMO)
00001500                           245  
00001500  4E75                     246              RTS
00001502                           247              
00001502                           248  ; ------------------------------------------------------------------------------
00001502                           249  PMUPD
00001502                           250  ; UPDATES THE PAC-MAN.
00001502                           251  ; INPUT    : NONE 
00001502                           252  ; OUTPUT   : NONE
00001502                           253  ; MODIFIES : NONE
00001502                           254  ; ------------------------------------------------------------------------------
00001502                           255              
00001502  48E7 FE00                256              MOVEM.L D0-D6,-(A7)
00001506                           257              
00001506  303C 0002                258              MOVE.W  #PMSPEED,D0
0000150A                           259              
0000150A                           260              
0000150A  3439 00002104            261              MOVE.W  (PMPOSX),D2
00001510  3639 00002106            262              MOVE.W  (PMPOSY),D3
00001516                           263              
00001516  5042                     264              ADDQ.W  #8,D2              
00001518  5043                     265              ADDQ.W  #8,D3  
0000151A                           266              
0000151A  1839 0000210D            267              MOVE.B  (PMLAMO),D4
00001520                           268              
00001520                           269              ;MASK OF THE LAST NIBBLE        
00001520  C47C 000F                270              AND.W   #$000F,D2               ; COORDENADA X
00001524  C67C 000F                271              AND.W   #$000F,D3               ; COORDENADA Y
00001528                           272              
00001528                           273              ;CHECK IF COORDS ARE MULTIPLES OF 16
00001528  B47C 0000                274              CMP     #$0000,D2
0000152C  6600 00F6                275              BNE     .NOTMULT
00001530  B67C 0000                276              CMP     #$0000,D3
00001534  6600 00EE                277              BNE     .NOTMULT
00001538                           278              
00001538                           279              ;BRA     .ACTYUP
00001538                           280  
00001538                           281              ;CHECK THE DIRECTION
00001538  0839 0000 00001CFE       282              BTST.B  #0,(KBDVAL)             ;CHECK LEFT
00001540  6700 000C                283              BEQ     .NOTLEFT
00001544  4204                     284              CLR.B   D4
00001546  183C 0000                285              MOVE.B  #0,D4
0000154A  6000 0074                286              BRA     .ACTXLEFT
0000154E                           287  .NOTLEFT            
0000154E  0839 0002 00001CFE       288              BTST.B   #2,(KBDVAL)             ;CHECK RIGHT
00001556  6700 000C                289              BEQ     .NOTRIGHT
0000155A  4204                     290              CLR.B   D4
0000155C  183C 0001                291              MOVE.B   #1,D4
00001560  6000 0032                292              BRA     .ACTXRIGHT
00001564                           293  .NOTRIGHT            
00001564  0839 0001 00001CFE       294              BTST.B   #1,(KBDVAL)             ;CHECK UP
0000156C  6700 000C                295              BEQ     .NOTUP
00001570  4204                     296              CLR.B   D4
00001572  183C 0002                297              MOVE.B  #2,D4
00001576  6000 0090                298              BRA     .ACTYUP
0000157A                           299  .NOTUP            
0000157A  0839 0003 00001CFE       300              BTST.B   #3,(KBDVAL)             ;CHECK DOWN
00001582  6700 000C                301              BEQ     .NOTDOWN
00001586  4204                     302              CLR.B   D4
00001588  183C 0003                303              MOVE.B   #3,D4
0000158C  6000 005E                304              BRA     .ACTYDOWN
00001590                           305  .NOTDOWN
00001590  6000 00A8                306              BRA     .DONE
00001594                           307              
00001594                           308              
00001594                           309              ;UPDATE COORDS
00001594                           310              
00001594                           311  .ACTXRIGHT  
00001594  4EB9 000019AA            312              JSR     COLWALLRIGHT
0000159A  BA7C 0001                313              CMP     #1,D5
0000159E  6600 0006                314              BNE     .NOTCOLISION
000015A2  303C 0000                315              MOVE.W  #0,D0
000015A6                           316  .NOTCOLISION
000015A6  BA7C 0004                317              CMP     #4,D5
000015AA  6600 000A                318              BNE     .NOTTP
000015AE  0479 01E0 00002104       319              SUB.W   #30*16,(PMPOSX)
000015B6                           320  .NOTTP
000015B6  D179 00002104            321              ADD.W   D0,(PMPOSX)
000015BC  6000 007C                322              BRA     .DONE
000015C0                           323  .ACTXLEFT
000015C0  4EB9 000019EC            324              JSR     COLWALLLEFT
000015C6  BA7C 0001                325              CMP     #1,D5
000015CA  6600 0006                326              BNE     .NOTCOLISION2
000015CE  303C 0000                327              MOVE.W  #0,D0
000015D2                           328  .NOTCOLISION2
000015D2  BA7C 0004                329              CMP     #4,D5
000015D6  6600 000A                330              BNE     .NOTTP2
000015DA  0679 01E0 00002104       331              ADD.W   #30*16,(PMPOSX)
000015E2                           332  .NOTTP2
000015E2  9179 00002104            333              SUB.W   D0,(PMPOSX)
000015E8  6000 0050                334              BRA     .DONE
000015EC                           335      
000015EC                           336  .ACTYDOWN
000015EC  4EB9 00001A2E            337              JSR     COLWALLDOWN
000015F2  BA7C 0001                338              CMP     #1,D5
000015F6  6600 0006                339              BNE     .NOTCOLISION3
000015FA  303C 0000                340              MOVE.W  #0,D0
000015FE                           341  .NOTCOLISION3
000015FE  D179 00002106            342              ADD.W   D0,(PMPOSY)
00001604  6000 0034                343              BRA     .DONE
00001608                           344  .ACTYUP     
00001608  4EB9 00001A6A            345              JSR     COLWALLUP
0000160E  BA7C 0001                346              CMP     #1,D5
00001612  6600 0006                347              BNE     .NOTCOLISION4
00001616  303C 0000                348              MOVE.W  #0,D0
0000161A                           349  .NOTCOLISION4
0000161A  9179 00002106            350              SUB.W   D0,(PMPOSY)
00001620  6000 0018                351              BRA     .DONE
00001624                           352              
00001624                           353              
00001624                           354              ;IF NOT MULT DO
00001624                           355  .NOTMULT     
00001624  B83C 0000                356              CMP.B     #0,D4
00001628  6796                     357              BEQ     .ACTXLEFT
0000162A  B83C 0001                358              CMP.B     #1,D4
0000162E  6700 FF64                359              BEQ     .ACTXRIGHT
00001632  B83C 0002                360              CMP.B     #2,D4
00001636  67D0                     361              BEQ     .ACTYUP
00001638  60B2                     362              BRA     .ACTYDOWN
0000163A                           363  .DONE
0000163A                           364              ;RESTORE
0000163A  4EB9 00001AA8            365              JSR     GETPOINTS
00001640  13C4 0000210D            366              MOVE.B  D4,(PMLAMO)
00001646                           367              
00001646  4CDF 007F                368              MOVEM.L (A7)+,D0-D6
0000164A                           369              
0000164A  4E75                     370              RTS
0000164C                           371                          
0000164C                           372  ; ------------------------------------------------------------------------------
0000164C                           373  PMPLOT
0000164C                           374  ; PLOT THE BALL.
0000164C                           375  ; INPUT    : NONE 
0000164C                           376  ; OUTPUT   : NONE
0000164C                           377  ; MODIFIES : NONE
0000164C                           378  ; ------------------------------------------------------------------------------
0000164C                           379  
0000164C  48E7 F800                380              MOVEM.L D0-D4,-(A7)
00001650                           381  
00001650                           382              ;SET PEN COLOR
00001650  303C 0050                383              MOVE.W  #80,D0
00001654  7200                     384              MOVE.L  #$0000,D1
00001656  4E4F                     385              TRAP    #15
00001658                           386              
00001658                           387              ;SET FILL COLOR
00001658  303C 0051                388              MOVE.W  #81,D0
0000165C  223C 0000FFFF            389              MOVE.L  #PMFCOL,D1
00001662  4E4F                     390              TRAP    #15
00001664                           391              
00001664                           392              ;DRAW QUIET
00001664  4EB9 000016EC            393              JSR     .FULLDRAW
0000166A                           394              
0000166A                           395              ;CHECK KBDVAL
0000166A  0839 0000 00001CFE       396              BTST.B  #0,(KBDVAL)             ;LEFT
00001672  6700 0026                397              BEQ     .DLEFT
00001676  0839 0001 00001CFE       398              BTST.B  #1,(KBDVAL)             :UP
0000167E  6700 0024                399              BEQ     .DUP
00001682  0839 0002 00001CFE       400              BTST.B  #2,(KBDVAL)             ;RIGHT
0000168A  6700 0022                401              BEQ     .DRIGHT
0000168E  0839 0003 00001CFE       402              BTST.B  #3,(KBDVAL)             ;DOWN
00001696  6700 0020                403              BEQ     .DDOWN
0000169A                           404              
0000169A                           405              ;DRAW MOVEMENT
0000169A                           406  .DLEFT
0000169A  4EB9 00001710            407              JSR     .LEFTDRAW
000016A0  6000 0020                408              BRA     .DRAW_MOUTH1
000016A4                           409  .DUP
000016A4  4EB9 00001774            410              JSR     .UPDRAW
000016AA  6000 0020                411              BRA     .DRAW_MOUTH2
000016AE                           412  
000016AE                           413  .DRIGHT
000016AE  4EB9 00001742            414              JSR     .RIGHTDRAW
000016B4  6000 0020                415              BRA     .DRAW_MOUTH3
000016B8                           416  
000016B8                           417  .DDOWN
000016B8  4EB9 000017A6            418              JSR     .DOWNDRAW
000016BE  6000 0020                419              BRA     .DRAW_MOUTH4
000016C2                           420              
000016C2                           421  .DRAW_MOUTH1            
000016C2  4EB9 000017D8            422              JSR     .SET_MOUTHLEFT
000016C8  6000 001C                423              BRA     .DDONE
000016CC                           424  .DRAW_MOUTH2            
000016CC  4EB9 00001814            425              JSR     .SET_MOUTHUP
000016D2  6000 0012                426              BRA     .DDONE
000016D6                           427  .DRAW_MOUTH3            
000016D6  4EB9 000017F6            428              JSR     .SET_MOUTHRIGHT
000016DC  6000 0008                429              BRA     .DDONE
000016E0                           430  .DRAW_MOUTH4            
000016E0  4EB9 00001832            431              JSR     .SET_MOUTHDOWN
000016E6                           432  .DDONE
000016E6  4CDF 001F                433              MOVEM.L (A7)+,D0-D4
000016EA                           434              
000016EA  4E75                     435              RTS
000016EC                           436  
000016EC                           437  
000016EC                           438  ;INTERNAL SUBRUTINES FOR PACMAN PLOT-------------------------------------------------------------
000016EC                           439  
000016EC                           440  .FULLDRAW
000016EC                           441              ;SET COORDS
000016EC  3239 00002104            442              MOVE.W  (PMPOSX),D1
000016F2  5141                     443              SUB.W   #PMRAD,D1
000016F4  3439 00002106            444              MOVE.W  (PMPOSY),D2
000016FA  5142                     445              SUB.W   #PMRAD,D2
000016FC                           446              
000016FC  3601                     447              MOVE.W  D1,D3
000016FE  0643 0010                448              ADD.W   #PMRAD*2,D3
00001702  3802                     449              MOVE.W  D2,D4
00001704  0644 0010                450              ADD.W   #PMRAD*2,D4
00001708                           451              
00001708                           452              ;DRAW PAC-MAN
00001708  303C 0058                453              MOVE.W  #88,D0
0000170C  4E4F                     454              TRAP    #15
0000170E                           455              
0000170E  4E75                     456              RTS
00001710                           457  .LEFTDRAW
00001710                           458              
00001710                           459              
00001710  303C 0054                460              MOVE.W  #84,D0
00001714  3239 00002104            461              MOVE.W  (PMPOSX),D1                   ;FINAL COORD OF THE FIRST LINE
0000171A  5141                     462              SUB.W   #PMRAD,D1
0000171C  3439 00002106            463              MOVE.W  (PMPOSY),D2
00001722  5142                     464              SUB.W   #PMRAD,D2
00001724                           465              
00001724  3639 00002104            466              MOVE.W  (PMPOSX),D3                   ;ORIGINAL COORD FIRST LINE
0000172A  3839 00002106            467              MOVE.W  (PMPOSY),D4
00001730                           468              
00001730  4E4F                     469              TRAP    #15
00001732                           470             
00001732  303C 0055                471              MOVE.W  #85,D0                        ;DRAW SECOND LINE
00001736                           472              
00001736  3203                     473              MOVE.W  D3,D1
00001738  3404                     474              MOVE.W  D4,D2
0000173A  5042                     475              ADD.W   #PMRAD,D2
0000173C  5141                     476              SUB.W   #PMRAD,D1
0000173E                           477              
0000173E  4E4F                     478              TRAP    #15
00001740                           479              
00001740                           480              
00001740  4E75                     481              RTS
00001742                           482              
00001742                           483  .RIGHTDRAW
00001742                           484              
00001742                           485              
00001742  303C 0054                486              MOVE.W  #84,D0
00001746  3239 00002104            487              MOVE.W  (PMPOSX),D1                   ;FINAL COORD OF THE FIRST LINE
0000174C  5041                     488              ADD.W   #PMRAD,D1
0000174E  3439 00002106            489              MOVE.W  (PMPOSY),D2
00001754  5042                     490              ADD.W   #PMRAD,D2
00001756                           491              
00001756  3639 00002104            492              MOVE.W  (PMPOSX),D3                   ;ORIGINAL COORD FIRST LINE
0000175C  3839 00002106            493              MOVE.W  (PMPOSY),D4
00001762                           494              
00001762  4E4F                     495              TRAP    #15
00001764                           496             
00001764  303C 0055                497              MOVE.W  #85,D0                        ;DRAW SECOND LINE
00001768                           498              
00001768  3203                     499              MOVE.W  D3,D1
0000176A  3404                     500              MOVE.W  D4,D2
0000176C  5042                     501              ADD.W   #PMRAD,D2
0000176E  5041                     502              ADD.W   #PMRAD,D1
00001770                           503              
00001770  4E4F                     504              TRAP    #15
00001772                           505              
00001772                           506              
00001772  4E75                     507              RTS
00001774                           508  .UPDRAW
00001774                           509              
00001774                           510              
00001774  303C 0054                511              MOVE.W  #84,D0
00001778  3239 00002104            512              MOVE.W  (PMPOSX),D1                   ;FINAL COORD OF THE FIRST LINE
0000177E  5141                     513              SUB.W   #PMRAD,D1
00001780  3439 00002106            514              MOVE.W  (PMPOSY),D2
00001786  5142                     515              SUB.W   #PMRAD,D2
00001788                           516              
00001788  3639 00002104            517              MOVE.W  (PMPOSX),D3                   ;ORIGINAL COORD FIRST LINE
0000178E  3839 00002106            518              MOVE.W  (PMPOSY),D4
00001794                           519              
00001794  4E4F                     520              TRAP    #15
00001796                           521             
00001796  303C 0055                522              MOVE.W  #85,D0                        ;DRAW SECOND LINE
0000179A                           523              
0000179A  3203                     524              MOVE.W  D3,D1
0000179C  3404                     525              MOVE.W  D4,D2
0000179E  5142                     526              SUB.W   #PMRAD,D2
000017A0  5041                     527              ADD.W   #PMRAD,D1
000017A2                           528              
000017A2  4E4F                     529              TRAP    #15
000017A4                           530              
000017A4                           531              
000017A4  4E75                     532              RTS
000017A6                           533              
000017A6                           534  .DOWNDRAW
000017A6                           535              
000017A6                           536              
000017A6  303C 0054                537              MOVE.W  #84,D0
000017AA  3239 00002104            538              MOVE.W  (PMPOSX),D1                   ;FINAL COORD OF THE FIRST LINE
000017B0  5141                     539              SUB.W   #PMRAD,D1
000017B2  3439 00002106            540              MOVE.W  (PMPOSY),D2
000017B8  5142                     541              SUB.W   #PMRAD,D2
000017BA                           542              
000017BA  3639 00002104            543              MOVE.W  (PMPOSX),D3                   ;ORIGINAL COORD FIRST LINE
000017C0  3839 00002106            544              MOVE.W  (PMPOSY),D4
000017C6                           545              
000017C6  4E4F                     546              TRAP    #15
000017C8                           547             
000017C8  303C 0055                548              MOVE.W  #85,D0                        ;DRAW SECOND LINE
000017CC                           549              
000017CC  3203                     550              MOVE.W  D3,D1
000017CE  3404                     551              MOVE.W  D4,D2
000017D0  5042                     552              ADD.W   #PMRAD,D2
000017D2  5041                     553              ADD.W   #PMRAD,D1
000017D4                           554              
000017D4  4E4F                     555              TRAP    #15
000017D6                           556              
000017D6                           557              
000017D6  4E75                     558              RTS
000017D8                           559  
000017D8                           560              
000017D8                           561  .SET_MOUTHLEFT
000017D8                           562              
000017D8  303C 0051                563              MOVE.W  #81,D0                         ;SET BLACK
000017DC  7200                     564              MOVE.L  #$0000,D1
000017DE  4E4F                     565              TRAP    #15
000017E0                           566              
000017E0  303C 0059                567              MOVE.W  #89,D0                         ;FILL
000017E4  3239 00002104            568              MOVE.W  (PMPOSX),D1
000017EA  5541                     569              SUBQ.W   #2,D1
000017EC  3439 00002106            570              MOVE.W  (PMPOSY),D2
000017F2  4E4F                     571              TRAP    #15
000017F4                           572  
000017F4  4E75                     573              RTS
000017F6                           574              
000017F6                           575  .SET_MOUTHRIGHT
000017F6                           576              
000017F6  303C 0051                577              MOVE.W  #81,D0                         ;SET BLACK
000017FA  7200                     578              MOVE.L  #$0000,D1
000017FC  4E4F                     579              TRAP    #15
000017FE                           580              
000017FE  303C 0059                581              MOVE.W  #89,D0                         ;FILL
00001802  3239 00002104            582              MOVE.W  (PMPOSX),D1
00001808  5441                     583              ADDQ.W   #2,D1
0000180A  3439 00002106            584              MOVE.W  (PMPOSY),D2
00001810  4E4F                     585              TRAP    #15
00001812                           586  
00001812  4E75                     587              RTS
00001814                           588  
00001814                           589  .SET_MOUTHUP
00001814                           590              
00001814  303C 0051                591              MOVE.W  #81,D0                         ;SET BLACK
00001818  7200                     592              MOVE.L  #$0000,D1
0000181A  4E4F                     593              TRAP    #15
0000181C                           594              
0000181C  303C 0059                595              MOVE.W  #89,D0                         ;FILL
00001820  3239 00002104            596              MOVE.W  (PMPOSX),D1
00001826  3439 00002106            597              MOVE.W  (PMPOSY),D2
0000182C  5542                     598              SUBQ.W   #2,D2
0000182E  4E4F                     599              TRAP    #15
00001830                           600  
00001830  4E75                     601              RTS
00001832                           602  
00001832                           603  .SET_MOUTHDOWN
00001832                           604              
00001832  303C 0051                605              MOVE.W  #81,D0                         ;SET BLACK
00001836  7200                     606              MOVE.L  #$0000,D1
00001838  4E4F                     607              TRAP    #15
0000183A                           608              
0000183A  303C 0059                609              MOVE.W  #89,D0                         ;FILL
0000183E  3239 00002104            610              MOVE.W  (PMPOSX),D1
00001844  3439 00002106            611              MOVE.W  (PMPOSY),D2
0000184A  5442                     612              ADDQ.W   #2,D2
0000184C  4E4F                     613              TRAP    #15
0000184E                           614  
0000184E  4E75                     615              RTS
00001850                           616  
00001850                           617  
00001850                           618  
00001850                           619  
00001850                           620  
00001850                           621  
00001850                           622  
00001850                           623  
00001850                           624  
00001850                           625  
00001850                           626  
00001850                           627  
00001850                           628  
00001850                           629  
00001850                           630  
00001850                           631  
00001850                           632  
00001850                           633  
00001850                           634  
00001850                           635  
00001850                           636  
00001850                           637  
00001850                           638  
00001850                           639  
00001850                           640  
00001850                           641  
00001850                           642  -------------------- end include --------------------
00001850                           643              INCLUDE "SCORE.X68"
00001850                           644  ; ==============================================================================
00001850                           645  ; SCOREBOARD MANAGEMENT
00001850                           646  ; ==============================================================================
00001850                           647              
00001850                           648  ; ------------------------------------------------------------------------------
00001850                           649  SCOINIT
00001850                           650  ; INITIALIZE SCOREBOARD
00001850                           651  ; INPUT    : NONE 
00001850                           652  ; OUTPUT   : NONE
00001850                           653  ; MODIFIES : NONE
00001850                           654  ; ------------------------------------------------------------------------------
00001850  4279 0000211A            655              CLR.W   (SCOPOINTS)
00001856  33FC 0003 00002118       656              MOVE.W  #3,(SCOLIFE)
0000185E  4E75                     657              RTS
00001860                           658              
00001860                           659  ; ------------------------------------------------------------------------------
00001860                           660  SCOPLOT
00001860                           661  ; PLOT THE SCOREBOARD
00001860                           662  ; INPUT    : NONE 
00001860                           663  ; OUTPUT   : NONE
00001860                           664  ; MODIFIES : NONE
00001860                           665  ; ------------------------------------------------------------------------------
00001860                           666              
00001860  48E7 C040                667               MOVEM.L D0-D1/A1,-(A7)
00001864                           668  
00001864                           669              ; SET BACKGROUND COLOR
00001864  103C 0051                670              MOVE.B  #81,D0
00001868  7200                     671              MOVE.L  #SCOFCOL,D1
0000186A  4E4F                     672              TRAP    #15
0000186C                           673              
0000186C                           674              ; SET FIRST LINE POSITION
0000186C  103C 000B                675              MOVE.B  #11,D0
00001870  323C 0101                676              MOVE.W  #SCOLINE1,D1
00001874  4E4F                     677              TRAP    #15
00001876                           678  
00001876                           679              ; PRINT FIRST LINE
00001876  43F9 000018AE            680              LEA     .TXT1,A1            ;PUT FIRST STRING IN A1
0000187C  4281                     681              CLR.L   D1
0000187E  3239 0000211A            682              MOVE.W  (SCOPOINTS),D1
00001884  103C 0011                683              MOVE.B  #17,D0
00001888  4E4F                     684              TRAP    #15
0000188A                           685  
0000188A                           686              ; SET SECOND LINE POSITION
0000188A  103C 000B                687              MOVE.B  #11,D0
0000188E  323C 0102                688              MOVE.W  #SCOLINE2,D1       
00001892  4E4F                     689              TRAP    #15
00001894                           690  
00001894                           691              ; PRINT SECOND LINE
00001894  43F9 000018B7            692              LEA     .TXT2,A1
0000189A  4281                     693              CLR.L   D1
0000189C  3239 00002118            694              MOVE.W  (SCOLIFE),D1
000018A2  103C 0011                695              MOVE.B  #17,D0
000018A6  4E4F                     696              TRAP    #15
000018A8                           697              
000018A8  4CDF 0203                698              MOVEM.L (A7)+,D0-D1/A1
000018AC                           699              
000018AC  4E75                     700              RTS
000018AE                           701  
000018AE= 50 4F 49 4E 54 53 ...    702  .TXT1       DC.B    'POINTS :',0      ;0 IS END OF STRING
000018B7= 4C 49 46 45 53 20 ...    703  .TXT2       DC.B    'LIFES  :',0
000018C0                           704  
000018C0                           705  
000018C0  4E75                     706              RTS
000018C2                           707  
000018C2                           708  
000018C2                           709  -------------------- end include --------------------
000018C2                           710              INCLUDE "SYSCONST.X68"
000018C2                           711  ; ==============================================================================
000018C2                           712  ; SYSTEM CONSTANTS
000018C2                           713  ; ==============================================================================
000018C2                           714  
000018C2                           715  ; --- SCREEN RELATED CONSTANTS -------------------------------------------------
000018C2                           716  
000018C2  =00000280                717  SCRWIDTH    EQU     640                     ; SCREEN WIDTH
000018C2  =00000280                718  SCRHEIGH    EQU     640                     ; SCREEN HEIGHT
000018C2                           719  
000018C2                           720  ;---KEYCODES--------------------------------------------------------------------
000018C2                           721  
000018C2  =00000025                722  KBDLEFT     EQU     $25
000018C2  =00000026                723  KBDUP       EQU     $26
000018C2  =00000027                724  KBDRIGHT    EQU     $27
000018C2  =00000028                725  KBDDOWN     EQU     $28
000018C2  =00000020                726  KBDFIRE1    EQU     ' '
000018C2  =0000004D                727  KBDFIRE2    EQU     'M'                         
000018C2  =00000010                728  KBDFIRE3    EQU     $10
000018C2  =00000050                729  KBDPAUSE    EQU     'P'
000018C2                           730  
000018C2                           731  
000018C2                           732  
000018C2                           733  
000018C2                           734  
000018C2                           735  
000018C2                           736  
000018C2                           737  
000018C2                           738  
000018C2                           739  -------------------- end include --------------------
000018C2                           740              INCLUDE "SYSTEM.X68"
000018C2                           741  ; ==============================================================================
000018C2                           742  ; SYSTEM
000018C2                           743  ; ==============================================================================
000018C2                           744              
000018C2                           745  ; ------------------------------------------------------------------------------
000018C2                           746  SYSINIT
000018C2                           747  ; INITIALIZE SYSTEM.
000018C2                           748  ; INPUT    : NONE
000018C2                           749  ; OUTPUT   : NONE
000018C2                           750  ; MODIFIES : NONE
000018C2                           751  ; ------------------------------------------------------------------------------
000018C2                           752              
000018C2  21FC 00001932 0080       753              MOVE.L  #SCRUPD,($80+0*4)          ;INSTALL SUBRUTINE TO TRAP #0
000018CA  21FC 00001962 0084       754              MOVE.L  #KBDUPD,($80+1*4)          ;INSTALL SUBRUTINE TO TRAP #1
000018D2                           755              
000018D2                           756              
000018D2  21FC 0000194C 0064       757              MOVE.L  #SCRTIM,($60+1*4)          ;INSTALL INTERRUPT #1
000018DA                           758              
000018DA  4EB9 000018EE            759              JSR     SCRINIT
000018E0  4EB9 00001954            760              JSR     KBDINIT
000018E6                           761              
000018E6                           762              
000018E6  40E7                     763              MOVE.W  SR,-(A7)
000018E8  0257 D8FF                764              ANDI.W  #$D8FF,(A7)                ;BIT SUPERVISOR TO O AND INTERRPUT MASK 000 (FOR REACTIVATE INTERRUPTIONS)             
000018EC  4E73                     765              RTE
000018EE                           766     
000018EE                           767  ; ------------------------------------------------------------------------------
000018EE                           768  SCRINIT
000018EE                           769  ; INIT SCREEN. SET SCREEN RESOLUTION, SET WINDOWED MODE, CLEAR SCREEN, ENABLE BUFFER
000018EE                           770  ; ENABLE TIMED INTERRUPTION
000018EE                           771  ; INPUT    : NONE
000018EE                           772  ; OUTPUT   : NONE
000018EE                           773  ; MODIFIES : NONE
000018EE                           774  ; ------------------------------------------------------------------------------
000018EE                           775  
000018EE  48E7 C000                776              MOVEM.L D0-D1,-(A7)                 ;SAFE REGISTERS IN STACK
000018F2                           777  
000018F2                           778              ; SET SCREEN RESOLUTION
000018F2  103C 0021                779              MOVE.B  #33,D0
000018F6  223C 02800280            780              MOVE.L  #SCRWIDTH<<16|SCRHEIGH,D1
000018FC  4E4F                     781              TRAP    #15
000018FE                           782              
000018FE                           783              ; SET WINDOWED MODE
000018FE  7201                     784              MOVE.L  #1,D1
00001900  4E4F                     785              TRAP    #15
00001902                           786              
00001902                           787              ; ENABLE DOUBLE BUFFER
00001902  103C 005C                788              MOVE.B  #92,D0
00001906  123C 0011                789              MOVE.B  #17,D1
0000190A  4E4F                     790              TRAP    #15
0000190C                           791              
0000190C                           792              ; CLEAR SCREEN
0000190C  103C 000B                793              MOVE.B  #11,D0
00001910  323C FF00                794              MOVE.W  #$FF00,D1
00001914  4E4F                     795              TRAP    #15
00001916                           796              
00001916                           797              ;ENABLE TIMED INTERRPUT
00001916  303C 0020                798              MOVE.W  #32,D0
0000191A  123C 0006                799              MOVE.B  #6,D1
0000191E  143C 0081                800              MOVE.B  #$81,D2                   ;INDICATE THAT INTERRUPT 1 IS ACTIVATED PERIODICALLY
00001922  7614                     801              MOVE.L  #20,D3                    ;INDICATE THE MILISECONDS FOR THAT PERIOD (20 ms == 50 FPS)
00001924  4E4F                     802              TRAP    #15
00001926                           803              
00001926                           804              ;CLEAR INTERRUPT COUNTER
00001926  4239 00001D00            805              CLR.B   (SCRINTCT)
0000192C                           806              
0000192C  4CDF 0003                807              MOVEM.L (A7)+,D0-D1               ;RESTORE REGISTERS FROM STACK
00001930                           808              
00001930  4E75                     809              RTS
00001932                           810  
00001932                           811  
00001932                           812              
00001932                           813  ;------------------------------------------------------------------------------            
00001932                           814  SCRUPD
00001932                           815  ; UPDATES DOUBLE BUFFER
00001932                           816  ; INPUT    : NONE
00001932                           817  ; OUTPUT   : NONE
00001932                           818  ; MODIFIES : NONE
00001932                           819  ; ------------------------------------------------------------------------------
00001932                           820  
00001932  48E7 C000                821              MOVEM.L D0-D1,-(A7)
00001936                           822              
00001936                           823              ;SWITCH BUFFERS
00001936  103C 005E                824              MOVE.B #94,D0
0000193A  4E4F                     825              TRAP #15
0000193C                           826              
0000193C                           827              ;CLEAR HIDDEN BUFFER
0000193C  103C 000B                828              MOVE.B  #11,D0
00001940  323C FF00                829              MOVE.W  #$FF00,D1
00001944  4E4F                     830              TRAP    #15
00001946                           831              
00001946  4CDF 0003                832              MOVEM.L (A7)+,D0-D1
0000194A                           833              
0000194A  4E73                     834              RTE
0000194C                           835              
0000194C                           836  ;------------------------------------------------------------------------------            
0000194C                           837  SCRTIM
0000194C                           838  ; TIME INTERRPUT SERVICE ROUTINE FOR SYNC
0000194C                           839  ; INPUT    : NONE
0000194C                           840  ; OUTPUT   : NONE
0000194C                           841  ; MODIFIES : NONE
0000194C                           842  ; ------------------------------------------------------------------------------
0000194C                           843  
0000194C  5239 00001D00            844              ADDQ.B  #1,(SCRINTCT)
00001952  4E73                     845              RTE
00001954                           846              
00001954                           847  ;------------------------------------------------------------------------------            
00001954                           848  KBDINIT
00001954                           849  ; INIT THE KEYBOARD
00001954                           850  ; INPUT    : NONE
00001954                           851  ; OUTPUT   : NONE
00001954                           852  ; MODIFIES : NONE
00001954                           853  ; ------------------------------------------------------------------------------
00001954                           854  
00001954  4239 00001CFE            855              CLR.B   (KBDVAL)
0000195A  4239 00001CFF            856              CLR.B   (KBDEDGE)
00001960                           857  
00001960  4E75                     858              RTS
00001962                           859  
00001962                           860  ;------------------------------------------------------------------------------            
00001962                           861  KBDUPD
00001962                           862  ; UPDATES KEYBOARD INFO
00001962                           863  ; 3 -> DOWN
00001962                           864  ; 2 -> RIGHT
00001962                           865  ; 1 -> UP
00001962                           866  ; 0 -> LEFT
00001962                           867  ; ------------------------------------------------------------------------------
00001962                           868              
00001962  48E7 F800                869              MOVEM.L D0-D4,-(A7)
00001966                           870              
00001966  303C 0013                871              MOVE.W  #19,D0
0000196A                           872              ;GET INFO OF THE KEYS
0000196A  223C 28272625            873              MOVE.L  #KBDDOWN<<24|KBDRIGHT<<16|KBDUP<<8|KBDLEFT,D1
00001970  4E4F                     874              TRAP    #15
00001972                           875              
00001972                           876              ;CONVERT TO DESIRED FORMAT
00001972  4EB9 0000199C            877              JSR .CONVERT
00001978                           878  
00001978                           879              ;GET KBDEDGE (IF SOME KEY HAVE CHANGED THE VALUE)
00001978  1039 00001CFE            880              MOVE.B  (KBDVAL),D0             ;D0 -> LAST KBDVAL
0000197E  4600                     881              NOT.B   D0                      ;D2 -> ACTUAL KBDVAL
00001980  C002                     882              AND.B   D2,D0
00001982  13C0 00001CFF            883              MOVE.B  D0,(KBDEDGE)
00001988                           884              
00001988                           885         
00001988  B03C 0000                886              CMP.B   #0,D0
0000198C  6700 0008                887              BEQ     .NOACT          
00001990                           888              
00001990                           889              ;STORE NEW KBDVAL
00001990  13C2 00001CFE            890              MOVE.B  D2,(KBDVAL)
00001996                           891  .NOACT
00001996                           892              
00001996  4CDF 001F                893              MOVEM.L (A7)+,D0-D4
0000199A                           894              
0000199A  4E73                     895              RTE    
0000199C                           896              
0000199C                           897  .CONVERT 
0000199C  363C 0003                898              MOVE.W  #3,D3
000019A0                           899              
000019A0  E189                     900  .LOOP       LSL.L   #8,D1
000019A2  E312                     901              ROXL.B  #1,D2
000019A4  51CB FFFA                902              DBRA.W  D3,.LOOP
000019A8  4E75                     903              RTS
000019AA                           904             
000019AA                           905  
000019AA                           906  ;------------------------------------------------------------------------------            
000019AA                           907  COLWALLRIGHT
000019AA                           908  ; COLLISION PAC-MAN WITH WALL
000019AA                           909  ; INPUT    : NONE
000019AA                           910  ; OUTPUT   : NONE
000019AA                           911  ; MODIFIES : NONE
000019AA                           912  ; ------------------------------------------------------------------------------
000019AA                           913  
000019AA  48E7 F800                914              MOVEM.L D0-D4,-(A7)
000019AE                           915  
000019AE  3039 00002104            916              MOVE.W  (PMPOSX),D0
000019B4  5140                     917              SUB.W   #8,D0
000019B6  3239 00002106            918              MOVE.W  (PMPOSY),D1
000019BC  5041                     919              ADD.W   #8,D1
000019BE                           920              
000019BE  81FC 0010                921              DIVS.W  #16,D0
000019C2  83FC 0010                922              DIVS.W  #16,D1
000019C6                           923              
000019C6  5940                     924              SUB.W   #4,D0                   ;LI RESTAM 4 PERQUE LA MATRIU ESTA A UNA DISTANCIA DE 64 PIXELS DE LA PANTALLA
000019C8  5941                     925              SUB.W   #4,D1
000019CA                           926              
000019CA  41F9 00001D01            927              LEA.L   MAPVAR,A0
000019D0                           928              
000019D0  5240                     929              ADD.W   #1,D0
000019D2  5341                     930              SUB.W   #1,D1
000019D4  C2FC 0020                931              MULU.W  #32,D1
000019D8  D041                     932              ADD.W   D1,D0
000019DA                           933              
000019DA  3240                     934              MOVE.W  D0,A1
000019DC  13C0 00002102            935              MOVE.B  D0,POSCON
000019E2                           936  
000019E2  1A29 1D01                937              MOVE.B  MAPVAR(A1),D5
000019E6                           938              
000019E6  4CDF 001F                939              MOVEM.L (A7)+,D0-D4
000019EA                           940              
000019EA  4E75                     941              RTS
000019EC                           942  
000019EC                           943  
000019EC                           944  ;------------------------------------------------------------------------------            
000019EC                           945  COLWALLLEFT
000019EC                           946  ; COLLISION PAC-MAN WITH WALL
000019EC                           947  ; INPUT    : NONE
000019EC                           948  ; OUTPUT   : NONE
000019EC                           949  ; MODIFIES : NONE
000019EC                           950  ; ------------------------------------------------------------------------------
000019EC                           951  
000019EC  48E7 F800                952              MOVEM.L D0-D4,-(A7)
000019F0                           953  
000019F0  3039 00002104            954              MOVE.W  (PMPOSX),D0
000019F6  5C40                     955              ADD.W   #6,D0
000019F8  3239 00002106            956              MOVE.W  (PMPOSY),D1
000019FE  5041                     957              ADD.W   #8,D1
00001A00                           958              
00001A00  81FC 0010                959              DIVS.W  #16,D0
00001A04  83FC 0010                960              DIVS.W  #16,D1
00001A08                           961              
00001A08  5940                     962              SUB.W   #4,D0                   ;LI RESTAM 4 PERQUE LA MATRIU ESTA A UNA DISTANCIA DE 64 PIXELS DE LA PANTALLA
00001A0A  5941                     963              SUB.W   #4,D1
00001A0C                           964              
00001A0C  41F9 00001D01            965              LEA.L   MAPVAR,A0
00001A12                           966              
00001A12  5340                     967              SUB.W   #1,D0
00001A14  5341                     968              SUB.W   #1,D1
00001A16  C2FC 0020                969              MULU.W  #32,D1
00001A1A  D041                     970              ADD.W   D1,D0
00001A1C                           971  
00001A1C  3240                     972              MOVE.W  D0,A1
00001A1E  13C0 00002102            973              MOVE.B  D0,POSCON
00001A24                           974  
00001A24  1A29 1D01                975              MOVE.B  MAPVAR(A1),D5               
00001A28                           976  
00001A28                           977              
00001A28  4CDF 001F                978              MOVEM.L (A7)+,D0-D4
00001A2C                           979              
00001A2C  4E75                     980              RTS
00001A2E                           981  
00001A2E                           982  ;------------------------------------------------------------------------------            
00001A2E                           983  COLWALLDOWN
00001A2E                           984  ; COLLISION PAC-MAN WITH WALL
00001A2E                           985  ; INPUT    : NONE
00001A2E                           986  ; OUTPUT   : NONE
00001A2E                           987  ; MODIFIES : NONE
00001A2E                           988  ; ------------------------------------------------------------------------------
00001A2E                           989  
00001A2E  48E7 F800                990              MOVEM.L D0-D4,-(A7)
00001A32                           991  
00001A32  3039 00002104            992              MOVE.W  (PMPOSX),D0
00001A38                           993              ;ADD.W   #8,D0
00001A38  3239 00002106            994              MOVE.W  (PMPOSY),D1
00001A3E  5041                     995              ADD.W   #8,D1
00001A40                           996              
00001A40  81FC 0010                997              DIVS.W  #16,D0
00001A44  83FC 0010                998              DIVS.W  #16,D1
00001A48                           999              
00001A48  5940                    1000              SUB.W   #4,D0                   ;LI RESTAM 4 PERQUE LA MATRIU ESTA A UNA DISTANCIA DE 64 PIXELS DE LA PANTALLA
00001A4A  5941                    1001              SUB.W   #4,D1
00001A4C                          1002              
00001A4C  41F9 00001D01           1003              LEA.L   MAPVAR,A0
00001A52                          1004              
00001A52  C2FC 0020               1005              MULU.W  #32,D1
00001A56  D041                    1006              ADD.W   D1,D0
00001A58                          1007  
00001A58  3240                    1008              MOVE.W  D0,A1
00001A5A  13C0 00002102           1009              MOVE.B  D0,POSCON
00001A60                          1010  
00001A60  1A29 1D01               1011              MOVE.B  MAPVAR(A1),D5 
00001A64                          1012  
00001A64                          1013              
00001A64  4CDF 001F               1014              MOVEM.L (A7)+,D0-D4
00001A68                          1015              
00001A68  4E75                    1016              RTS
00001A6A                          1017  
00001A6A                          1018  
00001A6A                          1019  ;------------------------------------------------------------------------------            
00001A6A                          1020  COLWALLUP
00001A6A                          1021  ; COLLISION PAC-MAN WITH WALL
00001A6A                          1022  ; INPUT    : NONE
00001A6A                          1023  ; OUTPUT   : NONE
00001A6A                          1024  ; MODIFIES : NONE
00001A6A                          1025  ; ------------------------------------------------------------------------------
00001A6A                          1026  
00001A6A  48E7 F800               1027              MOVEM.L D0-D4,-(A7)
00001A6E                          1028  
00001A6E  3039 00002104           1029              MOVE.W  (PMPOSX),D0
00001A74                          1030              ;SUB.W   #8,D0
00001A74  3239 00002106           1031              MOVE.W  (PMPOSY),D1
00001A7A  5C41                    1032              ADD.W   #6,D1
00001A7C                          1033              
00001A7C                          1034              
00001A7C  81FC 0010               1035              DIVS.W  #16,D0
00001A80  83FC 0010               1036              DIVS.W  #16,D1
00001A84                          1037              
00001A84  5940                    1038              SUB.W   #4,D0                   ;LI RESTAM 4 PERQUE LA MATRIU ESTA A UNA DISTANCIA DE 64 PIXELS DE LA PANTALLA
00001A86  5941                    1039              SUB.W   #4,D1
00001A88                          1040              
00001A88  41F9 00001D01           1041              LEA.L   MAPVAR,A0
00001A8E                          1042              
00001A8E  5341                    1043              SUB.W   #1,D1
00001A90                          1044              ;CMP     #1,D1
00001A90                          1045              ;BLO     BUCLE4
00001A90  C2FC 0020               1046              MULU.W  #32,D1
00001A94  D041                    1047              ADD.W   D1,D0
00001A96                          1048  
00001A96                          1049  ;BUCLE4            
00001A96  3240                    1050              MOVE.W  D0,A1
00001A98  13C0 00002102           1051              MOVE.B  D0,POSCON
00001A9E                          1052  
00001A9E  1A29 1D01               1053              MOVE.B  MAPVAR(A1),D5 
00001AA2                          1054  
00001AA2                          1055              ;MOVE.B  #0,D5
00001AA2                          1056              
00001AA2  4CDF 001F               1057              MOVEM.L (A7)+,D0-D4
00001AA6                          1058              
00001AA6  4E75                    1059              RTS
00001AA8                          1060  
00001AA8                          1061  
00001AA8                          1062  ;------------------------------------------------------------------------------            
00001AA8                          1063  GETPOINTS
00001AA8                          1064  ; COLLISION PAC-MAN WITH WALL
00001AA8                          1065  ; INPUT    : NONE
00001AA8                          1066  ; OUTPUT   : NONE
00001AA8                          1067  ; MODIFIES : NONE
00001AA8                          1068  ; ------------------------------------------------------------------------------
00001AA8                          1069  
00001AA8  48E7 F800               1070              MOVEM.L D0-D4,-(A7)
00001AAC                          1071  
00001AAC  3039 00002104           1072              MOVE.W  (PMPOSX),D0
00001AB2                          1073              ;SUB.W   #8,D0
00001AB2  3239 00002106           1074              MOVE.W  (PMPOSY),D1
00001AB8  0641 0010               1075              ADD.W   #16,D1
00001ABC                          1076              
00001ABC                          1077              
00001ABC  81FC 0010               1078              DIVS.W  #16,D0
00001AC0  83FC 0010               1079              DIVS.W  #16,D1
00001AC4                          1080              
00001AC4  5940                    1081              SUB.W   #4,D0                   ;LI RESTAM 4 PERQUE LA MATRIU ESTA A UNA DISTANCIA DE 64 PIXELS DE LA PANTALLA
00001AC6  5941                    1082              SUB.W   #4,D1
00001AC8                          1083                          
00001AC8  5341                    1084              SUB.W   #1,D1
00001ACA  C2FC 0020               1085              MULU.W  #32,D1
00001ACE  D041                    1086              ADD.W   D1,D0
00001AD0                          1087  
00001AD0  3240                    1088              MOVE.W  D0,A1
00001AD2  1A29 1D01               1089              MOVE.B  MAPVAR(A1),D5
00001AD6                          1090              
00001AD6  BA7C 0000               1091              CMP     #0,D5
00001ADA  6700 003A               1092              BEQ     .DONE
00001ADE  BA7C 0002               1093              CMP     #2,D5
00001AE2  6700 0020               1094              BEQ     .POINT
00001AE6  BA7C 0003               1095              CMP     #3,D5
00001AEA  6700 0006               1096              BEQ     .BPOINT
00001AEE  6600 0026               1097              BNE     .DONE
00001AF2                          1098  .BPOINT
00001AF2  137C 0000 1D01          1099              MOVE.B  #0,MAPVAR(A1)
00001AF8  0679 0032 0000211A      1100              ADD.W   #50,(SCOPOINTS)
00001B00  6600 0014               1101              BNE     .DONE
00001B04                          1102  .POINT
00001B04  137C 0000 1D01          1103              MOVE.B  #0,MAPVAR(A1)
00001B0A  0679 000A 0000211A      1104              ADD.W   #10,(SCOPOINTS)
00001B12  6600 0002               1105              BNE     .DONE            
00001B16                          1106  .DONE                        
00001B16  4CDF 001F               1107              MOVEM.L (A7)+,D0-D4
00001B1A                          1108              
00001B1A  4E75                    1109              RTS
00001B1C                          1110  
00001B1C                          1111  
00001B1C                          1112  
00001B1C                          1113  -------------------- end include --------------------
00001B1C                          1114              INCLUDE "MAP.X68"
00001B1C                          1115  
00001B1C                          1116  ; ------------------------------------------------------------------------------
00001B1C                          1117  MAPINIT
00001B1C                          1118  ; INIT MAP
00001B1C                          1119  ; INPUT    : NONE
00001B1C                          1120  ; OUTPUT   : NONE
00001B1C                          1121  ; MODIFIES : NONE
00001B1C                          1122  ; ------------------------------------------------------------------------------            
00001B1C                          1123              
00001B1C                          1124              ;MOVE.L  #DIBFIGWALL,($80+2*4)          ;INSTALL SUBRUTINE TO TRAP #2
00001B1C                          1125              ;MOVE.L  #DIBFIGPOINT,($80+3*4)          ;INSTALL SUBRUTINE TO TRAP #3
00001B1C                          1126              ;MOVE.L  #DIBFIGBPOINT,($80+4*4)          ;INSTALL SUBRUTINE TO TRAP #4
00001B1C                          1127              
00001B1C  48E7 FE00               1128              MOVEM.L D0-D6,-(A7)
00001B20  48E7 00C0               1129              MOVEM.L A0-A1,-(A7)
00001B24                          1130              
00001B24  41F8 1000               1131              LEA.L   MAPMAT,A0
00001B28  43F9 00001D01           1132              LEA.L   MAPVAR,A1
00001B2E  3C3C 0030               1133              MOVE.W  #48,D6
00001B32  343C 001F               1134              MOVE.W  #31,D2
00001B36                          1135  BUCLE_FILA
00001B36  3A3C 0030               1136              MOVE.W  #48,D5
00001B3A  323C 001F               1137              MOVE.W  #31,D1
00001B3E  0646 0010               1138              ADD.W   #16,D6
00001B42                          1139  
00001B42                          1140  BUCLE_COLUMNA
00001B42  0645 0010               1141              ADD.W   #16,D5
00001B46                          1142  
00001B46  1018                    1143              MOVE.B  (A0)+,D0
00001B48  12C0                    1144              MOVE.B  D0,(A1)+
00001B4A                          1145               
00001B4A  B07C 0000               1146              CMP     #0,D0
00001B4E  6700 0034               1147              BEQ     ZERO
00001B52  B07C 0004               1148              CMP     #4,D0
00001B56  6700 002C               1149              BEQ     ZERO
00001B5A  B07C 0001               1150              CMP     #1,D0
00001B5E  6600 0008               1151              BNE     NOTWALL
00001B62  4EB9 00001C0A           1152              JSR     DIBFIGWALL
00001B68                          1153  NOTWALL
00001B68  B07C 0002               1154              CMP     #2,D0
00001B6C  6600 0008               1155              BNE     NOTPOINT
00001B70  4EB9 00001C42           1156              JSR     DIBFIGPOINT
00001B76                          1157  NOTPOINT
00001B76  B07C 0003               1158              CMP     #3,D0
00001B7A  6600 0008               1159              BNE     ZERO
00001B7E  4EB9 00001C7E           1160              JSR     DIBFIGBPOINT
00001B84                          1161           
00001B84                          1162  ZERO
00001B84  51C9 FFBC               1163              DBRA    D1,BUCLE_COLUMNA  
00001B88  51CA FFAC               1164              DBRA    D2,BUCLE_FILA
00001B8C                          1165              
00001B8C  4CDF 0300               1166              MOVEM.L (A7)+,A0-A1
00001B90  4CDF 007F               1167              MOVEM.L (A7)+,D0-D6
00001B94                          1168  
00001B94                          1169  
00001B94                          1170              
00001B94  4E75                    1171              RTS            
00001B96                          1172  
00001B96                          1173  ; ------------------------------------------------------------------------------
00001B96                          1174  MAPPLOT
00001B96                          1175  ; INIT MAP
00001B96                          1176  ; INPUT    : NONE
00001B96                          1177  ; OUTPUT   : NONE
00001B96                          1178  ; MODIFIES : NONE
00001B96                          1179  ; ------------------------------------------------------------------------------            
00001B96                          1180  
00001B96  48E7 FE00               1181              MOVEM.L D0-D6,-(A7)
00001B9A  48E7 0080               1182              MOVEM.L A0,-(A7)
00001B9E                          1183  
00001B9E  41F9 00001D01           1184              LEA.L   MAPVAR,A0
00001BA4  3C3C 0030               1185              MOVE.W  #48,D6
00001BA8  343C 001F               1186              MOVE.W  #31,D2
00001BAC                          1187  BUCLE_FILA2
00001BAC  3A3C 0030               1188              MOVE.W  #48,D5
00001BB0  323C 001F               1189              MOVE.W  #31,D1
00001BB4  0646 0010               1190              ADD.W   #16,D6
00001BB8                          1191  
00001BB8                          1192  BUCLE_COLUMNA2
00001BB8  0645 0010               1193              ADD.W   #16,D5       
00001BBC                          1194  
00001BBC  1018                    1195              MOVE.B  (A0)+,D0
00001BBE                          1196  
00001BBE  B07C 0000               1197              CMP     #0,D0
00001BC2  6700 0034               1198              BEQ     ZERO2
00001BC6  B07C 0004               1199              CMP     #4,D0
00001BCA  6700 002C               1200              BEQ     ZERO2
00001BCE  B07C 0001               1201              CMP     #1,D0
00001BD2  6600 0008               1202              BNE     NOTWALL2
00001BD6  4EB9 00001C0A           1203              JSR     DIBFIGWALL
00001BDC                          1204  NOTWALL2
00001BDC  B07C 0002               1205              CMP     #2,D0
00001BE0  6600 0008               1206              BNE     NOTPOINT2
00001BE4  4EB9 00001C42           1207              JSR     DIBFIGPOINT
00001BEA                          1208  NOTPOINT2
00001BEA  B07C 0003               1209              CMP     #3,D0
00001BEE  6600 0008               1210              BNE     ZERO2
00001BF2  4EB9 00001C7E           1211              JSR     DIBFIGBPOINT
00001BF8                          1212  
00001BF8                          1213     
00001BF8                          1214  ZERO2
00001BF8  51C9 FFBE               1215              DBRA    D1,BUCLE_COLUMNA2
00001BFC                          1216              
00001BFC  51CA FFAE               1217              DBRA    D2,BUCLE_FILA2
00001C00                          1218              
00001C00  4CDF 0100               1219              MOVEM.L (A7)+,A0
00001C04  4CDF 007F               1220              MOVEM.L (A7)+,D0-D6
00001C08                          1221              
00001C08                          1222              
00001C08  4E75                    1223              RTS 
00001C0A                          1224              
00001C0A                          1225  ; -----------------------------------------------------------------------------
00001C0A                          1226  DIBFIGWALL
00001C0A                          1227  ; SUBRUTINE DRAW MAP
00001C0A                          1228  ; INPUT    : D5=POSITION X, D6=POSITION Y
00001C0A                          1229  ; OUTPUT   : NONE
00001C0A                          1230  ; MODIFIES : NONE
00001C0A                          1231  ; -----------------------------------------------------------------------------
00001C0A  48E7 FE00               1232              MOVEM.L D0-D6,-(A7)
00001C0E                          1233              ; SET CONTOURN COLOR
00001C0E  103C 0050               1234              MOVE.B  #80,D0
00001C12  223C 00AA0000           1235              MOVE.L  #$00AA0000,D1
00001C18  4E4F                    1236              TRAP    #15
00001C1A                          1237              
00001C1A                          1238              ; SET FILL COLOR
00001C1A  103C 0051               1239              MOVE.B  #81,D0
00001C1E  223C 00FF0000           1240              MOVE.L  #$00FF0000,D1
00001C24  4E4F                    1241              TRAP    #15
00001C26                          1242              
00001C26                          1243              ; DEFINE COORDINATES RECTANGLE
00001C26  3205                    1244              MOVE.W  D5,D1
00001C28  3406                    1245              MOVE.W  D6,D2
00001C2A  0645 0010               1246              ADD.W   #16,D5
00001C2E  0646 0010               1247              ADD.W   #16,D6
00001C32  3605                    1248              MOVE.W  D5,D3
00001C34  3806                    1249              MOVE.W  D6,D4
00001C36                          1250              
00001C36                          1251              ; DRAW RECTANGLE
00001C36  103C 0057               1252              MOVE.B  #87,D0
00001C3A  4E4F                    1253              TRAP    #15
00001C3C                          1254              
00001C3C  4CDF 007F               1255              MOVEM.L (A7)+,D0-D6
00001C40                          1256  
00001C40  4E75                    1257              RTS
00001C42                          1258              
00001C42                          1259  ; -----------------------------------------------------------------------------
00001C42                          1260  DIBFIGPOINT
00001C42                          1261  ; SUBRUTINE DRAW MAP
00001C42                          1262  ; INPUT    : D5=POSITION X, D6=POSITION Y
00001C42                          1263  ; OUTPUT   : NONE
00001C42                          1264  ; MODIFIES : NONE
00001C42                          1265  ; -----------------------------------------------------------------------------
00001C42  48E7 FE00               1266              MOVEM.L D0-D6,-(A7)
00001C46                          1267              ; SET CONTOURN COLOR
00001C46  103C 0050               1268              MOVE.B  #80,D0
00001C4A  223C 0000AAAA           1269              MOVE.L  #$0000AAAA,D1
00001C50  4E4F                    1270              TRAP    #15
00001C52                          1271              
00001C52                          1272              ; SET FILL COLOR
00001C52  103C 0051               1273              MOVE.B  #81,D0
00001C56  223C 0000FFFF           1274              MOVE.L  #$0000FFFF,D1
00001C5C  4E4F                    1275              TRAP    #15
00001C5E                          1276              
00001C5E                          1277              ; DEFINE COORDINATES RECTANGLE
00001C5E  3205                    1278              MOVE.W  D5,D1
00001C60  5041                    1279              ADD.W   #8,D1
00001C62  5541                    1280              SUB.W   #2,D1
00001C64  3406                    1281              MOVE.W  D6,D2
00001C66  5042                    1282              ADD.W   #8,D2
00001C68  5542                    1283              SUB.W   #2,D2
00001C6A                          1284              
00001C6A  3601                    1285              MOVE.W  D1,D3
00001C6C  5843                    1286              ADD.W   #2*2,D3
00001C6E  3802                    1287              MOVE.W  D2,D4
00001C70  5844                    1288              ADD.W   #2*2,D4
00001C72                          1289              
00001C72                          1290              ; DRAW POINT
00001C72  103C 0058               1291              MOVE.B  #88,D0
00001C76  4E4F                    1292              TRAP    #15
00001C78                          1293              
00001C78  4CDF 007F               1294              MOVEM.L (A7)+,D0-D6
00001C7C                          1295              
00001C7C  4E75                    1296              RTS
00001C7E                          1297  
00001C7E                          1298  
00001C7E                          1299  ; -----------------------------------------------------------------------------
00001C7E                          1300  DIBFIGBPOINT
00001C7E                          1301  ; SUBRUTINE DRAW MAP
00001C7E                          1302  ; INPUT    : D5=POSITION X, D6=POSITION Y
00001C7E                          1303  ; OUTPUT   : NONE
00001C7E                          1304  ; MODIFIES : NONE
00001C7E                          1305  ; -----------------------------------------------------------------------------
00001C7E  48E7 FE00               1306              MOVEM.L D0-D6,-(A7)
00001C82                          1307              ; SET CONTOURN COLOR
00001C82  103C 0050               1308              MOVE.B  #80,D0
00001C86  223C 0000AAAA           1309              MOVE.L  #$0000AAAA,D1
00001C8C  4E4F                    1310              TRAP    #15
00001C8E                          1311              
00001C8E                          1312              ; SET FILL COLOR
00001C8E  103C 0051               1313              MOVE.B  #81,D0
00001C92  223C 0000FFFF           1314              MOVE.L  #$0000FFFF,D1
00001C98  4E4F                    1315              TRAP    #15
00001C9A                          1316              
00001C9A                          1317              ; DEFINE COORDINATES RECTANGLE
00001C9A  3205                    1318              MOVE.W  D5,D1
00001C9C  5041                    1319              ADD.W   #8,D1
00001C9E  5941                    1320              SUB.W   #4,D1
00001CA0  3406                    1321              MOVE.W  D6,D2
00001CA2  5042                    1322              ADD.W   #8,D2
00001CA4  5942                    1323              SUB.W   #4,D2
00001CA6                          1324              
00001CA6  3601                    1325              MOVE.W  D1,D3
00001CA8  5043                    1326              ADD.W   #4*2,D3
00001CAA  3802                    1327              MOVE.W  D2,D4
00001CAC  5044                    1328              ADD.W   #4*2,D4
00001CAE                          1329              
00001CAE                          1330              ; DRAW BIG POINT
00001CAE  103C 0058               1331              MOVE.B  #88,D0
00001CB2  4E4F                    1332              TRAP    #15
00001CB4                          1333              
00001CB4  4CDF 007F               1334              MOVEM.L (A7)+,D0-D6
00001CB8                          1335              
00001CB8  4E75                    1336              RTS
00001CBA                          1337  
00001CBA                          1338  
00001CBA                          1339  
00001CBA                          1340  
00001CBA                          1341  
00001CBA                          1342  
00001CBA                          1343  
00001CBA                          1344  
00001CBA                          1345  
00001CBA                          1346  
00001CBA                          1347  
00001CBA                          1348  
00001CBA                          1349  -------------------- end include --------------------
00001CBA                          1350              
00001CBA                          1351      
00001CBA                          1352  START:
00001CBA                          1353  
00001CBA                          1354  ;--- INITIALIZATION -----------------------------------------------------------
00001CBA                          1355  
00001CBA  007C 0700               1356              ORI.W   #$0700,SR               ;DISABLE INTERRUPTIONS
00001CBE                          1357  
00001CBE  4EB8 18C2               1358              JSR     SYSINIT
00001CC2  4EB8 14CE               1359              JSR     PMINIT
00001CC6  4EB8 1B1C               1360              JSR     MAPINIT
00001CCA  4EB8 1400               1361              JSR     GSTINIT
00001CCE  4EB8 1850               1362              JSR     SCOINIT
00001CD2                          1363  
00001CD2                          1364  .LOOP
00001CD2                          1365  
00001CD2                          1366  ; --- UPDATE -------------------------------------------------------------------
00001CD2                          1367  
00001CD2                          1368  ; READ INPUT DEVICES
00001CD2                          1369  
00001CD2  4E41                    1370              TRAP    #1
00001CD4                          1371  
00001CD4                          1372  ; UPDATE GAME LOGIC
00001CD4                          1373  
00001CD4  4EB8 1502               1374              JSR     PMUPD
00001CD8                          1375             ;JSR     GSTUPD
00001CD8                          1376  
00001CD8                          1377  ; --- SYNC ---------------------------------------------------------------------
00001CD8                          1378              ;WHILE THERES NO INTERRUPTS IN THE COUNTER THE PROGRAM WILL BE IN
00001CD8                          1379              ;THE BUCLE
00001CD8                          1380              
00001CD8  4A39 00001D00           1381  .WAITINIT   TST.B   (SCRINTCT)
00001CDE  67F8                    1382              BEQ     .WAITINIT
00001CE0  4239 00001D00           1383              CLR.B   (SCRINTCT)
00001CE6                          1384  
00001CE6                          1385  ; --- PLOT ---------------------------------------------------------------------
00001CE6                          1386              
00001CE6  4EB8 1B96               1387              JSR     MAPPLOT
00001CEA  4EB8 1860               1388              JSR     SCOPLOT
00001CEE  4EB8 164C               1389              JSR     PMPLOT
00001CF2  4EB8 1464               1390              JSR     GSTPLOT
00001CF6                          1391              
00001CF6                          1392              
00001CF6                          1393              
00001CF6  4E40                    1394              TRAP    #0                      ;CHANGE BUFFER
00001CF8                          1395  
00001CF8  60D8                    1396              BRA     .LOOP
00001CFA                          1397  
00001CFA  FFFF FFFF               1398              SIMHALT  
00001CFE                          1399             
00001CFE                          1400              INCLUDE "SYSVARS.X68"
00001CFE                          1401  ; ==============================================================================
00001CFE                          1402  ; SYSTEM VARIABLES
00001CFE                          1403  ; ==============================================================================
00001CFE                          1404   
00001CFE                          1405  ; --- KEYBOARD RELATED VARIABLES -----------------------------------------------
00001CFE                          1406  
00001CFE                          1407  KBDVAL      DS.B    1                       ; KEY STATE
00001CFF                          1408  KBDEDGE     DS.B    1                       ; KEY EDGE
00001D00                          1409  
00001D00                          1410  ; --- TIMED INTERRUPT RELATED VARIABLES ----------------------------------------
00001D00                          1411  
00001D00                          1412  SCRINTCT    DS.B    1                       ; INTERRUPT COUNTER
00001D01                          1413              DS.B    0           
00001D01                          1414              
00001D01                          1415  ; --- MAP RELATED VARIABLE -----------------------------------------------------
00001D01                          1416  
00001D01                          1417  MAPVAR      DS.B    1024
00002101                          1418  
00002101                          1419              DS.B    0
00002101                          1420  
00002102                          1421  POSCON      DS.W    1
00002104                          1422  
00002104                          1423  
00002104                          1424  
00002104                          1425  
00002104                          1426  
00002104                          1427  -------------------- end include --------------------
00002104                          1428              INCLUDE "VARS.X68"
00002104                          1429  ; ==============================================================================
00002104                          1430  ; GAME VARIABLES
00002104                          1431  ; ==============================================================================
00002104                          1432  
00002104                          1433  ; --- PAC-MAN RELATED VARIABLES ------------------------------------------------
00002104                          1434  
00002104                          1435  PMPOSX      DS.W    1                       ; PM X COORDINATE
00002106                          1436  PMPOSY      DS.W    1                       ; PM Y COORDINATE
00002108                          1437  PMVELX      DS.W    1                       ; PM X VELOCITY
0000210A                          1438  PMVELY      DS.W    1                       ; PM Y VELOCITY
0000210C                          1439  PMEAT       DS.B    1                       ; PM BOOLEAN EAT GST
0000210D                          1440  PMLAMO      DS.B    1                       ; PM SAVE LAST MOVEMENT X O Y
0000210E                          1441              DS.B    0
0000210E                          1442  
0000210E                          1443  ; --- GHOST RELATED VARIABLES --------------------------------------------------
0000210E                          1444  
0000210E                          1445  GSTPOSX     DS.W    1                       ; GST X COORDINATE
00002110                          1446  GSTPOSY     DS.W    1                       ; GST Y COORDINATE
00002112                          1447  GSTVELX     DS.W    1                       ; GST X VELOCITY
00002114                          1448  GSTVELY     DS.W    1                       ; GST Y VELOCITY
00002116                          1449  GSTDEAD     DS.B    1                       ; GST BOOLEAN DEAD
00002117                          1450  GSTLAMO     DS.B    1                       ; GST LAST MOVEMENT (X OR Y)
00002118                          1451              DS.B    0
00002118                          1452  
00002118                          1453  ; --- SCOREBOARD RELATED VARIABLES ---------------------------------------------
00002118                          1454  
00002118                          1455  SCOLIFE     DS.W    1                       ; NUMBER OF LIFES
0000211A                          1456  SCOPOINTS   DS.W    1                       ; NUMBER OF POINTS
0000211C                          1457  
0000211C                          1458  
0000211C                          1459  
0000211C                          1460  
0000211C                          1461  
0000211C                          1462  
0000211C                          1463  
0000211C                          1464  -------------------- end include --------------------
0000211C                          1465              
0000211C                          1466              END    START        

No errors detected
No warnings generated


SYMBOL TABLE INFORMATION
Symbol-name         Value
-------------------------
BUCLE_COLUMNA       1B42
BUCLE_COLUMNA2      1BB8
BUCLE_FILA          1B36
BUCLE_FILA2         1BAC
COLWALLDOWN         1A2E
COLWALLLEFT         19EC
COLWALLRIGHT        19AA
COLWALLUP           1A6A
DIBFIGBPOINT        1C7E
DIBFIGPOINT         1C42
DIBFIGWALL          1C0A
GETPOINTS           1AA8
GETPOINTS:BPOINT    1AF2
GETPOINTS:DONE      1B16
GETPOINTS:POINT     1B04
GSTCOL1             FF
GSTCOL2             FF0080
GSTCOL3             FFFF00
GSTCOL4             80FF
GSTCOL5             800000
GSTDEAD             2116
GSTFCOL1            FFFFFF
GSTFCOL2            0
GSTFCOL3            0
GSTFCOL4            0
GSTFCOL5            0
GSTINIT             1400
GSTINX1             2
GSTINX2             2
GSTINX3             1F
GSTINX4             1F
GSTINY1             2
GSTINY2             1F
GSTINY3             2
GSTINY4             1F
GSTLAMO             2117
GSTPLOT             1464
GSTPOSX             210E
GSTPOSY             2110
GSTRAD              8
GSTRNG              10
GSTSPEED            7
GSTSPEED2           5
GSTUPD              1428
GSTUPD:GSTNOTMULT   145E
GSTVELX             2112
GSTVELY             2114
KBDDOWN             28
KBDEDGE             1CFF
KBDFIRE1            20
KBDFIRE2            4D
KBDFIRE3            10
KBDINIT             1954
KBDLEFT             25
KBDPAUSE            50
KBDRIGHT            27
KBDUP               26
KBDUPD              1962
KBDUPD:CONVERT      199C
KBDUPD:LOOP         19A0
KBDUPD:NOACT        1996
KBDVAL              1CFE
MAPINIT             1B1C
MAPMAT              1000
MAPPLOT             1B96
MAPVAR              1D01
NOTPOINT            1B76
NOTPOINT2           1BEA
NOTWALL             1B68
NOTWALL2            1BDC
PMEAT               210C
PMFCOL              FFFF
PMINIT              14CE
PMLAMO              210D
PMPCOL              FFFF
PMPLOT              164C
PMPLOT:DDONE        16E6
PMPLOT:DDOWN        16B8
PMPLOT:DLEFT        169A
PMPLOT:DOWNDRAW     17A6
PMPLOT:DRAW_MOUTH1  16C2
PMPLOT:DRAW_MOUTH2  16CC
PMPLOT:DRAW_MOUTH3  16D6
PMPLOT:DRAW_MOUTH4  16E0
PMPLOT:DRIGHT       16AE
PMPLOT:DUP          16A4
PMPLOT:FULLDRAW     16EC
PMPLOT:LEFTDRAW     1710
PMPLOT:RIGHTDRAW    1742
PMPLOT:SET_MOUTHDOWN  1832
PMPLOT:SET_MOUTHLEFT  17D8
PMPLOT:SET_MOUTHRIGHT  17F6
PMPLOT:SET_MOUTHUP  1814
PMPLOT:UPDRAW       1774
PMPOSX              2104
PMPOSY              2106
PMRAD               8
PMSPEED             2
PMUPD               1502
PMUPD:ACTXLEFT      15C0
PMUPD:ACTXRIGHT     1594
PMUPD:ACTYDOWN      15EC
PMUPD:ACTYUP        1608
PMUPD:DONE          163A
PMUPD:NOTCOLISION   15A6
PMUPD:NOTCOLISION2  15D2
PMUPD:NOTCOLISION3  15FE
PMUPD:NOTCOLISION4  161A
PMUPD:NOTDOWN       1590
PMUPD:NOTLEFT       154E
PMUPD:NOTMULT       1624
PMUPD:NOTRIGHT      1564
PMUPD:NOTTP         15B6
PMUPD:NOTTP2        15E2
PMUPD:NOTUP         157A
PMVELX              2108
PMVELY              210A
POSCON              2102
SCOFCOL             0
SCOINIT             1850
SCOLIFE             2118
SCOLINE1            101
SCOLINE2            102
SCOPLOT             1860
SCOPLOT:TXT1        18AE
SCOPLOT:TXT2        18B7
SCOPOINTS           211A
SCRHEIGH            280
SCRINIT             18EE
SCRINTCT            1D00
SCRTIM              194C
SCRUPD              1932
SCRWIDTH            280
START               1CBA
START:LOOP          1CD2
START:WAITINIT      1CD8
SYSINIT             18C2
ZERO                1B84
ZERO2               1BF8
