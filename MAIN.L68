00002182 Starting Address
Assembler used: EASy68K Editor/Assembler v5.16.01
Created On: 22/12/2022 11:00:24

00000000                             1  ; ==============================================================================
00000000                             2  ; TITLE       : PAC-MAN 68000
00000000                             3  ; DESCRIPTION : GAME IN MOTOROLA 68000 BASED ON PAC-MAN GAME
00000000                             4  ; AUTHOR      : JORDI FLORIT ENSENYAT
00000000                             5  ;               JOSEP GABRIEL FORNES REYNES
00000000                             6  ;               PAU GIRON RODRIGUEZ
00000000                             7  ; ==============================================================================
00001000                             8              ORG    $1000
00001000                             9  
00001000                            10              INCLUDE "CONST.X68"
00001000                            11  ; ==============================================================================
00001000                            12  ; GAME CONSTANTS
00001000                            13  ; ==============================================================================
00001000                            14  
00001000                            15  ; --- PAC-MAN RELATED CONTANTS ----------------------------------------------------
00001000                            16  
00001000  =0000FFFF                 17  PMPCOL      EQU     $0000FFFF               ; PAC-MAN CONTOUR COLOR
00001000  =0000FFFF                 18  PMFCOL      EQU     $0000FFFF               ; PAC-MAN FILL COLOR
00001000  =00000002                 19  PMSPEED     EQU     2                       ; MAGNITUDE OF THE X AND Y VEL.
00001000  =00000008                 20  PMRAD       EQU     8                       ; PAC-MAN RADIUS
00001000                            21  
00001000                            22  ; --- GHOST RELATED CONSTANTS ----------------------------------------------------
00001000                            23  
00001000  =00000007                 24  GSTSPEED    EQU     7                       ; MAGNITUDE OF THE NORMAL DISPLACEMENT
00001000  =00000005                 25  GSTSPEED2   EQU     5                       ; MAGNITUDE OF THE ATACKED DISPLACEMENT
00001000                            26  
00001000  =000000FF                 27  GSTCOL1     EQU     $000000FF               ; GHOST 1 CONTOUR COLOR RED
00001000  =00FFFFFF                 28  GSTFCOL1    EQU     $00FFFFFF               ; GHOST 1 FILL COLOR WHITE
00001000  =00000002                 29  GSTINX1     EQU     2                       ; GHOST 1 INITIAL X
00001000  =00000002                 30  GSTINY1     EQU     2                       ; GHOST 1 INITIAL Y
00001000                            31  
00001000  =00FF0080                 32  GSTCOL2     EQU     $00FF0080               ; GHOST 2 CONTOUR COLOR PINK
00001000  =00000000                 33  GSTFCOL2    EQU     $00000000               ; GHOST 1 FILL COLOR
00001000  =00000002                 34  GSTINX2     EQU     2                       ; GHOST 2 INITIAL X
00001000  =0000001F                 35  GSTINY2     EQU     31                      ; GHOST 2 INITIAL Y
00001000                            36  
00001000  =00FFFF00                 37  GSTCOL3     EQU     $00FFFF00               ; GHOST 3 CONTOUR COLOR CYAN
00001000  =00000000                 38  GSTFCOL3    EQU     $00000000               ; GHOST 3 FILL COLOR
00001000  =0000001F                 39  GSTINX3     EQU     31                      ; GHOST 3 INITIAL X
00001000  =00000002                 40  GSTINY3     EQU     2                       ; GHOST 3 INITIAL Y
00001000                            41  
00001000  =000080FF                 42  GSTCOL4     EQU     $000080FF               ; GHOST 4 CONTOUR COLOR ORANGE
00001000  =00000000                 43  GSTFCOL4    EQU     $00000000               ; GHOST 4 FILL COLOR
00001000  =0000001F                 44  GSTINX4     EQU     31                      ; GHOST 4 INITIAL X
00001000  =0000001F                 45  GSTINY4     EQU     31                      ; GHOST 4 INITIAL Y 
00001000                            46  
00001000  =00800000                 47  GSTCOL5     EQU     $00800000               ; CONTOUR COLOR OF ATACKED MODE
00001000  =00000000                 48  GSTFCOL5    EQU     $00000000               ; FILL COLOR OF ATACKED MODE
00001000                            49  
00001000  =00000008                 50  GSTRAD      EQU     8                       ; GHOST RADIUS
00001000  =00000010                 51  GSTRNG      EQU     16                      ; GHOST DETECTING RANGE
00001000                            52              
00001000                            53  ; --- SCOREBOARD RELATED CONSTANTS ---------------------------------------------
00001000                            54  ;MODIFICATE
00001000                            55  
00001000  =00000000                 56  SCOFCOL     EQU     $00000000               ; TEXT BACKGROUND COLOR
00001000  =00000101                 57  SCOLINE1    EQU     $0101                   ; FIRST TEXT LINE COORDINATES
00001000  =00000102                 58  SCOLINE2    EQU     $0102                   ; SECOND TEXT LINE COORDINATES
00001000                            59  
00001000                            60  ; --- MAP RELATED CONSTANTS ----------------------------------------------------
00001000                            61  
00001000= 01 01 01 01 01 01 ...     62  MAPMAT      DC.B    $1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
00001020= 01 02 02 02 02 02 ...     63              DC.B    $1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1
00001040= 01 02 01 01 01 01 ...     64              DC.B    $1,2,1,1,1,1,1,2,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,2,1,1,1,1,1,2,1
00001060= 01 03 01 01 01 01 ...     65              DC.B    $1,3,1,1,1,1,1,2,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,2,1,1,1,1,1,3,1
00001080= 01 02 02 02 02 02 ...     66              DC.B    $1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1
000010A0= 01 02 01 01 01 01 ...     67              DC.B    $1,2,1,1,1,1,1,2,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,2,1,1,1,1,1,2,1
000010C0= 01 02 01 01 01 01 ...     68              DC.B    $1,2,1,1,1,1,1,2,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,2,1,1,1,1,1,2,1
000010E0= 01 02 02 02 02 02 ...     69              DC.B    $1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1
00001100= 01 02 01 01 01 01 ...     70              DC.B    $1,2,1,1,1,1,1,2,1,1,1,2,1,1,1,1,1,1,1,1,2,1,1,1,2,1,1,1,1,1,2,1
00001120= 01 02 01 00 00 00 ...     71              DC.B    $1,2,1,0,0,0,1,2,1,0,1,2,1,1,1,1,1,1,1,1,2,1,0,1,2,1,0,0,0,1,2,1
00001140= 01 02 01 01 01 01 ...     72              DC.B    $1,2,1,1,1,1,1,2,1,0,1,2,2,2,2,1,1,2,2,2,2,1,0,1,2,1,1,1,1,1,2,1
00001160= 01 02 02 02 02 02 ...     73              DC.B    $1,2,2,2,2,2,2,2,1,0,1,1,1,1,2,1,1,2,1,1,1,1,0,1,2,2,2,2,2,2,2,1
00001180= 01 01 01 01 01 01 ...     74              DC.B    $1,1,1,1,1,1,1,2,1,0,1,1,1,1,2,1,1,2,1,1,1,1,0,1,2,1,1,1,1,1,1,1
000011A0= 01 00 00 00 00 00 ...     75              DC.B    $1,0,0,0,0,0,1,2,1,0,1,0,0,0,0,0,0,0,0,0,0,1,0,1,2,1,0,0,0,0,0,1
000011C0= 01 00 00 00 00 00 ...     76              DC.B    $1,0,0,0,0,0,1,2,1,0,1,0,1,1,1,0,0,1,1,1,0,1,0,1,2,1,0,0,0,0,0,1
000011E0= 01 01 01 01 01 01 ...     77              DC.B    $1,1,1,1,1,1,1,2,1,1,1,0,1,0,0,0,0,0,0,1,0,1,1,1,2,1,1,1,1,1,1,1
00001200= 04 00 00 00 00 00 ...     78              DC.B    $4,0,0,0,0,0,0,2,2,2,2,0,1,0,0,0,0,0,0,1,0,2,2,2,2,0,0,0,0,0,0,4
00001220= 01 01 01 01 01 01 ...     79              DC.B    $1,1,1,1,1,1,1,2,1,1,1,0,1,0,0,0,0,0,0,1,0,1,1,1,2,1,1,1,1,1,1,1
00001240= 01 00 00 00 00 00 ...     80              DC.B    $1,0,0,0,0,0,1,2,1,0,1,0,1,1,1,1,1,1,1,1,0,1,0,1,2,1,0,0,0,0,0,1
00001260= 01 00 00 00 00 00 ...     81              DC.B    $1,0,0,0,0,0,1,2,1,0,1,0,0,0,0,0,0,0,0,0,0,1,0,1,2,1,0,0,0,0,0,1
00001280= 01 01 01 01 01 01 ...     82              DC.B    $1,1,1,1,1,1,1,2,1,1,1,0,1,1,1,1,1,1,1,1,0,1,1,1,2,1,1,1,1,1,1,1
000012A0= 01 02 02 02 02 02 ...     83              DC.B    $1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1
000012C0= 01 02 01 01 01 01 ...     84              DC.B    $1,2,1,1,1,1,1,2,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,2,1,1,1,1,1,2,1
000012E0= 01 02 01 01 01 01 ...     85              DC.B    $1,2,1,1,1,1,1,2,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,2,1,1,1,1,1,2,1
00001300= 01 02 02 02 02 01 ...     86              DC.B    $1,2,2,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,2,2,2,1
00001320= 01 01 01 01 02 01 ...     87              DC.B    $1,1,1,1,2,1,1,2,1,1,1,2,1,1,1,1,1,1,1,1,2,1,1,1,2,1,1,2,1,1,1,1
00001340= 01 01 01 01 02 01 ...     88              DC.B    $1,1,1,1,2,1,1,2,1,0,1,2,1,1,1,1,1,1,1,1,2,1,0,1,2,1,1,2,1,1,1,1
00001360= 01 02 02 02 02 02 ...     89              DC.B    $1,2,2,2,2,2,2,2,1,0,1,2,2,2,2,1,1,2,2,2,2,1,0,1,2,2,2,2,2,2,2,1
00001380= 01 02 01 01 01 01 ...     90              DC.B    $1,2,1,1,1,1,1,1,1,0,1,1,1,1,2,1,1,2,1,1,1,1,0,1,1,1,1,1,1,1,2,1
000013A0= 01 03 01 01 01 01 ...     91              DC.B    $1,3,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,3,1
000013C0= 01 02 02 02 02 02 ...     92              DC.B    $1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1
000013E0= 01 01 01 01 01 01 ...     93              DC.B    $1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
00001400                            94              
00001400                            95  ; --- STATE RELATED CONSTANTS --------------------------------------------------
00001400                            96  
00001400  =FFFFFFFF                 97  STANONE     EQU     -1                      ; NON-EXISTENT STATE NUMBER
00001400                            98  
00001400                            99  
00001400                           100  
00001400                           101  
00001400                           102  
00001400                           103  
00001400                           104  
00001400                           105  
00001400                           106  
00001400                           107  
00001400                           108  
00001400                           109  
00001400                           110  
00001400                           111  
00001400                           112  
00001400                           113  
00001400                           114  
00001400                           115  
00001400                           116  
00001400                           117  
00001400                           118  
00001400                           119  
00001400                           120  
00001400                           121  -------------------- end include --------------------
00001400                           122              INCLUDE "GHOST.X68"
00001400                           123  ; ==============================================================================
00001400                           124  ; GHOST MANAGEMENT
00001400                           125  ; ==============================================================================
00001400                           126              
00001400                           127  ; ------------------------------------------------------------------------------
00001400                           128  GSTINIT
00001400                           129  ; INITIALIZE GHOST.
00001400                           130  ; INPUT    : NONE 
00001400                           131  ; OUTPUT   : NONE
00001400                           132  ; MODIFIES : NONE
00001400                           133  ; ------------------------------------------------------------------------------
00001400  33FC 0058 000025DC       134              MOVE.W  #GSTINX1*16+64-8,(GSTPOSX)
00001408  33FC 0058 000025DE       135              MOVE.W  #GSTINY1*16+64-8,(GSTPOSY)
00001410  33FC 0007 000025E0       136              MOVE.W  #GSTSPEED,(GSTVELX)
00001418  33FC 0007 000025E2       137              MOVE.W  #GSTSPEED,(GSTVELY)
00001420  4239 000025E5            138              CLR.B   (GSTLAMO)
00001426  4E75                     139              RTS
00001428                           140              
00001428                           141  ; ------------------------------------------------------------------------------
00001428                           142  GSTUPD
00001428                           143  ; UPDATES THE GHOST.
00001428                           144  ; INPUT    : NONE 
00001428                           145  ; OUTPUT   : NONE
00001428                           146  ; MODIFIES : NONE
00001428                           147  ; ------------------------------------------------------------------------------
00001428  48E7 F800                148              MOVEM.L D0-D4,-(A7)
0000142C                           149                          
0000142C                           150  .GSTNOTMULT
0000142C                           151  
0000142C  4CDF 001F                152              MOVEM.L (A7)+,D0-D4
00001430                           153              
00001430  4E75                     154              RTS
00001432                           155              
00001432                           156  ; ------------------------------------------------------------------------------
00001432                           157  GSTPLOT
00001432                           158  ; PLOT THE GHOST.
00001432                           159  ; INPUT    : NONE 
00001432                           160  ; OUTPUT   : NONE
00001432                           161  ; MODIFIES : NONE
00001432                           162  ; ------------------------------------------------------------------------------
00001432  48E7 F800                163              MOVEM.L D0-D4,-(A7)
00001436                           164              
00001436                           165              ;SET PEN COLOR
00001436  303C 0050                166              MOVE.W  #80,D0
0000143A  223C 000000FF            167              MOVE.L  #GSTCOL1,D1
00001440  4E4F                     168              TRAP    #15
00001442                           169              
00001442                           170              ;SET FILL COLOR
00001442  303C 0051                171              MOVE.W  #81,D0
00001446  223C 00FFFFFF            172              MOVE.L  #GSTFCOL1,D1
0000144C  4E4F                     173              TRAP    #15
0000144E                           174              
0000144E                           175              ;SET COORDS
0000144E  3239 000025DC            176              MOVE.W  (GSTPOSX),D1
00001454  5141                     177              SUB.W   #GSTRAD,D1
00001456  3439 000025DE            178              MOVE.W  (GSTPOSY),D2
0000145C  5142                     179              SUB.W   #GSTRAD,D2
0000145E                           180              
0000145E  3601                     181              MOVE.W  D1,D3
00001460  0643 0010                182              ADD.W   #GSTRAD*2,D3
00001464  3802                     183              MOVE.W  D2,D4
00001466  0644 0010                184              ADD.W   #GSTRAD*2,D4
0000146A                           185              
0000146A                           186              ;DRAW GHOST
0000146A  303C 0058                187              MOVE.W  #88,D0
0000146E  4E4F                     188              TRAP    #15
00001470                           189              
00001470                           190              ;SET RANGE COORDS
00001470  3239 000025DC            191              MOVE.W  (GSTPOSX),D1
00001476  0441 0100                192              SUB.W   #GSTRNG*16,D1
0000147A  3439 000025DE            193              MOVE.W  (GSTPOSY),D2
00001480  0442 0100                194              SUB.W   #GSTRNG*16,D2
00001484                           195              
00001484  3601                     196              MOVE.W  D1,D3
00001486  0643 0200                197              ADD.W   #GSTRNG*16*2,D3
0000148A  3802                     198              MOVE.W  D2,D4
0000148C  0644 0200                199              ADD.W   #GSTRNG*16*2,D4
00001490                           200              
00001490                           201              ;DRAW GHOST RANGE
00001490  303C 005A                202              MOVE.W  #90,D0
00001494  4E4F                     203              TRAP    #15
00001496                           204              
00001496  4CDF 001F                205              MOVEM.L (A7)+,D0-D4
0000149A                           206              
0000149A                           207  
0000149A  4E75                     208              RTS
0000149C                           209  
0000149C                           210  
0000149C                           211  
0000149C                           212  -------------------- end include --------------------
0000149C                           213              INCLUDE "PAC-MAN.X68"
0000149C                           214  ; ==============================================================================
0000149C                           215  ; PAC-MAN MANAGEMENT
0000149C                           216  ; ==============================================================================
0000149C                           217              
0000149C                           218  ; ------------------------------------------------------------------------------
0000149C                           219  PMINIT
0000149C                           220  ; INITIALIZE PAC-MAN.
0000149C                           221  ; INPUT    : NONE 
0000149C                           222  ; OUTPUT   : NONE
0000149C                           223  ; MODIFIES : NONE
0000149C                           224  ; ------------------------------------------------------------------------------
0000149C                           225  
0000149C  33FC 0140 000025D2       226              MOVE.W  #SCRWIDTH/2,(PMPOSX)
000014A4  33FC 0140 000025D4       227              MOVE.W  #SCRHEIGH/2,(PMPOSY)
000014AC  5079 000025D2            228              ADDQ.W  #8,(PMPOSX)
000014B2  5079 000025D4            229              ADDQ.W  #8,(PMPOSY)
000014B8  33FC 0002 000025D6       230              MOVE.W  #PMSPEED,(PMVELX)
000014C0  33FC 0002 000025D8       231              MOVE.W  #PMSPEED,(PMVELY)
000014C8  4239 000025DB            232              CLR.B   (PMLAMO)
000014CE                           233  
000014CE  4E75                     234              RTS
000014D0                           235              
000014D0                           236  ; ------------------------------------------------------------------------------
000014D0                           237  PMUPD
000014D0                           238  ; UPDATES THE PAC-MAN.
000014D0                           239  ; INPUT    : NONE 
000014D0                           240  ; OUTPUT   : NONE
000014D0                           241  ; MODIFIES : NONE
000014D0                           242  ; ------------------------------------------------------------------------------
000014D0                           243              
000014D0  48E7 FE00                244              MOVEM.L D0-D6,-(A7)
000014D4                           245              
000014D4  303C 0002                246              MOVE.W  #PMSPEED,D0
000014D8                           247              
000014D8                           248              
000014D8  3439 000025D2            249              MOVE.W  (PMPOSX),D2
000014DE  3639 000025D4            250              MOVE.W  (PMPOSY),D3
000014E4                           251              
000014E4  5042                     252              ADDQ.W  #8,D2              
000014E6  5043                     253              ADDQ.W  #8,D3  
000014E8                           254              
000014E8  1839 000025DB            255              MOVE.B  (PMLAMO),D4
000014EE                           256              
000014EE                           257              ;MASK OF THE LAST NIBBLE        
000014EE  C47C 000F                258              AND.W   #$000F,D2               ; COORDENADA X
000014F2  C67C 000F                259              AND.W   #$000F,D3               ; COORDENADA Y
000014F6                           260              
000014F6                           261              ;CHECK IF COORDS ARE MULTIPLES OF 16
000014F6  B47C 0000                262              CMP     #$0000,D2
000014FA  6600 00F6                263              BNE     .NOTMULT
000014FE  B67C 0000                264              CMP     #$0000,D3
00001502  6600 00EE                265              BNE     .NOTMULT
00001506                           266              
00001506                           267              ;BRA     .ACTYUP
00001506                           268  
00001506                           269              ;CHECK THE DIRECTION
00001506  0839 0000 000021CA       270              BTST.B  #0,(KBDVAL)             ;CHECK LEFT
0000150E  6700 000C                271              BEQ     .NOTLEFT
00001512  4204                     272              CLR.B   D4
00001514  183C 0000                273              MOVE.B  #0,D4
00001518  6000 0074                274              BRA     .ACTXLEFT
0000151C                           275  .NOTLEFT            
0000151C  0839 0002 000021CA       276              BTST.B   #2,(KBDVAL)             ;CHECK RIGHT
00001524  6700 000C                277              BEQ     .NOTRIGHT
00001528  4204                     278              CLR.B   D4
0000152A  183C 0001                279              MOVE.B   #1,D4
0000152E  6000 0032                280              BRA     .ACTXRIGHT
00001532                           281  .NOTRIGHT            
00001532  0839 0001 000021CA       282              BTST.B   #1,(KBDVAL)             ;CHECK UP
0000153A  6700 000C                283              BEQ     .NOTUP
0000153E  4204                     284              CLR.B   D4
00001540  183C 0002                285              MOVE.B  #2,D4
00001544  6000 0090                286              BRA     .ACTYUP
00001548                           287  .NOTUP            
00001548  0839 0003 000021CA       288              BTST.B   #3,(KBDVAL)             ;CHECK DOWN
00001550  6700 000C                289              BEQ     .NOTDOWN
00001554  4204                     290              CLR.B   D4
00001556  183C 0003                291              MOVE.B   #3,D4
0000155A  6000 005E                292              BRA     .ACTYDOWN
0000155E                           293  .NOTDOWN
0000155E  6000 00A8                294              BRA     .DONE
00001562                           295              
00001562                           296              
00001562                           297              ;UPDATE COORDS
00001562                           298              
00001562                           299  .ACTXRIGHT  
00001562  4EB9 00001978            300              JSR     COLWALLRIGHT
00001568  BA7C 0001                301              CMP     #1,D5
0000156C  6600 0006                302              BNE     .NOTCOLISION
00001570  303C 0000                303              MOVE.W  #0,D0
00001574                           304  .NOTCOLISION
00001574  BA7C 0004                305              CMP     #4,D5
00001578  6600 000A                306              BNE     .NOTTP
0000157C  0479 01E0 000025D2       307              SUB.W   #30*16,(PMPOSX)
00001584                           308  .NOTTP
00001584  D179 000025D2            309              ADD.W   D0,(PMPOSX)
0000158A  6000 007C                310              BRA     .DONE
0000158E                           311  .ACTXLEFT
0000158E  4EB9 000019BA            312              JSR     COLWALLLEFT
00001594  BA7C 0001                313              CMP     #1,D5
00001598  6600 0006                314              BNE     .NOTCOLISION2
0000159C  303C 0000                315              MOVE.W  #0,D0
000015A0                           316  .NOTCOLISION2
000015A0  BA7C 0004                317              CMP     #4,D5
000015A4  6600 000A                318              BNE     .NOTTP2
000015A8  0679 01E0 000025D2       319              ADD.W   #30*16,(PMPOSX)
000015B0                           320  .NOTTP2
000015B0  9179 000025D2            321              SUB.W   D0,(PMPOSX)
000015B6  6000 0050                322              BRA     .DONE
000015BA                           323      
000015BA                           324  .ACTYDOWN
000015BA  4EB9 000019FC            325              JSR     COLWALLDOWN
000015C0  BA7C 0001                326              CMP     #1,D5
000015C4  6600 0006                327              BNE     .NOTCOLISION3
000015C8  303C 0000                328              MOVE.W  #0,D0
000015CC                           329  .NOTCOLISION3
000015CC  D179 000025D4            330              ADD.W   D0,(PMPOSY)
000015D2  6000 0034                331              BRA     .DONE
000015D6                           332  .ACTYUP     
000015D6  4EB9 00001A38            333              JSR     COLWALLUP
000015DC  BA7C 0001                334              CMP     #1,D5
000015E0  6600 0006                335              BNE     .NOTCOLISION4
000015E4  303C 0000                336              MOVE.W  #0,D0
000015E8                           337  .NOTCOLISION4
000015E8  9179 000025D4            338              SUB.W   D0,(PMPOSY)
000015EE  6000 0018                339              BRA     .DONE
000015F2                           340              
000015F2                           341              
000015F2                           342              ;IF NOT MULT DO
000015F2                           343  .NOTMULT     
000015F2  B83C 0000                344              CMP.B     #0,D4
000015F6  6796                     345              BEQ     .ACTXLEFT
000015F8  B83C 0001                346              CMP.B     #1,D4
000015FC  6700 FF64                347              BEQ     .ACTXRIGHT
00001600  B83C 0002                348              CMP.B     #2,D4
00001604  67D0                     349              BEQ     .ACTYUP
00001606  60B2                     350              BRA     .ACTYDOWN
00001608                           351  .DONE
00001608                           352              ;RESTORE
00001608  4EB9 00001A76            353              JSR     GETPOINTS
0000160E  13C4 000025DB            354              MOVE.B  D4,(PMLAMO)
00001614                           355              
00001614  4CDF 007F                356              MOVEM.L (A7)+,D0-D6
00001618                           357              
00001618  4E75                     358              RTS
0000161A                           359                          
0000161A                           360  ; ------------------------------------------------------------------------------
0000161A                           361  PMPLOT
0000161A                           362  ; PLOT THE BALL.
0000161A                           363  ; INPUT    : NONE 
0000161A                           364  ; OUTPUT   : NONE
0000161A                           365  ; MODIFIES : NONE
0000161A                           366  ; ------------------------------------------------------------------------------
0000161A                           367  
0000161A  48E7 F800                368              MOVEM.L D0-D4,-(A7)
0000161E                           369  
0000161E                           370              ;SET PEN COLOR
0000161E  303C 0050                371              MOVE.W  #80,D0
00001622  7200                     372              MOVE.L  #$0000,D1
00001624  4E4F                     373              TRAP    #15
00001626                           374              
00001626                           375              ;SET FILL COLOR
00001626  303C 0051                376              MOVE.W  #81,D0
0000162A  223C 0000FFFF            377              MOVE.L  #PMFCOL,D1
00001630  4E4F                     378              TRAP    #15
00001632                           379              
00001632                           380              ;DRAW QUIET
00001632  4EB9 000016B4            381              JSR     .FULLDRAW
00001638  1A39 000021CA            382              MOVE.B  (KBDVAL),D5
0000163E  CA3C 000F                383              AND.B   #$0F,D5
00001642                           384  
00001642                           385              ;CHECK KBDVAL
00001642  BA3C 0001                386              CMP.B  #$1,D5             ;LEFT
00001646  6700 002E                387              BEQ     .DLEFT
0000164A  BA3C 0002                388              CMP.B  #$2,D5             ;UP
0000164E  6700 001C                389              BEQ     .DUP
00001652  BA3C 0004                390              CMP.B  #$4,D5             ;RIGHT
00001656  6700 000A                391              BEQ     .DRIGHT
0000165A  BA3C 0008                392              CMP.B  #$8,D5             ;DOWN
0000165E  6700 0020                393              BEQ     .DDOWN
00001662                           394              
00001662                           395              ;DRAW MOVEMENT
00001662                           396  .DRIGHT
00001662  4EB9 0000170A            397              JSR     .RIGHTDRAW
00001668  6000 0034                398              BRA     .DRAW_MOUTH3
0000166C                           399  .DUP
0000166C  4EB9 0000173C            400              JSR     .UPDRAW
00001672  6000 0020                401              BRA     .DRAW_MOUTH2
00001676                           402  
00001676                           403  .DLEFT
00001676  4EB9 000016D8            404              JSR     .LEFTDRAW
0000167C  6000 000C                405              BRA     .DRAW_MOUTH1
00001680                           406  
00001680                           407  .DDOWN
00001680  4EB9 0000176E            408              JSR     .DOWNDRAW
00001686  6000 0020                409              BRA     .DRAW_MOUTH4
0000168A                           410              
0000168A                           411  .DRAW_MOUTH1            
0000168A  4EB9 000017A0            412              JSR     .SET_MOUTHLEFT
00001690  6000 001C                413              BRA     .DDONE
00001694                           414  .DRAW_MOUTH2            
00001694  4EB9 000017DC            415              JSR     .SET_MOUTHUP
0000169A  6000 0012                416              BRA     .DDONE
0000169E                           417  .DRAW_MOUTH3            
0000169E  4EB9 000017BE            418              JSR     .SET_MOUTHRIGHT
000016A4  6000 0008                419              BRA     .DDONE
000016A8                           420  .DRAW_MOUTH4            
000016A8  4EB9 000017FA            421              JSR     .SET_MOUTHDOWN
000016AE                           422  .DDONE
000016AE  4CDF 001F                423              MOVEM.L (A7)+,D0-D4
000016B2                           424              
000016B2  4E75                     425              RTS
000016B4                           426  
000016B4                           427  
000016B4                           428  ;INTERNAL SUBRUTINES FOR PACMAN PLOT-------------------------------------------------------------
000016B4                           429  
000016B4                           430  .FULLDRAW
000016B4                           431              ;SET COORDS
000016B4  3239 000025D2            432              MOVE.W  (PMPOSX),D1
000016BA  5141                     433              SUB.W   #PMRAD,D1
000016BC  3439 000025D4            434              MOVE.W  (PMPOSY),D2
000016C2  5142                     435              SUB.W   #PMRAD,D2
000016C4                           436              
000016C4  3601                     437              MOVE.W  D1,D3
000016C6  0643 0010                438              ADD.W   #PMRAD*2,D3
000016CA  3802                     439              MOVE.W  D2,D4
000016CC  0644 0010                440              ADD.W   #PMRAD*2,D4
000016D0                           441              
000016D0                           442              ;DRAW PAC-MAN
000016D0  303C 0058                443              MOVE.W  #88,D0
000016D4  4E4F                     444              TRAP    #15
000016D6                           445              
000016D6  4E75                     446              RTS
000016D8                           447  .LEFTDRAW
000016D8                           448              
000016D8                           449              
000016D8  303C 0054                450              MOVE.W  #84,D0
000016DC  3239 000025D2            451              MOVE.W  (PMPOSX),D1                   ;FINAL COORD OF THE FIRST LINE
000016E2  5141                     452              SUB.W   #PMRAD,D1
000016E4  3439 000025D4            453              MOVE.W  (PMPOSY),D2
000016EA  5142                     454              SUB.W   #PMRAD,D2
000016EC                           455              
000016EC  3639 000025D2            456              MOVE.W  (PMPOSX),D3                   ;ORIGINAL COORD FIRST LINE
000016F2  3839 000025D4            457              MOVE.W  (PMPOSY),D4
000016F8                           458              
000016F8  4E4F                     459              TRAP    #15
000016FA                           460             
000016FA  303C 0055                461              MOVE.W  #85,D0                        ;DRAW SECOND LINE
000016FE                           462              
000016FE  3203                     463              MOVE.W  D3,D1
00001700  3404                     464              MOVE.W  D4,D2
00001702  5042                     465              ADD.W   #PMRAD,D2
00001704  5141                     466              SUB.W   #PMRAD,D1
00001706                           467              
00001706  4E4F                     468              TRAP    #15
00001708                           469              
00001708                           470              
00001708  4E75                     471              RTS
0000170A                           472              
0000170A                           473  .RIGHTDRAW
0000170A                           474              
0000170A                           475              
0000170A  303C 0054                476              MOVE.W  #84,D0
0000170E  3239 000025D2            477              MOVE.W  (PMPOSX),D1                   ;FINAL COORD OF THE FIRST LINE
00001714  5041                     478              ADD.W   #PMRAD,D1
00001716  3439 000025D4            479              MOVE.W  (PMPOSY),D2
0000171C  5042                     480              ADD.W   #PMRAD,D2
0000171E                           481              
0000171E  3639 000025D2            482              MOVE.W  (PMPOSX),D3                   ;ORIGINAL COORD FIRST LINE
00001724  3839 000025D4            483              MOVE.W  (PMPOSY),D4
0000172A                           484              
0000172A  4E4F                     485              TRAP    #15
0000172C                           486             
0000172C  303C 0055                487              MOVE.W  #85,D0                        ;DRAW SECOND LINE
00001730                           488              
00001730  3203                     489              MOVE.W  D3,D1
00001732  3404                     490              MOVE.W  D4,D2
00001734  5142                     491              SUB.W   #PMRAD,D2
00001736  5041                     492              ADD.W   #PMRAD,D1
00001738                           493              
00001738  4E4F                     494              TRAP    #15
0000173A                           495              
0000173A                           496              
0000173A  4E75                     497              RTS
0000173C                           498  .UPDRAW
0000173C                           499              
0000173C                           500              
0000173C  303C 0054                501              MOVE.W  #84,D0
00001740  3239 000025D2            502              MOVE.W  (PMPOSX),D1                   ;FINAL COORD OF THE FIRST LINE
00001746  5141                     503              SUB.W   #PMRAD,D1
00001748  3439 000025D4            504              MOVE.W  (PMPOSY),D2
0000174E  5142                     505              SUB.W   #PMRAD,D2
00001750                           506              
00001750  3639 000025D2            507              MOVE.W  (PMPOSX),D3                   ;ORIGINAL COORD FIRST LINE
00001756  3839 000025D4            508              MOVE.W  (PMPOSY),D4
0000175C                           509              
0000175C  4E4F                     510              TRAP    #15
0000175E                           511             
0000175E  303C 0055                512              MOVE.W  #85,D0                        ;DRAW SECOND LINE
00001762                           513              
00001762  3203                     514              MOVE.W  D3,D1
00001764  3404                     515              MOVE.W  D4,D2
00001766  5142                     516              SUB.W   #PMRAD,D2
00001768  5041                     517              ADD.W   #PMRAD,D1
0000176A                           518              
0000176A  4E4F                     519              TRAP    #15
0000176C                           520              
0000176C                           521              
0000176C  4E75                     522              RTS
0000176E                           523              
0000176E                           524  .DOWNDRAW
0000176E                           525              
0000176E                           526              
0000176E  303C 0054                527              MOVE.W  #84,D0
00001772  3239 000025D2            528              MOVE.W  (PMPOSX),D1                   ;FINAL COORD OF THE FIRST LINE
00001778  5141                     529              SUB.W   #PMRAD,D1
0000177A  3439 000025D4            530              MOVE.W  (PMPOSY),D2
00001780  5042                     531              ADD.W   #PMRAD,D2
00001782                           532              
00001782  3639 000025D2            533              MOVE.W  (PMPOSX),D3                   ;ORIGINAL COORD FIRST LINE
00001788  3839 000025D4            534              MOVE.W  (PMPOSY),D4
0000178E                           535              
0000178E  4E4F                     536              TRAP    #15
00001790                           537             
00001790  303C 0055                538              MOVE.W  #85,D0                        ;DRAW SECOND LINE
00001794                           539              
00001794  3203                     540              MOVE.W  D3,D1
00001796  3404                     541              MOVE.W  D4,D2
00001798  5042                     542              ADD.W   #PMRAD,D2
0000179A  5041                     543              ADD.W   #PMRAD,D1
0000179C                           544              
0000179C  4E4F                     545              TRAP    #15
0000179E                           546              
0000179E                           547              
0000179E  4E75                     548              RTS
000017A0                           549  
000017A0                           550              
000017A0                           551  .SET_MOUTHLEFT
000017A0                           552              
000017A0  303C 0051                553              MOVE.W  #81,D0                         ;SET BLACK
000017A4  7200                     554              MOVE.L  #$0000,D1
000017A6  4E4F                     555              TRAP    #15
000017A8                           556              
000017A8  303C 0059                557              MOVE.W  #89,D0                         ;FILL
000017AC  3239 000025D2            558              MOVE.W  (PMPOSX),D1
000017B2  5541                     559              SUBQ.W   #2,D1
000017B4  3439 000025D4            560              MOVE.W  (PMPOSY),D2
000017BA  4E4F                     561              TRAP    #15
000017BC                           562  
000017BC  4E75                     563              RTS
000017BE                           564              
000017BE                           565  .SET_MOUTHRIGHT
000017BE                           566              
000017BE  303C 0051                567              MOVE.W  #81,D0                         ;SET BLACK
000017C2  7200                     568              MOVE.L  #$0000,D1
000017C4  4E4F                     569              TRAP    #15
000017C6                           570              
000017C6  303C 0059                571              MOVE.W  #89,D0                         ;FILL
000017CA  3239 000025D2            572              MOVE.W  (PMPOSX),D1
000017D0  5441                     573              ADDQ.W   #2,D1
000017D2  3439 000025D4            574              MOVE.W  (PMPOSY),D2
000017D8  4E4F                     575              TRAP    #15
000017DA                           576  
000017DA  4E75                     577              RTS
000017DC                           578  
000017DC                           579  .SET_MOUTHUP
000017DC                           580              
000017DC  303C 0051                581              MOVE.W  #81,D0                         ;SET BLACK
000017E0  7200                     582              MOVE.L  #$0000,D1
000017E2  4E4F                     583              TRAP    #15
000017E4                           584              
000017E4  303C 0059                585              MOVE.W  #89,D0                         ;FILL
000017E8  3239 000025D2            586              MOVE.W  (PMPOSX),D1
000017EE  3439 000025D4            587              MOVE.W  (PMPOSY),D2
000017F4  5542                     588              SUBQ.W   #2,D2
000017F6  4E4F                     589              TRAP    #15
000017F8                           590  
000017F8  4E75                     591              RTS
000017FA                           592  
000017FA                           593  .SET_MOUTHDOWN
000017FA                           594              
000017FA  303C 0051                595              MOVE.W  #81,D0                         ;SET BLACK
000017FE  7200                     596              MOVE.L  #$0000,D1
00001800  4E4F                     597              TRAP    #15
00001802                           598              
00001802  303C 0059                599              MOVE.W  #89,D0                         ;FILL
00001806  3239 000025D2            600              MOVE.W  (PMPOSX),D1
0000180C  3439 000025D4            601              MOVE.W  (PMPOSY),D2
00001812  5442                     602              ADDQ.W   #2,D2
00001814  4E4F                     603              TRAP    #15
00001816                           604  
00001816  4E75                     605              RTS
00001818                           606  
00001818                           607  
00001818                           608  
00001818                           609  
00001818                           610  
00001818                           611  
00001818                           612  
00001818                           613  
00001818                           614  
00001818                           615  
00001818                           616  
00001818                           617  
00001818                           618  
00001818                           619  
00001818                           620  
00001818                           621  
00001818                           622  
00001818                           623  
00001818                           624  
00001818                           625  
00001818                           626  
00001818                           627  
00001818                           628  
00001818                           629  
00001818                           630  
00001818                           631  
00001818                           632  -------------------- end include --------------------
00001818                           633              INCLUDE "SCORE.X68"
00001818                           634  ; ==============================================================================
00001818                           635  ; SCOREBOARD MANAGEMENT
00001818                           636  ; ==============================================================================
00001818                           637              
00001818                           638  ; ------------------------------------------------------------------------------
00001818                           639  SCOINIT
00001818                           640  ; INITIALIZE SCOREBOARD
00001818                           641  ; INPUT    : NONE 
00001818                           642  ; OUTPUT   : NONE
00001818                           643  ; MODIFIES : NONE
00001818                           644  ; ------------------------------------------------------------------------------
00001818  4279 000025EA            645              CLR.W   (SCOPOINTS)
0000181E  33FC 0003 000025E8       646              MOVE.W  #3,(SCOLIFE)
00001826  4E75                     647              RTS
00001828                           648              
00001828                           649  ; ------------------------------------------------------------------------------
00001828                           650  SCOPLOT
00001828                           651  ; PLOT THE SCOREBOARD
00001828                           652  ; INPUT    : NONE 
00001828                           653  ; OUTPUT   : NONE
00001828                           654  ; MODIFIES : NONE
00001828                           655  ; ------------------------------------------------------------------------------
00001828                           656              
00001828  48E7 C040                657               MOVEM.L D0-D1/A1,-(A7)
0000182C                           658  
0000182C                           659              ; SET BACKGROUND COLOR
0000182C  103C 0051                660              MOVE.B  #81,D0
00001830  7200                     661              MOVE.L  #SCOFCOL,D1
00001832  4E4F                     662              TRAP    #15
00001834                           663              
00001834                           664              ; SET FIRST LINE POSITION
00001834  103C 000B                665              MOVE.B  #11,D0
00001838  323C 0101                666              MOVE.W  #SCOLINE1,D1
0000183C  4E4F                     667              TRAP    #15
0000183E                           668  
0000183E                           669              ; PRINT FIRST LINE
0000183E  43F9 00001876            670              LEA     .TXT1,A1            ;PUT FIRST STRING IN A1
00001844  4281                     671              CLR.L   D1
00001846  3239 000025EA            672              MOVE.W  (SCOPOINTS),D1
0000184C  103C 0011                673              MOVE.B  #17,D0
00001850  4E4F                     674              TRAP    #15
00001852                           675  
00001852                           676              ; SET SECOND LINE POSITION
00001852  103C 000B                677              MOVE.B  #11,D0
00001856  323C 0102                678              MOVE.W  #SCOLINE2,D1       
0000185A  4E4F                     679              TRAP    #15
0000185C                           680  
0000185C                           681              ; PRINT SECOND LINE
0000185C  43F9 0000187F            682              LEA     .TXT2,A1
00001862  4281                     683              CLR.L   D1
00001864  3239 000025E8            684              MOVE.W  (SCOLIFE),D1
0000186A  103C 0011                685              MOVE.B  #17,D0
0000186E  4E4F                     686              TRAP    #15
00001870                           687              
00001870  4CDF 0203                688              MOVEM.L (A7)+,D0-D1/A1
00001874                           689              
00001874  4E75                     690              RTS
00001876                           691  
00001876= 50 4F 49 4E 54 53 ...    692  .TXT1       DC.B    'POINTS :',0      ;0 IS END OF STRING
0000187F= 4C 49 46 45 53 20 ...    693  .TXT2       DC.B    'LIFES  :',0
00001888                           694  
00001888                           695  
00001888  4E75                     696              RTS
0000188A                           697  
0000188A                           698  
0000188A                           699  -------------------- end include --------------------
0000188A                           700              INCLUDE "SYSCONST.X68"
0000188A                           701  ; ==============================================================================
0000188A                           702  ; SYSTEM CONSTANTS
0000188A                           703  ; ==============================================================================
0000188A                           704  
0000188A                           705  ; --- SCREEN RELATED CONSTANTS -------------------------------------------------
0000188A                           706  
0000188A  =00000280                707  SCRWIDTH    EQU     640                     ; SCREEN WIDTH
0000188A  =00000280                708  SCRHEIGH    EQU     640                     ; SCREEN HEIGHT
0000188A                           709  
0000188A                           710  ;---KEYCODES--------------------------------------------------------------------
0000188A                           711  
0000188A  =00000025                712  KBDLEFT     EQU     $25
0000188A  =00000026                713  KBDUP       EQU     $26
0000188A  =00000027                714  KBDRIGHT    EQU     $27
0000188A  =00000028                715  KBDDOWN     EQU     $28
0000188A  =00000020                716  KBDFIRE1    EQU     ' '
0000188A  =0000004D                717  KBDFIRE2    EQU     'M'                         
0000188A  =00000010                718  KBDFIRE3    EQU     $10
0000188A  =00000050                719  KBDPAUSE    EQU     'P'
0000188A                           720  
0000188A                           721  
0000188A                           722  
0000188A                           723  
0000188A                           724  
0000188A                           725  
0000188A                           726  
0000188A                           727  
0000188A                           728  
0000188A                           729  -------------------- end include --------------------
0000188A                           730              INCLUDE "SYSTEM.X68"
0000188A                           731  ; ==============================================================================
0000188A                           732  ; SYSTEM
0000188A                           733  ; ==============================================================================
0000188A                           734              
0000188A                           735  ; ------------------------------------------------------------------------------
0000188A                           736  SYSINIT
0000188A                           737  ; INITIALIZE SYSTEM.
0000188A                           738  ; INPUT    : NONE
0000188A                           739  ; OUTPUT   : NONE
0000188A                           740  ; MODIFIES : NONE
0000188A                           741  ; ------------------------------------------------------------------------------
0000188A                           742              
0000188A  21FC 000018FA 0080       743              MOVE.L  #SCRUPD,($80+0*4)          ;INSTALL SUBRUTINE TO TRAP #0
00001892  21FC 00001930 0084       744              MOVE.L  #KBDUPD,($80+1*4)          ;INSTALL SUBRUTINE TO TRAP #1
0000189A                           745              
0000189A                           746              
0000189A  21FC 00001914 0064       747              MOVE.L  #SCRTIM,($60+1*4)          ;INSTALL INTERRUPT #1
000018A2                           748              
000018A2  4EB9 000018B6            749              JSR     SCRINIT
000018A8  4EB9 00001922            750              JSR     KBDINIT
000018AE                           751              
000018AE                           752              
000018AE  40E7                     753              MOVE.W  SR,-(A7)
000018B0  0257 D8FF                754              ANDI.W  #$D8FF,(A7)                ;BIT SUPERVISOR TO O AND INTERRPUT MASK 000 (FOR REACTIVATE INTERRUPTIONS)             
000018B4  4E73                     755              RTE
000018B6                           756     
000018B6                           757  ; ------------------------------------------------------------------------------
000018B6                           758  SCRINIT
000018B6                           759  ; INIT SCREEN. SET SCREEN RESOLUTION, SET WINDOWED MODE, CLEAR SCREEN, ENABLE BUFFER
000018B6                           760  ; ENABLE TIMED INTERRUPTION
000018B6                           761  ; INPUT    : NONE
000018B6                           762  ; OUTPUT   : NONE
000018B6                           763  ; MODIFIES : NONE
000018B6                           764  ; ------------------------------------------------------------------------------
000018B6                           765  
000018B6  48E7 C000                766              MOVEM.L D0-D1,-(A7)                 ;SAFE REGISTERS IN STACK
000018BA                           767  
000018BA                           768              ; SET SCREEN RESOLUTION
000018BA  103C 0021                769              MOVE.B  #33,D0
000018BE  223C 02800280            770              MOVE.L  #SCRWIDTH<<16|SCRHEIGH,D1
000018C4  4E4F                     771              TRAP    #15
000018C6                           772              
000018C6                           773              ; SET WINDOWED MODE
000018C6  7201                     774              MOVE.L  #1,D1
000018C8  4E4F                     775              TRAP    #15
000018CA                           776              
000018CA                           777              ; ENABLE DOUBLE BUFFER
000018CA  103C 005C                778              MOVE.B  #92,D0
000018CE  123C 0011                779              MOVE.B  #17,D1
000018D2  4E4F                     780              TRAP    #15
000018D4                           781              
000018D4                           782              ; CLEAR SCREEN
000018D4  103C 000B                783              MOVE.B  #11,D0
000018D8  323C FF00                784              MOVE.W  #$FF00,D1
000018DC  4E4F                     785              TRAP    #15
000018DE                           786              
000018DE                           787              ;ENABLE TIMED INTERRPUT
000018DE  303C 0020                788              MOVE.W  #32,D0
000018E2  123C 0006                789              MOVE.B  #6,D1
000018E6  143C 0081                790              MOVE.B  #$81,D2                   ;INDICATE THAT INTERRUPT 1 IS ACTIVATED PERIODICALLY
000018EA  7614                     791              MOVE.L  #20,D3                    ;INDICATE THE MILISECONDS FOR THAT PERIOD (20 ms == 50 FPS)
000018EC  4E4F                     792              TRAP    #15
000018EE                           793              
000018EE                           794              ;CLEAR INTERRUPT COUNTER
000018EE  4239 000021CD            795              CLR.B   (SCRINTCT)
000018F4                           796              
000018F4  4CDF 0003                797              MOVEM.L (A7)+,D0-D1               ;RESTORE REGISTERS FROM STACK
000018F8                           798              
000018F8  4E75                     799              RTS
000018FA                           800  
000018FA                           801  
000018FA                           802              
000018FA                           803  ;------------------------------------------------------------------------------            
000018FA                           804  SCRUPD
000018FA                           805  ; UPDATES DOUBLE BUFFER
000018FA                           806  ; INPUT    : NONE
000018FA                           807  ; OUTPUT   : NONE
000018FA                           808  ; MODIFIES : NONE
000018FA                           809  ; ------------------------------------------------------------------------------
000018FA                           810  
000018FA  48E7 C000                811              MOVEM.L D0-D1,-(A7)
000018FE                           812              
000018FE                           813              ;SWITCH BUFFERS
000018FE  103C 005E                814              MOVE.B #94,D0
00001902  4E4F                     815              TRAP #15
00001904                           816              
00001904                           817              ;CLEAR HIDDEN BUFFER
00001904  103C 000B                818              MOVE.B  #11,D0
00001908  323C FF00                819              MOVE.W  #$FF00,D1
0000190C  4E4F                     820              TRAP    #15
0000190E                           821              
0000190E  4CDF 0003                822              MOVEM.L (A7)+,D0-D1
00001912                           823              
00001912  4E73                     824              RTE
00001914                           825              
00001914                           826  ; ------------------------------------------------------------------------------
00001914                           827  SCRTIM
00001914                           828  ; TIMED INTERRUPT SERVICE ROUTINE
00001914                           829  ; INPUT    : NONE
00001914                           830  ; OUTPUT   : NONE
00001914                           831  ; MODIFIES : NONE
00001914                           832  ; ------------------------------------------------------------------------------
00001914  5239 000021CD            833              ADDQ.B  #1,(SCRINTCT)
0000191A  5239 000021CE            834              ADDQ.B  #1,(SCRCYCCT)
00001920  4E73                     835              RTE
00001922                           836              
00001922                           837  ;------------------------------------------------------------------------------            
00001922                           838  KBDINIT
00001922                           839  ; INIT THE KEYBOARD
00001922                           840  ; INPUT    : NONE
00001922                           841  ; OUTPUT   : NONE
00001922                           842  ; MODIFIES : NONE
00001922                           843  ; ------------------------------------------------------------------------------
00001922                           844  
00001922  4239 000021CA            845              CLR.B   (KBDVAL)
00001928  4239 000021CC            846              CLR.B   (KBDEDGE)
0000192E                           847  
0000192E  4E75                     848              RTS
00001930                           849  
00001930                           850  ;------------------------------------------------------------------------------            
00001930                           851  KBDUPD
00001930                           852  ; UPDATES KEYBOARD INFO
00001930                           853  ; 3 -> DOWN     (HEX: 8)
00001930                           854  ; 2 -> RIGHT    (HEX: 4)
00001930                           855  ; 1 -> UP       (HEX: 2)
00001930                           856  ; 0 -> LEFT     (HEX: 1)
00001930                           857  ; ------------------------------------------------------------------------------
00001930                           858              
00001930  48E7 F800                859              MOVEM.L D0-D4,-(A7)
00001934                           860              
00001934  303C 0013                861              MOVE.W  #19,D0
00001938                           862              ;GET INFO OF THE KEYS
00001938  223C 28272625            863              MOVE.L  #KBDDOWN<<24|KBDRIGHT<<16|KBDUP<<8|KBDLEFT,D1
0000193E  4E4F                     864              TRAP    #15
00001940                           865              
00001940                           866              ;CONVERT TO DESIRED FORMAT
00001940  4EB9 0000196A            867              JSR .CONVERT
00001946                           868  
00001946                           869              ;GET KBDEDGE (IF SOME KEY HAVE CHANGED THE VALUE)
00001946  1039 000021CA            870              MOVE.B  (KBDVAL),D0             ;D0 -> LAST KBDVAL
0000194C  4600                     871              NOT.B   D0                      ;D2 -> ACTUAL KBDVAL
0000194E  C002                     872              AND.B   D2,D0
00001950  13C0 000021CC            873              MOVE.B  D0,(KBDEDGE)
00001956                           874              
00001956                           875         
00001956  B03C 0000                876              CMP.B   #0,D0
0000195A  6700 0008                877              BEQ     .NOACT          
0000195E                           878              
0000195E                           879              ;STORE NEW KBDVAL
0000195E  13C2 000021CA            880              MOVE.B  D2,(KBDVAL)
00001964                           881  .NOACT
00001964                           882              
00001964  4CDF 001F                883              MOVEM.L (A7)+,D0-D4
00001968                           884              
00001968  4E73                     885              RTE    
0000196A                           886              
0000196A                           887  .CONVERT 
0000196A  363C 0003                888              MOVE.W  #3,D3
0000196E                           889              
0000196E  E189                     890  .LOOP       LSL.L   #8,D1
00001970  E312                     891              ROXL.B  #1,D2
00001972  51CB FFFA                892              DBRA.W  D3,.LOOP
00001976  4E75                     893              RTS
00001978                           894             
00001978                           895  
00001978                           896  ;------------------------------------------------------------------------------            
00001978                           897  COLWALLRIGHT
00001978                           898  ; COLLISION PAC-MAN WITH WALL
00001978                           899  ; INPUT    : NONE
00001978                           900  ; OUTPUT   : NONE
00001978                           901  ; MODIFIES : NONE
00001978                           902  ; ------------------------------------------------------------------------------
00001978                           903  
00001978  48E7 F800                904              MOVEM.L D0-D4,-(A7)
0000197C                           905  
0000197C  3039 000025D2            906              MOVE.W  (PMPOSX),D0
00001982  5140                     907              SUB.W   #8,D0
00001984  3239 000025D4            908              MOVE.W  (PMPOSY),D1
0000198A  5041                     909              ADD.W   #8,D1
0000198C                           910              
0000198C  81FC 0010                911              DIVS.W  #16,D0
00001990  83FC 0010                912              DIVS.W  #16,D1
00001994                           913              
00001994  5940                     914              SUB.W   #4,D0                   ;LI RESTAM 4 PERQUE LA MATRIU ESTA A UNA DISTANCIA DE 64 PIXELS DE LA PANTALLA
00001996  5941                     915              SUB.W   #4,D1
00001998                           916              
00001998  41F9 000021D0            917              LEA.L   MAPVAR,A0
0000199E                           918              
0000199E  5240                     919              ADD.W   #1,D0
000019A0  5341                     920              SUB.W   #1,D1
000019A2  C2FC 0020                921              MULU.W  #32,D1
000019A6  D041                     922              ADD.W   D1,D0
000019A8                           923              
000019A8  3240                     924              MOVE.W  D0,A1
000019AA  13C0 000025D0            925              MOVE.B  D0,POSCON
000019B0                           926  
000019B0  1A29 21D0                927              MOVE.B  MAPVAR(A1),D5
000019B4                           928              
000019B4  4CDF 001F                929              MOVEM.L (A7)+,D0-D4
000019B8                           930              
000019B8  4E75                     931              RTS
000019BA                           932  
000019BA                           933  
000019BA                           934  ;------------------------------------------------------------------------------            
000019BA                           935  COLWALLLEFT
000019BA                           936  ; COLLISION PAC-MAN WITH WALL
000019BA                           937  ; INPUT    : NONE
000019BA                           938  ; OUTPUT   : NONE
000019BA                           939  ; MODIFIES : NONE
000019BA                           940  ; ------------------------------------------------------------------------------
000019BA                           941  
000019BA  48E7 F800                942              MOVEM.L D0-D4,-(A7)
000019BE                           943  
000019BE  3039 000025D2            944              MOVE.W  (PMPOSX),D0
000019C4  5C40                     945              ADD.W   #6,D0
000019C6  3239 000025D4            946              MOVE.W  (PMPOSY),D1
000019CC  5041                     947              ADD.W   #8,D1
000019CE                           948              
000019CE  81FC 0010                949              DIVS.W  #16,D0
000019D2  83FC 0010                950              DIVS.W  #16,D1
000019D6                           951              
000019D6  5940                     952              SUB.W   #4,D0                   ;LI RESTAM 4 PERQUE LA MATRIU ESTA A UNA DISTANCIA DE 64 PIXELS DE LA PANTALLA
000019D8  5941                     953              SUB.W   #4,D1
000019DA                           954              
000019DA  41F9 000021D0            955              LEA.L   MAPVAR,A0
000019E0                           956              
000019E0  5340                     957              SUB.W   #1,D0
000019E2  5341                     958              SUB.W   #1,D1
000019E4  C2FC 0020                959              MULU.W  #32,D1
000019E8  D041                     960              ADD.W   D1,D0
000019EA                           961  
000019EA  3240                     962              MOVE.W  D0,A1
000019EC  13C0 000025D0            963              MOVE.B  D0,POSCON
000019F2                           964  
000019F2  1A29 21D0                965              MOVE.B  MAPVAR(A1),D5               
000019F6                           966  
000019F6                           967              
000019F6  4CDF 001F                968              MOVEM.L (A7)+,D0-D4
000019FA                           969              
000019FA  4E75                     970              RTS
000019FC                           971  
000019FC                           972  ;------------------------------------------------------------------------------            
000019FC                           973  COLWALLDOWN
000019FC                           974  ; COLLISION PAC-MAN WITH WALL
000019FC                           975  ; INPUT    : NONE
000019FC                           976  ; OUTPUT   : NONE
000019FC                           977  ; MODIFIES : NONE
000019FC                           978  ; ------------------------------------------------------------------------------
000019FC                           979  
000019FC  48E7 F800                980              MOVEM.L D0-D4,-(A7)
00001A00                           981  
00001A00  3039 000025D2            982              MOVE.W  (PMPOSX),D0
00001A06                           983              ;ADD.W   #8,D0
00001A06  3239 000025D4            984              MOVE.W  (PMPOSY),D1
00001A0C  5041                     985              ADD.W   #8,D1
00001A0E                           986              
00001A0E  81FC 0010                987              DIVS.W  #16,D0
00001A12  83FC 0010                988              DIVS.W  #16,D1
00001A16                           989              
00001A16  5940                     990              SUB.W   #4,D0                   ;LI RESTAM 4 PERQUE LA MATRIU ESTA A UNA DISTANCIA DE 64 PIXELS DE LA PANTALLA
00001A18  5941                     991              SUB.W   #4,D1
00001A1A                           992              
00001A1A  41F9 000021D0            993              LEA.L   MAPVAR,A0
00001A20                           994              
00001A20  C2FC 0020                995              MULU.W  #32,D1
00001A24  D041                     996              ADD.W   D1,D0
00001A26                           997  
00001A26  3240                     998              MOVE.W  D0,A1
00001A28  13C0 000025D0            999              MOVE.B  D0,POSCON
00001A2E                          1000  
00001A2E  1A29 21D0               1001              MOVE.B  MAPVAR(A1),D5 
00001A32                          1002  
00001A32                          1003              
00001A32  4CDF 001F               1004              MOVEM.L (A7)+,D0-D4
00001A36                          1005              
00001A36  4E75                    1006              RTS
00001A38                          1007  
00001A38                          1008  
00001A38                          1009  ;------------------------------------------------------------------------------            
00001A38                          1010  COLWALLUP
00001A38                          1011  ; COLLISION PAC-MAN WITH WALL
00001A38                          1012  ; INPUT    : NONE
00001A38                          1013  ; OUTPUT   : NONE
00001A38                          1014  ; MODIFIES : NONE
00001A38                          1015  ; ------------------------------------------------------------------------------
00001A38                          1016  
00001A38  48E7 F800               1017              MOVEM.L D0-D4,-(A7)
00001A3C                          1018  
00001A3C  3039 000025D2           1019              MOVE.W  (PMPOSX),D0
00001A42                          1020              ;SUB.W   #8,D0
00001A42  3239 000025D4           1021              MOVE.W  (PMPOSY),D1
00001A48  5C41                    1022              ADD.W   #6,D1
00001A4A                          1023              
00001A4A                          1024              
00001A4A  81FC 0010               1025              DIVS.W  #16,D0
00001A4E  83FC 0010               1026              DIVS.W  #16,D1
00001A52                          1027              
00001A52  5940                    1028              SUB.W   #4,D0                   ;LI RESTAM 4 PERQUE LA MATRIU ESTA A UNA DISTANCIA DE 64 PIXELS DE LA PANTALLA
00001A54  5941                    1029              SUB.W   #4,D1
00001A56                          1030              
00001A56  41F9 000021D0           1031              LEA.L   MAPVAR,A0
00001A5C                          1032              
00001A5C  5341                    1033              SUB.W   #1,D1
00001A5E                          1034              ;CMP     #1,D1
00001A5E                          1035              ;BLO     BUCLE4
00001A5E  C2FC 0020               1036              MULU.W  #32,D1
00001A62  D041                    1037              ADD.W   D1,D0
00001A64                          1038  
00001A64                          1039  ;BUCLE4            
00001A64  3240                    1040              MOVE.W  D0,A1
00001A66  13C0 000025D0           1041              MOVE.B  D0,POSCON
00001A6C                          1042  
00001A6C  1A29 21D0               1043              MOVE.B  MAPVAR(A1),D5 
00001A70                          1044  
00001A70                          1045              ;MOVE.B  #0,D5
00001A70                          1046              
00001A70  4CDF 001F               1047              MOVEM.L (A7)+,D0-D4
00001A74                          1048              
00001A74  4E75                    1049              RTS
00001A76                          1050  
00001A76                          1051  
00001A76                          1052  ;------------------------------------------------------------------------------            
00001A76                          1053  GETPOINTS
00001A76                          1054  ; COLLISION PAC-MAN WITH WALL
00001A76                          1055  ; INPUT    : NONE
00001A76                          1056  ; OUTPUT   : NONE
00001A76                          1057  ; MODIFIES : NONE
00001A76                          1058  ; ------------------------------------------------------------------------------
00001A76                          1059  
00001A76  48E7 F800               1060              MOVEM.L D0-D4,-(A7)
00001A7A                          1061  
00001A7A  3039 000025D2           1062              MOVE.W  (PMPOSX),D0
00001A80                          1063              ;SUB.W   #8,D0
00001A80  3239 000025D4           1064              MOVE.W  (PMPOSY),D1
00001A86  0641 0010               1065              ADD.W   #16,D1
00001A8A                          1066              
00001A8A                          1067              
00001A8A  81FC 0010               1068              DIVS.W  #16,D0
00001A8E  83FC 0010               1069              DIVS.W  #16,D1
00001A92                          1070              
00001A92  5940                    1071              SUB.W   #4,D0                   ;LI RESTAM 4 PERQUE LA MATRIU ESTA A UNA DISTANCIA DE 64 PIXELS DE LA PANTALLA
00001A94  5941                    1072              SUB.W   #4,D1
00001A96                          1073                          
00001A96  5341                    1074              SUB.W   #1,D1
00001A98  C2FC 0020               1075              MULU.W  #32,D1
00001A9C  D041                    1076              ADD.W   D1,D0
00001A9E                          1077  
00001A9E  3240                    1078              MOVE.W  D0,A1
00001AA0  1A29 21D0               1079              MOVE.B  MAPVAR(A1),D5
00001AA4                          1080              
00001AA4  BA7C 0000               1081              CMP     #0,D5
00001AA8  6700 003A               1082              BEQ     .DONE
00001AAC  BA7C 0002               1083              CMP     #2,D5
00001AB0  6700 0020               1084              BEQ     .POINT
00001AB4  BA7C 0003               1085              CMP     #3,D5
00001AB8  6700 0006               1086              BEQ     .BPOINT
00001ABC  6600 0026               1087              BNE     .DONE
00001AC0                          1088  .BPOINT
00001AC0  137C 0000 21D0          1089              MOVE.B  #0,MAPVAR(A1)
00001AC6  0679 0032 000025EA      1090              ADD.W   #50,(SCOPOINTS)
00001ACE  6600 0014               1091              BNE     .DONE
00001AD2                          1092  .POINT
00001AD2  137C 0000 21D0          1093              MOVE.B  #0,MAPVAR(A1)
00001AD8  0679 000A 000025EA      1094              ADD.W   #10,(SCOPOINTS)
00001AE0  6600 0002               1095              BNE     .DONE            
00001AE4                          1096  .DONE                        
00001AE4  4CDF 001F               1097              MOVEM.L (A7)+,D0-D4
00001AE8                          1098              
00001AE8  4E75                    1099              RTS
00001AEA                          1100  
00001AEA                          1101  
00001AEA                          1102  
00001AEA                          1103  
00001AEA                          1104  -------------------- end include --------------------
00001AEA                          1105              INCLUDE "MAP.X68"
00001AEA                          1106  
00001AEA                          1107  ; ------------------------------------------------------------------------------
00001AEA                          1108  MAPINIT
00001AEA                          1109  ; INIT MAP
00001AEA                          1110  ; INPUT    : NONE
00001AEA                          1111  ; OUTPUT   : NONE
00001AEA                          1112  ; MODIFIES : NONE
00001AEA                          1113  ; ------------------------------------------------------------------------------            
00001AEA                          1114              
00001AEA                          1115              ;MOVE.L  #DIBFIGWALL,($80+2*4)          ;INSTALL SUBRUTINE TO TRAP #2
00001AEA                          1116              ;MOVE.L  #DIBFIGPOINT,($80+3*4)          ;INSTALL SUBRUTINE TO TRAP #3
00001AEA                          1117              ;MOVE.L  #DIBFIGBPOINT,($80+4*4)          ;INSTALL SUBRUTINE TO TRAP #4
00001AEA                          1118              
00001AEA  48E7 FE00               1119              MOVEM.L D0-D6,-(A7)
00001AEE  48E7 00C0               1120              MOVEM.L A0-A1,-(A7)
00001AF2                          1121              
00001AF2  41F8 1000               1122              LEA.L   MAPMAT,A0
00001AF6  43F9 000021D0           1123              LEA.L   MAPVAR,A1
00001AFC  3C3C 0030               1124              MOVE.W  #48,D6
00001B00  343C 001F               1125              MOVE.W  #31,D2
00001B04                          1126  BUCLE_FILA
00001B04  3A3C 0030               1127              MOVE.W  #48,D5
00001B08  323C 001F               1128              MOVE.W  #31,D1
00001B0C  0646 0010               1129              ADD.W   #16,D6
00001B10                          1130  
00001B10                          1131  BUCLE_COLUMNA
00001B10  0645 0010               1132              ADD.W   #16,D5
00001B14                          1133  
00001B14  1018                    1134              MOVE.B  (A0)+,D0
00001B16  12C0                    1135              MOVE.B  D0,(A1)+
00001B18                          1136               
00001B18  B07C 0000               1137              CMP     #0,D0
00001B1C  6700 0034               1138              BEQ     ZERO
00001B20  B07C 0004               1139              CMP     #4,D0
00001B24  6700 002C               1140              BEQ     ZERO
00001B28  B07C 0001               1141              CMP     #1,D0
00001B2C  6600 0008               1142              BNE     NOTWALL
00001B30  4EB9 00001BD8           1143              JSR     DIBFIGWALL
00001B36                          1144  NOTWALL
00001B36  B07C 0002               1145              CMP     #2,D0
00001B3A  6600 0008               1146              BNE     NOTPOINT
00001B3E  4EB9 00001C10           1147              JSR     DIBFIGPOINT
00001B44                          1148  NOTPOINT
00001B44  B07C 0003               1149              CMP     #3,D0
00001B48  6600 0008               1150              BNE     ZERO
00001B4C  4EB9 00001C4C           1151              JSR     DIBFIGBPOINT
00001B52                          1152           
00001B52                          1153  ZERO
00001B52  51C9 FFBC               1154              DBRA    D1,BUCLE_COLUMNA  
00001B56  51CA FFAC               1155              DBRA    D2,BUCLE_FILA
00001B5A                          1156              
00001B5A  4CDF 0300               1157              MOVEM.L (A7)+,A0-A1
00001B5E  4CDF 007F               1158              MOVEM.L (A7)+,D0-D6
00001B62                          1159  
00001B62                          1160  
00001B62                          1161              
00001B62  4E75                    1162              RTS            
00001B64                          1163  
00001B64                          1164  ; ------------------------------------------------------------------------------
00001B64                          1165  MAPPLOT
00001B64                          1166  ; INIT MAP
00001B64                          1167  ; INPUT    : NONE
00001B64                          1168  ; OUTPUT   : NONE
00001B64                          1169  ; MODIFIES : NONE
00001B64                          1170  ; ------------------------------------------------------------------------------            
00001B64                          1171  
00001B64  48E7 FE00               1172              MOVEM.L D0-D6,-(A7)
00001B68  48E7 0080               1173              MOVEM.L A0,-(A7)
00001B6C                          1174  
00001B6C  41F9 000021D0           1175              LEA.L   MAPVAR,A0
00001B72  3C3C 0030               1176              MOVE.W  #48,D6
00001B76  343C 001F               1177              MOVE.W  #31,D2
00001B7A                          1178  BUCLE_FILA2
00001B7A  3A3C 0030               1179              MOVE.W  #48,D5
00001B7E  323C 001F               1180              MOVE.W  #31,D1
00001B82  0646 0010               1181              ADD.W   #16,D6
00001B86                          1182  
00001B86                          1183  BUCLE_COLUMNA2
00001B86  0645 0010               1184              ADD.W   #16,D5       
00001B8A                          1185  
00001B8A  1018                    1186              MOVE.B  (A0)+,D0
00001B8C                          1187  
00001B8C  B07C 0000               1188              CMP     #0,D0
00001B90  6700 0034               1189              BEQ     ZERO2
00001B94  B07C 0004               1190              CMP     #4,D0
00001B98  6700 002C               1191              BEQ     ZERO2
00001B9C  B07C 0001               1192              CMP     #1,D0
00001BA0  6600 0008               1193              BNE     NOTWALL2
00001BA4  4EB9 00001BD8           1194              JSR     DIBFIGWALL
00001BAA                          1195  NOTWALL2
00001BAA  B07C 0002               1196              CMP     #2,D0
00001BAE  6600 0008               1197              BNE     NOTPOINT2
00001BB2  4EB9 00001C10           1198              JSR     DIBFIGPOINT
00001BB8                          1199  NOTPOINT2
00001BB8  B07C 0003               1200              CMP     #3,D0
00001BBC  6600 0008               1201              BNE     ZERO2
00001BC0  4EB9 00001C4C           1202              JSR     DIBFIGBPOINT
00001BC6                          1203  
00001BC6                          1204     
00001BC6                          1205  ZERO2
00001BC6  51C9 FFBE               1206              DBRA    D1,BUCLE_COLUMNA2
00001BCA                          1207              
00001BCA  51CA FFAE               1208              DBRA    D2,BUCLE_FILA2
00001BCE                          1209              
00001BCE  4CDF 0100               1210              MOVEM.L (A7)+,A0
00001BD2  4CDF 007F               1211              MOVEM.L (A7)+,D0-D6
00001BD6                          1212              
00001BD6                          1213              
00001BD6  4E75                    1214              RTS 
00001BD8                          1215              
00001BD8                          1216  ; -----------------------------------------------------------------------------
00001BD8                          1217  DIBFIGWALL
00001BD8                          1218  ; SUBRUTINE DRAW MAP
00001BD8                          1219  ; INPUT    : D5=POSITION X, D6=POSITION Y
00001BD8                          1220  ; OUTPUT   : NONE
00001BD8                          1221  ; MODIFIES : NONE
00001BD8                          1222  ; -----------------------------------------------------------------------------
00001BD8  48E7 FE00               1223              MOVEM.L D0-D6,-(A7)
00001BDC                          1224              ; SET CONTOURN COLOR
00001BDC  103C 0050               1225              MOVE.B  #80,D0
00001BE0  223C 00AA0000           1226              MOVE.L  #$00AA0000,D1
00001BE6  4E4F                    1227              TRAP    #15
00001BE8                          1228              
00001BE8                          1229              ; SET FILL COLOR
00001BE8  103C 0051               1230              MOVE.B  #81,D0
00001BEC  223C 00FF0000           1231              MOVE.L  #$00FF0000,D1
00001BF2  4E4F                    1232              TRAP    #15
00001BF4                          1233              
00001BF4                          1234              ; DEFINE COORDINATES RECTANGLE
00001BF4  3205                    1235              MOVE.W  D5,D1
00001BF6  3406                    1236              MOVE.W  D6,D2
00001BF8  0645 0010               1237              ADD.W   #16,D5
00001BFC  0646 0010               1238              ADD.W   #16,D6
00001C00  3605                    1239              MOVE.W  D5,D3
00001C02  3806                    1240              MOVE.W  D6,D4
00001C04                          1241              
00001C04                          1242              ; DRAW RECTANGLE
00001C04  103C 0057               1243              MOVE.B  #87,D0
00001C08  4E4F                    1244              TRAP    #15
00001C0A                          1245              
00001C0A  4CDF 007F               1246              MOVEM.L (A7)+,D0-D6
00001C0E                          1247  
00001C0E  4E75                    1248              RTS
00001C10                          1249              
00001C10                          1250  ; -----------------------------------------------------------------------------
00001C10                          1251  DIBFIGPOINT
00001C10                          1252  ; SUBRUTINE DRAW MAP
00001C10                          1253  ; INPUT    : D5=POSITION X, D6=POSITION Y
00001C10                          1254  ; OUTPUT   : NONE
00001C10                          1255  ; MODIFIES : NONE
00001C10                          1256  ; -----------------------------------------------------------------------------
00001C10  48E7 FE00               1257              MOVEM.L D0-D6,-(A7)
00001C14                          1258              ; SET CONTOURN COLOR
00001C14  103C 0050               1259              MOVE.B  #80,D0
00001C18  223C 0000AAAA           1260              MOVE.L  #$0000AAAA,D1
00001C1E  4E4F                    1261              TRAP    #15
00001C20                          1262              
00001C20                          1263              ; SET FILL COLOR
00001C20  103C 0051               1264              MOVE.B  #81,D0
00001C24  223C 0000FFFF           1265              MOVE.L  #$0000FFFF,D1
00001C2A  4E4F                    1266              TRAP    #15
00001C2C                          1267              
00001C2C                          1268              ; DEFINE COORDINATES RECTANGLE
00001C2C  3205                    1269              MOVE.W  D5,D1
00001C2E  5041                    1270              ADD.W   #8,D1
00001C30  5541                    1271              SUB.W   #2,D1
00001C32  3406                    1272              MOVE.W  D6,D2
00001C34  5042                    1273              ADD.W   #8,D2
00001C36  5542                    1274              SUB.W   #2,D2
00001C38                          1275              
00001C38  3601                    1276              MOVE.W  D1,D3
00001C3A  5843                    1277              ADD.W   #2*2,D3
00001C3C  3802                    1278              MOVE.W  D2,D4
00001C3E  5844                    1279              ADD.W   #2*2,D4
00001C40                          1280              
00001C40                          1281              ; DRAW POINT
00001C40  103C 0058               1282              MOVE.B  #88,D0
00001C44  4E4F                    1283              TRAP    #15
00001C46                          1284              
00001C46  4CDF 007F               1285              MOVEM.L (A7)+,D0-D6
00001C4A                          1286              
00001C4A  4E75                    1287              RTS
00001C4C                          1288  
00001C4C                          1289  
00001C4C                          1290  ; -----------------------------------------------------------------------------
00001C4C                          1291  DIBFIGBPOINT
00001C4C                          1292  ; SUBRUTINE DRAW MAP
00001C4C                          1293  ; INPUT    : D5=POSITION X, D6=POSITION Y
00001C4C                          1294  ; OUTPUT   : NONE
00001C4C                          1295  ; MODIFIES : NONE
00001C4C                          1296  ; -----------------------------------------------------------------------------
00001C4C  48E7 FE00               1297              MOVEM.L D0-D6,-(A7)
00001C50                          1298              ; SET CONTOURN COLOR
00001C50  103C 0050               1299              MOVE.B  #80,D0
00001C54  223C 0000AAAA           1300              MOVE.L  #$0000AAAA,D1
00001C5A  4E4F                    1301              TRAP    #15
00001C5C                          1302              
00001C5C                          1303              ; SET FILL COLOR
00001C5C  103C 0051               1304              MOVE.B  #81,D0
00001C60  223C 0000FFFF           1305              MOVE.L  #$0000FFFF,D1
00001C66  4E4F                    1306              TRAP    #15
00001C68                          1307              
00001C68                          1308              ; DEFINE COORDINATES RECTANGLE
00001C68  3205                    1309              MOVE.W  D5,D1
00001C6A  5041                    1310              ADD.W   #8,D1
00001C6C  5941                    1311              SUB.W   #4,D1
00001C6E  3406                    1312              MOVE.W  D6,D2
00001C70  5042                    1313              ADD.W   #8,D2
00001C72  5942                    1314              SUB.W   #4,D2
00001C74                          1315              
00001C74  3601                    1316              MOVE.W  D1,D3
00001C76  5043                    1317              ADD.W   #4*2,D3
00001C78  3802                    1318              MOVE.W  D2,D4
00001C7A  5044                    1319              ADD.W   #4*2,D4
00001C7C                          1320              
00001C7C                          1321              ; DRAW BIG POINT
00001C7C  103C 0058               1322              MOVE.B  #88,D0
00001C80  4E4F                    1323              TRAP    #15
00001C82                          1324              
00001C82  4CDF 007F               1325              MOVEM.L (A7)+,D0-D6
00001C86                          1326              
00001C86  4E75                    1327              RTS
00001C88                          1328  
00001C88                          1329  
00001C88                          1330  
00001C88                          1331  
00001C88                          1332  
00001C88                          1333  
00001C88                          1334  
00001C88                          1335  
00001C88                          1336  
00001C88                          1337  
00001C88                          1338  
00001C88                          1339  
00001C88                          1340  -------------------- end include --------------------
00001C88                          1341              INCLUDE "LIB/UTLCONST.X68"
00001C88                          1342  ; ==============================================================================
00001C88                          1343  ; UTIL CONSTANTS
00001C88                          1344  ; ==============================================================================
00001C88                          1345  
00001C88  =00000008               1346  UTLCHRWD    EQU     8                       ; CHARACTER WIDTH IN PIXELS
00001C88                          1347  
00001C88                          1348  -------------------- end include --------------------
00001C88                          1349              INCLUDE "LIB/UTLCODE.X68"
00001C88                          1350  ; =============================================================================
00001C88                          1351  ; UTILITY CODE
00001C88                          1352  ; =============================================================================
00001C88                          1353  
00001C88                          1354  ; -----------------------------------------------------------------------------
00001C88                          1355  UTLINIT
00001C88                          1356  ; INITIALIZES UTILITY CODE
00001C88                          1357  ; INPUT    - NONE
00001C88                          1358  ; OUTPUT   - NONE
00001C88                          1359  ; MODIFIES - NONE
00001C88                          1360  ; -----------------------------------------------------------------------------
00001C88  48E7 C000               1361              MOVEM.L D0-D1,-(A7)
00001C8C  103C 0008               1362              MOVE.B  #8,D0
00001C90  4E4F                    1363              TRAP    #15
00001C92  13C1 000025F2           1364              MOVE.B  D1,(UTLRNDIX)
00001C98  4CDF 0003               1365              MOVEM.L (A7)+,D0-D1
00001C9C  4E75                    1366              RTS
00001C9E                          1367  
00001C9E                          1368  ; -----------------------------------------------------------------------------
00001C9E                          1369  UTLPRINT
00001C9E                          1370  ; PRINT SCREEN CENTERED TEXT
00001C9E                          1371  ; INPUT    : A0 POINTER TO ZERO-TERMINATED STRING
00001C9E                          1372  ;            D0.B SCREEN ROW TO PRINT TEXT
00001C9E                          1373  ; OUTPUT   : D0.B NEXT ROW
00001C9E                          1374  ; MODIFIES : NONE (ASIDE OF OUTPUT)
00001C9E                          1375  ; -----------------------------------------------------------------------------
00001C9E  48E7 C0C0               1376              MOVEM.L D0-D1/A0-A1,-(A7)
00001CA2  4201                    1377              CLR.B   D1
00001CA4  2248                    1378              MOVE.L  A0,A1
00001CA6  4A18                    1379  .LOOP       TST.B   (A0)+
00001CA8  6700 0006               1380              BEQ     .ENDLOOP
00001CAC  5201                    1381              ADDQ.B  #1,D1
00001CAE  60F6                    1382              BRA     .LOOP
00001CB0  E209                    1383  .ENDLOOP    LSR.B   #1,D1
00001CB2  0401 0028               1384              SUB.B   #(SCRWIDTH/UTLCHRWD)/2,D1
00001CB6  4401                    1385              NEG.B   D1
00001CB8  E141                    1386              ASL.W   #8,D1
00001CBA  8240                    1387              OR.W    D0,D1
00001CBC  103C 000B               1388              MOVE.B  #11,D0
00001CC0  4E4F                    1389              TRAP    #15
00001CC2  103C 000D               1390              MOVE.B  #13,D0
00001CC6  4E4F                    1391              TRAP    #15
00001CC8  4CDF 0303               1392              MOVEM.L (A7)+,D0-D1/A0-A1
00001CCC  5200                    1393              ADDQ.B  #1,D0
00001CCE  4E75                    1394              RTS
00001CD0                          1395              
00001CD0                          1396              
00001CD0                          1397  
00001CD0                          1398  
00001CD0                          1399              ; (SCRWIDTH/UTLCHRWD)/2 - D1/2
00001CD0                          1400  
00001CD0                          1401  
00001CD0                          1402  ; -----------------------------------------------------------------------------
00001CD0                          1403  UTLRAND
00001CD0                          1404  ; PROVIDES A PSEUDO-RANDOM BYTE
00001CD0                          1405  ; INPUT    - NONE
00001CD0                          1406  ; OUTPUT   - D0.L RANDOM VALUE (ONLY BYTE)
00001CD0                          1407  ; MODIFIES - NONE (ASIDE OF OUTPUT)
00001CD0                          1408  ; -----------------------------------------------------------------------------
00001CD0  2F08                    1409              MOVE.L  A0,-(A7)
00001CD2  41F9 00001CEE           1410              LEA     .RANDVEC,A0
00001CD8  4280                    1411              CLR.L   D0
00001CDA  1039 000025F2           1412              MOVE.B  (UTLRNDIX),D0
00001CE0  1030 0800               1413              MOVE.B  (A0,D0.L),D0
00001CE4  5239 000025F2           1414              ADDQ.B  #1,(UTLRNDIX)
00001CEA  205F                    1415              MOVE.L  (A7)+,A0
00001CEC  4E75                    1416              RTS
00001CEE                          1417  
00001CEE                          1418  
00001CEE= A2 EE 9A 0C F5 24 ...   1419  .RANDVEC    DC.B    162, 238, 154, 12 , 245, 36 , 32 , 103
00001CF6= 2A A3 51 26 E0 AC ...   1420              DC.B    42 , 163, 81 , 38 , 224, 172, 19 , 69
00001CFE= 75 51 CA FD 33 EB ...   1421              DC.B    117, 81 , 202, 253, 51 , 235, 108, 154
00001D06= 60 CC E7 B8 9A EB ...   1422              DC.B    96 , 204, 231, 184, 154, 235, 34 , 203
00001D0E= 1D 76 B5 95 B0 89 ...   1423              DC.B    29 , 118, 181, 149, 176, 137, 62 , 108
00001D16= 39 15 48 C9 6E CA ...   1424              DC.B    57 , 21 , 72 , 201, 110, 202, 159, 41
00001D1E= 43 E7 E2 7C 37 25 ...   1425              DC.B    67 , 231, 226, 124, 55 , 37 , 84 , 62
00001D26= E9 94 CE E9 E4 52 ...   1426              DC.B    233, 148, 206, 233, 228, 82 , 243, 78
00001D2E= 37 6D 9A 84 A2 28 ...   1427              DC.B    55 , 109, 154, 132, 162, 40 , 30 , 39
00001D36= 19 E2 C6 77 80 D4 ...   1428              DC.B    25 , 226, 198, 119, 128, 212, 232, 225
00001D3E= 0A 5A 32 67 33 C2 ...   1429              DC.B    10 , 90 , 50 , 103, 51 , 194, 222, 40
00001D46= 59 80 DC 0E 57 FC ...   1430              DC.B    89 , 128, 220, 14 , 87 , 252, 243, 252
00001D4E= 8A AB BC F7 07 4D ...   1431              DC.B    138, 171, 188, 247, 7  , 77 , 29 , 234
00001D56= EF D5 77 6E 1E BB ...   1432              DC.B    239, 213, 119, 110, 30 , 187, 131, 23
00001D5E= D6 E0 2A 8F BD 28 ...   1433              DC.B    214, 224, 42 , 143, 189, 40 , 212, 130
00001D66= 13 4F 66 EC 0A 64 ...   1434              DC.B    19 , 79 , 102, 236, 10 , 100, 122, 188
00001D6E= 56 52 9A 16 9B 90 ...   1435              DC.B    86 , 82 , 154, 22 , 155, 144, 7  , 199
00001D76= 06 8A A4 F7 01 DA ...   1436              DC.B    6  , 138, 164, 247, 1  , 218, 166, 82
00001D7E= F2 E7 77 28 B1 76 ...   1437              DC.B    242, 231, 119, 40 , 177, 118, 220, 102
00001D86= A4 42 E3 81 B1 67 ...   1438              DC.B    164, 66 , 227, 129, 177, 103, 165, 108
00001D8E= BF CE FA 16 BF 38 ...   1439              DC.B    191, 206, 250, 22 , 191, 56 , 30 , 161
00001D96= D1 8B 50 0C 5F 49 ...   1440              DC.B    209, 139, 80 , 12 , 95 , 73 , 168, 56
00001D9E= DE 4C 14 A2 40 DC ...   1441              DC.B    222, 76 , 20 , 162, 64 , 220, 93 , 12
00001DA6= B6 9B 0A 38 5D AB ...   1442              DC.B    182, 155, 10 , 56 , 93 , 171, 89 , 6
00001DAE= E2 1B DD 75 15 82 ...   1443              DC.B    226, 27 , 221, 117, 21 , 130, 101, 18
00001DB6= 8A 26 51 30 9F 47 ...   1444              DC.B    138, 38 , 81 , 48 , 159, 71 , 57 , 21
00001DBE= 1E 8A BB 71 C6 6E ...   1445              DC.B    30 , 138, 187, 113, 198, 110, 185, 152
00001DC6= 9F 47 E5 34 94 27 ...   1446              DC.B    159, 71 , 229, 52 , 148, 39 , 77 , 6
00001DCE= 7D 06 D6 BA 30 0F ...   1447              DC.B    125, 6  , 214, 186, 48 , 15 , 212, 22
00001DD6= EC 7F 7E 03 CF 2D ...   1448              DC.B    236, 127, 126, 3  , 207, 45 , 193, 2
00001DDE= 94 5B 23 F2 8B CD ...   1449              DC.B    148, 91 , 35 , 242, 139, 205, 248, 237
00001DE6= 74 33 EC B9 0F D5 ...   1450              DC.B    116, 51 , 236, 185, 15 , 213, 221, 6
00001DEE                          1451  
00001DEE                          1452  
00001DEE                          1453  
00001DEE                          1454  
00001DEE                          1455  -------------------- end include --------------------
00001DEE                          1456              INCLUDE "INTRO.X68"
00001DEE                          1457  ; ==============================================================================
00001DEE                          1458  ; INTRO SCREEN
00001DEE                          1459  ; ==============================================================================
00001DEE                          1460  
00001DEE                          1461  ; ------------------------------------------------------------------------------
00001DEE                          1462  ISCINIT
00001DEE                          1463  ; INTRO SCREEN INIT
00001DEE                          1464  ; INPUT    : NONE
00001DEE                          1465  ; OUTPUT   : NONE
00001DEE                          1466  ; MODIFIES : NONE
00001DEE                          1467  ; ------------------------------------------------------------------------------
00001DEE  4279 000025EC           1468              CLR.W   (ISCTIMER)
00001DF4  4E75                    1469              RTS
00001DF6                          1470  
00001DF6                          1471  ; ------------------------------------------------------------------------------
00001DF6                          1472  ISCUPD
00001DF6                          1473  ; INTRO SCREEN UPDATE
00001DF6                          1474  ; INPUT    : NONE
00001DF6                          1475  ; OUTPUT   : NONE
00001DF6                          1476  ; MODIFIES : NONE
00001DF6                          1477  ; ------------------------------------------------------------------------------
00001DF6  0839 0004 000021CC      1478              BTST.B  #4,(KBDEDGE)
00001DFE  6700 000A               1479              BEQ     .CONT
00001E02  33FC 0002 000025F0      1480              MOVE.W  #2,(STANEXT)
00001E0A  5279 000025EC           1481  .CONT       ADDQ.W  #1,(ISCTIMER)
00001E10  0C79 01F4 000025EC      1482              CMP.W   #500,(ISCTIMER)
00001E18  6D00 000A               1483              BLT     .DONE
00001E1C  33FC 0001 000025F0      1484              MOVE.W  #1,(STANEXT)
00001E24  4E75                    1485  .DONE       RTS
00001E26                          1486  
00001E26                          1487  ; ------------------------------------------------------------------------------
00001E26                          1488  ISCPLOT
00001E26                          1489  ; INTRO SCREEN PLOT
00001E26                          1490  ; INPUT    : NONE
00001E26                          1491  ; OUTPUT   : NONE
00001E26                          1492  ; MODIFIES : NONE
00001E26                          1493  ; ------------------------------------------------------------------------------
00001E26  48E7 C080               1494              MOVEM.L D0-D1/A0,-(A7)
00001E2A                          1495              
00001E2A  4281                    1496              CLR.L   D1
00001E2C  103C 0051               1497              MOVE.B  #81,D0
00001E30  4E4F                    1498              TRAP    #15
00001E32                          1499              
00001E32  41F9 00001E60           1500              LEA     .TXT1,A0
00001E38  103C 000A               1501              MOVE.B  #10,D0
00001E3C  4EB8 1C9E               1502              JSR     UTLPRINT
00001E40                          1503              
00001E40  0839 0004 000021CE      1504              BTST.B  #4,(SCRCYCCT)
00001E48  6700 0010               1505              BEQ     .DONE
00001E4C                          1506              
00001E4C  41F9 00001E6E           1507              LEA     .TXT2,A0
00001E52  103C 0019               1508              MOVE.B  #25,D0
00001E56  4EB8 1C9E               1509              JSR     UTLPRINT
00001E5A                          1510              
00001E5A  4CDF 0103               1511  .DONE       MOVEM.L (A7)+,D0-D1/A0
00001E5E                          1512  
00001E5E  4E75                    1513              RTS
00001E60= 50 41 43 2D 4D 41 ...   1514  .TXT1       DC.B    'PAC-MAN 68000',0
00001E6E= 50 52 45 53 53 20 ...   1515  .TXT2       DC.B    'PRESS FIRE1 TO START',0
00001E84                          1516              DS.W    0
00001E84                          1517  
00001E84                          1518  
00001E84                          1519  
00001E84                          1520  
00001E84                          1521  
00001E84                          1522  
00001E84                          1523  -------------------- end include --------------------
00001E84                          1524              INCLUDE "INSTRUCTIONS.X68"
00001E84                          1525  ; ==============================================================================
00001E84                          1526  ; INSTRUCTIONS SCREEN
00001E84                          1527  ; ==============================================================================
00001E84                          1528  
00001E84                          1529  ; ------------------------------------------------------------------------------
00001E84                          1530  INSINIT
00001E84                          1531  ; INSTRUCTIONS SCREEN INIT
00001E84                          1532  ; INPUT    : NONE
00001E84                          1533  ; OUTPUT   : NONE
00001E84                          1534  ; MODIFIES : NONE
00001E84                          1535  ; ------------------------------------------------------------------------------
00001E84  4E75                    1536              RTS
00001E86                          1537  
00001E86                          1538  ; ------------------------------------------------------------------------------
00001E86                          1539  INSUPD
00001E86                          1540  ; INSTRUCTIONS SCREEN UPDATE
00001E86                          1541  ; INPUT    : NONE
00001E86                          1542  ; OUTPUT   : NONE
00001E86                          1543  ; MODIFIES : NONE
00001E86                          1544  ; ------------------------------------------------------------------------------
00001E86  4E75                    1545              RTS
00001E88                          1546  
00001E88                          1547  ; ------------------------------------------------------------------------------
00001E88                          1548  INSPLOT
00001E88                          1549  ; INSTRUCTIONS SCREEN PLOT
00001E88                          1550  ; INPUT    : NONE
00001E88                          1551  ; OUTPUT   : NONE
00001E88                          1552  ; MODIFIES : NONE
00001E88                          1553  ; ------------------------------------------------------------------------------
00001E88                          1554  
00001E88  48E7 C0C0               1555              MOVEM.L D0-D1/A0-A1,-(A7)
00001E8C  4281                    1556              CLR.L   D1
00001E8E  103C 0051               1557              MOVE.B  #81,D0
00001E92  4E4F                    1558              TRAP    #15
00001E94  103C 000B               1559              MOVE.B  #11,D0
00001E98  43F9 00001FFA           1560              LEA     .TXTLST,A1
00001E9E  2219                    1561  .LOOP       MOVE.L  (A1)+,D1
00001EA0  6700 000A               1562              BEQ     .DONE
00001EA4  2041                    1563              MOVE.L  D1,A0
00001EA6  4EB8 1C9E               1564              JSR     UTLPRINT
00001EAA  60F2                    1565              BRA     .LOOP
00001EAC  4CDF 0303               1566  .DONE       MOVEM.L (A7)+,D0-D1/A0-A1
00001EB0  4E75                    1567              RTS
00001EB2= 57 45 4C 43 4F 4D ...   1568  .TXT1       DC.B    'WELCOME TO THE WORLD OF MULTI-PONG 68000!',0
00001EDC= 59 4F 55 52 20 47 ...   1569  .TXT2       DC.B    'YOUR GOAL IN THIS GAME IS TO AVOID MISSING THE BALLS',0
00001F11= 54 4F 20 54 48 49 ...   1570  .TXT3       DC.B    'TO THIS END, MOVE THE PAD USING THE KEYBOARD',0
00001F3E= 48 4F 57 20 54 4F ...   1571  .TXT4       DC.B    'HOW TO DO IT? YOU MAY ASK.',0
00001F59= 49 54 20 49 53 20 ...   1572  .TXT5       DC.B    'IT IS EASY: JUST USE THE UP KEY TO MOVE THE PAD...',0
00001F8C= 55 50 21 00             1573  .TXT6       DC.B    'UP!',0
00001F90= 41 4E 44 20 55 53 ...   1574  .TXT7       DC.B    'AND USE THE DOWN KEY TO MOVE THE PAD DOWN.',0
00001FBB= 57 48 41 54 20 41 ...   1575  .TXT8       DC.B    'WHAT ABOUT LEFT AND RIGHT?',0
00001FD6= 4E 4F 2E 20 54 48 ...   1576  .TXT9       DC.B    'NO. THESE ARE FORBIDDEN DIRECTIONS',0
00001FFA                          1577              DS.W    0
00001FFA= 00001EB2 00001EDC ...   1578  .TXTLST     DC.L    .TXT1,.TXT2,.TXT3,.TXT4,.TXT5,.TXT6,.TXT7,.TXT8,.TXT9,0
00002022                          1579  
00002022                          1580  
00002022                          1581  -------------------- end include --------------------
00002022                          1582              INCLUDE "WIN.X68"
00002022                          1583  ; ==============================================================================
00002022                          1584  ; VICTORY SCREEN
00002022                          1585  ; ==============================================================================
00002022                          1586  
00002022                          1587  ; ------------------------------------------------------------------------------
00002022                          1588  WININIT
00002022                          1589  ; VICTORY SCREEN INIT
00002022                          1590  ; INPUT    : NONE
00002022                          1591  ; OUTPUT   : NONE
00002022                          1592  ; MODIFIES : NONE
00002022                          1593  ; ------------------------------------------------------------------------------
00002022  4E75                    1594              RTS
00002024                          1595  
00002024                          1596  ; ------------------------------------------------------------------------------
00002024                          1597  WINUPD
00002024                          1598  ; VICTORY SCREEN UPDATE
00002024                          1599  ; INPUT    : NONE
00002024                          1600  ; OUTPUT   : NONE
00002024                          1601  ; MODIFIES : NONE
00002024                          1602  ; ------------------------------------------------------------------------------
00002024  4E75                    1603              RTS
00002026                          1604  
00002026                          1605  ; ------------------------------------------------------------------------------
00002026                          1606  WINPLOT
00002026                          1607  ; VICTORY SCREEN PLOT
00002026                          1608  ; INPUT    : NONE
00002026                          1609  ; OUTPUT   : NONE
00002026                          1610  ; MODIFIES : NONE
00002026                          1611  ; ------------------------------------------------------------------------------
00002026  48E7 C080               1612              MOVEM.L D0-D1/A0,-(A7)
0000202A                          1613              
0000202A  4281                    1614              CLR.L   D1
0000202C  103C 0051               1615              MOVE.B  #81,D0
00002030  4E4F                    1616              TRAP    #15
00002032                          1617              
00002032  41F9 00002060           1618              LEA     .TXT1,A0
00002038  103C 000A               1619              MOVE.B  #10,D0
0000203C  4EB8 1C9E               1620              JSR     UTLPRINT
00002040                          1621              
00002040  0839 0004 000021CE      1622              BTST.B  #4,(SCRCYCCT)
00002048  6700 0010               1623              BEQ     .DONE
0000204C                          1624              
0000204C  41F9 00002069           1625              LEA     .TXT2,A0
00002052  103C 0019               1626              MOVE.B  #25,D0
00002056  4EB8 1C9E               1627              JSR     UTLPRINT
0000205A                          1628              
0000205A  4CDF 0103               1629  .DONE       MOVEM.L (A7)+,D0-D1/A0
0000205E                          1630  
0000205E  4E75                    1631              RTS
00002060= 59 4F 55 20 57 4F ...   1632  .TXT1       DC.B    'YOU WON!',0
00002069= 50 52 45 53 53 20 ...   1633  .TXT2       DC.B    'PRESS FIRE1 TO CONTINUE',0
00002082                          1634              DS.W    0
00002082                          1635  
00002082                          1636  
00002082                          1637  
00002082                          1638  -------------------- end include --------------------
00002082                          1639              INCLUDE "GOVER.X68"
00002082                          1640  ; ==============================================================================
00002082                          1641  ; GAME OVER SCREEN
00002082                          1642  ; ==============================================================================
00002082                          1643  
00002082                          1644  ; ------------------------------------------------------------------------------
00002082                          1645  GOVINIT
00002082                          1646  ; GAME OVER SCREEN INIT
00002082                          1647  ; INPUT    : NONE
00002082                          1648  ; OUTPUT   : NONE
00002082                          1649  ; MODIFIES : NONE
00002082                          1650  ; ------------------------------------------------------------------------------
00002082  4E75                    1651              RTS
00002084                          1652  
00002084                          1653  ; ------------------------------------------------------------------------------
00002084                          1654  GOVUPD
00002084                          1655  ; GAME OVER SCREEN UPDATE
00002084                          1656  ; INPUT    : NONE
00002084                          1657  ; OUTPUT   : NONE
00002084                          1658  ; MODIFIES : NONE
00002084                          1659  ; ------------------------------------------------------------------------------
00002084  4E75                    1660              RTS
00002086                          1661  
00002086                          1662  ; ------------------------------------------------------------------------------
00002086                          1663  GOVPLOT
00002086                          1664  ; GAME OVER SCREEN PLOT
00002086                          1665  ; INPUT    : NONE
00002086                          1666  ; OUTPUT   : NONE
00002086                          1667  ; MODIFIES : NONE
00002086                          1668  ; ------------------------------------------------------------------------------
00002086  48E7 C080               1669              MOVEM.L D0-D1/A0,-(A7)
0000208A                          1670              
0000208A  4281                    1671              CLR.L   D1
0000208C  103C 0051               1672              MOVE.B  #81,D0
00002090  4E4F                    1673              TRAP    #15
00002092                          1674              
00002092  41F9 000020C0           1675              LEA     .TXT1,A0
00002098  103C 000A               1676              MOVE.B  #10,D0
0000209C  4EB8 1C9E               1677              JSR     UTLPRINT
000020A0                          1678              
000020A0  0839 0004 000021CE      1679              BTST.B  #4,(SCRCYCCT)
000020A8  6700 0010               1680              BEQ     .DONE
000020AC                          1681              
000020AC  41F9 000020CA           1682              LEA     .TXT2,A0
000020B2  103C 0019               1683              MOVE.B  #25,D0
000020B6  4EB8 1C9E               1684              JSR     UTLPRINT
000020BA                          1685              
000020BA  4CDF 0103               1686  .DONE       MOVEM.L (A7)+,D0-D1/A0
000020BE                          1687  
000020BE  4E75                    1688              RTS
000020C0= 47 41 4D 45 20 4F ...   1689  .TXT1       DC.B    'GAME OVER',0
000020CA= 50 52 45 53 53 20 ...   1690  .TXT2       DC.B    'PRESS FIRE1 TO CONTINUE',0
000020E2                          1691              DS.W    0
000020E2                          1692  
000020E2                          1693  
000020E2                          1694  -------------------- end include --------------------
000020E2                          1695              INCLUDE "STATES.X68"
000020E2                          1696  ; =============================================================================
000020E2                          1697  ; GAME STATE MANAGEMENT
000020E2                          1698  ; =============================================================================
000020E2                          1699  
000020E2                          1700  ; -----------------------------------------------------------------------------
000020E2                          1701  STAINIT
000020E2                          1702  ; INITALIZES THE STATE MANAGER
000020E2                          1703  ; INPUT    - NONE
000020E2                          1704  ; OUTPUT   - NONE
000020E2                          1705  ; MODIFIES - NONE
000020E2                          1706  ; -----------------------------------------------------------------------------
000020E2  33FC FFFF 000025EE      1707              MOVE.W  #STANONE,(STACUR)
000020EA  4279 000025F0           1708              CLR.W   (STANEXT)
000020F0  4E75                    1709              RTS
000020F2                          1710  
000020F2                          1711  ; -----------------------------------------------------------------------------
000020F2                          1712  STAUPD
000020F2                          1713  ; PERFORMS STATE UPDATE AND INIT IF NECESSARY
000020F2                          1714  ; INPUT    - NONE
000020F2                          1715  ; OUTPUT   - NONE
000020F2                          1716  ; MODIFIES - NONE
000020F2                          1717  ; -----------------------------------------------------------------------------
000020F2  48E7 8080               1718              MOVEM.L D0/A0,-(A7)
000020F6  4280                    1719              CLR.L   D0
000020F8  3039 000025F0           1720              MOVE.W  (STANEXT),D0
000020FE  B079 000025EE           1721              CMP.W   (STACUR),D0
00002104  6700 0012               1722              BEQ     .DOUPD
00002108  33C0 000025EE           1723              MOVE.W  D0,(STACUR)             ; IF STATE CHANGED, DO INIT
0000210E  E588                    1724              LSL.L   #2,D0
00002110  2040                    1725              MOVE.L  D0,A0
00002112  2068 2130               1726              MOVE.L  .INITBL(A0),A0
00002116  4E90                    1727              JSR     (A0)
00002118  4280                    1728  .DOUPD      CLR.L   D0                      ; IN ANY CASE, DO UPDATE
0000211A  3039 000025EE           1729              MOVE.W  (STACUR),D0
00002120  E588                    1730              LSL.L   #2,D0
00002122  2040                    1731              MOVE.L  D0,A0
00002124  2068 2134               1732              MOVE.L  .UPDTBL(A0),A0
00002128  4E90                    1733              JSR     (A0)
0000212A  4CDF 0101               1734              MOVEM.L (A7)+,D0/A0
0000212E  4E75                    1735              RTS
00002130= 00001DEE                1736  .INITBL     DC.L    ISCINIT
00002134= 00001DF6                1737  .UPDTBL     DC.L    ISCUPD
00002138                          1738  
00002138                          1739  ; -----------------------------------------------------------------------------
00002138                          1740  STAPLOT
00002138                          1741  ; PERFORMS STATE PLOT
00002138                          1742  ; INPUT    - NONE
00002138                          1743  ; OUTPUT   - NONE
00002138                          1744  ; MODIFIES - NONE
00002138                          1745  ; -----------------------------------------------------------------------------
00002138  48E7 8080               1746              MOVEM.L D0/A0,-(A7)
0000213C  4280                    1747              CLR.L   D0
0000213E  3039 000025EE           1748              MOVE.W  (STACUR),D0
00002144  E588                    1749              LSL.L   #2,D0
00002146  2040                    1750              MOVE.L  D0,A0
00002148  2068 2154               1751              MOVE.L  .PLTTBL(A0),A0
0000214C  4E90                    1752              JSR     (A0)
0000214E  4CDF 0101               1753              MOVEM.L (A7)+,D0/A0
00002152  4E75                    1754              RTS
00002154= 00001E26                1755  .PLTTBL     DC.L    ISCPLOT
00002158                          1756  
00002158                          1757  ; -----------------------------------------------------------------------------
00002158                          1758  STAEMPTY
00002158                          1759  ; EMPTY SUBROUTINE FOR CASES WITH NOTHING TO DO
00002158                          1760  ; INPUT    - NONE
00002158                          1761  ; OUTPUT   - NONE
00002158                          1762  ; MODIFIES - NONE
00002158                          1763  ; NOTE     - JUST A PLACEHOLDER. NOTHING TO DO.
00002158                          1764  ; -----------------------------------------------------------------------------
00002158  4E75                    1765              RTS
0000215A                          1766  
0000215A                          1767  
0000215A                          1768  
0000215A                          1769  
0000215A                          1770  
0000215A                          1771  
0000215A                          1772  
0000215A                          1773  
0000215A                          1774  -------------------- end include --------------------
0000215A                          1775              INCLUDE "GAME.X68"
0000215A                          1776  ; ==============================================================================
0000215A                          1777  ; GAME MANAGEMENT
0000215A                          1778  ; ==============================================================================
0000215A                          1779  
0000215A                          1780  ; ------------------------------------------------------------------------------
0000215A                          1781  GAMINIT
0000215A                          1782  ; INITIALIZES GAME.
0000215A                          1783  ; INPUT    : NONE
0000215A                          1784  ; OUTPUT   : NONE
0000215A                          1785  ; MODIFIES : NONE
0000215A                          1786  ; ------------------------------------------------------------------------------
0000215A  4EB8 188A               1787              JSR     SYSINIT
0000215E  4EB8 149C               1788              JSR     PMINIT
00002162  4EB8 1AEA               1789              JSR     MAPINIT
00002166  4EB8 1400               1790              JSR     GSTINIT
0000216A  6000 F6AC               1791              BRA     SCOINIT
0000216E                          1792  
0000216E                          1793  ; ------------------------------------------------------------------------------
0000216E                          1794  GAMUPD
0000216E                          1795  ; UPDATES THE GAME
0000216E                          1796  ; INPUT    : NONE
0000216E                          1797  ; OUTPUT   : NONE
0000216E                          1798  ; MODIFIES : NONE
0000216E                          1799  ; ------------------------------------------------------------------------------
0000216E  6000 F360               1800              BRA     PMUPD
00002172                          1801              
00002172                          1802  ; ------------------------------------------------------------------------------
00002172                          1803  GAMPLOT
00002172                          1804  ; PLOTS THE GAME
00002172                          1805  ; INPUT    : NONE
00002172                          1806  ; OUTPUT   : NONE
00002172                          1807  ; MODIFIES : NONE
00002172                          1808  ; ------------------------------------------------------------------------------
00002172  4EB8 1B64               1809              JSR     MAPPLOT
00002176  4EB8 1828               1810              JSR     SCOPLOT
0000217A  4EB8 161A               1811              JSR     PMPLOT
0000217E  6000 F2B2               1812              BRA     GSTPLOT
00002182                          1813  
00002182                          1814  -------------------- end include --------------------
00002182                          1815              
00002182                          1816      
00002182                          1817  START:
00002182                          1818  
00002182                          1819  ;--- INITIALIZATION -----------------------------------------------------------
00002182                          1820  
00002182  007C 0700               1821              ORI.W   #$0700,SR               ;DISABLE INTERRUPTIONS
00002186                          1822  
00002186  4EB8 188A               1823              JSR     SYSINIT
0000218A  4EB8 149C               1824              JSR     PMINIT
0000218E  4EB8 1AEA               1825              JSR     MAPINIT
00002192  4EB8 1400               1826              JSR     GSTINIT
00002196  4EB8 1818               1827              JSR     SCOINIT
0000219A  4EB8 1DEE               1828              JSR     ISCINIT
0000219E                          1829              ;JSR     GAMINIT
0000219E                          1830  
0000219E                          1831  .LOOP
0000219E                          1832  
0000219E                          1833  ; --- UPDATE -------------------------------------------------------------------
0000219E                          1834  
0000219E                          1835  ; READ INPUT DEVICES
0000219E                          1836  
0000219E  4E41                    1837              TRAP    #1
000021A0                          1838  
000021A0                          1839  ; UPDATE GAME LOGIC
000021A0                          1840  
000021A0  4EB8 14D0               1841             JSR     PMUPD
000021A4                          1842             ;JSR     GSTUPD
000021A4                          1843             ;JSR      ISCUPD
000021A4                          1844             ;JSR      GAMUPD
000021A4                          1845  
000021A4                          1846  ; --- SYNC ---------------------------------------------------------------------
000021A4                          1847              ;WHILE THERES NO INTERRUPTS IN THE COUNTER THE PROGRAM WILL BE IN
000021A4                          1848              ;THE BUCLE
000021A4                          1849              
000021A4  4A39 000021CD           1850  .WAITINIT   TST.B   (SCRINTCT)
000021AA  67F8                    1851              BEQ     .WAITINIT
000021AC  4239 000021CD           1852              CLR.B   (SCRINTCT)
000021B2                          1853  
000021B2                          1854  ; --- PLOT ---------------------------------------------------------------------
000021B2                          1855              
000021B2  4EB8 1B64               1856              JSR     MAPPLOT
000021B6  4EB8 1828               1857              JSR     SCOPLOT
000021BA  4EB8 161A               1858              JSR     PMPLOT
000021BE  4EB8 1432               1859              JSR     GSTPLOT
000021C2                          1860              ;JSR     ISCPLOT
000021C2                          1861              ;JSR     GAMPLOT
000021C2                          1862              
000021C2                          1863              
000021C2  4E40                    1864              TRAP    #0                      ;CHANGE BUFFER
000021C4                          1865  
000021C4  60D8                    1866              BRA     .LOOP
000021C6                          1867  
000021C6  FFFF FFFF               1868              SIMHALT  
000021CA                          1869             
000021CA                          1870              INCLUDE "SYSVARS.X68"
000021CA                          1871  ; ==============================================================================
000021CA                          1872  ; SYSTEM VARIABLES
000021CA                          1873  ; ==============================================================================
000021CA                          1874   
000021CA                          1875  ; --- KEYBOARD RELATED VARIABLES -----------------------------------------------
000021CA                          1876  
000021CA                          1877  KBDVAL      DS.B    1                       ; KEY STATE
000021CB                          1878  KBDLAST     DS.B    1                       ; LAST KEY PRESSED
000021CC                          1879  KBDEDGE     DS.B    1                       ; KEY EDGE
000021CD                          1880              DS.B    0 
000021CD                          1881  
000021CD                          1882  ; --- TIMED INTERRUPT RELATED VARIABLES ----------------------------------------
000021CD                          1883  
000021CD                          1884  SCRINTCT    DS.B    1                       ; INTERRUPT COUNTER
000021CE                          1885  SCRCYCCT    DS.B    1                       ; CYCLE COUNTER
000021D0                          1886              DS.W    0        
000021D0                          1887              
000021D0                          1888  ; --- MAP RELATED VARIABLE -----------------------------------------------------
000021D0                          1889  
000021D0                          1890  MAPVAR      DS.B    1024
000025D0                          1891  
000025D0                          1892              DS.B    0
000025D0                          1893  
000025D0                          1894  POSCON      DS.W    1
000025D2                          1895  
000025D2                          1896  
000025D2                          1897  
000025D2                          1898  
000025D2                          1899  
000025D2                          1900  
000025D2                          1901  -------------------- end include --------------------
000025D2                          1902              INCLUDE "VARS.X68"
000025D2                          1903  ; ==============================================================================
000025D2                          1904  ; GAME VARIABLES
000025D2                          1905  ; ==============================================================================
000025D2                          1906  
000025D2                          1907  ; --- PAC-MAN RELATED VARIABLES ------------------------------------------------
000025D2                          1908  
000025D2                          1909  PMPOSX      DS.W    1                       ; PM X COORDINATE
000025D4                          1910  PMPOSY      DS.W    1                       ; PM Y COORDINATE
000025D6                          1911  PMVELX      DS.W    1                       ; PM X VELOCITY
000025D8                          1912  PMVELY      DS.W    1                       ; PM Y VELOCITY
000025DA                          1913  PMEAT       DS.B    1                       ; PM BOOLEAN EAT GST
000025DB                          1914  PMLAMO      DS.B    1                       ; PM SAVE LAST MOVEMENT X O Y
000025DC                          1915              DS.B    0
000025DC                          1916  
000025DC                          1917  ; --- GHOST RELATED VARIABLES --------------------------------------------------
000025DC                          1918  
000025DC                          1919  GSTPOSX     DS.W    1                       ; GST X COORDINATE
000025DE                          1920  GSTPOSY     DS.W    1                       ; GST Y COORDINATE
000025E0                          1921  GSTVELX     DS.W    1                       ; GST X VELOCITY
000025E2                          1922  GSTVELY     DS.W    1                       ; GST Y VELOCITY
000025E4                          1923  GSTDEAD     DS.B    1                       ; GST BOOLEAN DEAD
000025E5                          1924  GSTLAMO     DS.B    1                       ; GST LAST MOVEMENT (X OR Y)
000025E6                          1925  GSTINRNG    DS.B    1                       ; GST IS IN RANGE
000025E7                          1926  GSTTARG     DS.B    1                       ; GST TARGET (0-PACMAN, 1-RANDOM)
000025E8                          1927              DS.B    0
000025E8                          1928  
000025E8                          1929  ; --- SCOREBOARD RELATED VARIABLES ---------------------------------------------
000025E8                          1930  
000025E8                          1931  SCOLIFE     DS.W    1                       ; NUMBER OF LIFES
000025EA                          1932  SCOPOINTS   DS.W    1                       ; NUMBER OF POINTS
000025EC                          1933  
000025EC                          1934  ; --- INTRO STATE RELATED VARIABLES --------------------------------------------
000025EC                          1935  
000025EC                          1936  ISCTIMER    DS.W    1                       ; INTRO TIMER
000025EE                          1937  
000025EE                          1938  ; --- STATE RELATED VARIABLES --------------------------------------------------
000025EE                          1939  
000025EE                          1940  STACUR      DS.W    1                       ; CURRENT STATE
000025F0                          1941  STANEXT     DS.W    1                       ; NEXT STATE
000025F2                          1942  
000025F2                          1943  
000025F2                          1944  
000025F2                          1945  
000025F2                          1946  
000025F2                          1947  
000025F2                          1948  
000025F2                          1949  
000025F2                          1950  
000025F2                          1951  -------------------- end include --------------------
000025F2                          1952              INCLUDE "LIB/UTLVARS.X68"
000025F2                          1953  ; =============================================================================
000025F2                          1954  ; UTILITY VARIABLES
000025F2                          1955  ; =============================================================================
000025F2                          1956  
000025F2                          1957  UTLRNDIX    DS.B    1                       ; NEXT INDEX TO RANDOM NUMBER
000025F4                          1958              DS.W    0
000025F4                          1959  -------------------- end include --------------------
000025F4                          1960              
000025F4                          1961              END    START        

No errors detected
No warnings generated


SYMBOL TABLE INFORMATION
Symbol-name         Value
-------------------------
BUCLE_COLUMNA       1B10
BUCLE_COLUMNA2      1B86
BUCLE_FILA          1B04
BUCLE_FILA2         1B7A
COLWALLDOWN         19FC
COLWALLLEFT         19BA
COLWALLRIGHT        1978
COLWALLUP           1A38
DIBFIGBPOINT        1C4C
DIBFIGPOINT         1C10
DIBFIGWALL          1BD8
GAMINIT             215A
GAMPLOT             2172
GAMUPD              216E
GETPOINTS           1A76
GETPOINTS:BPOINT    1AC0
GETPOINTS:DONE      1AE4
GETPOINTS:POINT     1AD2
GOVINIT             2082
GOVPLOT             2086
GOVPLOT:DONE        20BA
GOVPLOT:TXT1        20C0
GOVPLOT:TXT2        20CA
GOVUPD              2084
GSTCOL1             FF
GSTCOL2             FF0080
GSTCOL3             FFFF00
GSTCOL4             80FF
GSTCOL5             800000
GSTDEAD             25E4
GSTFCOL1            FFFFFF
GSTFCOL2            0
GSTFCOL3            0
GSTFCOL4            0
GSTFCOL5            0
GSTINIT             1400
GSTINRNG            25E6
GSTINX1             2
GSTINX2             2
GSTINX3             1F
GSTINX4             1F
GSTINY1             2
GSTINY2             1F
GSTINY3             2
GSTINY4             1F
GSTLAMO             25E5
GSTPLOT             1432
GSTPOSX             25DC
GSTPOSY             25DE
GSTRAD              8
GSTRNG              10
GSTSPEED            7
GSTSPEED2           5
GSTTARG             25E7
GSTUPD              1428
GSTUPD:GSTNOTMULT   142C
GSTVELX             25E0
GSTVELY             25E2
INSINIT             1E84
INSPLOT             1E88
INSPLOT:DONE        1EAC
INSPLOT:LOOP        1E9E
INSPLOT:TXT1        1EB2
INSPLOT:TXT2        1EDC
INSPLOT:TXT3        1F11
INSPLOT:TXT4        1F3E
INSPLOT:TXT5        1F59
INSPLOT:TXT6        1F8C
INSPLOT:TXT7        1F90
INSPLOT:TXT8        1FBB
INSPLOT:TXT9        1FD6
INSPLOT:TXTLST      1FFA
INSUPD              1E86
ISCINIT             1DEE
ISCPLOT             1E26
ISCPLOT:DONE        1E5A
ISCPLOT:TXT1        1E60
ISCPLOT:TXT2        1E6E
ISCTIMER            25EC
ISCUPD              1DF6
ISCUPD:CONT         1E0A
ISCUPD:DONE         1E24
KBDDOWN             28
KBDEDGE             21CC
KBDFIRE1            20
KBDFIRE2            4D
KBDFIRE3            10
KBDINIT             1922
KBDLAST             21CB
KBDLEFT             25
KBDPAUSE            50
KBDRIGHT            27
KBDUP               26
KBDUPD              1930
KBDUPD:CONVERT      196A
KBDUPD:LOOP         196E
KBDUPD:NOACT        1964
KBDVAL              21CA
MAPINIT             1AEA
MAPMAT              1000
MAPPLOT             1B64
MAPVAR              21D0
NOTPOINT            1B44
NOTPOINT2           1BB8
NOTWALL             1B36
NOTWALL2            1BAA
PMEAT               25DA
PMFCOL              FFFF
PMINIT              149C
PMLAMO              25DB
PMPCOL              FFFF
PMPLOT              161A
PMPLOT:DDONE        16AE
PMPLOT:DDOWN        1680
PMPLOT:DLEFT        1676
PMPLOT:DOWNDRAW     176E
PMPLOT:DRAW_MOUTH1  168A
PMPLOT:DRAW_MOUTH2  1694
PMPLOT:DRAW_MOUTH3  169E
PMPLOT:DRAW_MOUTH4  16A8
PMPLOT:DRIGHT       1662
PMPLOT:DUP          166C
PMPLOT:FULLDRAW     16B4
PMPLOT:LEFTDRAW     16D8
PMPLOT:RIGHTDRAW    170A
PMPLOT:SET_MOUTHDOWN  17FA
PMPLOT:SET_MOUTHLEFT  17A0
PMPLOT:SET_MOUTHRIGHT  17BE
PMPLOT:SET_MOUTHUP  17DC
PMPLOT:UPDRAW       173C
PMPOSX              25D2
PMPOSY              25D4
PMRAD               8
PMSPEED             2
PMUPD               14D0
PMUPD:ACTXLEFT      158E
PMUPD:ACTXRIGHT     1562
PMUPD:ACTYDOWN      15BA
PMUPD:ACTYUP        15D6
PMUPD:DONE          1608
PMUPD:NOTCOLISION   1574
PMUPD:NOTCOLISION2  15A0
PMUPD:NOTCOLISION3  15CC
PMUPD:NOTCOLISION4  15E8
PMUPD:NOTDOWN       155E
PMUPD:NOTLEFT       151C
PMUPD:NOTMULT       15F2
PMUPD:NOTRIGHT      1532
PMUPD:NOTTP         1584
PMUPD:NOTTP2        15B0
PMUPD:NOTUP         1548
PMVELX              25D6
PMVELY              25D8
POSCON              25D0
SCOFCOL             0
SCOINIT             1818
SCOLIFE             25E8
SCOLINE1            101
SCOLINE2            102
SCOPLOT             1828
SCOPLOT:TXT1        1876
SCOPLOT:TXT2        187F
SCOPOINTS           25EA
SCRCYCCT            21CE
SCRHEIGH            280
SCRINIT             18B6
SCRINTCT            21CD
SCRTIM              1914
SCRUPD              18FA
SCRWIDTH            280
STACUR              25EE
STAEMPTY            2158
STAINIT             20E2
STANEXT             25F0
STANONE             FFFFFFFF
STAPLOT             2138
STAPLOT:PLTTBL      2154
START               2182
START:LOOP          219E
START:WAITINIT      21A4
STAUPD              20F2
STAUPD:DOUPD        2118
STAUPD:INITBL       2130
STAUPD:UPDTBL       2134
SYSINIT             188A
UTLCHRWD            8
UTLINIT             1C88
UTLPRINT            1C9E
UTLPRINT:ENDLOOP    1CB0
UTLPRINT:LOOP       1CA6
UTLRAND             1CD0
UTLRAND:RANDVEC     1CEE
UTLRNDIX            25F2
WININIT             2022
WINPLOT             2026
WINPLOT:DONE        205A
WINPLOT:TXT1        2060
WINPLOT:TXT2        2069
WINUPD              2024
ZERO                1B52
ZERO2               1BC6
