00002454 Starting Address
Assembler used: EASy68K Editor/Assembler v5.16.01
Created On: 24/12/2022 13:50:01

00000000                             1  ; ==============================================================================
00000000                             2  ; TITLE       : PAC-MAN 68000
00000000                             3  ; DESCRIPTION : GAME IN MOTOROLA 68000 BASED ON PAC-MAN GAME
00000000                             4  ; AUTHOR      : JORDI FLORIT ENSENYAT
00000000                             5  ;               JOSEP GABRIEL FORNES REYNES
00000000                             6  ;               PAU GIRON RODRIGUEZ
00000000                             7  ; ==============================================================================
00001000                             8              ORG    $1000
00001000                             9  
00001000                            10              INCLUDE "CONST.X68"
00001000                            11  ; ==============================================================================
00001000                            12  ; GAME CONSTANTS
00001000                            13  ; ==============================================================================
00001000                            14  
00001000                            15  ; --- PAC-MAN RELATED CONTANTS ----------------------------------------------------
00001000                            16  
00001000  =0000FFFF                 17  PMPCOL      EQU     $0000FFFF               ; PAC-MAN CONTOUR COLOR
00001000  =0000FFFF                 18  PMFCOL      EQU     $0000FFFF               ; PAC-MAN FILL COLOR
00001000  =00000002                 19  PMSPEED     EQU     2                       ; MAGNITUDE OF THE X AND Y VEL.
00001000  =00000008                 20  PMRAD       EQU     8                       ; PAC-MAN RADIUS
00001000                            21  
00001000                            22  ; --- GHOST RELATED CONSTANTS ----------------------------------------------------
00001000                            23  
00001000  =00000007                 24  GSTSPEED    EQU     7                       ; MAGNITUDE OF THE NORMAL DISPLACEMENT
00001000  =00000005                 25  GSTSPEED2   EQU     5                       ; MAGNITUDE OF THE ATACKED DISPLACEMENT
00001000                            26  
00001000  =000000FF                 27  GSTCOL1     EQU     $000000FF               ; GHOST 1 CONTOUR COLOR RED
00001000  =00FFFFFF                 28  GSTFCOL1    EQU     $00FFFFFF               ; GHOST 1 FILL COLOR WHITE
00001000  =00000002                 29  GSTINX1     EQU     2                       ; GHOST 1 INITIAL X
00001000  =00000002                 30  GSTINY1     EQU     2                       ; GHOST 1 INITIAL Y
00001000                            31  
00001000  =00FF0080                 32  GSTCOL2     EQU     $00FF0080               ; GHOST 2 CONTOUR COLOR PINK
00001000  =00000000                 33  GSTFCOL2    EQU     $00000000               ; GHOST 1 FILL COLOR
00001000  =00000002                 34  GSTINX2     EQU     2                       ; GHOST 2 INITIAL X
00001000  =0000001F                 35  GSTINY2     EQU     31                      ; GHOST 2 INITIAL Y
00001000                            36  
00001000  =00FFFF00                 37  GSTCOL3     EQU     $00FFFF00               ; GHOST 3 CONTOUR COLOR CYAN
00001000  =00000000                 38  GSTFCOL3    EQU     $00000000               ; GHOST 3 FILL COLOR
00001000  =0000001F                 39  GSTINX3     EQU     31                      ; GHOST 3 INITIAL X
00001000  =00000002                 40  GSTINY3     EQU     2                       ; GHOST 3 INITIAL Y
00001000                            41  
00001000  =000080FF                 42  GSTCOL4     EQU     $000080FF               ; GHOST 4 CONTOUR COLOR ORANGE
00001000  =00000000                 43  GSTFCOL4    EQU     $00000000               ; GHOST 4 FILL COLOR
00001000  =0000001F                 44  GSTINX4     EQU     31                      ; GHOST 4 INITIAL X
00001000  =0000001F                 45  GSTINY4     EQU     31                      ; GHOST 4 INITIAL Y 
00001000                            46  
00001000  =00800000                 47  GSTCOL5     EQU     $00800000               ; CONTOUR COLOR OF ATACKED MODE
00001000  =00000000                 48  GSTFCOL5    EQU     $00000000               ; FILL COLOR OF ATACKED MODE
00001000                            49  
00001000  =00000008                 50  GSTRAD      EQU     8                       ; GHOST RADIUS
00001000  =00000010                 51  GSTRNG      EQU     16                      ; GHOST DETECTING RANGE
00001000                            52              
00001000                            53  ; --- SCOREBOARD RELATED CONSTANTS ---------------------------------------------
00001000                            54  ;MODIFICATE
00001000                            55  
00001000  =00000000                 56  SCOFCOL     EQU     $00000000               ; TEXT BACKGROUND COLOR
00001000  =00000101                 57  SCOLINE1    EQU     $0101                   ; FIRST TEXT LINE COORDINATES
00001000  =00000102                 58  SCOLINE2    EQU     $0102                   ; SECOND TEXT LINE COORDINATES
00001000                            59  
00001000                            60  ; --- MAP RELATED CONSTANTS ----------------------------------------------------
00001000                            61  
00001000= 01 01 01 01 01 01 ...     62  MAPMAT      DC.B    $1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
00001020= 01 02 02 02 02 02 ...     63              DC.B    $1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1
00001040= 01 02 01 01 01 01 ...     64              DC.B    $1,2,1,1,1,1,1,2,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,2,1,1,1,1,1,2,1
00001060= 01 03 01 01 01 01 ...     65              DC.B    $1,3,1,1,1,1,1,2,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,2,1,1,1,1,1,3,1
00001080= 01 02 02 02 02 02 ...     66              DC.B    $1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1
000010A0= 01 02 01 01 01 01 ...     67              DC.B    $1,2,1,1,1,1,1,2,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,2,1,1,1,1,1,2,1
000010C0= 01 02 01 01 01 01 ...     68              DC.B    $1,2,1,1,1,1,1,2,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,2,1,1,1,1,1,2,1
000010E0= 01 02 02 02 02 02 ...     69              DC.B    $1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1
00001100= 01 02 01 01 01 01 ...     70              DC.B    $1,2,1,1,1,1,1,2,1,1,1,2,1,1,1,1,1,1,1,1,2,1,1,1,2,1,1,1,1,1,2,1
00001120= 01 02 01 00 00 00 ...     71              DC.B    $1,2,1,0,0,0,1,2,1,0,1,2,1,1,1,1,1,1,1,1,2,1,0,1,2,1,0,0,0,1,2,1
00001140= 01 02 01 01 01 01 ...     72              DC.B    $1,2,1,1,1,1,1,2,1,0,1,2,2,2,2,1,1,2,2,2,2,1,0,1,2,1,1,1,1,1,2,1
00001160= 01 02 02 02 02 02 ...     73              DC.B    $1,2,2,2,2,2,2,2,1,0,1,1,1,1,2,1,1,2,1,1,1,1,0,1,2,2,2,2,2,2,2,1
00001180= 01 01 01 01 01 01 ...     74              DC.B    $1,1,1,1,1,1,1,2,1,0,1,1,1,1,2,1,1,2,1,1,1,1,0,1,2,1,1,1,1,1,1,1
000011A0= 01 00 00 00 00 00 ...     75              DC.B    $1,0,0,0,0,0,1,2,1,0,1,0,0,0,0,0,0,0,0,0,0,1,0,1,2,1,0,0,0,0,0,1
000011C0= 01 00 00 00 00 00 ...     76              DC.B    $1,0,0,0,0,0,1,2,1,0,1,0,1,1,1,0,0,1,1,1,0,1,0,1,2,1,0,0,0,0,0,1
000011E0= 01 01 01 01 01 01 ...     77              DC.B    $1,1,1,1,1,1,1,2,1,1,1,0,1,0,0,0,0,0,0,1,0,1,1,1,2,1,1,1,1,1,1,1
00001200= 04 00 00 00 00 00 ...     78              DC.B    $4,0,0,0,0,0,0,2,2,2,2,0,1,0,0,0,0,0,0,1,0,2,2,2,2,0,0,0,0,0,0,4
00001220= 01 01 01 01 01 01 ...     79              DC.B    $1,1,1,1,1,1,1,2,1,1,1,0,1,0,0,0,0,0,0,1,0,1,1,1,2,1,1,1,1,1,1,1
00001240= 01 00 00 00 00 00 ...     80              DC.B    $1,0,0,0,0,0,1,2,1,0,1,0,1,1,1,1,1,1,1,1,0,1,0,1,2,1,0,0,0,0,0,1
00001260= 01 00 00 00 00 00 ...     81              DC.B    $1,0,0,0,0,0,1,2,1,0,1,0,0,0,0,0,0,0,0,0,0,1,0,1,2,1,0,0,0,0,0,1
00001280= 01 01 01 01 01 01 ...     82              DC.B    $1,1,1,1,1,1,1,2,1,1,1,0,1,1,1,1,1,1,1,1,0,1,1,1,2,1,1,1,1,1,1,1
000012A0= 01 02 02 02 02 02 ...     83              DC.B    $1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1
000012C0= 01 02 01 01 01 01 ...     84              DC.B    $1,2,1,1,1,1,1,2,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,2,1,1,1,1,1,2,1
000012E0= 01 02 01 01 01 01 ...     85              DC.B    $1,2,1,1,1,1,1,2,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,2,1,1,1,1,1,2,1
00001300= 01 02 02 02 02 01 ...     86              DC.B    $1,2,2,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,2,2,2,1
00001320= 01 01 01 01 02 01 ...     87              DC.B    $1,1,1,1,2,1,1,2,1,1,1,2,1,1,1,1,1,1,1,1,2,1,1,1,2,1,1,2,1,1,1,1
00001340= 01 01 01 01 02 01 ...     88              DC.B    $1,1,1,1,2,1,1,2,1,0,1,2,1,1,1,1,1,1,1,1,2,1,0,1,2,1,1,2,1,1,1,1
00001360= 01 02 02 02 02 02 ...     89              DC.B    $1,2,2,2,2,2,2,2,1,0,1,2,2,2,2,1,1,2,2,2,2,1,0,1,2,2,2,2,2,2,2,1
00001380= 01 02 01 01 01 01 ...     90              DC.B    $1,2,1,1,1,1,1,1,1,0,1,1,1,1,2,1,1,2,1,1,1,1,0,1,1,1,1,1,1,1,2,1
000013A0= 01 03 01 01 01 01 ...     91              DC.B    $1,3,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,3,1
000013C0= 01 02 02 02 02 02 ...     92              DC.B    $1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1
000013E0= 01 01 01 01 01 01 ...     93              DC.B    $1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
00001400                            94              
00001400                            95  ; --- STATE RELATED CONSTANTS --------------------------------------------------
00001400                            96  
00001400  =FFFFFFFF                 97  STANONE     EQU     -1                      ; NON-EXISTENT STATE NUMBER
00001400                            98  
00001400                            99  
00001400                           100  
00001400                           101  
00001400                           102  
00001400                           103  
00001400                           104  
00001400                           105  
00001400                           106  
00001400                           107  
00001400                           108  
00001400                           109  
00001400                           110  
00001400                           111  
00001400                           112  
00001400                           113  
00001400                           114  
00001400                           115  
00001400                           116  
00001400                           117  
00001400                           118  
00001400                           119  
00001400                           120  
00001400                           121  -------------------- end include --------------------
00001400                           122              INCLUDE "GHOST.X68"
00001400                           123  ; ==============================================================================
00001400                           124  ; GHOST MANAGEMENT
00001400                           125  ; ==============================================================================
00001400                           126              
00001400                           127  ; ------------------------------------------------------------------------------
00001400                           128  GSTINIT
00001400                           129  ; INITIALIZE GHOST.
00001400                           130  ; INPUT    : NONE 
00001400                           131  ; OUTPUT   : NONE
00001400                           132  ; MODIFIES : NONE
00001400                           133  ; ------------------------------------------------------------------------------
00001400  33FC 0058 0000331C       134              MOVE.W  #GSTINX1*16+64-8,(GSTPOSX)
00001408  33FC 0058 0000331E       135              MOVE.W  #GSTINY1*16+64-8,(GSTPOSY)
00001410  33FC 0007 00003320       136              MOVE.W  #GSTSPEED,(GSTVELX)
00001418  33FC 0007 00003322       137              MOVE.W  #GSTSPEED,(GSTVELY)
00001420  13FC 0001 00003325       138              MOVE.B  #1,(GSTLAMO)
00001428  4E75                     139              RTS
0000142A                           140              
0000142A                           141  ; ------------------------------------------------------------------------------
0000142A                           142  GSTUPD
0000142A                           143  ; UPDATES THE GHOST.
0000142A                           144  ; INPUT    : NONE 
0000142A                           145  ; OUTPUT   : NONE
0000142A                           146  ; MODIFIES : NONE
0000142A                           147  ; ------------------------------------------------------------------------------
0000142A  48E7 F800                148              MOVEM.L D0-D4,-(A7)
0000142E                           149              
0000142E                           150              ;MOVE.W  (PMPOSX)/16*(PMPOSX)/16+(PMPOSY)/16*(PMPOSY)/16-#GSTRNG*#GSTRNG,D0
0000142E  6600 000E                151              BNE     .GSTINRNG
00001432                           152  .GSTNOTINRNG
00001432  13FC 0001 00003326       153              MOVE.B  #1,(GSTINRNG)
0000143A  6000 000A                154              BRA     .GSTMOVE
0000143E                           155  .GSTINRNG
0000143E  13FC 0000 00003326       156              MOVE.B  #0,(GSTINRNG)
00001446                           157  .GSTMOVE
00001446  1839 00003325            158              MOVE.B  (GSTLAMO),D4
0000144C                           159              ;MASK OF THE LAST NIBBLE        
0000144C  C47C 000F                160              AND.W   #$000F,D2               ; COORDENADA X
00001450  C67C 000F                161              AND.W   #$000F,D3               ; COORDENADA Y
00001454                           162              
00001454                           163              ;CHECK IF COORDS ARE MULTIPLES OF 16
00001454  B47C 0000                164              CMP     #$0000,D2
00001458  6600 000A                165              BNE     .GSTNOTMULT
0000145C  B67C 0000                166              CMP     #$0000,D3
00001460  6600 0002                167              BNE     .GSTNOTMULT
00001464                           168  .GSTMULT
00001464                           169  
00001464                           170  .GSTNOTMULT            
00001464  B87C 0001                171              CMP     #1,D4
00001468  6700 0016                172              BEQ     .GSTRIGHTMOVE
0000146C  B87C 0002                173              CMP     #2,D4
00001470  6700 003A                174              BEQ     .GSTLEFTMOVE
00001474  B87C 0003                175              CMP     #3,D4
00001478  6700 005E                176              BEQ     .GSTDOWNMOVE
0000147C  6000 0076                177              BRA     .GSTUPMOVE
00001480                           178  
00001480                           179              ;UPDATE COORDS
00001480                           180              
00001480                           181  .GSTRIGHTMOVE
00001480  4EB9 00001BC2            182              JSR     GSTCOLWALLRIGHT
00001486  BA7C 0001                183              CMP     #1,D5
0000148A  6600 0006                184              BNE     .GSTNOTCOLISION
0000148E  303C 0000                185              MOVE.W  #0,D0
00001492                           186  .GSTNOTCOLISION
00001492  BA7C 0004                187              CMP     #4,D5
00001496  6600 000A                188              BNE     .GSTNOTTP
0000149A  0479 01E0 0000331C       189              SUB.W   #30*16,(GSTPOSX)
000014A2                           190  .GSTNOTTP
000014A2  D179 0000331C            191              ADD.W   D0,(GSTPOSX)
000014A8  6000 0066                192              BRA     .GSTDONE
000014AC                           193  .GSTLEFTMOVE
000014AC  4EB9 00001BFE            194              JSR     GSTCOLWALLLEFT
000014B2  BA7C 0001                195              CMP     #1,D5
000014B6  6600 0006                196              BNE     .GSTNOTCOLISION2
000014BA  303C 0000                197              MOVE.W  #0,D0
000014BE                           198  .GSTNOTCOLISION2
000014BE  BA7C 0004                199              CMP     #4,D5
000014C2  6600 000A                200              BNE     .GSTNOTTP2
000014C6  0679 01E0 0000331C       201              ADD.W   #30*16,(GSTPOSX)
000014CE                           202  .GSTNOTTP2
000014CE  9179 0000331C            203              SUB.W   D0,(GSTPOSX)
000014D4  6000 003A                204              BRA     .GSTDONE
000014D8                           205      
000014D8                           206  .GSTDOWNMOVE
000014D8  4EB9 00001C3A            207              JSR     GSTCOLWALLDOWN
000014DE  BA7C 0001                208              CMP     #1,D5
000014E2  6600 0006                209              BNE     .GSTNOTCOLISION3
000014E6  303C 0000                210              MOVE.W  #0,D0
000014EA                           211  .GSTNOTCOLISION3
000014EA  D179 0000331E            212              ADD.W   D0,(GSTPOSY)
000014F0  6000 001E                213              BRA     .GSTDONE
000014F4                           214  .GSTUPMOVE    
000014F4  4EB9 00001C70            215              JSR     GSTCOLWALLUP
000014FA  BA7C 0001                216              CMP     #1,D5
000014FE  6600 0006                217              BNE     .GSTNOTCOLISION4
00001502  303C 0000                218              MOVE.W  #0,D0
00001506                           219  .GSTNOTCOLISION4
00001506  9179 0000331E            220              SUB.W   D0,(GSTPOSY)
0000150C  6000 0002                221              BRA     .GSTDONE
00001510                           222  
00001510                           223  .GSTDONE
00001510  13C4 00003325            224              MOVE.B  D4,(GSTLAMO)
00001516                           225  
00001516  4CDF 001F                226              MOVEM.L (A7)+,D0-D4
0000151A                           227              
0000151A  4E75                     228              RTS
0000151C                           229              
0000151C                           230  ; ------------------------------------------------------------------------------
0000151C                           231  GSTPLOT
0000151C                           232  ; PLOT THE GHOST.
0000151C                           233  ; INPUT    : NONE 
0000151C                           234  ; OUTPUT   : NONE
0000151C                           235  ; MODIFIES : NONE
0000151C                           236  ; ------------------------------------------------------------------------------
0000151C  48E7 F800                237              MOVEM.L D0-D4,-(A7)
00001520                           238              
00001520                           239              ;SET PEN COLOR
00001520  303C 0050                240              MOVE.W  #80,D0
00001524  223C 000000FF            241              MOVE.L  #GSTCOL1,D1
0000152A  4E4F                     242              TRAP    #15
0000152C                           243              
0000152C                           244              ;SET FILL COLOR
0000152C  303C 0051                245              MOVE.W  #81,D0
00001530  223C 00FFFFFF            246              MOVE.L  #GSTFCOL1,D1
00001536  4E4F                     247              TRAP    #15
00001538                           248              
00001538                           249              ;SET COORDS
00001538  3239 0000331C            250              MOVE.W  (GSTPOSX),D1
0000153E  5141                     251              SUB.W   #GSTRAD,D1
00001540  3439 0000331E            252              MOVE.W  (GSTPOSY),D2
00001546  5142                     253              SUB.W   #GSTRAD,D2
00001548                           254              
00001548  3601                     255              MOVE.W  D1,D3
0000154A  0643 0010                256              ADD.W   #GSTRAD*2,D3
0000154E  3802                     257              MOVE.W  D2,D4
00001550  0644 0010                258              ADD.W   #GSTRAD*2,D4
00001554                           259              
00001554                           260              ;DRAW GHOST
00001554  303C 0058                261              MOVE.W  #88,D0
00001558  4E4F                     262              TRAP    #15
0000155A                           263              
0000155A                           264              ;SET RANGE COORDS
0000155A  3239 0000331C            265              MOVE.W  (GSTPOSX),D1
00001560  0441 0100                266              SUB.W   #GSTRNG*16,D1
00001564  3439 0000331E            267              MOVE.W  (GSTPOSY),D2
0000156A  0442 0100                268              SUB.W   #GSTRNG*16,D2
0000156E                           269              
0000156E  3601                     270              MOVE.W  D1,D3
00001570  0643 0200                271              ADD.W   #GSTRNG*16*2,D3
00001574  3802                     272              MOVE.W  D2,D4
00001576  0644 0200                273              ADD.W   #GSTRNG*16*2,D4
0000157A                           274              
0000157A                           275              ;DRAW GHOST RANGE
0000157A  303C 005B                276              MOVE.W  #91,D0
0000157E  4E4F                     277              TRAP    #15
00001580                           278              
00001580  4CDF 001F                279              MOVEM.L (A7)+,D0-D4
00001584                           280              
00001584                           281  
00001584  4E75                     282              RTS
00001586                           283  
00001586                           284  
00001586                           285  
00001586                           286  
00001586                           287  
00001586                           288  -------------------- end include --------------------
00001586                           289              INCLUDE "PAC-MAN.X68"
00001586                           290  ; ==============================================================================
00001586                           291  ; PAC-MAN MANAGEMENT
00001586                           292  ; ==============================================================================
00001586                           293              
00001586                           294  ; ------------------------------------------------------------------------------
00001586                           295  PMINIT
00001586                           296  ; INITIALIZE PAC-MAN.
00001586                           297  ; INPUT    : NONE 
00001586                           298  ; OUTPUT   : NONE
00001586                           299  ; MODIFIES : NONE
00001586                           300  ; ------------------------------------------------------------------------------
00001586                           301  
00001586  33FC 0140 00003312       302              MOVE.W  #SCRWIDTH/2,(PMPOSX)
0000158E  33FC 0140 00003314       303              MOVE.W  #SCRHEIGH/2,(PMPOSY)
00001596  5079 00003312            304              ADDQ.W  #8,(PMPOSX)
0000159C  5079 00003314            305              ADDQ.W  #8,(PMPOSY)
000015A2  33FC 0002 00003316       306              MOVE.W  #PMSPEED,(PMVELX)
000015AA  33FC 0002 00003318       307              MOVE.W  #PMSPEED,(PMVELY)
000015B2  4239 0000331B            308              CLR.B   (PMLAMO)
000015B8                           309  
000015B8  4E75                     310              RTS
000015BA                           311              
000015BA                           312  ; ------------------------------------------------------------------------------
000015BA                           313  PMUPD
000015BA                           314  ; UPDATES THE PAC-MAN.
000015BA                           315  ; INPUT    : NONE 
000015BA                           316  ; OUTPUT   : NONE
000015BA                           317  ; MODIFIES : NONE
000015BA                           318  ; ------------------------------------------------------------------------------
000015BA                           319              
000015BA  48E7 FE00                320              MOVEM.L D0-D6,-(A7)
000015BE                           321              
000015BE  303C 0002                322              MOVE.W  #PMSPEED,D0
000015C2                           323              
000015C2                           324              
000015C2  3439 00003312            325              MOVE.W  (PMPOSX),D2
000015C8  3639 00003314            326              MOVE.W  (PMPOSY),D3
000015CE                           327              
000015CE  5042                     328              ADDQ.W  #8,D2              
000015D0  5043                     329              ADDQ.W  #8,D3  
000015D2                           330              
000015D2  1839 0000331B            331              MOVE.B  (PMLAMO),D4
000015D8                           332              
000015D8                           333              ;MASK OF THE LAST NIBBLE        
000015D8  C47C 000F                334              AND.W   #$000F,D2               ; COORDENADA X
000015DC  C67C 000F                335              AND.W   #$000F,D3               ; COORDENADA Y
000015E0                           336              
000015E0                           337              ;CHECK IF COORDS ARE MULTIPLES OF 16
000015E0  B47C 0000                338              CMP     #$0000,D2
000015E4  6600 0116                339              BNE     .NOTMULT
000015E8  B67C 0000                340              CMP     #$0000,D3
000015EC  6600 010E                341              BNE     .NOTMULT
000015F0                           342              
000015F0                           343              ;BRA     .ACTYUP
000015F0                           344  
000015F0                           345              ;CHECK THE DIRECTION
000015F0  0839 0000 00002480       346              BTST.B  #0,(KBDVAL)             ;CHECK LEFT
000015F8  6700 000C                347              BEQ     .NOTLEFT
000015FC  4204                     348              CLR.B   D4
000015FE  183C 0000                349              MOVE.B  #0,D4
00001602  6000 007C                350              BRA     .ACTXLEFT
00001606                           351  .NOTLEFT            
00001606  0839 0002 00002480       352              BTST.B   #2,(KBDVAL)             ;CHECK RIGHT
0000160E  6700 000C                353              BEQ     .NOTRIGHT
00001612  4204                     354              CLR.B   D4
00001614  183C 0001                355              MOVE.B   #1,D4
00001618  6000 0032                356              BRA     .ACTXRIGHT
0000161C                           357  .NOTRIGHT            
0000161C  0839 0001 00002480       358              BTST.B   #1,(KBDVAL)             ;CHECK UP
00001624  6700 000C                359              BEQ     .NOTUP
00001628  4204                     360              CLR.B   D4
0000162A  183C 0002                361              MOVE.B  #2,D4
0000162E  6000 00A8                362              BRA     .ACTYUP
00001632                           363  .NOTUP            
00001632  0839 0003 00002480       364              BTST.B   #3,(KBDVAL)             ;CHECK DOWN
0000163A  6700 000C                365              BEQ     .NOTDOWN
0000163E  4204                     366              CLR.B   D4
00001640  183C 0003                367              MOVE.B   #3,D4
00001644  6000 006E                368              BRA     .ACTYDOWN
00001648                           369  .NOTDOWN
00001648  6000 00CA                370              BRA     .DONE
0000164C                           371              
0000164C                           372              
0000164C                           373              ;UPDATE COORDS
0000164C                           374              
0000164C                           375  .ACTXRIGHT  
0000164C  4EB9 00001AC4            376              JSR     COLWALLRIGHT
00001652  BA7C 0001                377              CMP     #1,D5
00001656  6600 000E                378              BNE     .NOTCOLISION
0000165A  13FC 0000 00002480       379              MOVE.B  #0,(KBDVAL)
00001662  303C 0000                380              MOVE.W  #0,D0
00001666                           381  .NOTCOLISION
00001666  BA7C 0004                382              CMP     #4,D5
0000166A  6600 000A                383              BNE     .NOTTP
0000166E  0479 01E0 00003312       384              SUB.W   #30*16,(PMPOSX)
00001676                           385  .NOTTP
00001676  D179 00003312            386              ADD.W   D0,(PMPOSX)
0000167C  6000 0096                387              BRA     .DONE
00001680                           388  .ACTXLEFT
00001680  4EB9 00001B06            389              JSR     COLWALLLEFT
00001686  BA7C 0001                390              CMP     #1,D5
0000168A  6600 000E                391              BNE     .NOTCOLISION2
0000168E  13FC 0000 00002480       392              MOVE.B  #0,(KBDVAL)
00001696  303C 0000                393              MOVE.W  #0,D0
0000169A                           394  .NOTCOLISION2
0000169A  BA7C 0004                395              CMP     #4,D5
0000169E  6600 000A                396              BNE     .NOTTP2
000016A2  0679 01E0 00003312       397              ADD.W   #30*16,(PMPOSX)
000016AA                           398  .NOTTP2
000016AA  9179 00003312            399              SUB.W   D0,(PMPOSX)
000016B0  6000 0062                400              BRA     .DONE
000016B4                           401      
000016B4                           402  .ACTYDOWN
000016B4  4EB9 00001B48            403              JSR     COLWALLDOWN
000016BA  BA7C 0001                404              CMP     #1,D5
000016BE  6600 000E                405              BNE     .NOTCOLISION3
000016C2  13FC 0000 00002480       406              MOVE.B  #0,(KBDVAL)
000016CA  303C 0000                407              MOVE.W  #0,D0
000016CE                           408  .NOTCOLISION3
000016CE  D179 00003314            409              ADD.W   D0,(PMPOSY)
000016D4  6000 003E                410              BRA     .DONE
000016D8                           411  .ACTYUP     
000016D8  4EB9 00001B84            412              JSR     COLWALLUP
000016DE  BA7C 0001                413              CMP     #1,D5
000016E2  6600 000E                414              BNE     .NOTCOLISION4
000016E6  13FC 0000 00002480       415              MOVE.B  #0,(KBDVAL)
000016EE  303C 0000                416              MOVE.W  #0,D0
000016F2                           417  .NOTCOLISION4
000016F2  9179 00003314            418              SUB.W   D0,(PMPOSY)
000016F8  6000 001A                419              BRA     .DONE
000016FC                           420              
000016FC                           421              
000016FC                           422              ;IF NOT MULT DO
000016FC                           423  .NOTMULT     
000016FC  B83C 0000                424              CMP.B     #0,D4
00001700  6700 FF7E                425              BEQ     .ACTXLEFT
00001704  B83C 0001                426              CMP.B     #1,D4
00001708  6700 FF42                427              BEQ     .ACTXRIGHT
0000170C  B83C 0002                428              CMP.B     #2,D4
00001710  67C6                     429              BEQ     .ACTYUP
00001712  60A0                     430              BRA     .ACTYDOWN
00001714                           431  .DONE
00001714                           432              ;RESTORE
00001714  4EB9 00001CA8            433              JSR     GETPOINTS
0000171A  13C4 0000331B            434              MOVE.B  D4,(PMLAMO)
00001720                           435              
00001720  4CDF 007F                436              MOVEM.L (A7)+,D0-D6
00001724                           437              
00001724  4E75                     438              RTS
00001726                           439                          
00001726                           440  ; ------------------------------------------------------------------------------
00001726                           441  PMPLOT
00001726                           442  ; PLOT THE BALL.
00001726                           443  ; INPUT    : NONE 
00001726                           444  ; OUTPUT   : NONE
00001726                           445  ; MODIFIES : NONE
00001726                           446  ; ------------------------------------------------------------------------------
00001726                           447  
00001726  48E7 FC00                448              MOVEM.L D0-D5,-(A7)
0000172A                           449  
0000172A                           450              ;SET PEN COLOR
0000172A  303C 0050                451              MOVE.W  #80,D0
0000172E  7200                     452              MOVE.L  #$0000,D1
00001730  4E4F                     453              TRAP    #15
00001732                           454              
00001732                           455              ;SET FILL COLOR
00001732  303C 0051                456              MOVE.W  #81,D0
00001736  223C 0000FFFF            457              MOVE.L  #PMFCOL,D1
0000173C  4E4F                     458              TRAP    #15
0000173E                           459              
0000173E  0839 0003 00002483       460              BTST.B  #3,(SCRCYCCT)
00001746  6700 000C                461              BEQ     .MOUTHOPEN
0000174A                           462              
0000174A                           463              ;DRAW QUIET
0000174A  4EB9 000017E8            464              JSR     .FULLDRAW
00001750  6000 0090                465              BRA     .DDONE
00001754                           466              
00001754                           467  .MOUTHOPEN     
00001754  4EB9 000017E8            468              JSR     .FULLDRAW       
0000175A  1A39 00002480            469              MOVE.B  (KBDVAL),D5
00001760  CA3C 000F                470              AND.B   #$0F,D5
00001764                           471   
00001764                           472              ;CHECK KBDVAL
00001764  BA3C 0000                473              CMP.B   #$0,D5
00001768  6700 0022                474              BEQ     .NOTMOVE
0000176C  BA3C 0001                475              CMP.B  #$1,D5             ;LEFT
00001770  6700 0038                476              BEQ     .DLEFT
00001774  BA3C 0002                477              CMP.B  #$2,D5             ;UP
00001778  6700 0026                478              BEQ     .DUP
0000177C  BA3C 0004                479              CMP.B  #$4,D5             ;RIGHT
00001780  6700 0014                480              BEQ     .DRIGHT
00001784  BA3C 0008                481              CMP.B  #$8,D5             ;DOWN
00001788  6700 002A                482              BEQ     .DDOWN
0000178C                           483              
0000178C                           484              ;DRAW MOVEMENT
0000178C  4EB9 000017E8            485  .NOTMOVE    JSR     .FULLDRAW
00001792  6000 004E                486              BRA     .DDONE
00001796                           487  .DRIGHT
00001796  4EB9 0000183E            488              JSR     .RIGHTDRAW
0000179C  6000 0034                489              BRA     .DRAW_MOUTH3
000017A0                           490  .DUP
000017A0  4EB9 00001870            491              JSR     .UPDRAW
000017A6  6000 0020                492              BRA     .DRAW_MOUTH2
000017AA                           493  
000017AA                           494  .DLEFT
000017AA  4EB9 0000180C            495              JSR     .LEFTDRAW
000017B0  6000 000C                496              BRA     .DRAW_MOUTH1
000017B4                           497  
000017B4                           498  .DDOWN
000017B4  4EB9 000018A2            499              JSR     .DOWNDRAW
000017BA  6000 0020                500              BRA     .DRAW_MOUTH4
000017BE                           501              
000017BE                           502  .DRAW_MOUTH1            
000017BE  4EB9 000018D4            503              JSR     .SET_MOUTHLEFT
000017C4  6000 001C                504              BRA     .DDONE
000017C8                           505  .DRAW_MOUTH2            
000017C8  4EB9 00001910            506              JSR     .SET_MOUTHUP
000017CE  6000 0012                507              BRA     .DDONE
000017D2                           508  .DRAW_MOUTH3            
000017D2  4EB9 000018F2            509              JSR     .SET_MOUTHRIGHT
000017D8  6000 0008                510              BRA     .DDONE
000017DC                           511  .DRAW_MOUTH4            
000017DC  4EB9 0000192E            512              JSR     .SET_MOUTHDOWN
000017E2                           513  .DDONE
000017E2  4CDF 003F                514              MOVEM.L (A7)+,D0-D5
000017E6                           515              
000017E6  4E75                     516              RTS
000017E8                           517  
000017E8                           518  
000017E8                           519  ;INTERNAL SUBRUTINES FOR PACMAN PLOT-------------------------------------------------------------
000017E8                           520  
000017E8                           521  .FULLDRAW
000017E8                           522              ;SET COORDS
000017E8  3239 00003312            523              MOVE.W  (PMPOSX),D1
000017EE  5141                     524              SUB.W   #PMRAD,D1
000017F0  3439 00003314            525              MOVE.W  (PMPOSY),D2
000017F6  5142                     526              SUB.W   #PMRAD,D2
000017F8                           527              
000017F8  3601                     528              MOVE.W  D1,D3
000017FA  0643 0010                529              ADD.W   #PMRAD*2,D3
000017FE  3802                     530              MOVE.W  D2,D4
00001800  0644 0010                531              ADD.W   #PMRAD*2,D4
00001804                           532              
00001804                           533              ;DRAW PAC-MAN
00001804  303C 0058                534              MOVE.W  #88,D0
00001808  4E4F                     535              TRAP    #15
0000180A                           536              
0000180A  4E75                     537              RTS
0000180C                           538  .LEFTDRAW
0000180C                           539              
0000180C                           540              
0000180C  303C 0054                541              MOVE.W  #84,D0
00001810  3239 00003312            542              MOVE.W  (PMPOSX),D1                   ;FINAL COORD OF THE FIRST LINE
00001816  5141                     543              SUB.W   #PMRAD,D1
00001818  3439 00003314            544              MOVE.W  (PMPOSY),D2
0000181E  5142                     545              SUB.W   #PMRAD,D2
00001820                           546              
00001820  3639 00003312            547              MOVE.W  (PMPOSX),D3                   ;ORIGINAL COORD FIRST LINE
00001826  3839 00003314            548              MOVE.W  (PMPOSY),D4
0000182C                           549              
0000182C  4E4F                     550              TRAP    #15
0000182E                           551             
0000182E  303C 0055                552              MOVE.W  #85,D0                        ;DRAW SECOND LINE
00001832                           553              
00001832  3203                     554              MOVE.W  D3,D1
00001834  3404                     555              MOVE.W  D4,D2
00001836  5042                     556              ADD.W   #PMRAD,D2
00001838  5141                     557              SUB.W   #PMRAD,D1
0000183A                           558              
0000183A  4E4F                     559              TRAP    #15
0000183C                           560              
0000183C                           561              
0000183C  4E75                     562              RTS
0000183E                           563              
0000183E                           564  .RIGHTDRAW
0000183E                           565              
0000183E                           566              
0000183E  303C 0054                567              MOVE.W  #84,D0
00001842  3239 00003312            568              MOVE.W  (PMPOSX),D1                   ;FINAL COORD OF THE FIRST LINE
00001848  5041                     569              ADD.W   #PMRAD,D1
0000184A  3439 00003314            570              MOVE.W  (PMPOSY),D2
00001850  5042                     571              ADD.W   #PMRAD,D2
00001852                           572              
00001852  3639 00003312            573              MOVE.W  (PMPOSX),D3                   ;ORIGINAL COORD FIRST LINE
00001858  3839 00003314            574              MOVE.W  (PMPOSY),D4
0000185E                           575              
0000185E  4E4F                     576              TRAP    #15
00001860                           577             
00001860  303C 0055                578              MOVE.W  #85,D0                        ;DRAW SECOND LINE
00001864                           579              
00001864  3203                     580              MOVE.W  D3,D1
00001866  3404                     581              MOVE.W  D4,D2
00001868  5142                     582              SUB.W   #PMRAD,D2
0000186A  5041                     583              ADD.W   #PMRAD,D1
0000186C                           584              
0000186C  4E4F                     585              TRAP    #15
0000186E                           586              
0000186E                           587              
0000186E  4E75                     588              RTS
00001870                           589  .UPDRAW
00001870                           590              
00001870                           591              
00001870  303C 0054                592              MOVE.W  #84,D0
00001874  3239 00003312            593              MOVE.W  (PMPOSX),D1                   ;FINAL COORD OF THE FIRST LINE
0000187A  5141                     594              SUB.W   #PMRAD,D1
0000187C  3439 00003314            595              MOVE.W  (PMPOSY),D2
00001882  5142                     596              SUB.W   #PMRAD,D2
00001884                           597              
00001884  3639 00003312            598              MOVE.W  (PMPOSX),D3                   ;ORIGINAL COORD FIRST LINE
0000188A  3839 00003314            599              MOVE.W  (PMPOSY),D4
00001890                           600              
00001890  4E4F                     601              TRAP    #15
00001892                           602             
00001892  303C 0055                603              MOVE.W  #85,D0                        ;DRAW SECOND LINE
00001896                           604              
00001896  3203                     605              MOVE.W  D3,D1
00001898  3404                     606              MOVE.W  D4,D2
0000189A  5142                     607              SUB.W   #PMRAD,D2
0000189C  5041                     608              ADD.W   #PMRAD,D1
0000189E                           609              
0000189E  4E4F                     610              TRAP    #15
000018A0                           611              
000018A0                           612              
000018A0  4E75                     613              RTS
000018A2                           614              
000018A2                           615  .DOWNDRAW
000018A2                           616              
000018A2                           617              
000018A2  303C 0054                618              MOVE.W  #84,D0
000018A6  3239 00003312            619              MOVE.W  (PMPOSX),D1                   ;FINAL COORD OF THE FIRST LINE
000018AC  5141                     620              SUB.W   #PMRAD,D1
000018AE  3439 00003314            621              MOVE.W  (PMPOSY),D2
000018B4  5042                     622              ADD.W   #PMRAD,D2
000018B6                           623              
000018B6  3639 00003312            624              MOVE.W  (PMPOSX),D3                   ;ORIGINAL COORD FIRST LINE
000018BC  3839 00003314            625              MOVE.W  (PMPOSY),D4
000018C2                           626              
000018C2  4E4F                     627              TRAP    #15
000018C4                           628             
000018C4  303C 0055                629              MOVE.W  #85,D0                        ;DRAW SECOND LINE
000018C8                           630              
000018C8  3203                     631              MOVE.W  D3,D1
000018CA  3404                     632              MOVE.W  D4,D2
000018CC  5042                     633              ADD.W   #PMRAD,D2
000018CE  5041                     634              ADD.W   #PMRAD,D1
000018D0                           635              
000018D0  4E4F                     636              TRAP    #15
000018D2                           637              
000018D2                           638              
000018D2  4E75                     639              RTS
000018D4                           640  
000018D4                           641              
000018D4                           642  .SET_MOUTHLEFT
000018D4                           643              
000018D4  303C 0051                644              MOVE.W  #81,D0                         ;SET BLACK
000018D8  7200                     645              MOVE.L  #$0000,D1
000018DA  4E4F                     646              TRAP    #15
000018DC                           647              
000018DC  303C 0059                648              MOVE.W  #89,D0                         ;FILL
000018E0  3239 00003312            649              MOVE.W  (PMPOSX),D1
000018E6  5541                     650              SUBQ.W   #2,D1
000018E8  3439 00003314            651              MOVE.W  (PMPOSY),D2
000018EE  4E4F                     652              TRAP    #15
000018F0                           653  
000018F0  4E75                     654              RTS
000018F2                           655              
000018F2                           656  .SET_MOUTHRIGHT
000018F2                           657              
000018F2  303C 0051                658              MOVE.W  #81,D0                         ;SET BLACK
000018F6  7200                     659              MOVE.L  #$0000,D1
000018F8  4E4F                     660              TRAP    #15
000018FA                           661              
000018FA  303C 0059                662              MOVE.W  #89,D0                         ;FILL
000018FE  3239 00003312            663              MOVE.W  (PMPOSX),D1
00001904  5441                     664              ADDQ.W   #2,D1
00001906  3439 00003314            665              MOVE.W  (PMPOSY),D2
0000190C  4E4F                     666              TRAP    #15
0000190E                           667  
0000190E  4E75                     668              RTS
00001910                           669  
00001910                           670  .SET_MOUTHUP
00001910                           671              
00001910  303C 0051                672              MOVE.W  #81,D0                         ;SET BLACK
00001914  7200                     673              MOVE.L  #$0000,D1
00001916  4E4F                     674              TRAP    #15
00001918                           675              
00001918  303C 0059                676              MOVE.W  #89,D0                         ;FILL
0000191C  3239 00003312            677              MOVE.W  (PMPOSX),D1
00001922  3439 00003314            678              MOVE.W  (PMPOSY),D2
00001928  5542                     679              SUBQ.W   #2,D2
0000192A  4E4F                     680              TRAP    #15
0000192C                           681  
0000192C  4E75                     682              RTS
0000192E                           683  
0000192E                           684  .SET_MOUTHDOWN
0000192E                           685              
0000192E  303C 0051                686              MOVE.W  #81,D0                         ;SET BLACK
00001932  7200                     687              MOVE.L  #$0000,D1
00001934  4E4F                     688              TRAP    #15
00001936                           689              
00001936  303C 0059                690              MOVE.W  #89,D0                         ;FILL
0000193A  3239 00003312            691              MOVE.W  (PMPOSX),D1
00001940  3439 00003314            692              MOVE.W  (PMPOSY),D2
00001946  5442                     693              ADDQ.W   #2,D2
00001948  4E4F                     694              TRAP    #15
0000194A                           695  
0000194A  4E75                     696              RTS
0000194C                           697  
0000194C                           698  
0000194C                           699  
0000194C                           700  
0000194C                           701  
0000194C                           702  
0000194C                           703  
0000194C                           704  
0000194C                           705  
0000194C                           706  
0000194C                           707  
0000194C                           708  
0000194C                           709  
0000194C                           710  
0000194C                           711  
0000194C                           712  
0000194C                           713  
0000194C                           714  
0000194C                           715  
0000194C                           716  
0000194C                           717  
0000194C                           718  
0000194C                           719  
0000194C                           720  
0000194C                           721  
0000194C                           722  
0000194C                           723  
0000194C                           724  -------------------- end include --------------------
0000194C                           725              INCLUDE "SCORE.X68"
0000194C                           726  ; ==============================================================================
0000194C                           727  ; SCOREBOARD MANAGEMENT
0000194C                           728  ; ==============================================================================
0000194C                           729              
0000194C                           730  ; ------------------------------------------------------------------------------
0000194C                           731  SCOINIT
0000194C                           732  ; INITIALIZE SCOREBOARD
0000194C                           733  ; INPUT    : NONE 
0000194C                           734  ; OUTPUT   : NONE
0000194C                           735  ; MODIFIES : NONE
0000194C                           736  ; ------------------------------------------------------------------------------
0000194C  4279 0000332A            737              CLR.W   (SCOPOINTS)
00001952  33FC 0003 00003328       738              MOVE.W  #3,(SCOLIFE)
0000195A  4E75                     739              RTS
0000195C                           740              
0000195C                           741  ; ------------------------------------------------------------------------------
0000195C                           742  SCOPLOT
0000195C                           743  ; PLOT THE SCOREBOARD
0000195C                           744  ; INPUT    : NONE 
0000195C                           745  ; OUTPUT   : NONE
0000195C                           746  ; MODIFIES : NONE
0000195C                           747  ; ------------------------------------------------------------------------------
0000195C                           748              
0000195C  48E7 C040                749               MOVEM.L D0-D1/A1,-(A7)
00001960                           750  
00001960                           751              ; SET BACKGROUND COLOR
00001960  103C 0051                752              MOVE.B  #81,D0
00001964  7200                     753              MOVE.L  #SCOFCOL,D1
00001966  4E4F                     754              TRAP    #15
00001968                           755              
00001968                           756              ; SET FIRST LINE POSITION
00001968  103C 000B                757              MOVE.B  #11,D0
0000196C  323C 0101                758              MOVE.W  #SCOLINE1,D1
00001970  4E4F                     759              TRAP    #15
00001972                           760  
00001972                           761              ; PRINT FIRST LINE
00001972  43F9 000019AA            762              LEA     .TXT1,A1            ;PUT FIRST STRING IN A1
00001978  4281                     763              CLR.L   D1
0000197A  3239 0000332A            764              MOVE.W  (SCOPOINTS),D1
00001980  103C 0011                765              MOVE.B  #17,D0
00001984  4E4F                     766              TRAP    #15
00001986                           767  
00001986                           768              ; SET SECOND LINE POSITION
00001986  103C 000B                769              MOVE.B  #11,D0
0000198A  323C 0102                770              MOVE.W  #SCOLINE2,D1       
0000198E  4E4F                     771              TRAP    #15
00001990                           772  
00001990                           773              ; PRINT SECOND LINE
00001990  43F9 000019B3            774              LEA     .TXT2,A1
00001996  4281                     775              CLR.L   D1
00001998  3239 00003328            776              MOVE.W  (SCOLIFE),D1
0000199E  103C 0011                777              MOVE.B  #17,D0
000019A2  4E4F                     778              TRAP    #15
000019A4                           779              
000019A4  4CDF 0203                780              MOVEM.L (A7)+,D0-D1/A1
000019A8                           781              
000019A8  4E75                     782              RTS
000019AA                           783  
000019AA= 50 4F 49 4E 54 53 ...    784  .TXT1       DC.B    'POINTS :',0      ;0 IS END OF STRING
000019B3= 4C 49 46 45 53 20 ...    785  .TXT2       DC.B    'LIFES  :',0
000019BC                           786  
000019BC                           787  
000019BC  4E75                     788              RTS
000019BE                           789  
000019BE                           790  
000019BE                           791  -------------------- end include --------------------
000019BE                           792              INCLUDE "SYSCONST.X68"
000019BE                           793  ; ==============================================================================
000019BE                           794  ; SYSTEM CONSTANTS
000019BE                           795  ; ==============================================================================
000019BE                           796  
000019BE                           797  ; --- SCREEN RELATED CONSTANTS -------------------------------------------------
000019BE                           798  
000019BE  =00000280                799  SCRWIDTH    EQU     640                     ; SCREEN WIDTH
000019BE  =00000280                800  SCRHEIGH    EQU     640                     ; SCREEN HEIGHT
000019BE                           801  
000019BE                           802  ;--- TITLE RELATED CONSTANTS ---------------------------------------------------
000019BE= 74 69 74 6C 65 2E ...    803  FILENAME    DC.B    'title.txt',0
000019C8  =00000A8C                804  FILESIZE    EQU     2700
000019C8                           805              DS.B    0                       
000019C8                           806  ;---KEYCODES--------------------------------------------------------------------
000019C8                           807  
000019C8  =00000025                808  KBDLEFT     EQU     $25
000019C8  =00000026                809  KBDUP       EQU     $26
000019C8  =00000027                810  KBDRIGHT    EQU     $27
000019C8  =00000028                811  KBDDOWN     EQU     $28
000019C8  =00000020                812  KBDFIRE1    EQU     ' '
000019C8  =0000004D                813  KBDFIRE2    EQU     'M'                         
000019C8  =00000010                814  KBDFIRE3    EQU     $10
000019C8  =00000050                815  KBDPAUSE    EQU     'P'
000019C8                           816  
000019C8                           817  
000019C8                           818  
000019C8                           819  
000019C8                           820  
000019C8                           821  
000019C8                           822  
000019C8                           823  
000019C8                           824  
000019C8                           825  
000019C8                           826  -------------------- end include --------------------
000019C8                           827              INCLUDE "SYSTEM.X68"
000019C8                           828  ; ==============================================================================
000019C8                           829  ; SYSTEM
000019C8                           830  ; ==============================================================================
000019C8                           831              
000019C8                           832  ; ------------------------------------------------------------------------------
000019C8                           833  SYSINIT
000019C8                           834  ; INITIALIZE SYSTEM.
000019C8                           835  ; INPUT    : NONE
000019C8                           836  ; OUTPUT   : NONE
000019C8                           837  ; MODIFIES : NONE
000019C8                           838  ; ------------------------------------------------------------------------------
000019C8                           839              
000019C8  21FC 00001A38 0080       840              MOVE.L  #SCRUPD,($80+0*4)          ;INSTALL SUBRUTINE TO TRAP #0
000019D0  21FC 00001A6E 0084       841              MOVE.L  #KBDUPD,($80+1*4)          ;INSTALL SUBRUTINE TO TRAP #1
000019D8                           842              
000019D8                           843              
000019D8  21FC 00001A52 0064       844              MOVE.L  #SCRTIM,($60+1*4)          ;INSTALL INTERRUPT #1
000019E0                           845              
000019E0  4EB9 000019F4            846              JSR     SCRINIT
000019E6  4EB9 00001A60            847              JSR     KBDINIT
000019EC                           848              
000019EC                           849              
000019EC  40E7                     850              MOVE.W  SR,-(A7)
000019EE  0257 D8FF                851              ANDI.W  #$D8FF,(A7)                ;BIT SUPERVISOR TO O AND INTERRPUT MASK 000 (FOR REACTIVATE INTERRUPTIONS)             
000019F2  4E73                     852              RTE
000019F4                           853     
000019F4                           854  ; ------------------------------------------------------------------------------
000019F4                           855  SCRINIT
000019F4                           856  ; INIT SCREEN. SET SCREEN RESOLUTION, SET WINDOWED MODE, CLEAR SCREEN, ENABLE BUFFER
000019F4                           857  ; ENABLE TIMED INTERRUPTION
000019F4                           858  ; INPUT    : NONE
000019F4                           859  ; OUTPUT   : NONE
000019F4                           860  ; MODIFIES : NONE
000019F4                           861  ; ------------------------------------------------------------------------------
000019F4                           862  
000019F4  48E7 C000                863              MOVEM.L D0-D1,-(A7)                 ;SAFE REGISTERS IN STACK
000019F8                           864  
000019F8                           865              ; SET SCREEN RESOLUTION
000019F8  103C 0021                866              MOVE.B  #33,D0
000019FC  223C 02800280            867              MOVE.L  #SCRWIDTH<<16|SCRHEIGH,D1
00001A02  4E4F                     868              TRAP    #15
00001A04                           869              
00001A04                           870              ; SET WINDOWED MODE
00001A04  7201                     871              MOVE.L  #1,D1
00001A06  4E4F                     872              TRAP    #15
00001A08                           873              
00001A08                           874              ; ENABLE DOUBLE BUFFER
00001A08  103C 005C                875              MOVE.B  #92,D0
00001A0C  123C 0011                876              MOVE.B  #17,D1
00001A10  4E4F                     877              TRAP    #15
00001A12                           878              
00001A12                           879              ; CLEAR SCREEN
00001A12  103C 000B                880              MOVE.B  #11,D0
00001A16  323C FF00                881              MOVE.W  #$FF00,D1
00001A1A  4E4F                     882              TRAP    #15
00001A1C                           883              
00001A1C                           884              ;ENABLE TIMED INTERRPUT
00001A1C  303C 0020                885              MOVE.W  #32,D0
00001A20  123C 0006                886              MOVE.B  #6,D1
00001A24  143C 0081                887              MOVE.B  #$81,D2                   ;INDICATE THAT INTERRUPT 1 IS ACTIVATED PERIODICALLY
00001A28  7614                     888              MOVE.L  #20,D3                    ;INDICATE THE MILISECONDS FOR THAT PERIOD (20 ms == 50 FPS)
00001A2A  4E4F                     889              TRAP    #15
00001A2C                           890              
00001A2C                           891              ;CLEAR INTERRUPT COUNTER
00001A2C  4239 00002482            892              CLR.B   (SCRINTCT)
00001A32                           893              
00001A32  4CDF 0003                894              MOVEM.L (A7)+,D0-D1               ;RESTORE REGISTERS FROM STACK
00001A36                           895              
00001A36  4E75                     896              RTS
00001A38                           897  
00001A38                           898  
00001A38                           899              
00001A38                           900  ;------------------------------------------------------------------------------            
00001A38                           901  SCRUPD
00001A38                           902  ; UPDATES DOUBLE BUFFER
00001A38                           903  ; INPUT    : NONE
00001A38                           904  ; OUTPUT   : NONE
00001A38                           905  ; MODIFIES : NONE
00001A38                           906  ; ------------------------------------------------------------------------------
00001A38                           907  
00001A38  48E7 C000                908              MOVEM.L D0-D1,-(A7)
00001A3C                           909              
00001A3C                           910              ;SWITCH BUFFERS
00001A3C  103C 005E                911              MOVE.B #94,D0
00001A40  4E4F                     912              TRAP #15
00001A42                           913              
00001A42                           914              ;CLEAR HIDDEN BUFFER
00001A42  103C 000B                915              MOVE.B  #11,D0
00001A46  323C FF00                916              MOVE.W  #$FF00,D1
00001A4A  4E4F                     917              TRAP    #15
00001A4C                           918              
00001A4C  4CDF 0003                919              MOVEM.L (A7)+,D0-D1
00001A50                           920              
00001A50  4E73                     921              RTE
00001A52                           922              
00001A52                           923  ; ------------------------------------------------------------------------------
00001A52                           924  SCRTIM
00001A52                           925  ; TIMED INTERRUPT SERVICE ROUTINE
00001A52                           926  ; INPUT    : NONE
00001A52                           927  ; OUTPUT   : NONE
00001A52                           928  ; MODIFIES : NONE
00001A52                           929  ; ------------------------------------------------------------------------------
00001A52  5239 00002482            930              ADDQ.B  #1,(SCRINTCT)
00001A58  5239 00002483            931              ADDQ.B  #1,(SCRCYCCT)
00001A5E  4E73                     932              RTE
00001A60                           933              
00001A60                           934  ;------------------------------------------------------------------------------            
00001A60                           935  KBDINIT
00001A60                           936  ; INIT THE KEYBOARD
00001A60                           937  ; INPUT    : NONE
00001A60                           938  ; OUTPUT   : NONE
00001A60                           939  ; MODIFIES : NONE
00001A60                           940  ; ------------------------------------------------------------------------------
00001A60                           941  
00001A60  4239 00002480            942              CLR.B   (KBDVAL)
00001A66  4239 00002481            943              CLR.B   (KBDEDGE)
00001A6C                           944  
00001A6C  4E75                     945              RTS
00001A6E                           946  
00001A6E                           947  ;------------------------------------------------------------------------------            
00001A6E                           948  KBDUPD
00001A6E                           949  ; UPDATES KEYBOARD INFO
00001A6E                           950  ; 3 -> DOWN     (HEX: 8)
00001A6E                           951  ; 2 -> RIGHT    (HEX: 4)
00001A6E                           952  ; 1 -> UP       (HEX: 2)
00001A6E                           953  ; 0 -> LEFT     (HEX: 1)
00001A6E                           954  ; ------------------------------------------------------------------------------
00001A6E                           955              
00001A6E  48E7 F800                956              MOVEM.L D0-D4,-(A7)
00001A72                           957              
00001A72                           958              ; READ FIRST PART
00001A72  103C 0013                959              MOVE.B  #19,D0
00001A76  223C 50104D20            960              MOVE.L  #KBDPAUSE<<24|KBDFIRE3<<16|KBDFIRE2<<8|KBDFIRE1,D1
00001A7C  4E4F                     961              TRAP    #15
00001A7E                           962  
00001A7E                           963              ; CONVERT TO DESIRED FORMAT
00001A7E  4EB9 00001AB6            964              JSR     .CONVERT
00001A84                           965  
00001A84                           966              ; READ SECOND PART
00001A84  223C 28272625            967              MOVE.L  #KBDDOWN<<24|KBDRIGHT<<16|KBDUP<<8|KBDLEFT,D1
00001A8A  4E4F                     968              TRAP    #15
00001A8C                           969              
00001A8C                           970              ;CONVERT TO DESIRED FORMAT
00001A8C  4EB9 00001AB6            971              JSR .CONVERT
00001A92                           972  
00001A92                           973              ;GET KBDEDGE (IF SOME KEY HAVE CHANGED THE VALUE)
00001A92  1039 00002480            974              MOVE.B  (KBDVAL),D0             ;D0 -> LAST KBDVAL
00001A98  4600                     975              NOT.B   D0                      ;D2 -> ACTUAL KBDVAL
00001A9A  C002                     976              AND.B   D2,D0
00001A9C  13C0 00002481            977              MOVE.B  D0,(KBDEDGE)
00001AA2                           978              
00001AA2                           979         
00001AA2  B03C 0000                980              CMP.B   #0,D0
00001AA6  6700 0008                981              BEQ     .NOACT          
00001AAA                           982              
00001AAA                           983              ;STORE NEW KBDVAL
00001AAA  13C2 00002480            984              MOVE.B  D2,(KBDVAL)
00001AB0                           985  .NOACT
00001AB0                           986              
00001AB0  4CDF 001F                987              MOVEM.L (A7)+,D0-D4
00001AB4                           988              
00001AB4  4E73                     989              RTE    
00001AB6                           990              
00001AB6                           991  .CONVERT 
00001AB6  363C 0003                992              MOVE.W  #3,D3
00001ABA                           993              
00001ABA  E189                     994  .LOOP       LSL.L   #8,D1
00001ABC  E312                     995              ROXL.B  #1,D2
00001ABE  51CB FFFA                996              DBRA.W  D3,.LOOP
00001AC2  4E75                     997              RTS
00001AC4                           998             
00001AC4                           999  
00001AC4                          1000  ;------------------------------------------------------------------------------            
00001AC4                          1001  COLWALLRIGHT
00001AC4                          1002  ; COLLISION PAC-MAN WITH WALL
00001AC4                          1003  ; INPUT    : NONE
00001AC4                          1004  ; OUTPUT   : NONE
00001AC4                          1005  ; MODIFIES : NONE
00001AC4                          1006  ; ------------------------------------------------------------------------------
00001AC4                          1007  
00001AC4  48E7 F800               1008              MOVEM.L D0-D4,-(A7)
00001AC8                          1009  
00001AC8  3039 00003312           1010              MOVE.W  (PMPOSX),D0
00001ACE  5140                    1011              SUB.W   #8,D0
00001AD0  3239 00003314           1012              MOVE.W  (PMPOSY),D1
00001AD6  5041                    1013              ADD.W   #8,D1
00001AD8                          1014              
00001AD8  81FC 0010               1015              DIVS.W  #16,D0
00001ADC  83FC 0010               1016              DIVS.W  #16,D1
00001AE0                          1017              
00001AE0  5940                    1018              SUB.W   #4,D0                   ;LI RESTAM 4 PERQUE LA MATRIU ESTA A UNA DISTANCIA DE 64 PIXELS DE LA PANTALLA
00001AE2  5941                    1019              SUB.W   #4,D1
00001AE4                          1020              
00001AE4  41F9 00002484           1021              LEA.L   MAPVAR,A0
00001AEA                          1022              
00001AEA  5240                    1023              ADD.W   #1,D0
00001AEC  5341                    1024              SUB.W   #1,D1
00001AEE  C2FC 0020               1025              MULU.W  #32,D1
00001AF2  D041                    1026              ADD.W   D1,D0
00001AF4                          1027              
00001AF4  3240                    1028              MOVE.W  D0,A1
00001AF6  13C0 00002884           1029              MOVE.B  D0,POSCON
00001AFC                          1030  
00001AFC  1A29 2484               1031              MOVE.B  MAPVAR(A1),D5
00001B00                          1032              
00001B00  4CDF 001F               1033              MOVEM.L (A7)+,D0-D4
00001B04                          1034              
00001B04  4E75                    1035              RTS
00001B06                          1036  
00001B06                          1037  
00001B06                          1038  ;------------------------------------------------------------------------------            
00001B06                          1039  COLWALLLEFT
00001B06                          1040  ; COLLISION PAC-MAN WITH WALL
00001B06                          1041  ; INPUT    : NONE
00001B06                          1042  ; OUTPUT   : NONE
00001B06                          1043  ; MODIFIES : NONE
00001B06                          1044  ; ------------------------------------------------------------------------------
00001B06                          1045  
00001B06  48E7 F800               1046              MOVEM.L D0-D4,-(A7)
00001B0A                          1047  
00001B0A  3039 00003312           1048              MOVE.W  (PMPOSX),D0
00001B10  5C40                    1049              ADD.W   #6,D0
00001B12  3239 00003314           1050              MOVE.W  (PMPOSY),D1
00001B18  5041                    1051              ADD.W   #8,D1
00001B1A                          1052              
00001B1A  81FC 0010               1053              DIVS.W  #16,D0
00001B1E  83FC 0010               1054              DIVS.W  #16,D1
00001B22                          1055              
00001B22  5940                    1056              SUB.W   #4,D0                   ;LI RESTAM 4 PERQUE LA MATRIU ESTA A UNA DISTANCIA DE 64 PIXELS DE LA PANTALLA
00001B24  5941                    1057              SUB.W   #4,D1
00001B26                          1058              
00001B26  41F9 00002484           1059              LEA.L   MAPVAR,A0
00001B2C                          1060              
00001B2C  5340                    1061              SUB.W   #1,D0
00001B2E  5341                    1062              SUB.W   #1,D1
00001B30  C2FC 0020               1063              MULU.W  #32,D1
00001B34  D041                    1064              ADD.W   D1,D0
00001B36                          1065  
00001B36  3240                    1066              MOVE.W  D0,A1
00001B38  13C0 00002884           1067              MOVE.B  D0,POSCON
00001B3E                          1068  
00001B3E  1A29 2484               1069              MOVE.B  MAPVAR(A1),D5               
00001B42                          1070  
00001B42                          1071              
00001B42  4CDF 001F               1072              MOVEM.L (A7)+,D0-D4
00001B46                          1073              
00001B46  4E75                    1074              RTS
00001B48                          1075  
00001B48                          1076  ;------------------------------------------------------------------------------            
00001B48                          1077  COLWALLDOWN
00001B48                          1078  ; COLLISION PAC-MAN WITH WALL
00001B48                          1079  ; INPUT    : NONE
00001B48                          1080  ; OUTPUT   : NONE
00001B48                          1081  ; MODIFIES : NONE
00001B48                          1082  ; ------------------------------------------------------------------------------
00001B48                          1083  
00001B48  48E7 F800               1084              MOVEM.L D0-D4,-(A7)
00001B4C                          1085  
00001B4C  3039 00003312           1086              MOVE.W  (PMPOSX),D0
00001B52                          1087              ;ADD.W   #8,D0
00001B52  3239 00003314           1088              MOVE.W  (PMPOSY),D1
00001B58  5041                    1089              ADD.W   #8,D1
00001B5A                          1090              
00001B5A  81FC 0010               1091              DIVS.W  #16,D0
00001B5E  83FC 0010               1092              DIVS.W  #16,D1
00001B62                          1093              
00001B62  5940                    1094              SUB.W   #4,D0                   ;LI RESTAM 4 PERQUE LA MATRIU ESTA A UNA DISTANCIA DE 64 PIXELS DE LA PANTALLA
00001B64  5941                    1095              SUB.W   #4,D1
00001B66                          1096              
00001B66  41F9 00002484           1097              LEA.L   MAPVAR,A0
00001B6C                          1098              
00001B6C  C2FC 0020               1099              MULU.W  #32,D1
00001B70  D041                    1100              ADD.W   D1,D0
00001B72                          1101  
00001B72  3240                    1102              MOVE.W  D0,A1
00001B74  13C0 00002884           1103              MOVE.B  D0,POSCON
00001B7A                          1104  
00001B7A  1A29 2484               1105              MOVE.B  MAPVAR(A1),D5 
00001B7E                          1106  
00001B7E                          1107              
00001B7E  4CDF 001F               1108              MOVEM.L (A7)+,D0-D4
00001B82                          1109              
00001B82  4E75                    1110              RTS
00001B84                          1111  
00001B84                          1112  
00001B84                          1113  ;------------------------------------------------------------------------------            
00001B84                          1114  COLWALLUP
00001B84                          1115  ; COLLISION PAC-MAN WITH WALL
00001B84                          1116  ; INPUT    : NONE
00001B84                          1117  ; OUTPUT   : NONE
00001B84                          1118  ; MODIFIES : NONE
00001B84                          1119  ; ------------------------------------------------------------------------------
00001B84                          1120  
00001B84  48E7 F800               1121              MOVEM.L D0-D4,-(A7)
00001B88                          1122  
00001B88  3039 00003312           1123              MOVE.W  (PMPOSX),D0
00001B8E                          1124              ;SUB.W   #8,D0
00001B8E  3239 00003314           1125              MOVE.W  (PMPOSY),D1
00001B94  5C41                    1126              ADD.W   #6,D1
00001B96                          1127              
00001B96                          1128              
00001B96  81FC 0010               1129              DIVS.W  #16,D0
00001B9A  83FC 0010               1130              DIVS.W  #16,D1
00001B9E                          1131              
00001B9E  5940                    1132              SUB.W   #4,D0                   ;LI RESTAM 4 PERQUE LA MATRIU ESTA A UNA DISTANCIA DE 64 PIXELS DE LA PANTALLA
00001BA0  5941                    1133              SUB.W   #4,D1
00001BA2                          1134              
00001BA2  41F9 00002484           1135              LEA.L   MAPVAR,A0
00001BA8                          1136              
00001BA8  5341                    1137              SUB.W   #1,D1
00001BAA                          1138              ;CMP     #1,D1
00001BAA                          1139              ;BLO     BUCLE4
00001BAA  C2FC 0020               1140              MULU.W  #32,D1
00001BAE  D041                    1141              ADD.W   D1,D0
00001BB0                          1142  
00001BB0                          1143  ;BUCLE4            
00001BB0  3240                    1144              MOVE.W  D0,A1
00001BB2  13C0 00002884           1145              MOVE.B  D0,POSCON
00001BB8                          1146  
00001BB8  1A29 2484               1147              MOVE.B  MAPVAR(A1),D5 
00001BBC                          1148  
00001BBC                          1149              ;MOVE.B  #0,D5
00001BBC                          1150              
00001BBC  4CDF 001F               1151              MOVEM.L (A7)+,D0-D4
00001BC0                          1152              
00001BC0  4E75                    1153              RTS
00001BC2                          1154  
00001BC2                          1155  ;------------------------------------------------------------------------------            
00001BC2                          1156  GSTCOLWALLRIGHT
00001BC2                          1157  ; COLLISION PAC-MAN WITH WALL
00001BC2                          1158  ; INPUT    : NONE
00001BC2                          1159  ; OUTPUT   : NONE
00001BC2                          1160  ; MODIFIES : NONE
00001BC2                          1161  ; ------------------------------------------------------------------------------
00001BC2                          1162  
00001BC2  48E7 F800               1163              MOVEM.L D0-D4,-(A7)
00001BC6                          1164  
00001BC6  3039 0000331C           1165              MOVE.W  (GSTPOSX),D0
00001BCC  5140                    1166              SUB.W   #8,D0
00001BCE  3239 0000331E           1167              MOVE.W  (GSTPOSY),D1
00001BD4  5041                    1168              ADD.W   #8,D1
00001BD6                          1169              
00001BD6  81FC 0010               1170              DIVS.W  #16,D0
00001BDA  83FC 0010               1171              DIVS.W  #16,D1
00001BDE                          1172              
00001BDE  5940                    1173              SUB.W   #4,D0                   ;LI RESTAM 4 PERQUE LA MATRIU ESTA A UNA DISTANCIA DE 64 PIXELS DE LA PANTALLA
00001BE0  5941                    1174              SUB.W   #4,D1
00001BE2                          1175              
00001BE2  41F9 00002484           1176              LEA.L   MAPVAR,A0
00001BE8                          1177              
00001BE8  5240                    1178              ADD.W   #1,D0
00001BEA  5341                    1179              SUB.W   #1,D1
00001BEC  C2FC 0020               1180              MULU.W  #32,D1
00001BF0  D041                    1181              ADD.W   D1,D0
00001BF2                          1182              
00001BF2  3240                    1183              MOVE.W  D0,A1
00001BF4                          1184  
00001BF4  1A29 2484               1185              MOVE.B  MAPVAR(A1),D5
00001BF8                          1186              
00001BF8  4CDF 001F               1187              MOVEM.L (A7)+,D0-D4
00001BFC                          1188              
00001BFC  4E75                    1189              RTS
00001BFE                          1190  
00001BFE                          1191  
00001BFE                          1192  ;------------------------------------------------------------------------------            
00001BFE                          1193  GSTCOLWALLLEFT
00001BFE                          1194  ; COLLISION PAC-MAN WITH WALL
00001BFE                          1195  ; INPUT    : NONE
00001BFE                          1196  ; OUTPUT   : NONE
00001BFE                          1197  ; MODIFIES : NONE
00001BFE                          1198  ; ------------------------------------------------------------------------------
00001BFE                          1199  
00001BFE  48E7 F800               1200              MOVEM.L D0-D4,-(A7)
00001C02                          1201  
00001C02  3039 0000331C           1202              MOVE.W  (GSTPOSX),D0
00001C08  5C40                    1203              ADD.W   #6,D0
00001C0A  3239 0000331E           1204              MOVE.W  (GSTPOSY),D1
00001C10  5041                    1205              ADD.W   #8,D1
00001C12                          1206              
00001C12  81FC 0010               1207              DIVS.W  #16,D0
00001C16  83FC 0010               1208              DIVS.W  #16,D1
00001C1A                          1209              
00001C1A  5940                    1210              SUB.W   #4,D0                   ;LI RESTAM 4 PERQUE LA MATRIU ESTA A UNA DISTANCIA DE 64 PIXELS DE LA PANTALLA
00001C1C  5941                    1211              SUB.W   #4,D1
00001C1E                          1212              
00001C1E  41F9 00002484           1213              LEA.L   MAPVAR,A0
00001C24                          1214              
00001C24  5340                    1215              SUB.W   #1,D0
00001C26  5341                    1216              SUB.W   #1,D1
00001C28  C2FC 0020               1217              MULU.W  #32,D1
00001C2C  D041                    1218              ADD.W   D1,D0
00001C2E                          1219  
00001C2E  3240                    1220              MOVE.W  D0,A1
00001C30  1A29 2484               1221              MOVE.B  MAPVAR(A1),D5               
00001C34                          1222  
00001C34                          1223              
00001C34  4CDF 001F               1224              MOVEM.L (A7)+,D0-D4
00001C38                          1225              
00001C38  4E75                    1226              RTS
00001C3A                          1227  
00001C3A                          1228  ;------------------------------------------------------------------------------            
00001C3A                          1229  GSTCOLWALLDOWN
00001C3A                          1230  ; COLLISION PAC-MAN WITH WALL
00001C3A                          1231  ; INPUT    : NONE
00001C3A                          1232  ; OUTPUT   : NONE
00001C3A                          1233  ; MODIFIES : NONE
00001C3A                          1234  ; ------------------------------------------------------------------------------
00001C3A                          1235  
00001C3A  48E7 F800               1236              MOVEM.L D0-D4,-(A7)
00001C3E                          1237  
00001C3E  3039 0000331C           1238              MOVE.W  (GSTPOSX),D0
00001C44                          1239              ;ADD.W   #8,D0
00001C44  3239 0000331E           1240              MOVE.W  (GSTPOSY),D1
00001C4A  5041                    1241              ADD.W   #8,D1
00001C4C                          1242              
00001C4C  81FC 0010               1243              DIVS.W  #16,D0
00001C50  83FC 0010               1244              DIVS.W  #16,D1
00001C54                          1245              
00001C54  5940                    1246              SUB.W   #4,D0                   ;LI RESTAM 4 PERQUE LA MATRIU ESTA A UNA DISTANCIA DE 64 PIXELS DE LA PANTALLA
00001C56  5941                    1247              SUB.W   #4,D1
00001C58                          1248              
00001C58  41F9 00002484           1249              LEA.L   MAPVAR,A0
00001C5E                          1250              
00001C5E  C2FC 0020               1251              MULU.W  #32,D1
00001C62  D041                    1252              ADD.W   D1,D0
00001C64                          1253  
00001C64  3240                    1254              MOVE.W  D0,A1
00001C66  1A29 2484               1255              MOVE.B  MAPVAR(A1),D5 
00001C6A                          1256  
00001C6A                          1257              
00001C6A  4CDF 001F               1258              MOVEM.L (A7)+,D0-D4
00001C6E                          1259              
00001C6E  4E75                    1260              RTS
00001C70                          1261  
00001C70                          1262  
00001C70                          1263  ;------------------------------------------------------------------------------            
00001C70                          1264  GSTCOLWALLUP
00001C70                          1265  ; COLLISION PAC-MAN WITH WALL
00001C70                          1266  ; INPUT    : NONE
00001C70                          1267  ; OUTPUT   : NONE
00001C70                          1268  ; MODIFIES : NONE
00001C70                          1269  ; ------------------------------------------------------------------------------
00001C70                          1270  
00001C70  48E7 F800               1271              MOVEM.L D0-D4,-(A7)
00001C74                          1272  
00001C74  3039 0000331C           1273              MOVE.W  (GSTPOSX),D0
00001C7A                          1274              ;SUB.W   #8,D0
00001C7A  3239 0000331E           1275              MOVE.W  (GSTPOSY),D1
00001C80  5C41                    1276              ADD.W   #6,D1
00001C82                          1277              
00001C82                          1278              
00001C82  81FC 0010               1279              DIVS.W  #16,D0
00001C86  83FC 0010               1280              DIVS.W  #16,D1
00001C8A                          1281              
00001C8A  5940                    1282              SUB.W   #4,D0                   ;LI RESTAM 4 PERQUE LA MATRIU ESTA A UNA DISTANCIA DE 64 PIXELS DE LA PANTALLA
00001C8C  5941                    1283              SUB.W   #4,D1
00001C8E                          1284              
00001C8E  41F9 00002484           1285              LEA.L   MAPVAR,A0
00001C94                          1286              
00001C94  5341                    1287              SUB.W   #1,D1
00001C96                          1288  
00001C96  C2FC 0020               1289              MULU.W  #32,D1
00001C9A  D041                    1290              ADD.W   D1,D0
00001C9C                          1291  
00001C9C  3240                    1292              MOVE.W  D0,A1
00001C9E                          1293  
00001C9E  1A29 2484               1294              MOVE.B  MAPVAR(A1),D5 
00001CA2                          1295  
00001CA2                          1296              ;MOVE.B  #0,D5
00001CA2                          1297              
00001CA2  4CDF 001F               1298              MOVEM.L (A7)+,D0-D4
00001CA6                          1299              
00001CA6  4E75                    1300              RTS
00001CA8                          1301  ;------------------------------------------------------------------------------            
00001CA8                          1302  GETPOINTS
00001CA8                          1303  ; COLLISION PAC-MAN WITH WALL
00001CA8                          1304  ; INPUT    : NONE
00001CA8                          1305  ; OUTPUT   : NONE
00001CA8                          1306  ; MODIFIES : NONE
00001CA8                          1307  ; ------------------------------------------------------------------------------
00001CA8                          1308  
00001CA8  48E7 F800               1309              MOVEM.L D0-D4,-(A7)
00001CAC                          1310  
00001CAC  3039 00003312           1311              MOVE.W  (PMPOSX),D0
00001CB2                          1312              ;SUB.W   #8,D0
00001CB2  3239 00003314           1313              MOVE.W  (PMPOSY),D1
00001CB8  0641 0010               1314              ADD.W   #16,D1
00001CBC                          1315              
00001CBC                          1316              
00001CBC  81FC 0010               1317              DIVS.W  #16,D0
00001CC0  83FC 0010               1318              DIVS.W  #16,D1
00001CC4                          1319              
00001CC4  5940                    1320              SUB.W   #4,D0                   ;LI RESTAM 4 PERQUE LA MATRIU ESTA A UNA DISTANCIA DE 64 PIXELS DE LA PANTALLA
00001CC6  5941                    1321              SUB.W   #4,D1
00001CC8                          1322                          
00001CC8  5341                    1323              SUB.W   #1,D1
00001CCA  C2FC 0020               1324              MULU.W  #32,D1
00001CCE  D041                    1325              ADD.W   D1,D0
00001CD0                          1326  
00001CD0  3240                    1327              MOVE.W  D0,A1
00001CD2  1A29 2484               1328              MOVE.B  MAPVAR(A1),D5
00001CD6                          1329              
00001CD6  BA7C 0000               1330              CMP     #0,D5
00001CDA  6700 003A               1331              BEQ     .DONE
00001CDE  BA7C 0002               1332              CMP     #2,D5
00001CE2  6700 0020               1333              BEQ     .POINT
00001CE6  BA7C 0003               1334              CMP     #3,D5
00001CEA  6700 0006               1335              BEQ     .BPOINT
00001CEE  6600 0026               1336              BNE     .DONE
00001CF2                          1337  .BPOINT
00001CF2  137C 0000 2484          1338              MOVE.B  #0,MAPVAR(A1)
00001CF8  0679 0032 0000332A      1339              ADD.W   #50,(SCOPOINTS)
00001D00  6600 0014               1340              BNE     .DONE
00001D04                          1341  .POINT
00001D04  137C 0000 2484          1342              MOVE.B  #0,MAPVAR(A1)
00001D0A  0679 000A 0000332A      1343              ADD.W   #10,(SCOPOINTS)
00001D12  6600 0002               1344              BNE     .DONE            
00001D16                          1345  .DONE                        
00001D16  4CDF 001F               1346              MOVEM.L (A7)+,D0-D4
00001D1A                          1347              
00001D1A  4E75                    1348              RTS
00001D1C                          1349  
00001D1C                          1350  
00001D1C                          1351  
00001D1C                          1352  
00001D1C                          1353  
00001D1C                          1354  
00001D1C                          1355  -------------------- end include --------------------
00001D1C                          1356              INCLUDE "MAP.X68"
00001D1C                          1357  
00001D1C                          1358  ; ------------------------------------------------------------------------------
00001D1C                          1359  MAPINIT
00001D1C                          1360  ; INIT MAP
00001D1C                          1361  ; INPUT    : NONE
00001D1C                          1362  ; OUTPUT   : NONE
00001D1C                          1363  ; MODIFIES : NONE
00001D1C                          1364  ; ------------------------------------------------------------------------------            
00001D1C                          1365              
00001D1C                          1366              ;MOVE.L  #DIBFIGWALL,($80+2*4)          ;INSTALL SUBRUTINE TO TRAP #2
00001D1C                          1367              ;MOVE.L  #DIBFIGPOINT,($80+3*4)          ;INSTALL SUBRUTINE TO TRAP #3
00001D1C                          1368              ;MOVE.L  #DIBFIGBPOINT,($80+4*4)          ;INSTALL SUBRUTINE TO TRAP #4
00001D1C                          1369              
00001D1C  48E7 FE00               1370              MOVEM.L D0-D6,-(A7)
00001D20  48E7 00C0               1371              MOVEM.L A0-A1,-(A7)
00001D24                          1372              
00001D24  41F8 1000               1373              LEA.L   MAPMAT,A0
00001D28  43F9 00002484           1374              LEA.L   MAPVAR,A1
00001D2E  3C3C 0030               1375              MOVE.W  #48,D6
00001D32  343C 001F               1376              MOVE.W  #31,D2
00001D36                          1377  BUCLE_FILA
00001D36  3A3C 0030               1378              MOVE.W  #48,D5
00001D3A  323C 001F               1379              MOVE.W  #31,D1
00001D3E  0646 0010               1380              ADD.W   #16,D6
00001D42                          1381  
00001D42                          1382  BUCLE_COLUMNA
00001D42  0645 0010               1383              ADD.W   #16,D5
00001D46                          1384  
00001D46  1018                    1385              MOVE.B  (A0)+,D0
00001D48  12C0                    1386              MOVE.B  D0,(A1)+
00001D4A                          1387               
00001D4A  B07C 0000               1388              CMP     #0,D0
00001D4E  6700 0034               1389              BEQ     ZERO
00001D52  B07C 0004               1390              CMP     #4,D0
00001D56  6700 002C               1391              BEQ     ZERO
00001D5A  B07C 0001               1392              CMP     #1,D0
00001D5E  6600 0008               1393              BNE     NOTWALL
00001D62  4EB9 00001E0A           1394              JSR     DIBFIGWALL
00001D68                          1395  NOTWALL
00001D68  B07C 0002               1396              CMP     #2,D0
00001D6C  6600 0008               1397              BNE     NOTPOINT
00001D70  4EB9 00001E42           1398              JSR     DIBFIGPOINT
00001D76                          1399  NOTPOINT
00001D76  B07C 0003               1400              CMP     #3,D0
00001D7A  6600 0008               1401              BNE     ZERO
00001D7E  4EB9 00001E7E           1402              JSR     DIBFIGBPOINT
00001D84                          1403           
00001D84                          1404  ZERO
00001D84  51C9 FFBC               1405              DBRA    D1,BUCLE_COLUMNA  
00001D88  51CA FFAC               1406              DBRA    D2,BUCLE_FILA
00001D8C                          1407              
00001D8C  4CDF 0300               1408              MOVEM.L (A7)+,A0-A1
00001D90  4CDF 007F               1409              MOVEM.L (A7)+,D0-D6
00001D94                          1410  
00001D94                          1411  
00001D94                          1412              
00001D94  4E75                    1413              RTS            
00001D96                          1414  
00001D96                          1415  ; ------------------------------------------------------------------------------
00001D96                          1416  MAPPLOT
00001D96                          1417  ; INIT MAP
00001D96                          1418  ; INPUT    : NONE
00001D96                          1419  ; OUTPUT   : NONE
00001D96                          1420  ; MODIFIES : NONE
00001D96                          1421  ; ------------------------------------------------------------------------------            
00001D96                          1422  
00001D96  48E7 FE00               1423              MOVEM.L D0-D6,-(A7)
00001D9A  48E7 0080               1424              MOVEM.L A0,-(A7)
00001D9E                          1425  
00001D9E  41F9 00002484           1426              LEA.L   MAPVAR,A0
00001DA4  3C3C 0030               1427              MOVE.W  #48,D6
00001DA8  343C 001F               1428              MOVE.W  #31,D2
00001DAC                          1429  BUCLE_FILA2
00001DAC  3A3C 0030               1430              MOVE.W  #48,D5
00001DB0  323C 001F               1431              MOVE.W  #31,D1
00001DB4  0646 0010               1432              ADD.W   #16,D6
00001DB8                          1433  
00001DB8                          1434  BUCLE_COLUMNA2
00001DB8  0645 0010               1435              ADD.W   #16,D5       
00001DBC                          1436  
00001DBC  1018                    1437              MOVE.B  (A0)+,D0
00001DBE                          1438  
00001DBE  B07C 0000               1439              CMP     #0,D0
00001DC2  6700 0034               1440              BEQ     ZERO2
00001DC6  B07C 0004               1441              CMP     #4,D0
00001DCA  6700 002C               1442              BEQ     ZERO2
00001DCE  B07C 0001               1443              CMP     #1,D0
00001DD2  6600 0008               1444              BNE     NOTWALL2
00001DD6  4EB9 00001E0A           1445              JSR     DIBFIGWALL
00001DDC                          1446  NOTWALL2
00001DDC  B07C 0002               1447              CMP     #2,D0
00001DE0  6600 0008               1448              BNE     NOTPOINT2
00001DE4  4EB9 00001E42           1449              JSR     DIBFIGPOINT
00001DEA                          1450  NOTPOINT2
00001DEA  B07C 0003               1451              CMP     #3,D0
00001DEE  6600 0008               1452              BNE     ZERO2
00001DF2  4EB9 00001E7E           1453              JSR     DIBFIGBPOINT
00001DF8                          1454  
00001DF8                          1455     
00001DF8                          1456  ZERO2
00001DF8  51C9 FFBE               1457              DBRA    D1,BUCLE_COLUMNA2
00001DFC                          1458              
00001DFC  51CA FFAE               1459              DBRA    D2,BUCLE_FILA2
00001E00                          1460              
00001E00  4CDF 0100               1461              MOVEM.L (A7)+,A0
00001E04  4CDF 007F               1462              MOVEM.L (A7)+,D0-D6
00001E08                          1463              
00001E08                          1464              
00001E08  4E75                    1465              RTS 
00001E0A                          1466              
00001E0A                          1467  ; -----------------------------------------------------------------------------
00001E0A                          1468  DIBFIGWALL
00001E0A                          1469  ; SUBRUTINE DRAW MAP
00001E0A                          1470  ; INPUT    : D5=POSITION X, D6=POSITION Y
00001E0A                          1471  ; OUTPUT   : NONE
00001E0A                          1472  ; MODIFIES : NONE
00001E0A                          1473  ; -----------------------------------------------------------------------------
00001E0A  48E7 FE00               1474              MOVEM.L D0-D6,-(A7)
00001E0E                          1475              ; SET CONTOURN COLOR
00001E0E  103C 0050               1476              MOVE.B  #80,D0
00001E12  223C 00AA0000           1477              MOVE.L  #$00AA0000,D1
00001E18  4E4F                    1478              TRAP    #15
00001E1A                          1479              
00001E1A                          1480              ; SET FILL COLOR
00001E1A  103C 0051               1481              MOVE.B  #81,D0
00001E1E  223C 00FF0000           1482              MOVE.L  #$00FF0000,D1
00001E24  4E4F                    1483              TRAP    #15
00001E26                          1484              
00001E26                          1485              ; DEFINE COORDINATES RECTANGLE
00001E26  3205                    1486              MOVE.W  D5,D1
00001E28  3406                    1487              MOVE.W  D6,D2
00001E2A  0645 0010               1488              ADD.W   #16,D5
00001E2E  0646 0010               1489              ADD.W   #16,D6
00001E32  3605                    1490              MOVE.W  D5,D3
00001E34  3806                    1491              MOVE.W  D6,D4
00001E36                          1492              
00001E36                          1493              ; DRAW RECTANGLE
00001E36  103C 0057               1494              MOVE.B  #87,D0
00001E3A  4E4F                    1495              TRAP    #15
00001E3C                          1496              
00001E3C  4CDF 007F               1497              MOVEM.L (A7)+,D0-D6
00001E40                          1498  
00001E40  4E75                    1499              RTS
00001E42                          1500              
00001E42                          1501  ; -----------------------------------------------------------------------------
00001E42                          1502  DIBFIGPOINT
00001E42                          1503  ; SUBRUTINE DRAW MAP
00001E42                          1504  ; INPUT    : D5=POSITION X, D6=POSITION Y
00001E42                          1505  ; OUTPUT   : NONE
00001E42                          1506  ; MODIFIES : NONE
00001E42                          1507  ; -----------------------------------------------------------------------------
00001E42  48E7 FE00               1508              MOVEM.L D0-D6,-(A7)
00001E46                          1509              ; SET CONTOURN COLOR
00001E46  103C 0050               1510              MOVE.B  #80,D0
00001E4A  223C 0000AAAA           1511              MOVE.L  #$0000AAAA,D1
00001E50  4E4F                    1512              TRAP    #15
00001E52                          1513              
00001E52                          1514              ; SET FILL COLOR
00001E52  103C 0051               1515              MOVE.B  #81,D0
00001E56  223C 0000FFFF           1516              MOVE.L  #$0000FFFF,D1
00001E5C  4E4F                    1517              TRAP    #15
00001E5E                          1518              
00001E5E                          1519              ; DEFINE COORDINATES RECTANGLE
00001E5E  3205                    1520              MOVE.W  D5,D1
00001E60  5041                    1521              ADD.W   #8,D1
00001E62  5541                    1522              SUB.W   #2,D1
00001E64  3406                    1523              MOVE.W  D6,D2
00001E66  5042                    1524              ADD.W   #8,D2
00001E68  5542                    1525              SUB.W   #2,D2
00001E6A                          1526              
00001E6A  3601                    1527              MOVE.W  D1,D3
00001E6C  5843                    1528              ADD.W   #2*2,D3
00001E6E  3802                    1529              MOVE.W  D2,D4
00001E70  5844                    1530              ADD.W   #2*2,D4
00001E72                          1531              
00001E72                          1532              ; DRAW POINT
00001E72  103C 0058               1533              MOVE.B  #88,D0
00001E76  4E4F                    1534              TRAP    #15
00001E78                          1535              
00001E78  4CDF 007F               1536              MOVEM.L (A7)+,D0-D6
00001E7C                          1537              
00001E7C  4E75                    1538              RTS
00001E7E                          1539  
00001E7E                          1540  
00001E7E                          1541  ; -----------------------------------------------------------------------------
00001E7E                          1542  DIBFIGBPOINT
00001E7E                          1543  ; SUBRUTINE DRAW MAP
00001E7E                          1544  ; INPUT    : D5=POSITION X, D6=POSITION Y
00001E7E                          1545  ; OUTPUT   : NONE
00001E7E                          1546  ; MODIFIES : NONE
00001E7E                          1547  ; -----------------------------------------------------------------------------
00001E7E  48E7 FE00               1548              MOVEM.L D0-D6,-(A7)
00001E82                          1549              ; SET CONTOURN COLOR
00001E82  103C 0050               1550              MOVE.B  #80,D0
00001E86  223C 0000AAAA           1551              MOVE.L  #$0000AAAA,D1
00001E8C  4E4F                    1552              TRAP    #15
00001E8E                          1553              
00001E8E                          1554              ; SET FILL COLOR
00001E8E  103C 0051               1555              MOVE.B  #81,D0
00001E92  223C 0000FFFF           1556              MOVE.L  #$0000FFFF,D1
00001E98  4E4F                    1557              TRAP    #15
00001E9A                          1558              
00001E9A                          1559              ; DEFINE COORDINATES RECTANGLE
00001E9A  3205                    1560              MOVE.W  D5,D1
00001E9C  5041                    1561              ADD.W   #8,D1
00001E9E  5941                    1562              SUB.W   #4,D1
00001EA0  3406                    1563              MOVE.W  D6,D2
00001EA2  5042                    1564              ADD.W   #8,D2
00001EA4  5942                    1565              SUB.W   #4,D2
00001EA6                          1566              
00001EA6  3601                    1567              MOVE.W  D1,D3
00001EA8  5043                    1568              ADD.W   #4*2,D3
00001EAA  3802                    1569              MOVE.W  D2,D4
00001EAC  5044                    1570              ADD.W   #4*2,D4
00001EAE                          1571              
00001EAE                          1572              ; DRAW BIG POINT
00001EAE  103C 0058               1573              MOVE.B  #88,D0
00001EB2  4E4F                    1574              TRAP    #15
00001EB4                          1575              
00001EB4  4CDF 007F               1576              MOVEM.L (A7)+,D0-D6
00001EB8                          1577              
00001EB8  4E75                    1578              RTS
00001EBA                          1579  
00001EBA                          1580  
00001EBA                          1581  
00001EBA                          1582  
00001EBA                          1583  
00001EBA                          1584  
00001EBA                          1585  
00001EBA                          1586  
00001EBA                          1587  
00001EBA                          1588  
00001EBA                          1589  
00001EBA                          1590  
00001EBA                          1591  -------------------- end include --------------------
00001EBA                          1592              INCLUDE "LIB/UTLCONST.X68"
00001EBA                          1593  ; ==============================================================================
00001EBA                          1594  ; UTIL CONSTANTS
00001EBA                          1595  ; ==============================================================================
00001EBA                          1596  
00001EBA  =00000008               1597  UTLCHRWD    EQU     8                       ; CHARACTER WIDTH IN PIXELS
00001EBA                          1598  
00001EBA                          1599  -------------------- end include --------------------
00001EBA                          1600              INCLUDE "LIB/UTLCODE.X68"
00001EBA                          1601  ; =============================================================================
00001EBA                          1602  ; UTILITY CODE
00001EBA                          1603  ; =============================================================================
00001EBA                          1604  
00001EBA                          1605  ; -----------------------------------------------------------------------------
00001EBA                          1606  UTLINIT
00001EBA                          1607  ; INITIALIZES UTILITY CODE
00001EBA                          1608  ; INPUT    - NONE
00001EBA                          1609  ; OUTPUT   - NONE
00001EBA                          1610  ; MODIFIES - NONE
00001EBA                          1611  ; -----------------------------------------------------------------------------
00001EBA  48E7 C000               1612              MOVEM.L D0-D1,-(A7)
00001EBE  103C 0008               1613              MOVE.B  #8,D0
00001EC2  4E4F                    1614              TRAP    #15
00001EC4  13C1 00003332           1615              MOVE.B  D1,(UTLRNDIX)
00001ECA  4CDF 0003               1616              MOVEM.L (A7)+,D0-D1
00001ECE  4E75                    1617              RTS
00001ED0                          1618  
00001ED0                          1619  ; -----------------------------------------------------------------------------
00001ED0                          1620  UTLPRINT
00001ED0                          1621  ; PRINT SCREEN CENTERED TEXT
00001ED0                          1622  ; INPUT    : A0 POINTER TO ZERO-TERMINATED STRING
00001ED0                          1623  ;            D0.B SCREEN ROW TO PRINT TEXT
00001ED0                          1624  ; OUTPUT   : D0.B NEXT ROW
00001ED0                          1625  ; MODIFIES : NONE (ASIDE OF OUTPUT)
00001ED0                          1626  ; -----------------------------------------------------------------------------
00001ED0  48E7 C0C0               1627              MOVEM.L D0-D1/A0-A1,-(A7)
00001ED4  4201                    1628              CLR.B   D1
00001ED6  2248                    1629              MOVE.L  A0,A1
00001ED8  4A18                    1630  .LOOP       TST.B   (A0)+
00001EDA  6700 0006               1631              BEQ     .ENDLOOP
00001EDE  5201                    1632              ADDQ.B  #1,D1
00001EE0  60F6                    1633              BRA     .LOOP
00001EE2  E209                    1634  .ENDLOOP    LSR.B   #1,D1
00001EE4  0401 0028               1635              SUB.B   #(SCRWIDTH/UTLCHRWD)/2,D1
00001EE8  4401                    1636              NEG.B   D1
00001EEA  E141                    1637              ASL.W   #8,D1
00001EEC  8240                    1638              OR.W    D0,D1
00001EEE  103C 000B               1639              MOVE.B  #11,D0
00001EF2  4E4F                    1640              TRAP    #15
00001EF4  103C 000D               1641              MOVE.B  #13,D0
00001EF8  4E4F                    1642              TRAP    #15
00001EFA  4CDF 0303               1643              MOVEM.L (A7)+,D0-D1/A0-A1
00001EFE  5200                    1644              ADDQ.B  #1,D0
00001F00  4E75                    1645              RTS
00001F02                          1646              
00001F02                          1647              
00001F02                          1648  
00001F02                          1649  
00001F02                          1650              ; (SCRWIDTH/UTLCHRWD)/2 - D1/2
00001F02                          1651  
00001F02                          1652  
00001F02                          1653  ; -----------------------------------------------------------------------------
00001F02                          1654  UTLRAND
00001F02                          1655  ; PROVIDES A PSEUDO-RANDOM BYTE
00001F02                          1656  ; INPUT    - NONE
00001F02                          1657  ; OUTPUT   - D0.L RANDOM VALUE (ONLY BYTE)
00001F02                          1658  ; MODIFIES - NONE (ASIDE OF OUTPUT)
00001F02                          1659  ; -----------------------------------------------------------------------------
00001F02  2F08                    1660              MOVE.L  A0,-(A7)
00001F04  41F9 00001F20           1661              LEA     .RANDVEC,A0
00001F0A  4280                    1662              CLR.L   D0
00001F0C  1039 00003332           1663              MOVE.B  (UTLRNDIX),D0
00001F12  1030 0800               1664              MOVE.B  (A0,D0.L),D0
00001F16  5239 00003332           1665              ADDQ.B  #1,(UTLRNDIX)
00001F1C  205F                    1666              MOVE.L  (A7)+,A0
00001F1E  4E75                    1667              RTS
00001F20                          1668  
00001F20                          1669  
00001F20= A2 EE 9A 0C F5 24 ...   1670  .RANDVEC    DC.B    162, 238, 154, 12 , 245, 36 , 32 , 103
00001F28= 2A A3 51 26 E0 AC ...   1671              DC.B    42 , 163, 81 , 38 , 224, 172, 19 , 69
00001F30= 75 51 CA FD 33 EB ...   1672              DC.B    117, 81 , 202, 253, 51 , 235, 108, 154
00001F38= 60 CC E7 B8 9A EB ...   1673              DC.B    96 , 204, 231, 184, 154, 235, 34 , 203
00001F40= 1D 76 B5 95 B0 89 ...   1674              DC.B    29 , 118, 181, 149, 176, 137, 62 , 108
00001F48= 39 15 48 C9 6E CA ...   1675              DC.B    57 , 21 , 72 , 201, 110, 202, 159, 41
00001F50= 43 E7 E2 7C 37 25 ...   1676              DC.B    67 , 231, 226, 124, 55 , 37 , 84 , 62
00001F58= E9 94 CE E9 E4 52 ...   1677              DC.B    233, 148, 206, 233, 228, 82 , 243, 78
00001F60= 37 6D 9A 84 A2 28 ...   1678              DC.B    55 , 109, 154, 132, 162, 40 , 30 , 39
00001F68= 19 E2 C6 77 80 D4 ...   1679              DC.B    25 , 226, 198, 119, 128, 212, 232, 225
00001F70= 0A 5A 32 67 33 C2 ...   1680              DC.B    10 , 90 , 50 , 103, 51 , 194, 222, 40
00001F78= 59 80 DC 0E 57 FC ...   1681              DC.B    89 , 128, 220, 14 , 87 , 252, 243, 252
00001F80= 8A AB BC F7 07 4D ...   1682              DC.B    138, 171, 188, 247, 7  , 77 , 29 , 234
00001F88= EF D5 77 6E 1E BB ...   1683              DC.B    239, 213, 119, 110, 30 , 187, 131, 23
00001F90= D6 E0 2A 8F BD 28 ...   1684              DC.B    214, 224, 42 , 143, 189, 40 , 212, 130
00001F98= 13 4F 66 EC 0A 64 ...   1685              DC.B    19 , 79 , 102, 236, 10 , 100, 122, 188
00001FA0= 56 52 9A 16 9B 90 ...   1686              DC.B    86 , 82 , 154, 22 , 155, 144, 7  , 199
00001FA8= 06 8A A4 F7 01 DA ...   1687              DC.B    6  , 138, 164, 247, 1  , 218, 166, 82
00001FB0= F2 E7 77 28 B1 76 ...   1688              DC.B    242, 231, 119, 40 , 177, 118, 220, 102
00001FB8= A4 42 E3 81 B1 67 ...   1689              DC.B    164, 66 , 227, 129, 177, 103, 165, 108
00001FC0= BF CE FA 16 BF 38 ...   1690              DC.B    191, 206, 250, 22 , 191, 56 , 30 , 161
00001FC8= D1 8B 50 0C 5F 49 ...   1691              DC.B    209, 139, 80 , 12 , 95 , 73 , 168, 56
00001FD0= DE 4C 14 A2 40 DC ...   1692              DC.B    222, 76 , 20 , 162, 64 , 220, 93 , 12
00001FD8= B6 9B 0A 38 5D AB ...   1693              DC.B    182, 155, 10 , 56 , 93 , 171, 89 , 6
00001FE0= E2 1B DD 75 15 82 ...   1694              DC.B    226, 27 , 221, 117, 21 , 130, 101, 18
00001FE8= 8A 26 51 30 9F 47 ...   1695              DC.B    138, 38 , 81 , 48 , 159, 71 , 57 , 21
00001FF0= 1E 8A BB 71 C6 6E ...   1696              DC.B    30 , 138, 187, 113, 198, 110, 185, 152
00001FF8= 9F 47 E5 34 94 27 ...   1697              DC.B    159, 71 , 229, 52 , 148, 39 , 77 , 6
00002000= 7D 06 D6 BA 30 0F ...   1698              DC.B    125, 6  , 214, 186, 48 , 15 , 212, 22
00002008= EC 7F 7E 03 CF 2D ...   1699              DC.B    236, 127, 126, 3  , 207, 45 , 193, 2
00002010= 94 5B 23 F2 8B CD ...   1700              DC.B    148, 91 , 35 , 242, 139, 205, 248, 237
00002018= 74 33 EC B9 0F D5 ...   1701              DC.B    116, 51 , 236, 185, 15 , 213, 221, 6
00002020                          1702  
00002020                          1703  
00002020                          1704  
00002020                          1705  
00002020                          1706  -------------------- end include --------------------
00002020                          1707              INCLUDE "INTRO.X68"
00002020                          1708  ; ==============================================================================
00002020                          1709  ; INTRO SCREEN
00002020                          1710  ; ==============================================================================
00002020                          1711  
00002020                          1712  ; ------------------------------------------------------------------------------
00002020                          1713  ISCINIT
00002020                          1714  ; INTRO SCREEN INIT
00002020                          1715  ; INPUT    : NONE
00002020                          1716  ; OUTPUT   : NONE
00002020                          1717  ; MODIFIES : NONE
00002020                          1718  ; ------------------------------------------------------------------------------
00002020  4279 0000332C           1719              CLR.W   (ISCTIMER)
00002026  4EB9 000020A0           1720              JSR     OPENFILE
0000202C  4E75                    1721              RTS
0000202E                          1722  
0000202E                          1723  ; ------------------------------------------------------------------------------
0000202E                          1724  ISCUPD
0000202E                          1725  ; INTRO SCREEN UPDATE
0000202E                          1726  ; INPUT    : NONE
0000202E                          1727  ; OUTPUT   : NONE
0000202E                          1728  ; MODIFIES : NONE
0000202E                          1729  ; ------------------------------------------------------------------------------
0000202E  0839 0004 00002480      1730              BTST.B  #4,(KBDVAL)
00002036  6700 000A               1731              BEQ     .CONT
0000203A  33FC 0001 00003330      1732              MOVE.W  #1,(STANEXT)
00002042                          1733  .CONT       ;ADDQ.W  #1,(ISCTIMER)
00002042                          1734  ;            CMP.W   #500,(ISCTIMER)
00002042                          1735  ;            BLT     .DONE
00002042                          1736  ;            MOVE.W  #1,(STANEXT)
00002042  4E75                    1737  .DONE       RTS
00002044                          1738  
00002044                          1739  ; ------------------------------------------------------------------------------
00002044                          1740  ISCPLOT
00002044                          1741  ; INTRO SCREEN PLOT
00002044                          1742  ; INPUT    : NONE
00002044                          1743  ; OUTPUT   : NONE
00002044                          1744  ; MODIFIES : NONE
00002044                          1745  ; ------------------------------------------------------------------------------
00002044  48E7 C080               1746              MOVEM.L D0-D1/A0,-(A7)
00002048                          1747              
00002048  4281                    1748              CLR.L   D1
0000204A  103C 0051               1749              MOVE.B  #81,D0
0000204E  4E4F                    1750              TRAP    #15
00002050                          1751              
00002050  4EB9 000020D2           1752              JSR     IMGPLOT
00002056                          1753              
00002056  0839 0004 00002483      1754              BTST.B  #4,(SCRCYCCT)
0000205E  6700 0010               1755              BEQ     .DONE
00002062                          1756              
00002062  41F9 00002084           1757              LEA     .TXT2,A0
00002068  103C 0019               1758              MOVE.B  #25,D0
0000206C  4EB8 1ED0               1759              JSR     UTLPRINT
00002070                          1760              
00002070  4CDF 0103               1761  .DONE       MOVEM.L (A7)+,D0-D1/A0
00002074                          1762  
00002074  4E75                    1763              RTS
00002076= 50 41 43 2D 4D 41 ...   1764  .TXT1       DC.B    'PAC-MAN 68000',0
00002084= 50 52 45 53 53 20 ...   1765  .TXT2       DC.B    'PRESS SPACE BUTTON TO START',0
000020A0                          1766              DS.W    0
000020A0                          1767              
000020A0                          1768  ;------------------------------------------------------------------------
000020A0                          1769              
000020A0                          1770  OPENFILE                 
000020A0                          1771              ;OPEN FILE
000020A0  43F8 19BE               1772              LEA     FILENAME,A1
000020A4  303C 0033               1773              MOVE    #51,D0
000020A8  4E4F                    1774              TRAP    #15
000020AA                          1775              
000020AA                          1776              ;READ FILE
000020AA  243C 00000A8C           1777              MOVE.L  #FILESIZE,D2
000020B0  43F9 00002886           1778              LEA     BUFFER,A1
000020B6  303C 0035               1779              MOVE    #53,D0
000020BA  4E4F                    1780              TRAP    #15
000020BC                          1781              
000020BC  263C 00000A8C           1782              MOVE.L  #FILESIZE,D3
000020C2                          1783              
000020C2                          1784  .convert_loop 
000020C2  4A03                    1785              TST.B   D3
000020C4  6700 000A               1786              BEQ     .END
000020C8  0419 0030               1787              SUB.B   #$30,(A1)+
000020CC  5303                    1788              SUB.B   #1,D3
000020CE  60F2                    1789              BRA     .convert_loop           
000020D0                          1790  .END        
000020D0                          1791  
000020D0                          1792           
000020D0                          1793            
000020D0                          1794              
000020D0  4E75                    1795              RTS
000020D2                          1796  ; ------------------------------------------------------------------------------
000020D2                          1797  IMGPLOT
000020D2                          1798  ; TITLE IMAGE PLOT
000020D2                          1799  ; INPUT    : NONE
000020D2                          1800  ; OUTPUT   : NONE
000020D2                          1801  ; MODIFIES : NONE
000020D2                          1802  ; ------------------------------------------------------------------------------
000020D2  48E7 FE00               1803              MOVEM.L D0-D6,-(A7)
000020D6  48E7 00C0               1804              MOVEM.L A0-A1,-(A7)
000020DA                          1805              
000020DA                          1806              ;PLOT
000020DA                          1807   
000020DA  41F9 00002886           1808              LEA.L   BUFFER,A0
000020E0  3C3C 00DC               1809              MOVE.W  #220,D6
000020E4  343C 001C               1810              MOVE.W  #28,D2
000020E8                          1811  BUCLE_FILA3
000020E8  3A3C 0064               1812              MOVE.W  #100,D5
000020EC  323C 0065               1813              MOVE.W  #101,D1
000020F0  5846                    1814              ADD.W   #4,D6
000020F2                          1815  
000020F2                          1816  BUCLE_COLUMNA3
000020F2  5845                    1817              ADD.W   #4,D5
000020F4                          1818  
000020F4  1018                    1819              MOVE.B  (A0)+,D0
000020F6                          1820               
000020F6  B07C 0001               1821              CMP     #1,D0
000020FA  6700 000C               1822              BEQ     ZERO3
000020FE  B07C 0000               1823              CMP     #0,D0
00002102  4EB9 0000211A           1824              JSR     DRAW
00002108                          1825  ZERO3
00002108  51C9 FFE8               1826              DBRA    D1,BUCLE_COLUMNA3
0000210C  51CA FFDA               1827              DBRA    D2,BUCLE_FILA3
00002110                          1828              
00002110  4CDF 0300               1829              MOVEM.L (A7)+,A0-A1
00002114  4CDF 007F               1830              MOVEM.L (A7)+,D0-D6
00002118                          1831          
00002118                          1832  
00002118  4E75                    1833              RTS
0000211A                          1834  
0000211A                          1835  
0000211A                          1836  ; -----------------------------------------------------------------------------
0000211A                          1837  DRAW
0000211A                          1838  ; SUBRUTINE DRAW 
0000211A                          1839  ; INPUT    : D5=POSITION X, D6=POSITION Y
0000211A                          1840  ; OUTPUT   : NONE
0000211A                          1841  ; MODIFIES : NONE
0000211A                          1842  ; -----------------------------------------------------------------------------
0000211A  48E7 FE00               1843              MOVEM.L D0-D6,-(A7)
0000211E                          1844              ; SET CONTOURN COLOR
0000211E  103C 0050               1845              MOVE.B  #80,D0
00002122  223C 00AA0000           1846              MOVE.L  #$00AA0000,D1
00002128  4E4F                    1847              TRAP    #15
0000212A                          1848              
0000212A                          1849              ; SET FILL COLOR
0000212A  103C 0051               1850              MOVE.B  #81,D0
0000212E  223C 00FF0000           1851              MOVE.L  #$00FF0000,D1
00002134  4E4F                    1852              TRAP    #15
00002136                          1853              
00002136                          1854              ; DEFINE COORDINATES RECTANGLE
00002136  3205                    1855              MOVE.W  D5,D1
00002138  3406                    1856              MOVE.W  D6,D2
0000213A  5845                    1857              ADD.W   #4,D5
0000213C  5846                    1858              ADD.W   #4,D6
0000213E  3605                    1859              MOVE.W  D5,D3
00002140  3806                    1860              MOVE.W  D6,D4
00002142                          1861              
00002142                          1862              ; DRAW RECTANGLE
00002142  103C 0057               1863              MOVE.B  #87,D0
00002146  4E4F                    1864              TRAP    #15
00002148                          1865              
00002148  4CDF 007F               1866              MOVEM.L (A7)+,D0-D6
0000214C                          1867  
0000214C  4E75                    1868              RTS
0000214E                          1869  
0000214E                          1870  
0000214E                          1871  
0000214E                          1872  
0000214E                          1873  
0000214E                          1874  
0000214E                          1875  -------------------- end include --------------------
0000214E                          1876              INCLUDE "INSTRUCTIONS.X68"
0000214E                          1877  ; ==============================================================================
0000214E                          1878  ; INSTRUCTIONS SCREEN
0000214E                          1879  ; ==============================================================================
0000214E                          1880  
0000214E                          1881  ; ------------------------------------------------------------------------------
0000214E                          1882  INSINIT
0000214E                          1883  ; INSTRUCTIONS SCREEN INIT
0000214E                          1884  ; INPUT    : NONE
0000214E                          1885  ; OUTPUT   : NONE
0000214E                          1886  ; MODIFIES : NONE
0000214E                          1887  ; ------------------------------------------------------------------------------
0000214E  4E75                    1888              RTS
00002150                          1889  
00002150                          1890  ; ------------------------------------------------------------------------------
00002150                          1891  INSUPD
00002150                          1892  ; INSTRUCTIONS SCREEN UPDATE
00002150                          1893  ; INPUT    : NONE
00002150                          1894  ; OUTPUT   : NONE
00002150                          1895  ; MODIFIES : NONE
00002150                          1896  ; ------------------------------------------------------------------------------
00002150  4E75                    1897              RTS
00002152                          1898  
00002152                          1899  ; ------------------------------------------------------------------------------
00002152                          1900  INSPLOT
00002152                          1901  ; INSTRUCTIONS SCREEN PLOT
00002152                          1902  ; INPUT    : NONE
00002152                          1903  ; OUTPUT   : NONE
00002152                          1904  ; MODIFIES : NONE
00002152                          1905  ; ------------------------------------------------------------------------------
00002152                          1906  
00002152  48E7 C0C0               1907              MOVEM.L D0-D1/A0-A1,-(A7)
00002156  4281                    1908              CLR.L   D1
00002158  103C 0051               1909              MOVE.B  #81,D0
0000215C  4E4F                    1910              TRAP    #15
0000215E  103C 000B               1911              MOVE.B  #11,D0
00002162  43F9 000022C4           1912              LEA     .TXTLST,A1
00002168  2219                    1913  .LOOP       MOVE.L  (A1)+,D1
0000216A  6700 000A               1914              BEQ     .DONE
0000216E  2041                    1915              MOVE.L  D1,A0
00002170  4EB8 1ED0               1916              JSR     UTLPRINT
00002174  60F2                    1917              BRA     .LOOP
00002176  4CDF 0303               1918  .DONE       MOVEM.L (A7)+,D0-D1/A0-A1
0000217A  4E75                    1919              RTS
0000217C= 57 45 4C 43 4F 4D ...   1920  .TXT1       DC.B    'WELCOME TO THE WORLD OF MULTI-PONG 68000!',0
000021A6= 59 4F 55 52 20 47 ...   1921  .TXT2       DC.B    'YOUR GOAL IN THIS GAME IS TO AVOID MISSING THE BALLS',0
000021DB= 54 4F 20 54 48 49 ...   1922  .TXT3       DC.B    'TO THIS END, MOVE THE PAD USING THE KEYBOARD',0
00002208= 48 4F 57 20 54 4F ...   1923  .TXT4       DC.B    'HOW TO DO IT? YOU MAY ASK.',0
00002223= 49 54 20 49 53 20 ...   1924  .TXT5       DC.B    'IT IS EASY: JUST USE THE UP KEY TO MOVE THE PAD...',0
00002256= 55 50 21 00             1925  .TXT6       DC.B    'UP!',0
0000225A= 41 4E 44 20 55 53 ...   1926  .TXT7       DC.B    'AND USE THE DOWN KEY TO MOVE THE PAD DOWN.',0
00002285= 57 48 41 54 20 41 ...   1927  .TXT8       DC.B    'WHAT ABOUT LEFT AND RIGHT?',0
000022A0= 4E 4F 2E 20 54 48 ...   1928  .TXT9       DC.B    'NO. THESE ARE FORBIDDEN DIRECTIONS',0
000022C4                          1929              DS.W    0
000022C4= 0000217C 000021A6 ...   1930  .TXTLST     DC.L    .TXT1,.TXT2,.TXT3,.TXT4,.TXT5,.TXT6,.TXT7,.TXT8,.TXT9,0
000022EC                          1931  
000022EC                          1932  
000022EC                          1933  -------------------- end include --------------------
000022EC                          1934              INCLUDE "WIN.X68"
000022EC                          1935  ; ==============================================================================
000022EC                          1936  ; VICTORY SCREEN
000022EC                          1937  ; ==============================================================================
000022EC                          1938  
000022EC                          1939  ; ------------------------------------------------------------------------------
000022EC                          1940  WININIT
000022EC                          1941  ; VICTORY SCREEN INIT
000022EC                          1942  ; INPUT    : NONE
000022EC                          1943  ; OUTPUT   : NONE
000022EC                          1944  ; MODIFIES : NONE
000022EC                          1945  ; ------------------------------------------------------------------------------
000022EC  4E75                    1946              RTS
000022EE                          1947  
000022EE                          1948  ; ------------------------------------------------------------------------------
000022EE                          1949  WINUPD
000022EE                          1950  ; VICTORY SCREEN UPDATE
000022EE                          1951  ; INPUT    : NONE
000022EE                          1952  ; OUTPUT   : NONE
000022EE                          1953  ; MODIFIES : NONE
000022EE                          1954  ; ------------------------------------------------------------------------------
000022EE  4E75                    1955              RTS
000022F0                          1956  
000022F0                          1957  ; ------------------------------------------------------------------------------
000022F0                          1958  WINPLOT
000022F0                          1959  ; VICTORY SCREEN PLOT
000022F0                          1960  ; INPUT    : NONE
000022F0                          1961  ; OUTPUT   : NONE
000022F0                          1962  ; MODIFIES : NONE
000022F0                          1963  ; ------------------------------------------------------------------------------
000022F0  48E7 C080               1964              MOVEM.L D0-D1/A0,-(A7)
000022F4                          1965              
000022F4  4281                    1966              CLR.L   D1
000022F6  103C 0051               1967              MOVE.B  #81,D0
000022FA  4E4F                    1968              TRAP    #15
000022FC                          1969              
000022FC  41F9 0000232A           1970              LEA     .TXT1,A0
00002302  103C 000A               1971              MOVE.B  #10,D0
00002306  4EB8 1ED0               1972              JSR     UTLPRINT
0000230A                          1973              
0000230A  0839 0004 00002483      1974              BTST.B  #4,(SCRCYCCT)
00002312  6700 0010               1975              BEQ     .DONE
00002316                          1976              
00002316  41F9 00002333           1977              LEA     .TXT2,A0
0000231C  103C 0019               1978              MOVE.B  #25,D0
00002320  4EB8 1ED0               1979              JSR     UTLPRINT
00002324                          1980              
00002324  4CDF 0103               1981  .DONE       MOVEM.L (A7)+,D0-D1/A0
00002328                          1982  
00002328  4E75                    1983              RTS
0000232A= 59 4F 55 20 57 4F ...   1984  .TXT1       DC.B    'YOU WON!',0
00002333= 50 52 45 53 53 20 ...   1985  .TXT2       DC.B    'PRESS FIRE1 TO CONTINUE',0
0000234C                          1986              DS.W    0
0000234C                          1987  
0000234C                          1988  
0000234C                          1989  
0000234C                          1990  -------------------- end include --------------------
0000234C                          1991              INCLUDE "GOVER.X68"
0000234C                          1992  ; ==============================================================================
0000234C                          1993  ; GAME OVER SCREEN
0000234C                          1994  ; ==============================================================================
0000234C                          1995  
0000234C                          1996  ; ------------------------------------------------------------------------------
0000234C                          1997  GOVINIT
0000234C                          1998  ; GAME OVER SCREEN INIT
0000234C                          1999  ; INPUT    : NONE
0000234C                          2000  ; OUTPUT   : NONE
0000234C                          2001  ; MODIFIES : NONE
0000234C                          2002  ; ------------------------------------------------------------------------------
0000234C  4E75                    2003              RTS
0000234E                          2004  
0000234E                          2005  ; ------------------------------------------------------------------------------
0000234E                          2006  GOVUPD
0000234E                          2007  ; GAME OVER SCREEN UPDATE
0000234E                          2008  ; INPUT    : NONE
0000234E                          2009  ; OUTPUT   : NONE
0000234E                          2010  ; MODIFIES : NONE
0000234E                          2011  ; ------------------------------------------------------------------------------
0000234E  4E75                    2012              RTS
00002350                          2013  
00002350                          2014  ; ------------------------------------------------------------------------------
00002350                          2015  GOVPLOT
00002350                          2016  ; GAME OVER SCREEN PLOT
00002350                          2017  ; INPUT    : NONE
00002350                          2018  ; OUTPUT   : NONE
00002350                          2019  ; MODIFIES : NONE
00002350                          2020  ; ------------------------------------------------------------------------------
00002350  48E7 C080               2021              MOVEM.L D0-D1/A0,-(A7)
00002354                          2022              
00002354  4281                    2023              CLR.L   D1
00002356  103C 0051               2024              MOVE.B  #81,D0
0000235A  4E4F                    2025              TRAP    #15
0000235C                          2026              
0000235C  41F9 0000238A           2027              LEA     .TXT1,A0
00002362  103C 000A               2028              MOVE.B  #10,D0
00002366  4EB8 1ED0               2029              JSR     UTLPRINT
0000236A                          2030              
0000236A  0839 0004 00002483      2031              BTST.B  #4,(SCRCYCCT)
00002372  6700 0010               2032              BEQ     .DONE
00002376                          2033              
00002376  41F9 00002394           2034              LEA     .TXT2,A0
0000237C  103C 0019               2035              MOVE.B  #25,D0
00002380  4EB8 1ED0               2036              JSR     UTLPRINT
00002384                          2037              
00002384  4CDF 0103               2038  .DONE       MOVEM.L (A7)+,D0-D1/A0
00002388                          2039  
00002388  4E75                    2040              RTS
0000238A= 47 41 4D 45 20 4F ...   2041  .TXT1       DC.B    'GAME OVER',0
00002394= 50 52 45 53 53 20 ...   2042  .TXT2       DC.B    'PRESS FIRE1 TO CONTINUE',0
000023AC                          2043              DS.W    0
000023AC                          2044  
000023AC                          2045  
000023AC                          2046  -------------------- end include --------------------
000023AC                          2047              INCLUDE "STATES.X68"
000023AC                          2048  ; =============================================================================
000023AC                          2049  ; GAME STATE MANAGEMENT
000023AC                          2050  ; =============================================================================
000023AC                          2051  
000023AC                          2052  ; -----------------------------------------------------------------------------
000023AC                          2053  STAINIT
000023AC                          2054  ; INITALIZES THE STATE MANAGER
000023AC                          2055  ; INPUT    - NONE
000023AC                          2056  ; OUTPUT   - NONE
000023AC                          2057  ; MODIFIES - NONE
000023AC                          2058  ; -----------------------------------------------------------------------------
000023AC  33FC FFFF 0000332E      2059              MOVE.W  #STANONE,(STACUR)
000023B4  4279 00003330           2060              CLR.W   (STANEXT)
000023BA  4E75                    2061              RTS
000023BC                          2062  
000023BC                          2063  ; -----------------------------------------------------------------------------
000023BC                          2064  STAUPD
000023BC                          2065  ; PERFORMS STATE UPDATE AND INIT IF NECESSARY
000023BC                          2066  ; INPUT    - NONE
000023BC                          2067  ; OUTPUT   - NONE
000023BC                          2068  ; MODIFIES - NONE
000023BC                          2069  ; -----------------------------------------------------------------------------
000023BC  48E7 8080               2070              MOVEM.L D0/A0,-(A7)
000023C0  4280                    2071              CLR.L   D0
000023C2  3039 00003330           2072              MOVE.W  (STANEXT),D0
000023C8  B079 0000332E           2073              CMP.W   (STACUR),D0
000023CE  6700 0012               2074              BEQ     .DOUPD
000023D2  33C0 0000332E           2075              MOVE.W  D0,(STACUR)             ; IF STATE CHANGED, DO INIT
000023D8  E588                    2076              LSL.L   #2,D0
000023DA  2040                    2077              MOVE.L  D0,A0
000023DC  2068 23FA               2078              MOVE.L  .INITBL(A0),A0
000023E0  4E90                    2079              JSR     (A0)
000023E2  4280                    2080  .DOUPD      CLR.L   D0                      ; IN ANY CASE, DO UPDATE
000023E4  3039 0000332E           2081              MOVE.W  (STACUR),D0
000023EA  E588                    2082              LSL.L   #2,D0
000023EC  2040                    2083              MOVE.L  D0,A0
000023EE  2068 2402               2084              MOVE.L  .UPDTBL(A0),A0
000023F2  4E90                    2085              JSR     (A0)
000023F4  4CDF 0101               2086              MOVEM.L (A7)+,D0/A0
000023F8  4E75                    2087              RTS
000023FA= 00002020 00002430       2088  .INITBL     DC.L    ISCINIT,GAMINIT
00002402= 0000202E 00002440       2089  .UPDTBL     DC.L    ISCUPD,GAMUPD
0000240A                          2090  
0000240A                          2091  ; -----------------------------------------------------------------------------
0000240A                          2092  STAPLOT
0000240A                          2093  ; PERFORMS STATE PLOT
0000240A                          2094  ; INPUT    - NONE
0000240A                          2095  ; OUTPUT   - NONE
0000240A                          2096  ; MODIFIES - NONE
0000240A                          2097  ; -----------------------------------------------------------------------------
0000240A  48E7 8080               2098              MOVEM.L D0/A0,-(A7)
0000240E  4280                    2099              CLR.L   D0
00002410  3039 0000332E           2100              MOVE.W  (STACUR),D0
00002416  E588                    2101              LSL.L   #2,D0
00002418  2040                    2102              MOVE.L  D0,A0
0000241A  2068 2426               2103              MOVE.L  .PLTTBL(A0),A0
0000241E  4E90                    2104              JSR     (A0)
00002420  4CDF 0101               2105              MOVEM.L (A7)+,D0/A0
00002424  4E75                    2106              RTS
00002426= 00002044 00002444       2107  .PLTTBL     DC.L    ISCPLOT,GAMPLOT
0000242E                          2108  
0000242E                          2109  ; -----------------------------------------------------------------------------
0000242E                          2110  STAEMPTY
0000242E                          2111  ; EMPTY SUBROUTINE FOR CASES WITH NOTHING TO DO
0000242E                          2112  ; INPUT    - NONE
0000242E                          2113  ; OUTPUT   - NONE
0000242E                          2114  ; MODIFIES - NONE
0000242E                          2115  ; NOTE     - JUST A PLACEHOLDER. NOTHING TO DO.
0000242E                          2116  ; -----------------------------------------------------------------------------
0000242E  4E75                    2117              RTS
00002430                          2118  
00002430                          2119  
00002430                          2120  
00002430                          2121  
00002430                          2122  
00002430                          2123  
00002430                          2124  
00002430                          2125  
00002430                          2126  
00002430                          2127  -------------------- end include --------------------
00002430                          2128              INCLUDE "GAME.X68"
00002430                          2129  ; ==============================================================================
00002430                          2130  ; GAME MANAGEMENT
00002430                          2131  ; ==============================================================================
00002430                          2132  
00002430                          2133  ; ------------------------------------------------------------------------------
00002430                          2134  GAMINIT
00002430                          2135  ; INITIALIZES GAME.
00002430                          2136  ; INPUT    : NONE
00002430                          2137  ; OUTPUT   : NONE
00002430                          2138  ; MODIFIES : NONE
00002430                          2139  ; ------------------------------------------------------------------------------
00002430  4EB8 1586               2140              JSR     PMINIT
00002434  4EB8 1D1C               2141              JSR     MAPINIT
00002438  4EB8 1400               2142              JSR     GSTINIT
0000243C  6000 F50E               2143              BRA     SCOINIT
00002440                          2144  
00002440                          2145  ; ------------------------------------------------------------------------------
00002440                          2146  GAMUPD
00002440                          2147  ; UPDATES THE GAME
00002440                          2148  ; INPUT    : NONE
00002440                          2149  ; OUTPUT   : NONE
00002440                          2150  ; MODIFIES : NONE
00002440                          2151  ; ------------------------------------------------------------------------------
00002440                          2152              
00002440                          2153              ;JSR     GSTUPD
00002440  6000 F178               2154              BRA     PMUPD
00002444                          2155              
00002444                          2156  ; ------------------------------------------------------------------------------
00002444                          2157  GAMPLOT
00002444                          2158  ; PLOTS THE GAME
00002444                          2159  ; INPUT    : NONE
00002444                          2160  ; OUTPUT   : NONE
00002444                          2161  ; MODIFIES : NONE
00002444                          2162  ; ------------------------------------------------------------------------------
00002444  4EB8 1D96               2163              JSR     MAPPLOT
00002448  4EB8 195C               2164              JSR     SCOPLOT
0000244C  4EB8 1726               2165              JSR     PMPLOT
00002450  6000 F0CA               2166              BRA     GSTPLOT
00002454                          2167  
00002454                          2168  
00002454                          2169  -------------------- end include --------------------
00002454                          2170        
00002454                          2171              
00002454                          2172      
00002454                          2173  START:
00002454                          2174  
00002454                          2175  ;--- INITIALIZATION -----------------------------------------------------------
00002454                          2176  
00002454  007C 0700               2177              ORI.W   #$0700,SR               ;DISABLE INTERRUPTIONS
00002458                          2178  
00002458  4EB8 19C8               2179              JSR     SYSINIT
0000245C  4EB8 23AC               2180              JSR     STAINIT
00002460                          2181  
00002460                          2182  .LOOP
00002460                          2183  
00002460                          2184  ; --- UPDATE -------------------------------------------------------------------
00002460                          2185  
00002460                          2186  ; READ INPUT DEVICES
00002460                          2187  
00002460  4E41                    2188              TRAP    #1
00002462                          2189  
00002462                          2190  ; UPDATE GAME LOGIC
00002462                          2191  
00002462  4EB8 23BC               2192             JSR     STAUPD
00002466                          2193  
00002466                          2194  ; --- SYNC ---------------------------------------------------------------------
00002466                          2195              ;WHILE THERES NO INTERRUPTS IN THE COUNTER THE PROGRAM WILL BE IN
00002466                          2196              ;THE BUCLE
00002466                          2197              
00002466  4A39 00002482           2198  .WAITINIT   TST.B   (SCRINTCT)
0000246C  67F8                    2199              BEQ     .WAITINIT
0000246E  4239 00002482           2200              CLR.B   (SCRINTCT)
00002474                          2201  
00002474                          2202  ; --- PLOT ---------------------------------------------------------------------
00002474                          2203              
00002474  4EB8 240A               2204              JSR     STAPLOT
00002478                          2205              
00002478                          2206              
00002478  4E40                    2207              TRAP    #0                      ;CHANGE BUFFER
0000247A                          2208  
0000247A  60E4                    2209              BRA     .LOOP
0000247C                          2210  
0000247C  FFFF FFFF               2211              SIMHALT  
00002480                          2212             
00002480                          2213              INCLUDE "SYSVARS.X68"
00002480                          2214  ; ==============================================================================
00002480                          2215  ; SYSTEM VARIABLES
00002480                          2216  ; ==============================================================================
00002480                          2217   
00002480                          2218  ; --- KEYBOARD RELATED VARIABLES -----------------------------------------------
00002480                          2219  
00002480                          2220  KBDVAL      DS.B    1                       ; KEY STATE
00002481                          2221  KBDEDGE     DS.B    1                       ; KEY EDGE
00002482                          2222              DS.W    0 
00002482                          2223  
00002482                          2224  ; --- TIMED INTERRUPT RELATED VARIABLES ----------------------------------------
00002482                          2225  
00002482                          2226  SCRINTCT    DS.B    1                       ; INTERRUPT COUNTER
00002483                          2227  SCRCYCCT    DS.B    1                       ; CYCLE COUNTER
00002484                          2228              DS.W    0        
00002484                          2229              
00002484                          2230  ; --- MAP RELATED VARIABLE -----------------------------------------------------
00002484                          2231  
00002484                          2232  MAPVAR      DS.B    1024
00002884                          2233  
00002884                          2234              DS.B    0
00002884                          2235  
00002884                          2236  POSCON      DS.W    1
00002886                          2237  
00002886                          2238  ; --- TITLE RELATED VARIABLE -----------------------------------------------------
00002886                          2239  
00002886                          2240  BUFFER      DS.B    2700
00003312                          2241              DS.B    0
00003312                          2242              
00003312                          2243  
00003312                          2244  
00003312                          2245  
00003312                          2246  
00003312                          2247  
00003312                          2248  
00003312                          2249  
00003312                          2250  -------------------- end include --------------------
00003312                          2251              INCLUDE "VARS.X68"
00003312                          2252  ; ==============================================================================
00003312                          2253  ; GAME VARIABLES
00003312                          2254  ; ==============================================================================
00003312                          2255  
00003312                          2256  ; --- PAC-MAN RELATED VARIABLES ------------------------------------------------
00003312                          2257  
00003312                          2258  PMPOSX      DS.W    1                       ; PM X COORDINATE
00003314                          2259  PMPOSY      DS.W    1                       ; PM Y COORDINATE
00003316                          2260  PMVELX      DS.W    1                       ; PM X VELOCITY
00003318                          2261  PMVELY      DS.W    1                       ; PM Y VELOCITY
0000331A                          2262  PMEAT       DS.B    1                       ; PM BOOLEAN EAT GST
0000331B                          2263  PMLAMO      DS.B    1                       ; PM SAVE LAST MOVEMENT X O Y
0000331C                          2264              DS.B    0
0000331C                          2265  
0000331C                          2266  ; --- GHOST RELATED VARIABLES --------------------------------------------------
0000331C                          2267  
0000331C                          2268  GSTPOSX     DS.W    1                       ; GST X COORDINATE
0000331E                          2269  GSTPOSY     DS.W    1                       ; GST Y COORDINATE
00003320                          2270  GSTVELX     DS.W    1                       ; GST X VELOCITY
00003322                          2271  GSTVELY     DS.W    1                       ; GST Y VELOCITY
00003324                          2272  GSTDEAD     DS.B    1                       ; GST BOOLEAN DEAD
00003325                          2273  GSTLAMO     DS.B    1                       ; GST LAST MOVEMENT (X OR Y)
00003326                          2274  GSTINRNG    DS.B    1                       ; GST IS IN RANGE
00003327                          2275  GSTTARG     DS.B    1                       ; GST TARGET (0-PACMAN, 1-RANDOM)
00003328                          2276              DS.B    0
00003328                          2277  
00003328                          2278  ; --- SCOREBOARD RELATED VARIABLES ---------------------------------------------
00003328                          2279  
00003328                          2280  SCOLIFE     DS.W    1                       ; NUMBER OF LIFES
0000332A                          2281  SCOPOINTS   DS.W    1                       ; NUMBER OF POINTS
0000332C                          2282  
0000332C                          2283  ; --- INTRO STATE RELATED VARIABLES --------------------------------------------
0000332C                          2284  
0000332C                          2285  ISCTIMER    DS.W    1                       ; INTRO TIMER
0000332E                          2286  
0000332E                          2287  ; --- STATE RELATED VARIABLES --------------------------------------------------
0000332E                          2288  
0000332E                          2289  STACUR      DS.W    1                       ; CURRENT STATE
00003330                          2290  STANEXT     DS.W    1                       ; NEXT STATE
00003332                          2291  
00003332                          2292  
00003332                          2293  
00003332                          2294  
00003332                          2295  
00003332                          2296  
00003332                          2297  
00003332                          2298  
00003332                          2299  
00003332                          2300  -------------------- end include --------------------
00003332                          2301              INCLUDE "LIB/UTLVARS.X68"
00003332                          2302  ; =============================================================================
00003332                          2303  ; UTILITY VARIABLES
00003332                          2304  ; =============================================================================
00003332                          2305  
00003332                          2306  UTLRNDIX    DS.B    1                       ; NEXT INDEX TO RANDOM NUMBER
00003334                          2307              DS.W    0
00003334                          2308  -------------------- end include --------------------
00003334                          2309              
00003334                          2310              END    START        

No errors detected
No warnings generated


SYMBOL TABLE INFORMATION
Symbol-name         Value
-------------------------
BUCLE_COLUMNA       1D42
BUCLE_COLUMNA2      1DB8
BUCLE_COLUMNA3      20F2
BUCLE_FILA          1D36
BUCLE_FILA2         1DAC
BUCLE_FILA3         20E8
BUFFER              2886
COLWALLDOWN         1B48
COLWALLLEFT         1B06
COLWALLRIGHT        1AC4
COLWALLUP           1B84
DIBFIGBPOINT        1E7E
DIBFIGPOINT         1E42
DIBFIGWALL          1E0A
DRAW                211A
FILENAME            19BE
FILESIZE            A8C
GAMINIT             2430
GAMPLOT             2444
GAMUPD              2440
GETPOINTS           1CA8
GETPOINTS:BPOINT    1CF2
GETPOINTS:DONE      1D16
GETPOINTS:POINT     1D04
GOVINIT             234C
GOVPLOT             2350
GOVPLOT:DONE        2384
GOVPLOT:TXT1        238A
GOVPLOT:TXT2        2394
GOVUPD              234E
GSTCOL1             FF
GSTCOL2             FF0080
GSTCOL3             FFFF00
GSTCOL4             80FF
GSTCOL5             800000
GSTCOLWALLDOWN      1C3A
GSTCOLWALLLEFT      1BFE
GSTCOLWALLRIGHT     1BC2
GSTCOLWALLUP        1C70
GSTDEAD             3324
GSTFCOL1            FFFFFF
GSTFCOL2            0
GSTFCOL3            0
GSTFCOL4            0
GSTFCOL5            0
GSTINIT             1400
GSTINRNG            3326
GSTINX1             2
GSTINX2             2
GSTINX3             1F
GSTINX4             1F
GSTINY1             2
GSTINY2             1F
GSTINY3             2
GSTINY4             1F
GSTLAMO             3325
GSTPLOT             151C
GSTPOSX             331C
GSTPOSY             331E
GSTRAD              8
GSTRNG              10
GSTSPEED            7
GSTSPEED2           5
GSTTARG             3327
GSTUPD              142A
GSTUPD:GSTDONE      1510
GSTUPD:GSTDOWNMOVE  14D8
GSTUPD:GSTINRNG     143E
GSTUPD:GSTLEFTMOVE  14AC
GSTUPD:GSTMOVE      1446
GSTUPD:GSTMULT      1464
GSTUPD:GSTNOTCOLISION  1492
GSTUPD:GSTNOTCOLISION2  14BE
GSTUPD:GSTNOTCOLISION3  14EA
GSTUPD:GSTNOTCOLISION4  1506
GSTUPD:GSTNOTINRNG  1432
GSTUPD:GSTNOTMULT   1464
GSTUPD:GSTNOTTP     14A2
GSTUPD:GSTNOTTP2    14CE
GSTUPD:GSTRIGHTMOVE  1480
GSTUPD:GSTUPMOVE    14F4
GSTVELX             3320
GSTVELY             3322
IMGPLOT             20D2
INSINIT             214E
INSPLOT             2152
INSPLOT:DONE        2176
INSPLOT:LOOP        2168
INSPLOT:TXT1        217C
INSPLOT:TXT2        21A6
INSPLOT:TXT3        21DB
INSPLOT:TXT4        2208
INSPLOT:TXT5        2223
INSPLOT:TXT6        2256
INSPLOT:TXT7        225A
INSPLOT:TXT8        2285
INSPLOT:TXT9        22A0
INSPLOT:TXTLST      22C4
INSUPD              2150
ISCINIT             2020
ISCPLOT             2044
ISCPLOT:DONE        2070
ISCPLOT:TXT1        2076
ISCPLOT:TXT2        2084
ISCTIMER            332C
ISCUPD              202E
ISCUPD:CONT         2042
ISCUPD:DONE         2042
KBDDOWN             28
KBDEDGE             2481
KBDFIRE1            20
KBDFIRE2            4D
KBDFIRE3            10
KBDINIT             1A60
KBDLEFT             25
KBDPAUSE            50
KBDRIGHT            27
KBDUP               26
KBDUPD              1A6E
KBDUPD:CONVERT      1AB6
KBDUPD:LOOP         1ABA
KBDUPD:NOACT        1AB0
KBDVAL              2480
MAPINIT             1D1C
MAPMAT              1000
MAPPLOT             1D96
MAPVAR              2484
NOTPOINT            1D76
NOTPOINT2           1DEA
NOTWALL             1D68
NOTWALL2            1DDC
OPENFILE            20A0
OPENFILE:CONVERT_LOOP  20C2
OPENFILE:END        20D0
PMEAT               331A
PMFCOL              FFFF
PMINIT              1586
PMLAMO              331B
PMPCOL              FFFF
PMPLOT              1726
PMPLOT:DDONE        17E2
PMPLOT:DDOWN        17B4
PMPLOT:DLEFT        17AA
PMPLOT:DOWNDRAW     18A2
PMPLOT:DRAW_MOUTH1  17BE
PMPLOT:DRAW_MOUTH2  17C8
PMPLOT:DRAW_MOUTH3  17D2
PMPLOT:DRAW_MOUTH4  17DC
PMPLOT:DRIGHT       1796
PMPLOT:DUP          17A0
PMPLOT:FULLDRAW     17E8
PMPLOT:LEFTDRAW     180C
PMPLOT:MOUTHOPEN    1754
PMPLOT:NOTMOVE      178C
PMPLOT:RIGHTDRAW    183E
PMPLOT:SET_MOUTHDOWN  192E
PMPLOT:SET_MOUTHLEFT  18D4
PMPLOT:SET_MOUTHRIGHT  18F2
PMPLOT:SET_MOUTHUP  1910
PMPLOT:UPDRAW       1870
PMPOSX              3312
PMPOSY              3314
PMRAD               8
PMSPEED             2
PMUPD               15BA
PMUPD:ACTXLEFT      1680
PMUPD:ACTXRIGHT     164C
PMUPD:ACTYDOWN      16B4
PMUPD:ACTYUP        16D8
PMUPD:DONE          1714
PMUPD:NOTCOLISION   1666
PMUPD:NOTCOLISION2  169A
PMUPD:NOTCOLISION3  16CE
PMUPD:NOTCOLISION4  16F2
PMUPD:NOTDOWN       1648
PMUPD:NOTLEFT       1606
PMUPD:NOTMULT       16FC
PMUPD:NOTRIGHT      161C
PMUPD:NOTTP         1676
PMUPD:NOTTP2        16AA
PMUPD:NOTUP         1632
PMVELX              3316
PMVELY              3318
POSCON              2884
SCOFCOL             0
SCOINIT             194C
SCOLIFE             3328
SCOLINE1            101
SCOLINE2            102
SCOPLOT             195C
SCOPLOT:TXT1        19AA
SCOPLOT:TXT2        19B3
SCOPOINTS           332A
SCRCYCCT            2483
SCRHEIGH            280
SCRINIT             19F4
SCRINTCT            2482
SCRTIM              1A52
SCRUPD              1A38
SCRWIDTH            280
STACUR              332E
STAEMPTY            242E
STAINIT             23AC
STANEXT             3330
STANONE             FFFFFFFF
STAPLOT             240A
STAPLOT:PLTTBL      2426
START               2454
START:LOOP          2460
START:WAITINIT      2466
STAUPD              23BC
STAUPD:DOUPD        23E2
STAUPD:INITBL       23FA
STAUPD:UPDTBL       2402
SYSINIT             19C8
UTLCHRWD            8
UTLINIT             1EBA
UTLPRINT            1ED0
UTLPRINT:ENDLOOP    1EE2
UTLPRINT:LOOP       1ED8
UTLRAND             1F02
UTLRAND:RANDVEC     1F20
UTLRNDIX            3332
WININIT             22EC
WINPLOT             22F0
WINPLOT:DONE        2324
WINPLOT:TXT1        232A
WINPLOT:TXT2        2333
WINUPD              22EE
ZERO                1D84
ZERO2               1DF8
ZERO3               2108
