00002648 Starting Address
Assembler used: EASy68K Editor/Assembler v5.16.01
Created On: 29/12/2022 18:55:53

00000000                             1  ; ==============================================================================
00000000                             2  ; TITLE       : PAC-MAN 68000
00000000                             3  ; DESCRIPTION : GAME IN MOTOROLA 68000 BASED ON PAC-MAN GAME
00000000                             4  ; AUTHOR      : JORDI FLORIT ENSENYAT
00000000                             5  ;               JOSEP GABRIEL FORNES REYNES
00000000                             6  ;               PAU GIRON RODRIGUEZ
00000000                             7  ; ==============================================================================
00001000                             8              ORG    $1000
00001000                             9  
00001000                            10              INCLUDE "CONST.X68"
00001000                            11  ; ==============================================================================
00001000                            12  ; GAME CONSTANTS
00001000                            13  ; ==============================================================================
00001000                            14  
00001000                            15  ; --- PAC-MAN RELATED CONTANTS ----------------------------------------------------
00001000                            16  
00001000  =0000FFFF                 17  PMPCOL      EQU     $0000FFFF               ; PAC-MAN CONTOUR COLOR
00001000  =0000FFFF                 18  PMFCOL      EQU     $0000FFFF               ; PAC-MAN FILL COLOR
00001000  =00000002                 19  PMSPEED     EQU     2                       ; MAGNITUDE OF THE X AND Y VEL.
00001000  =00000008                 20  PMRAD       EQU     8                       ; PAC-MAN RADIUS
00001000                            21  
00001000                            22  ; --- GHOST RELATED CONSTANTS ----------------------------------------------------
00001000                            23  
00001000  =00000002                 24  GSTSPEED    EQU     2                       ; MAGNITUDE OF THE NORMAL DISPLACEMENT
00001000  =00000005                 25  GSTSPEED2   EQU     5                       ; MAGNITUDE OF THE ATACKED DISPLACEMENT
00001000                            26  
00001000  =000000FF                 27  GSTCOL1     EQU     $000000FF               ; GHOST 1 CONTOUR COLOR RED
00001000  =00FFFFFF                 28  GSTFCOL1    EQU     $00FFFFFF               ; GHOST 1 FILL COLOR WHITE
00001000  =00000002                 29  GSTINX1     EQU     2                       ; GHOST 1 INITIAL X
00001000  =00000002                 30  GSTINY1     EQU     2                       ; GHOST 1 INITIAL Y
00001000                            31  
00001000  =00FF0080                 32  GSTCOL2     EQU     $00FF0080               ; GHOST 2 CONTOUR COLOR PINK
00001000  =00000000                 33  GSTFCOL2    EQU     $00000000               ; GHOST 1 FILL COLOR
00001000  =00000002                 34  GSTINX2     EQU     2                       ; GHOST 2 INITIAL X
00001000  =0000001F                 35  GSTINY2     EQU     31                      ; GHOST 2 INITIAL Y
00001000                            36  
00001000  =00FFFF00                 37  GSTCOL3     EQU     $00FFFF00               ; GHOST 3 CONTOUR COLOR CYAN
00001000  =00000000                 38  GSTFCOL3    EQU     $00000000               ; GHOST 3 FILL COLOR
00001000  =0000001F                 39  GSTINX3     EQU     31                      ; GHOST 3 INITIAL X
00001000  =00000002                 40  GSTINY3     EQU     2                       ; GHOST 3 INITIAL Y
00001000                            41  
00001000  =000080FF                 42  GSTCOL4     EQU     $000080FF               ; GHOST 4 CONTOUR COLOR ORANGE
00001000  =00000000                 43  GSTFCOL4    EQU     $00000000               ; GHOST 4 FILL COLOR
00001000  =0000001F                 44  GSTINX4     EQU     31                      ; GHOST 4 INITIAL X
00001000  =0000001F                 45  GSTINY4     EQU     31                      ; GHOST 4 INITIAL Y 
00001000                            46  
00001000  =00800000                 47  GSTCOL5     EQU     $00800000               ; CONTOUR COLOR OF ATACKED MODE
00001000  =00000000                 48  GSTFCOL5    EQU     $00000000               ; FILL COLOR OF ATACKED MODE
00001000                            49  
00001000  =00000008                 50  GSTRAD      EQU     8                       ; GHOST RADIUS
00001000  =00000010                 51  GSTRNG      EQU     16                      ; GHOST DETECTING RANGE
00001000= 0001 0002 0003 0004       52  GSTDECVEC   DC.W    1,2,3,4                 ; GHOST MOVEMENT DECISSIONS
00001008                            53              
00001008                            54  ; --- SCOREBOARD RELATED CONSTANTS ---------------------------------------------
00001008                            55  ;MODIFICATE
00001008                            56  
00001008  =00000000                 57  SCOFCOL     EQU     $00000000               ; TEXT BACKGROUND COLOR
00001008  =00000101                 58  SCOLINE1    EQU     $0101                   ; FIRST TEXT LINE COORDINATES
00001008  =00000102                 59  SCOLINE2    EQU     $0102                   ; SECOND TEXT LINE COORDINATES
00001008                            60  
00001008                            61  ; --- MAP RELATED CONSTANTS ----------------------------------------------------
00001008                            62  
00001008= 01 01 01 01 01 01 ...     63  MAPMAT      DC.B    $1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
00001028= 01 02 02 02 02 02 ...     64              DC.B    $1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1
00001048= 01 02 01 01 01 01 ...     65              DC.B    $1,2,1,1,1,1,1,2,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,2,1,1,1,1,1,2,1
00001068= 01 03 01 01 01 01 ...     66              DC.B    $1,3,1,1,1,1,1,2,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,2,1,1,1,1,1,3,1
00001088= 01 02 02 02 02 02 ...     67              DC.B    $1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1
000010A8= 01 02 01 01 01 01 ...     68              DC.B    $1,2,1,1,1,1,1,2,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,2,1,1,1,1,1,2,1
000010C8= 01 02 01 01 01 01 ...     69              DC.B    $1,2,1,1,1,1,1,2,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,2,1,1,1,1,1,2,1
000010E8= 01 02 02 02 02 02 ...     70              DC.B    $1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1
00001108= 01 02 01 01 01 01 ...     71              DC.B    $1,2,1,1,1,1,1,2,1,1,1,2,1,1,1,1,1,1,1,1,2,1,1,1,2,1,1,1,1,1,2,1
00001128= 01 02 01 00 00 00 ...     72              DC.B    $1,2,1,0,0,0,1,2,1,0,1,2,1,1,1,1,1,1,1,1,2,1,0,1,2,1,0,0,0,1,2,1
00001148= 01 02 01 01 01 01 ...     73              DC.B    $1,2,1,1,1,1,1,2,1,0,1,2,2,2,2,1,1,2,2,2,2,1,0,1,2,1,1,1,1,1,2,1
00001168= 01 02 02 02 02 02 ...     74              DC.B    $1,2,2,2,2,2,2,2,1,0,1,1,1,1,2,1,1,2,1,1,1,1,0,1,2,2,2,2,2,2,2,1
00001188= 01 01 01 01 01 01 ...     75              DC.B    $1,1,1,1,1,1,1,2,1,0,1,1,1,1,2,1,1,2,1,1,1,1,0,1,2,1,1,1,1,1,1,1
000011A8= 01 00 00 00 00 00 ...     76              DC.B    $1,0,0,0,0,0,1,2,1,0,1,0,0,0,0,0,0,0,0,0,0,1,0,1,2,1,0,0,0,0,0,1
000011C8= 01 00 00 00 00 00 ...     77              DC.B    $1,0,0,0,0,0,1,2,1,0,1,0,1,1,1,0,0,1,1,1,0,1,0,1,2,1,0,0,0,0,0,1
000011E8= 01 01 01 01 01 01 ...     78              DC.B    $1,1,1,1,1,1,1,2,1,1,1,0,1,0,0,0,0,0,0,1,0,1,1,1,2,1,1,1,1,1,1,1
00001208= 04 00 00 00 00 00 ...     79              DC.B    $4,0,0,0,0,0,0,2,2,2,2,0,1,0,0,0,0,0,0,1,0,2,2,2,2,0,0,0,0,0,0,4
00001228= 01 01 01 01 01 01 ...     80              DC.B    $1,1,1,1,1,1,1,2,1,1,1,0,1,0,0,0,0,0,0,1,0,1,1,1,2,1,1,1,1,1,1,1
00001248= 01 00 00 00 00 00 ...     81              DC.B    $1,0,0,0,0,0,1,2,1,0,1,0,1,1,1,1,1,1,1,1,0,1,0,1,2,1,0,0,0,0,0,1
00001268= 01 00 00 00 00 00 ...     82              DC.B    $1,0,0,0,0,0,1,2,1,0,1,0,0,0,0,0,0,0,0,0,0,1,0,1,2,1,0,0,0,0,0,1
00001288= 01 01 01 01 01 01 ...     83              DC.B    $1,1,1,1,1,1,1,2,1,1,1,0,1,1,1,1,1,1,1,1,0,1,1,1,2,1,1,1,1,1,1,1
000012A8= 01 02 02 02 02 02 ...     84              DC.B    $1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1
000012C8= 01 02 01 01 01 01 ...     85              DC.B    $1,2,1,1,1,1,1,2,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,2,1,1,1,1,1,2,1
000012E8= 01 02 01 01 01 01 ...     86              DC.B    $1,2,1,1,1,1,1,2,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,2,1,1,1,1,1,2,1
00001308= 01 02 02 02 02 01 ...     87              DC.B    $1,2,2,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,2,2,2,1
00001328= 01 01 01 01 02 01 ...     88              DC.B    $1,1,1,1,2,1,1,2,1,1,1,2,1,1,1,1,1,1,1,1,2,1,1,1,2,1,1,2,1,1,1,1
00001348= 01 01 01 01 02 01 ...     89              DC.B    $1,1,1,1,2,1,1,2,1,0,1,2,1,1,1,1,1,1,1,1,2,1,0,1,2,1,1,2,1,1,1,1
00001368= 01 02 02 02 02 02 ...     90              DC.B    $1,2,2,2,2,2,2,2,1,0,1,2,2,2,2,1,1,2,2,2,2,1,0,1,2,2,2,2,2,2,2,1
00001388= 01 02 01 01 01 01 ...     91              DC.B    $1,2,1,1,1,1,1,1,1,0,1,1,1,1,2,1,1,2,1,1,1,1,0,1,1,1,1,1,1,1,2,1
000013A8= 01 03 01 01 01 01 ...     92              DC.B    $1,3,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,3,1
000013C8= 01 02 02 02 02 02 ...     93              DC.B    $1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1
000013E8= 01 01 01 01 01 01 ...     94              DC.B    $1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
00001408                            95              
00001408                            96  ; --- STATE RELATED CONSTANTS --------------------------------------------------
00001408                            97  
00001408  =FFFFFFFF                 98  STANONE     EQU     -1                      ; NON-EXISTENT STATE NUMBER
00001408                            99  
00001408                           100  
00001408                           101  
00001408                           102  
00001408                           103  
00001408                           104  
00001408                           105  
00001408                           106  
00001408                           107  
00001408                           108  
00001408                           109  
00001408                           110  
00001408                           111  
00001408                           112  
00001408                           113  
00001408                           114  
00001408                           115  
00001408                           116  
00001408                           117  
00001408                           118  
00001408                           119  
00001408                           120  
00001408                           121  
00001408                           122  
00001408                           123  -------------------- end include --------------------
00001408                           124              INCLUDE "GHOST.X68"
00001408                           125  ; ==============================================================================
00001408                           126  ; GHOST MANAGEMENT
00001408                           127  ; ==============================================================================
00001408                           128              
00001408                           129  ; ------------------------------------------------------------------------------
00001408                           130  GSTINIT
00001408                           131  ; INITIALIZE GHOST.
00001408                           132  ; INPUT    : NONE 
00001408                           133  ; OUTPUT   : NONE
00001408                           134  ; MODIFIES : NONE
00001408                           135  ; ------------------------------------------------------------------------------
00001408  33FC 0058 00017A74       136              MOVE.W  #GSTINX1*16+64-8,(GSTPOSX)
00001410  33FC 0058 00017A76       137              MOVE.W  #GSTINY1*16+64-8,(GSTPOSY)
00001418  33FC 0002 00017A78       138              MOVE.W  #GSTSPEED,(GSTVELX)
00001420  33FC 0002 00017A7A       139              MOVE.W  #GSTSPEED,(GSTVELY)
00001428  13FC 0002 00017A7C       140              MOVE.B  #2,(GSTLAMO)
00001430  13FC 0000 00017A81       141              MOVE.B  #0,(GSTCHDIR)
00001438  4E75                     142              RTS
0000143A                           143              
0000143A                           144  ; ------------------------------------------------------------------------------
0000143A                           145  GSTUPD
0000143A                           146  ; UPDATES THE GHOST.
0000143A                           147  ; INPUT    : NONE 
0000143A                           148  ; OUTPUT   : NONE
0000143A                           149  ; MODIFIES : NONE
0000143A                           150  ; ------------------------------------------------------------------------------
0000143A  48E7 FC00                151              MOVEM.L D0-D5,-(A7)
0000143E                           152              
0000143E                           153              ;MOVE.W  (PMPOSX)/16*(PMPOSX)/16+(PMPOSY)/16*(PMPOSY)/16,D0
0000143E  323C 0010                154              MOVE.W  #GSTRNG,D1
00001442  C2FC 0010                155              MULU.W  #GSTRNG,D1
00001446  9240                     156              SUB.W   D0,D1
00001448  303C 0002                157              MOVE.W  #GSTSPEED,D0
0000144C  6600 0016                158              BNE     .GSTINRNG
00001450                           159  .GSTNOTINRNG
00001450  4240                     160              CLR     D0
00001452  4241                     161              CLR     D1
00001454  383C 0000                162              MOVE.W  #0,D4
00001458  13FC 0001 00017A7F       163              MOVE.B  #1,(GSTINRNG)
00001460  6000 000E                164              BRA     .GSTMOVE
00001464                           165  .GSTINRNG
00001464  383C 0000                166              MOVE.W  #0,D4
00001468  13FC 0000 00017A7F       167              MOVE.B  #0,(GSTINRNG)
00001470                           168  .GSTMOVE
00001470  1439 00017A81            169              MOVE.B  (GSTCHDIR),D2
00001476                           170              ;CMP.B   #1,D2
00001476                           171              ;BGE     .GSTNOTMULT
00001476  3439 00017A74            172              MOVE.W  (GSTPOSX),D2
0000147C  3639 00017A76            173              MOVE.W  (GSTPOSY),D3
00001482                           174              
00001482  5042                     175              ADDQ.W  #8,D2              
00001484  5043                     176              ADDQ.W  #8,D3
00001486                           177  
00001486                           178              ;MASK OF THE LAST NIBBLE        
00001486  C47C 000F                179              AND.W   #$000F,D2               ; COORDENADA X
0000148A  C67C 000F                180              AND.W   #$000F,D3               ; COORDENADA Y
0000148E                           181              
0000148E                           182              ;CHECK IF COORDS ARE MULTIPLES OF 16
0000148E  B47C 0000                183              CMP     #$0000,D2
00001492  6600 0136                184              BNE     .GSTNOTMULT
00001496  B67C 0000                185              CMP     #$0000,D3
0000149A  6600 012E                186              BNE     .GSTNOTMULT
0000149E                           187  .GSTMULT
0000149E  13FC 0000 00017A7D       188              MOVE.B  #0,(GSTPOSMV)
000014A6  13FC 0003 00017A81       189              MOVE.B  #3,(GSTCHDIR)
000014AE                           190  .GSTMULTRIGHT
000014AE  4EB9 00001DCC            191              JSR     GSTCOLWALLRIGHT
000014B4  BA7C 0001                192              CMP     #1,D5
000014B8  6700 000A                193              BEQ     .GSTMULTLEFT
000014BC  5239 00017A7D            194              ADD.B   #1,(GSTPOSMV)
000014C2  5244                     195              ADDQ.W  #1,D4
000014C4                           196  .GSTMULTLEFT
000014C4  4EB9 00001E08            197              JSR     GSTCOLWALLLEFT
000014CA  BA7C 0001                198              CMP     #1,D5
000014CE  6700 000A                199              BEQ     .GSTMULTDOWN
000014D2  5439 00017A7D            200              ADD.B   #2,(GSTPOSMV)
000014D8  5244                     201              ADDQ.W  #1,D4
000014DA                           202  .GSTMULTDOWN
000014DA  4EB9 00001E44            203              JSR     GSTCOLWALLDOWN
000014E0  BA7C 0001                204              CMP     #1,D5
000014E4  6700 000A                205              BEQ     .GSTMULTUP
000014E8  5839 00017A7D            206              ADD.B   #4,(GSTPOSMV)
000014EE  5244                     207              ADDQ.W  #1,D4
000014F0                           208  .GSTMULTUP
000014F0  4EB9 00001E7A            209              JSR     GSTCOLWALLUP
000014F6  BA7C 0001                210              CMP     #1,D5
000014FA  6700 000A                211              BEQ     .GSTDECISSION
000014FE  5039 00017A7D            212              ADD.B   #8,(GSTPOSMV)
00001504  5244                     213              ADDQ.W  #1,D4
00001506                           214  .GSTDECISSION
00001506  B87C 0002                215              CMP     #2,D4
0000150A  6F00 0032                216              BLE     .GST2MOVES
0000150E  4EB9 0000210C            217              JSR     UTLRAND
00001514  C0BC 00000006            218              AND.L   #$00000006,D0
0000151A  43F8 1000                219              LEA     GSTDECVEC,A1
0000151E  3231 0000                220              MOVE.W  (A1,D0),D1
00001522  B27C 0001                221              CMP     #1,D1
00001526  6700 0062                222              BEQ     .GSTRANRIGHT
0000152A  B27C 0002                223              CMP     #2,D1
0000152E  6700 006A                224              BEQ     .GSTRANLEFT
00001532  B27C 0003                225              CMP     #3,D1
00001536  6700 0072                226              BEQ     .GSTRANDOWN
0000153A  6000 007E                227              BRA     .GSTRANUP
0000153E                           228  .GST2MOVES
0000153E  4EB9 000016A8            229              JSR     GST2DECISSIONS
00001544  B87C 0000                230              CMP     #0,D4
00001548  6600 0080                231              BNE     .GSTNOTMULT
0000154C  1839 00017A7C            232              MOVE.B  (GSTLAMO),D4
00001552  B87C 0001                233              CMP     #1,D4
00001556  6700 000E                234              BEQ     .2MLAMOX
0000155A  B87C 0002                235              CMP     #2,D4
0000155E  6700 0006                236              BEQ     .2MLAMOX
00001562  6000 0014                237              BRA     .2MLAMOY
00001566                           238  .2MLAMOX
00001566  4EB9 00001E7A            239              JSR     GSTCOLWALLUP
0000156C  BA7C 0001                240              CMP     #1,D5
00001570  6600 010C                241              BNE     .GSTUPMOVE
00001574  6000 00E4                242              BRA     .GSTDOWNMOVE
00001578                           243  .2MLAMOY
00001578  4EB9 00001DCC            244              JSR     GSTCOLWALLRIGHT
0000157E  BA7C 0001                245              CMP     #1,D5
00001582  6600 006E                246              BNE     .GSTRIGHTMOVE
00001586  6000 009E                247              BRA     .GSTLEFTMOVE
0000158A                           248  
0000158A                           249  .GSTRANRIGHT
0000158A  0839 0000 00017A7D       250              BTST.B  #0,(GSTPOSMV)
00001592  6700 FF72                251              BEQ     .GSTDECISSION
00001596  6000 005A                252              BRA     .GSTRIGHTMOVE
0000159A                           253  .GSTRANLEFT
0000159A  0839 0001 00017A7D       254              BTST.B  #1,(GSTPOSMV)
000015A2  6700 FF62                255              BEQ     .GSTDECISSION
000015A6  6000 007E                256              BRA     .GSTLEFTMOVE
000015AA                           257  .GSTRANDOWN
000015AA  0839 0002 00017A7D       258              BTST.B  #2,(GSTPOSMV)
000015B2  6700 FF52                259              BEQ     .GSTDECISSION
000015B6  6000 00A2                260              BRA     .GSTDOWNMOVE
000015BA                           261  .GSTRANUP
000015BA  0839 0003 00017A7D       262              BTST.B  #3,(GSTPOSMV)
000015C2  6700 FF42                263              BEQ     .GSTDECISSION
000015C6  6000 00B6                264              BRA     .GSTUPMOVE
000015CA                           265  .GSTNOTMULT 
000015CA  5339 00017A81            266              SUB.B   #1,(GSTCHDIR)
000015D0  1839 00017A7C            267              MOVE.B  (GSTLAMO),D4           
000015D6  B87C 0001                268              CMP     #1,D4
000015DA  6700 0016                269              BEQ     .GSTRIGHTMOVE
000015DE  B87C 0002                270              CMP     #2,D4
000015E2  6700 0042                271              BEQ     .GSTLEFTMOVE
000015E6  B87C 0003                272              CMP     #3,D4
000015EA  6700 006E                273              BEQ     .GSTDOWNMOVE
000015EE  6000 008E                274              BRA     .GSTUPMOVE
000015F2                           275  
000015F2                           276              ;UPDATE COORDS
000015F2                           277              
000015F2                           278  .GSTRIGHTMOVE
000015F2  4EB9 00001DCC            279              JSR     GSTCOLWALLRIGHT
000015F8  BA7C 0001                280              CMP     #1,D5
000015FC  6600 0006                281              BNE     .GSTNOTCOLISION
00001600  303C 0000                282              MOVE.W  #0,D0
00001604                           283  .GSTNOTCOLISION
00001604  BA7C 0004                284              CMP     #4,D5
00001608  6600 000A                285              BNE     .GSTNOTTP
0000160C  0479 01E0 00017A74       286              SUB.W   #30*16,(GSTPOSX)
00001614                           287  .GSTNOTTP
00001614  D179 00017A74            288              ADD.W   D0,(GSTPOSX)
0000161A  13FC 0001 00017A7C       289              MOVE.B  #1,(GSTLAMO)
00001622  6000 007E                290              BRA     .GSTDONE
00001626                           291  .GSTLEFTMOVE
00001626  4EB9 00001E08            292              JSR     GSTCOLWALLLEFT
0000162C  BA7C 0001                293              CMP     #1,D5
00001630  6600 0006                294              BNE     .GSTNOTCOLISION2
00001634  303C 0000                295              MOVE.W  #0,D0
00001638                           296  .GSTNOTCOLISION2
00001638  BA7C 0004                297              CMP     #4,D5
0000163C  6600 000A                298              BNE     .GSTNOTTP2
00001640  0679 01E0 00017A74       299              ADD.W   #30*16,(GSTPOSX)
00001648                           300  .GSTNOTTP2
00001648  9179 00017A74            301              SUB.W   D0,(GSTPOSX)
0000164E  13FC 0002 00017A7C       302              MOVE.B  #2,(GSTLAMO)
00001656  6000 004A                303              BRA     .GSTDONE
0000165A                           304      
0000165A                           305  .GSTDOWNMOVE
0000165A  4EB9 00001E44            306              JSR     GSTCOLWALLDOWN
00001660  BA7C 0001                307              CMP     #1,D5
00001664  6600 0006                308              BNE     .GSTNOTCOLISION3
00001668  303C 0000                309              MOVE.W  #0,D0
0000166C                           310  .GSTNOTCOLISION3
0000166C  D179 00017A76            311              ADD.W   D0,(GSTPOSY)
00001672  13FC 0003 00017A7C       312              MOVE.B  #3,(GSTLAMO)
0000167A  6000 0026                313              BRA     .GSTDONE
0000167E                           314  .GSTUPMOVE    
0000167E  4EB9 00001E7A            315              JSR     GSTCOLWALLUP
00001684  BA7C 0001                316              CMP     #1,D5
00001688  6600 0006                317              BNE     .GSTNOTCOLISION4
0000168C  303C 0000                318              MOVE.W  #0,D0
00001690                           319  .GSTNOTCOLISION4
00001690  9179 00017A76            320              SUB.W   D0,(GSTPOSY)
00001696  13FC 0004 00017A7C       321              MOVE.B  #4,(GSTLAMO)
0000169E  6000 0002                322              BRA     .GSTDONE
000016A2                           323  
000016A2                           324  .GSTDONE
000016A2                           325  
000016A2  4CDF 003F                326              MOVEM.L (A7)+,D0-D5
000016A6                           327              
000016A6  4E75                     328              RTS
000016A8                           329              
000016A8                           330  ; SUBRUTINES FOR GHOST UPDATE --------------------------------------------------
000016A8                           331  
000016A8                           332  GST2DECISSIONS
000016A8                           333  
000016A8  48E7 8000                334              MOVEM.L D0,-(A7)
000016AC                           335              
000016AC  1039 00017A7C            336              MOVE.B  (GSTLAMO),D0
000016B2  B07C 0001                337              CMP     #1,D0
000016B6  6700 0016                338              BEQ     .LAMORIGHT
000016BA  B07C 0002                339              CMP     #2,D0
000016BE  6700 0022                340              BEQ     .LAMOLEFT
000016C2  B07C 0003                341              CMP     #3,D0
000016C6  6700 002E                342              BEQ     .LAMODOWN
000016CA  6000 003E                343              BRA     .LAMOUP
000016CE                           344              
000016CE                           345  .LAMORIGHT
000016CE  0839 0000 00017A7D       346              BTST.B  #0,(GSTPOSMV)
000016D6  6700 0046                347              BEQ     .RETURN0
000016DA  383C 0001                348              MOVE.W  #1,D4
000016DE  6000 0042                349              BRA     .GST2DECEND
000016E2                           350  .LAMOLEFT
000016E2  0839 0001 00017A7D       351              BTST.B  #1,(GSTPOSMV)
000016EA  6700 0032                352              BEQ     .RETURN0
000016EE  383C 0001                353              MOVE.W  #1,D4
000016F2  6000 002E                354              BRA     .GST2DECEND
000016F6                           355  .LAMODOWN
000016F6  0839 0002 00017A7D       356              BTST.B  #2,(GSTPOSMV)
000016FE  6700 001E                357              BEQ     .RETURN0
00001702  383C 0001                358              MOVE.W  #1,D4
00001706  6000 001A                359              BRA     .GST2DECEND
0000170A                           360  .LAMOUP
0000170A  0839 0003 00017A7D       361              BTST.B  #3,(GSTPOSMV)
00001712  6700 000A                362              BEQ     .RETURN0
00001716  383C 0001                363              MOVE.W  #1,D4
0000171A  6000 0006                364              BRA     .GST2DECEND
0000171E                           365  .RETURN0
0000171E  383C 0000                366              MOVE.W  #0,D4
00001722                           367              
00001722                           368  .GST2DECEND
00001722                           369  
00001722  4CDF 0001                370              MOVEM.L (A7)+,D0
00001726  4E75                     371              RTS
00001728                           372  
00001728                           373              
00001728                           374  ; ------------------------------------------------------------------------------
00001728                           375  GSTPLOT
00001728                           376  ; PLOT THE GHOST.
00001728                           377  ; INPUT    : NONE 
00001728                           378  ; OUTPUT   : NONE
00001728                           379  ; MODIFIES : NONE
00001728                           380  ; ------------------------------------------------------------------------------
00001728  48E7 F800                381              MOVEM.L D0-D4,-(A7)
0000172C                           382              
0000172C                           383              ;SET PEN COLOR
0000172C  303C 0050                384              MOVE.W  #80,D0
00001730  223C 000000FF            385              MOVE.L  #GSTCOL1,D1
00001736  4E4F                     386              TRAP    #15
00001738                           387              
00001738                           388              ;SET FILL COLOR
00001738  303C 0051                389              MOVE.W  #81,D0
0000173C  223C 00FFFFFF            390              MOVE.L  #GSTFCOL1,D1
00001742  4E4F                     391              TRAP    #15
00001744                           392              
00001744                           393              ;SET COORDS
00001744  3239 00017A74            394              MOVE.W  (GSTPOSX),D1
0000174A  5141                     395              SUB.W   #GSTRAD,D1
0000174C  3439 00017A76            396              MOVE.W  (GSTPOSY),D2
00001752  5142                     397              SUB.W   #GSTRAD,D2
00001754                           398              
00001754  3601                     399              MOVE.W  D1,D3
00001756  0643 0010                400              ADD.W   #GSTRAD*2,D3
0000175A  3802                     401              MOVE.W  D2,D4
0000175C  0644 0010                402              ADD.W   #GSTRAD*2,D4
00001760                           403              
00001760                           404              ;DRAW GHOST
00001760  303C 0058                405              MOVE.W  #88,D0
00001764  4E4F                     406              TRAP    #15
00001766                           407              
00001766                           408              ;SET RANGE COORDS
00001766  3239 00017A74            409              MOVE.W  (GSTPOSX),D1
0000176C  0441 0100                410              SUB.W   #GSTRNG*16,D1
00001770  3439 00017A76            411              MOVE.W  (GSTPOSY),D2
00001776  0442 0100                412              SUB.W   #GSTRNG*16,D2
0000177A                           413              
0000177A  3601                     414              MOVE.W  D1,D3
0000177C  0643 0200                415              ADD.W   #GSTRNG*16*2,D3
00001780  3802                     416              MOVE.W  D2,D4
00001782  0644 0200                417              ADD.W   #GSTRNG*16*2,D4
00001786                           418              
00001786                           419              ;DRAW GHOST RANGE
00001786  303C 005B                420              MOVE.W  #91,D0
0000178A  4E4F                     421              TRAP    #15
0000178C                           422              
0000178C  4CDF 001F                423              MOVEM.L (A7)+,D0-D4
00001790                           424              
00001790                           425  
00001790  4E75                     426              RTS
00001792                           427  
00001792                           428  
00001792                           429  
00001792                           430  
00001792                           431  
00001792                           432  
00001792                           433  
00001792                           434  
00001792                           435  
00001792                           436  
00001792                           437  -------------------- end include --------------------
00001792                           438              INCLUDE "PAC-MAN.X68"
00001792                           439  ; ==============================================================================
00001792                           440  ; PAC-MAN MANAGEMENT
00001792                           441  ; ==============================================================================
00001792                           442              
00001792                           443  ; ------------------------------------------------------------------------------
00001792                           444  PMINIT
00001792                           445  ; INITIALIZE PAC-MAN.
00001792                           446  ; INPUT    : NONE 
00001792                           447  ; OUTPUT   : NONE
00001792                           448  ; MODIFIES : NONE
00001792                           449  ; ------------------------------------------------------------------------------
00001792                           450  
00001792  33FC 0140 00017A6A       451              MOVE.W  #SCRWIDTH/2,(PMPOSX)
0000179A  33FC 0140 00017A6C       452              MOVE.W  #SCRHEIGH/2,(PMPOSY)
000017A2  5079 00017A6A            453              ADDQ.W  #8,(PMPOSX)
000017A8  5079 00017A6C            454              ADDQ.W  #8,(PMPOSY)
000017AE  33FC 0002 00017A6E       455              MOVE.W  #PMSPEED,(PMVELX)
000017B6  33FC 0002 00017A70       456              MOVE.W  #PMSPEED,(PMVELY)
000017BE  4239 00017A73            457              CLR.B   (PMLAMO)
000017C4                           458  
000017C4  4E75                     459              RTS
000017C6                           460              
000017C6                           461  ; ------------------------------------------------------------------------------
000017C6                           462  PMUPD
000017C6                           463  ; UPDATES THE PAC-MAN.
000017C6                           464  ; INPUT    : NONE 
000017C6                           465  ; OUTPUT   : NONE
000017C6                           466  ; MODIFIES : NONE
000017C6                           467  ; ------------------------------------------------------------------------------
000017C6                           468              
000017C6  48E7 FE00                469              MOVEM.L D0-D6,-(A7)
000017CA                           470              
000017CA  303C 0002                471              MOVE.W  #PMSPEED,D0
000017CE                           472              
000017CE                           473              
000017CE  3439 00017A6A            474              MOVE.W  (PMPOSX),D2
000017D4  3639 00017A6C            475              MOVE.W  (PMPOSY),D3
000017DA                           476              
000017DA  5042                     477              ADDQ.W  #8,D2              
000017DC  5043                     478              ADDQ.W  #8,D3  
000017DE                           479              
000017DE  1839 00017A73            480              MOVE.B  (PMLAMO),D4
000017E4                           481              
000017E4                           482              ;MASK OF THE LAST NIBBLE        
000017E4  C47C 000F                483              AND.W   #$000F,D2               ; COORDENADA X
000017E8  C67C 000F                484              AND.W   #$000F,D3               ; COORDENADA Y
000017EC                           485              
000017EC                           486              ;CHECK IF COORDS ARE MULTIPLES OF 16
000017EC  B47C 0000                487              CMP     #$0000,D2
000017F0  6600 0116                488              BNE     .NOTMULT
000017F4  B67C 0000                489              CMP     #$0000,D3
000017F8  6600 010E                490              BNE     .NOTMULT
000017FC                           491              
000017FC                           492              ;BRA     .ACTYUP
000017FC                           493  
000017FC                           494              ;CHECK THE DIRECTION
000017FC  0839 0000 00002674       495              BTST.B  #0,(KBDVAL)             ;CHECK LEFT
00001804  6700 000C                496              BEQ     .NOTLEFT
00001808  4204                     497              CLR.B   D4
0000180A  183C 0000                498              MOVE.B  #0,D4
0000180E  6000 007C                499              BRA     .ACTXLEFT
00001812                           500  .NOTLEFT            
00001812  0839 0002 00002674       501              BTST.B   #2,(KBDVAL)             ;CHECK RIGHT
0000181A  6700 000C                502              BEQ     .NOTRIGHT
0000181E  4204                     503              CLR.B   D4
00001820  183C 0001                504              MOVE.B   #1,D4
00001824  6000 0032                505              BRA     .ACTXRIGHT
00001828                           506  .NOTRIGHT            
00001828  0839 0001 00002674       507              BTST.B   #1,(KBDVAL)             ;CHECK UP
00001830  6700 000C                508              BEQ     .NOTUP
00001834  4204                     509              CLR.B   D4
00001836  183C 0002                510              MOVE.B  #2,D4
0000183A  6000 00A8                511              BRA     .ACTYUP
0000183E                           512  .NOTUP            
0000183E  0839 0003 00002674       513              BTST.B   #3,(KBDVAL)             ;CHECK DOWN
00001846  6700 000C                514              BEQ     .NOTDOWN
0000184A  4204                     515              CLR.B   D4
0000184C  183C 0003                516              MOVE.B   #3,D4
00001850  6000 006E                517              BRA     .ACTYDOWN
00001854                           518  .NOTDOWN
00001854  6000 00CA                519              BRA     .DONE
00001858                           520              
00001858                           521              
00001858                           522              ;UPDATE COORDS
00001858                           523              
00001858                           524  .ACTXRIGHT  
00001858  4EB9 00001CCE            525              JSR     COLWALLRIGHT
0000185E  BA7C 0001                526              CMP     #1,D5
00001862  6600 000E                527              BNE     .NOTCOLISION
00001866  13FC 0000 00002674       528              MOVE.B  #0,(KBDVAL)
0000186E  303C 0000                529              MOVE.W  #0,D0
00001872                           530  .NOTCOLISION
00001872  BA7C 0004                531              CMP     #4,D5
00001876  6600 000A                532              BNE     .NOTTP
0000187A  0479 01E0 00017A6A       533              SUB.W   #30*16,(PMPOSX)
00001882                           534  .NOTTP
00001882  D179 00017A6A            535              ADD.W   D0,(PMPOSX)
00001888  6000 0096                536              BRA     .DONE
0000188C                           537  .ACTXLEFT
0000188C  4EB9 00001D10            538              JSR     COLWALLLEFT
00001892  BA7C 0001                539              CMP     #1,D5
00001896  6600 000E                540              BNE     .NOTCOLISION2
0000189A  13FC 0000 00002674       541              MOVE.B  #0,(KBDVAL)
000018A2  303C 0000                542              MOVE.W  #0,D0
000018A6                           543  .NOTCOLISION2
000018A6  BA7C 0004                544              CMP     #4,D5
000018AA  6600 000A                545              BNE     .NOTTP2
000018AE  0679 01E0 00017A6A       546              ADD.W   #30*16,(PMPOSX)
000018B6                           547  .NOTTP2
000018B6  9179 00017A6A            548              SUB.W   D0,(PMPOSX)
000018BC  6000 0062                549              BRA     .DONE
000018C0                           550      
000018C0                           551  .ACTYDOWN
000018C0  4EB9 00001D52            552              JSR     COLWALLDOWN
000018C6  BA7C 0001                553              CMP     #1,D5
000018CA  6600 000E                554              BNE     .NOTCOLISION3
000018CE  13FC 0000 00002674       555              MOVE.B  #0,(KBDVAL)
000018D6  303C 0000                556              MOVE.W  #0,D0
000018DA                           557  .NOTCOLISION3
000018DA  D179 00017A6C            558              ADD.W   D0,(PMPOSY)
000018E0  6000 003E                559              BRA     .DONE
000018E4                           560  .ACTYUP     
000018E4  4EB9 00001D8E            561              JSR     COLWALLUP
000018EA  BA7C 0001                562              CMP     #1,D5
000018EE  6600 000E                563              BNE     .NOTCOLISION4
000018F2  13FC 0000 00002674       564              MOVE.B  #0,(KBDVAL)
000018FA  303C 0000                565              MOVE.W  #0,D0
000018FE                           566  .NOTCOLISION4
000018FE  9179 00017A6C            567              SUB.W   D0,(PMPOSY)
00001904  6000 001A                568              BRA     .DONE
00001908                           569              
00001908                           570              
00001908                           571              ;IF NOT MULT DO
00001908                           572  .NOTMULT     
00001908  B83C 0000                573              CMP.B     #0,D4
0000190C  6700 FF7E                574              BEQ     .ACTXLEFT
00001910  B83C 0001                575              CMP.B     #1,D4
00001914  6700 FF42                576              BEQ     .ACTXRIGHT
00001918  B83C 0002                577              CMP.B     #2,D4
0000191C  67C6                     578              BEQ     .ACTYUP
0000191E  60A0                     579              BRA     .ACTYDOWN
00001920                           580  .DONE
00001920                           581              ;RESTORE
00001920  4EB9 00001EB2            582              JSR     GETPOINTS
00001926  13C4 00017A73            583              MOVE.B  D4,(PMLAMO)
0000192C                           584              
0000192C  4CDF 007F                585              MOVEM.L (A7)+,D0-D6
00001930                           586              
00001930  4E75                     587              RTS
00001932                           588                          
00001932                           589  ; ------------------------------------------------------------------------------
00001932                           590  PMPLOT
00001932                           591  ; PLOT THE BALL.
00001932                           592  ; INPUT    : NONE 
00001932                           593  ; OUTPUT   : NONE
00001932                           594  ; MODIFIES : NONE
00001932                           595  ; ------------------------------------------------------------------------------
00001932                           596  
00001932  48E7 FC00                597              MOVEM.L D0-D5,-(A7)
00001936                           598  
00001936                           599              ;SET PEN COLOR
00001936  303C 0050                600              MOVE.W  #80,D0
0000193A  7200                     601              MOVE.L  #$0000,D1
0000193C  4E4F                     602              TRAP    #15
0000193E                           603              
0000193E                           604              ;SET FILL COLOR
0000193E  303C 0051                605              MOVE.W  #81,D0
00001942  223C 0000FFFF            606              MOVE.L  #PMFCOL,D1
00001948  4E4F                     607              TRAP    #15
0000194A                           608              
0000194A  0839 0003 00002677       609              BTST.B  #3,(SCRCYCCT)
00001952  6700 000C                610              BEQ     .MOUTHOPEN
00001956                           611              
00001956                           612              ;DRAW QUIET
00001956  4EB9 000019F4            613              JSR     .FULLDRAW
0000195C  6000 0090                614              BRA     .DDONE
00001960                           615              
00001960                           616  .MOUTHOPEN     
00001960  4EB9 000019F4            617              JSR     .FULLDRAW       
00001966  1A39 00002674            618              MOVE.B  (KBDVAL),D5
0000196C  CA3C 000F                619              AND.B   #$0F,D5
00001970                           620   
00001970                           621              ;CHECK KBDVAL
00001970  BA3C 0000                622              CMP.B   #$0,D5
00001974  6700 0022                623              BEQ     .NOTMOVE
00001978  BA3C 0001                624              CMP.B  #$1,D5             ;LEFT
0000197C  6700 0038                625              BEQ     .DLEFT
00001980  BA3C 0002                626              CMP.B  #$2,D5             ;UP
00001984  6700 0026                627              BEQ     .DUP
00001988  BA3C 0004                628              CMP.B  #$4,D5             ;RIGHT
0000198C  6700 0014                629              BEQ     .DRIGHT
00001990  BA3C 0008                630              CMP.B  #$8,D5             ;DOWN
00001994  6700 002A                631              BEQ     .DDOWN
00001998                           632              
00001998                           633              ;DRAW MOVEMENT
00001998  4EB9 000019F4            634  .NOTMOVE    JSR     .FULLDRAW
0000199E  6000 004E                635              BRA     .DDONE
000019A2                           636  .DRIGHT
000019A2  4EB9 00001A4A            637              JSR     .RIGHTDRAW
000019A8  6000 0034                638              BRA     .DRAW_MOUTH3
000019AC                           639  .DUP
000019AC  4EB9 00001A7C            640              JSR     .UPDRAW
000019B2  6000 0020                641              BRA     .DRAW_MOUTH2
000019B6                           642  
000019B6                           643  .DLEFT
000019B6  4EB9 00001A18            644              JSR     .LEFTDRAW
000019BC  6000 000C                645              BRA     .DRAW_MOUTH1
000019C0                           646  
000019C0                           647  .DDOWN
000019C0  4EB9 00001AAE            648              JSR     .DOWNDRAW
000019C6  6000 0020                649              BRA     .DRAW_MOUTH4
000019CA                           650              
000019CA                           651  .DRAW_MOUTH1            
000019CA  4EB9 00001AE0            652              JSR     .SET_MOUTHLEFT
000019D0  6000 001C                653              BRA     .DDONE
000019D4                           654  .DRAW_MOUTH2            
000019D4  4EB9 00001B1C            655              JSR     .SET_MOUTHUP
000019DA  6000 0012                656              BRA     .DDONE
000019DE                           657  .DRAW_MOUTH3            
000019DE  4EB9 00001AFE            658              JSR     .SET_MOUTHRIGHT
000019E4  6000 0008                659              BRA     .DDONE
000019E8                           660  .DRAW_MOUTH4            
000019E8  4EB9 00001B3A            661              JSR     .SET_MOUTHDOWN
000019EE                           662  .DDONE
000019EE  4CDF 003F                663              MOVEM.L (A7)+,D0-D5
000019F2                           664              
000019F2  4E75                     665              RTS
000019F4                           666  
000019F4                           667  
000019F4                           668  ;INTERNAL SUBRUTINES FOR PACMAN PLOT-------------------------------------------------------------
000019F4                           669  
000019F4                           670  .FULLDRAW
000019F4                           671              ;SET COORDS
000019F4  3239 00017A6A            672              MOVE.W  (PMPOSX),D1
000019FA  5141                     673              SUB.W   #PMRAD,D1
000019FC  3439 00017A6C            674              MOVE.W  (PMPOSY),D2
00001A02  5142                     675              SUB.W   #PMRAD,D2
00001A04                           676              
00001A04  3601                     677              MOVE.W  D1,D3
00001A06  0643 0010                678              ADD.W   #PMRAD*2,D3
00001A0A  3802                     679              MOVE.W  D2,D4
00001A0C  0644 0010                680              ADD.W   #PMRAD*2,D4
00001A10                           681              
00001A10                           682              ;DRAW PAC-MAN
00001A10  303C 0058                683              MOVE.W  #88,D0
00001A14  4E4F                     684              TRAP    #15
00001A16                           685              
00001A16  4E75                     686              RTS
00001A18                           687  .LEFTDRAW
00001A18                           688              
00001A18                           689              
00001A18  303C 0054                690              MOVE.W  #84,D0
00001A1C  3239 00017A6A            691              MOVE.W  (PMPOSX),D1                   ;FINAL COORD OF THE FIRST LINE
00001A22  5141                     692              SUB.W   #PMRAD,D1
00001A24  3439 00017A6C            693              MOVE.W  (PMPOSY),D2
00001A2A  5142                     694              SUB.W   #PMRAD,D2
00001A2C                           695              
00001A2C  3639 00017A6A            696              MOVE.W  (PMPOSX),D3                   ;ORIGINAL COORD FIRST LINE
00001A32  3839 00017A6C            697              MOVE.W  (PMPOSY),D4
00001A38                           698              
00001A38  4E4F                     699              TRAP    #15
00001A3A                           700             
00001A3A  303C 0055                701              MOVE.W  #85,D0                        ;DRAW SECOND LINE
00001A3E                           702              
00001A3E  3203                     703              MOVE.W  D3,D1
00001A40  3404                     704              MOVE.W  D4,D2
00001A42  5042                     705              ADD.W   #PMRAD,D2
00001A44  5141                     706              SUB.W   #PMRAD,D1
00001A46                           707              
00001A46  4E4F                     708              TRAP    #15
00001A48                           709              
00001A48                           710              
00001A48  4E75                     711              RTS
00001A4A                           712              
00001A4A                           713  .RIGHTDRAW
00001A4A                           714              
00001A4A                           715              
00001A4A  303C 0054                716              MOVE.W  #84,D0
00001A4E  3239 00017A6A            717              MOVE.W  (PMPOSX),D1                   ;FINAL COORD OF THE FIRST LINE
00001A54  5041                     718              ADD.W   #PMRAD,D1
00001A56  3439 00017A6C            719              MOVE.W  (PMPOSY),D2
00001A5C  5042                     720              ADD.W   #PMRAD,D2
00001A5E                           721              
00001A5E  3639 00017A6A            722              MOVE.W  (PMPOSX),D3                   ;ORIGINAL COORD FIRST LINE
00001A64  3839 00017A6C            723              MOVE.W  (PMPOSY),D4
00001A6A                           724              
00001A6A  4E4F                     725              TRAP    #15
00001A6C                           726             
00001A6C  303C 0055                727              MOVE.W  #85,D0                        ;DRAW SECOND LINE
00001A70                           728              
00001A70  3203                     729              MOVE.W  D3,D1
00001A72  3404                     730              MOVE.W  D4,D2
00001A74  5142                     731              SUB.W   #PMRAD,D2
00001A76  5041                     732              ADD.W   #PMRAD,D1
00001A78                           733              
00001A78  4E4F                     734              TRAP    #15
00001A7A                           735              
00001A7A                           736              
00001A7A  4E75                     737              RTS
00001A7C                           738  .UPDRAW
00001A7C                           739              
00001A7C                           740              
00001A7C  303C 0054                741              MOVE.W  #84,D0
00001A80  3239 00017A6A            742              MOVE.W  (PMPOSX),D1                   ;FINAL COORD OF THE FIRST LINE
00001A86  5141                     743              SUB.W   #PMRAD,D1
00001A88  3439 00017A6C            744              MOVE.W  (PMPOSY),D2
00001A8E  5142                     745              SUB.W   #PMRAD,D2
00001A90                           746              
00001A90  3639 00017A6A            747              MOVE.W  (PMPOSX),D3                   ;ORIGINAL COORD FIRST LINE
00001A96  3839 00017A6C            748              MOVE.W  (PMPOSY),D4
00001A9C                           749              
00001A9C  4E4F                     750              TRAP    #15
00001A9E                           751             
00001A9E  303C 0055                752              MOVE.W  #85,D0                        ;DRAW SECOND LINE
00001AA2                           753              
00001AA2  3203                     754              MOVE.W  D3,D1
00001AA4  3404                     755              MOVE.W  D4,D2
00001AA6  5142                     756              SUB.W   #PMRAD,D2
00001AA8  5041                     757              ADD.W   #PMRAD,D1
00001AAA                           758              
00001AAA  4E4F                     759              TRAP    #15
00001AAC                           760              
00001AAC                           761              
00001AAC  4E75                     762              RTS
00001AAE                           763              
00001AAE                           764  .DOWNDRAW
00001AAE                           765              
00001AAE                           766              
00001AAE  303C 0054                767              MOVE.W  #84,D0
00001AB2  3239 00017A6A            768              MOVE.W  (PMPOSX),D1                   ;FINAL COORD OF THE FIRST LINE
00001AB8  5141                     769              SUB.W   #PMRAD,D1
00001ABA  3439 00017A6C            770              MOVE.W  (PMPOSY),D2
00001AC0  5042                     771              ADD.W   #PMRAD,D2
00001AC2                           772              
00001AC2  3639 00017A6A            773              MOVE.W  (PMPOSX),D3                   ;ORIGINAL COORD FIRST LINE
00001AC8  3839 00017A6C            774              MOVE.W  (PMPOSY),D4
00001ACE                           775              
00001ACE  4E4F                     776              TRAP    #15
00001AD0                           777             
00001AD0  303C 0055                778              MOVE.W  #85,D0                        ;DRAW SECOND LINE
00001AD4                           779              
00001AD4  3203                     780              MOVE.W  D3,D1
00001AD6  3404                     781              MOVE.W  D4,D2
00001AD8  5042                     782              ADD.W   #PMRAD,D2
00001ADA  5041                     783              ADD.W   #PMRAD,D1
00001ADC                           784              
00001ADC  4E4F                     785              TRAP    #15
00001ADE                           786              
00001ADE                           787              
00001ADE  4E75                     788              RTS
00001AE0                           789  
00001AE0                           790              
00001AE0                           791  .SET_MOUTHLEFT
00001AE0                           792              
00001AE0  303C 0051                793              MOVE.W  #81,D0                         ;SET BLACK
00001AE4  7200                     794              MOVE.L  #$0000,D1
00001AE6  4E4F                     795              TRAP    #15
00001AE8                           796              
00001AE8  303C 0059                797              MOVE.W  #89,D0                         ;FILL
00001AEC  3239 00017A6A            798              MOVE.W  (PMPOSX),D1
00001AF2  5541                     799              SUBQ.W   #2,D1
00001AF4  3439 00017A6C            800              MOVE.W  (PMPOSY),D2
00001AFA  4E4F                     801              TRAP    #15
00001AFC                           802  
00001AFC  4E75                     803              RTS
00001AFE                           804              
00001AFE                           805  .SET_MOUTHRIGHT
00001AFE                           806              
00001AFE  303C 0051                807              MOVE.W  #81,D0                         ;SET BLACK
00001B02  7200                     808              MOVE.L  #$0000,D1
00001B04  4E4F                     809              TRAP    #15
00001B06                           810              
00001B06  303C 0059                811              MOVE.W  #89,D0                         ;FILL
00001B0A  3239 00017A6A            812              MOVE.W  (PMPOSX),D1
00001B10  5441                     813              ADDQ.W   #2,D1
00001B12  3439 00017A6C            814              MOVE.W  (PMPOSY),D2
00001B18  4E4F                     815              TRAP    #15
00001B1A                           816  
00001B1A  4E75                     817              RTS
00001B1C                           818  
00001B1C                           819  .SET_MOUTHUP
00001B1C                           820              
00001B1C  303C 0051                821              MOVE.W  #81,D0                         ;SET BLACK
00001B20  7200                     822              MOVE.L  #$0000,D1
00001B22  4E4F                     823              TRAP    #15
00001B24                           824              
00001B24  303C 0059                825              MOVE.W  #89,D0                         ;FILL
00001B28  3239 00017A6A            826              MOVE.W  (PMPOSX),D1
00001B2E  3439 00017A6C            827              MOVE.W  (PMPOSY),D2
00001B34  5542                     828              SUBQ.W   #2,D2
00001B36  4E4F                     829              TRAP    #15
00001B38                           830  
00001B38  4E75                     831              RTS
00001B3A                           832  
00001B3A                           833  .SET_MOUTHDOWN
00001B3A                           834              
00001B3A  303C 0051                835              MOVE.W  #81,D0                         ;SET BLACK
00001B3E  7200                     836              MOVE.L  #$0000,D1
00001B40  4E4F                     837              TRAP    #15
00001B42                           838              
00001B42  303C 0059                839              MOVE.W  #89,D0                         ;FILL
00001B46  3239 00017A6A            840              MOVE.W  (PMPOSX),D1
00001B4C  3439 00017A6C            841              MOVE.W  (PMPOSY),D2
00001B52  5442                     842              ADDQ.W   #2,D2
00001B54  4E4F                     843              TRAP    #15
00001B56                           844  
00001B56  4E75                     845              RTS
00001B58                           846  
00001B58                           847  
00001B58                           848  
00001B58                           849  
00001B58                           850  
00001B58                           851  
00001B58                           852  
00001B58                           853  
00001B58                           854  
00001B58                           855  
00001B58                           856  
00001B58                           857  
00001B58                           858  
00001B58                           859  
00001B58                           860  
00001B58                           861  
00001B58                           862  
00001B58                           863  
00001B58                           864  
00001B58                           865  
00001B58                           866  
00001B58                           867  
00001B58                           868  
00001B58                           869  
00001B58                           870  
00001B58                           871  
00001B58                           872  
00001B58                           873  -------------------- end include --------------------
00001B58                           874              INCLUDE "SCORE.X68"
00001B58                           875  ; ==============================================================================
00001B58                           876  ; SCOREBOARD MANAGEMENT
00001B58                           877  ; ==============================================================================
00001B58                           878              
00001B58                           879  ; ------------------------------------------------------------------------------
00001B58                           880  SCOINIT
00001B58                           881  ; INITIALIZE SCOREBOARD
00001B58                           882  ; INPUT    : NONE 
00001B58                           883  ; OUTPUT   : NONE
00001B58                           884  ; MODIFIES : NONE
00001B58                           885  ; ------------------------------------------------------------------------------
00001B58  4279 00017A84            886              CLR.W   (SCOPOINTS)
00001B5E  33FC 0003 00017A82       887              MOVE.W  #3,(SCOLIFE)
00001B66  4E75                     888              RTS
00001B68                           889              
00001B68                           890  ; ------------------------------------------------------------------------------
00001B68                           891  SCOPLOT
00001B68                           892  ; PLOT THE SCOREBOARD
00001B68                           893  ; INPUT    : NONE 
00001B68                           894  ; OUTPUT   : NONE
00001B68                           895  ; MODIFIES : NONE
00001B68                           896  ; ------------------------------------------------------------------------------
00001B68                           897              
00001B68  48E7 C040                898               MOVEM.L D0-D1/A1,-(A7)
00001B6C                           899  
00001B6C                           900              ; SET BACKGROUND COLOR
00001B6C  103C 0051                901              MOVE.B  #81,D0
00001B70  7200                     902              MOVE.L  #SCOFCOL,D1
00001B72  4E4F                     903              TRAP    #15
00001B74                           904              
00001B74                           905              ; SET FIRST LINE POSITION
00001B74  103C 000B                906              MOVE.B  #11,D0
00001B78  323C 0101                907              MOVE.W  #SCOLINE1,D1
00001B7C  4E4F                     908              TRAP    #15
00001B7E                           909  
00001B7E                           910              ; PRINT FIRST LINE
00001B7E  43F9 00001BB6            911              LEA     .TXT1,A1            ;PUT FIRST STRING IN A1
00001B84  4281                     912              CLR.L   D1
00001B86  3239 00017A84            913              MOVE.W  (SCOPOINTS),D1
00001B8C  103C 0011                914              MOVE.B  #17,D0
00001B90  4E4F                     915              TRAP    #15
00001B92                           916  
00001B92                           917              ; SET SECOND LINE POSITION
00001B92  103C 000B                918              MOVE.B  #11,D0
00001B96  323C 0102                919              MOVE.W  #SCOLINE2,D1       
00001B9A  4E4F                     920              TRAP    #15
00001B9C                           921  
00001B9C                           922              ; PRINT SECOND LINE
00001B9C  43F9 00001BBF            923              LEA     .TXT2,A1
00001BA2  4281                     924              CLR.L   D1
00001BA4  3239 00017A82            925              MOVE.W  (SCOLIFE),D1
00001BAA  103C 0011                926              MOVE.B  #17,D0
00001BAE  4E4F                     927              TRAP    #15
00001BB0                           928              
00001BB0  4CDF 0203                929              MOVEM.L (A7)+,D0-D1/A1
00001BB4                           930              
00001BB4  4E75                     931              RTS
00001BB6                           932  
00001BB6= 50 4F 49 4E 54 53 ...    933  .TXT1       DC.B    'POINTS :',0      ;0 IS END OF STRING
00001BBF= 4C 49 46 45 53 20 ...    934  .TXT2       DC.B    'LIFES  :',0
00001BC8                           935  
00001BC8                           936  
00001BC8  4E75                     937              RTS
00001BCA                           938  
00001BCA                           939  
00001BCA                           940  -------------------- end include --------------------
00001BCA                           941              INCLUDE "SYSCONST.X68"
00001BCA                           942  ; ==============================================================================
00001BCA                           943  ; SYSTEM CONSTANTS
00001BCA                           944  ; ==============================================================================
00001BCA                           945  
00001BCA                           946  ; --- SCREEN RELATED CONSTANTS -------------------------------------------------
00001BCA                           947  
00001BCA  =00000280                948  SCRWIDTH    EQU     640                     ; SCREEN WIDTH
00001BCA  =00000280                949  SCRHEIGH    EQU     640                     ; SCREEN HEIGHT
00001BCA                           950  
00001BCA                           951  ;--- TITLE RELATED CONSTANTS ---------------------------------------------------
00001BCA= 62 67 72 2E 74 78 ...    952  FILENAME    DC.B    'bgr.txt',0
00001BD2  =00014FF0                953  FILESIZE    EQU     86000
00001BD2                           954              DS.B    0                       
00001BD2                           955  ;---KEYCODES--------------------------------------------------------------------
00001BD2                           956  
00001BD2  =00000025                957  KBDLEFT     EQU     $25
00001BD2  =00000026                958  KBDUP       EQU     $26
00001BD2  =00000027                959  KBDRIGHT    EQU     $27
00001BD2  =00000028                960  KBDDOWN     EQU     $28
00001BD2  =00000020                961  KBDFIRE1    EQU     ' '
00001BD2  =0000004D                962  KBDFIRE2    EQU     'M'                         
00001BD2  =00000010                963  KBDFIRE3    EQU     $10
00001BD2  =00000050                964  KBDPAUSE    EQU     'P'
00001BD2                           965  
00001BD2                           966  
00001BD2                           967  
00001BD2                           968  
00001BD2                           969  
00001BD2                           970  
00001BD2                           971  
00001BD2                           972  
00001BD2                           973  
00001BD2                           974  
00001BD2                           975  
00001BD2                           976  -------------------- end include --------------------
00001BD2                           977              INCLUDE "SYSTEM.X68"
00001BD2                           978  ; ==============================================================================
00001BD2                           979  ; SYSTEM
00001BD2                           980  ; ==============================================================================
00001BD2                           981              
00001BD2                           982  ; ------------------------------------------------------------------------------
00001BD2                           983  SYSINIT
00001BD2                           984  ; INITIALIZE SYSTEM.
00001BD2                           985  ; INPUT    : NONE
00001BD2                           986  ; OUTPUT   : NONE
00001BD2                           987  ; MODIFIES : NONE
00001BD2                           988  ; ------------------------------------------------------------------------------
00001BD2                           989              
00001BD2  21FC 00001C42 0080       990              MOVE.L  #SCRUPD,($80+0*4)          ;INSTALL SUBRUTINE TO TRAP #0
00001BDA  21FC 00001C78 0084       991              MOVE.L  #KBDUPD,($80+1*4)          ;INSTALL SUBRUTINE TO TRAP #1
00001BE2                           992              
00001BE2                           993              
00001BE2  21FC 00001C5C 0064       994              MOVE.L  #SCRTIM,($60+1*4)          ;INSTALL INTERRUPT #1
00001BEA                           995              
00001BEA  4EB9 00001BFE            996              JSR     SCRINIT
00001BF0  4EB9 00001C6A            997              JSR     KBDINIT
00001BF6                           998              
00001BF6                           999              
00001BF6  40E7                    1000              MOVE.W  SR,-(A7)
00001BF8  0257 D8FF               1001              ANDI.W  #$D8FF,(A7)                ;BIT SUPERVISOR TO O AND INTERRPUT MASK 000 (FOR REACTIVATE INTERRUPTIONS)             
00001BFC  4E73                    1002              RTE
00001BFE                          1003     
00001BFE                          1004  ; ------------------------------------------------------------------------------
00001BFE                          1005  SCRINIT
00001BFE                          1006  ; INIT SCREEN. SET SCREEN RESOLUTION, SET WINDOWED MODE, CLEAR SCREEN, ENABLE BUFFER
00001BFE                          1007  ; ENABLE TIMED INTERRUPTION
00001BFE                          1008  ; INPUT    : NONE
00001BFE                          1009  ; OUTPUT   : NONE
00001BFE                          1010  ; MODIFIES : NONE
00001BFE                          1011  ; ------------------------------------------------------------------------------
00001BFE                          1012  
00001BFE  48E7 C000               1013              MOVEM.L D0-D1,-(A7)                 ;SAFE REGISTERS IN STACK
00001C02                          1014  
00001C02                          1015              ; SET SCREEN RESOLUTION
00001C02  103C 0021               1016              MOVE.B  #33,D0
00001C06  223C 02800280           1017              MOVE.L  #SCRWIDTH<<16|SCRHEIGH,D1
00001C0C  4E4F                    1018              TRAP    #15
00001C0E                          1019              
00001C0E                          1020              ; SET WINDOWED MODE
00001C0E  7201                    1021              MOVE.L  #1,D1
00001C10  4E4F                    1022              TRAP    #15
00001C12                          1023              
00001C12                          1024              ; ENABLE DOUBLE BUFFER
00001C12  103C 005C               1025              MOVE.B  #92,D0
00001C16  123C 0011               1026              MOVE.B  #17,D1
00001C1A  4E4F                    1027              TRAP    #15
00001C1C                          1028              
00001C1C                          1029              ; CLEAR SCREEN
00001C1C  103C 000B               1030              MOVE.B  #11,D0
00001C20  323C FF00               1031              MOVE.W  #$FF00,D1
00001C24  4E4F                    1032              TRAP    #15
00001C26                          1033              
00001C26                          1034              ;ENABLE TIMED INTERRPUT
00001C26  303C 0020               1035              MOVE.W  #32,D0
00001C2A  123C 0006               1036              MOVE.B  #6,D1
00001C2E  143C 0081               1037              MOVE.B  #$81,D2                   ;INDICATE THAT INTERRUPT 1 IS ACTIVATED PERIODICALLY
00001C32  7614                    1038              MOVE.L  #20,D3                    ;INDICATE THE MILISECONDS FOR THAT PERIOD (20 ms == 50 FPS)
00001C34  4E4F                    1039              TRAP    #15
00001C36                          1040              
00001C36                          1041              ;CLEAR INTERRUPT COUNTER
00001C36  4239 00002676           1042              CLR.B   (SCRINTCT)
00001C3C                          1043              
00001C3C  4CDF 0003               1044              MOVEM.L (A7)+,D0-D1               ;RESTORE REGISTERS FROM STACK
00001C40                          1045              
00001C40  4E75                    1046              RTS
00001C42                          1047  
00001C42                          1048  
00001C42                          1049              
00001C42                          1050  ;------------------------------------------------------------------------------            
00001C42                          1051  SCRUPD
00001C42                          1052  ; UPDATES DOUBLE BUFFER
00001C42                          1053  ; INPUT    : NONE
00001C42                          1054  ; OUTPUT   : NONE
00001C42                          1055  ; MODIFIES : NONE
00001C42                          1056  ; ------------------------------------------------------------------------------
00001C42                          1057  
00001C42  48E7 C000               1058              MOVEM.L D0-D1,-(A7)
00001C46                          1059              
00001C46                          1060              ;SWITCH BUFFERS
00001C46  103C 005E               1061              MOVE.B #94,D0
00001C4A  4E4F                    1062              TRAP #15
00001C4C                          1063              
00001C4C                          1064              ;CLEAR HIDDEN BUFFER
00001C4C  103C 000B               1065              MOVE.B  #11,D0
00001C50  323C FF00               1066              MOVE.W  #$FF00,D1
00001C54  4E4F                    1067              TRAP    #15
00001C56                          1068              
00001C56  4CDF 0003               1069              MOVEM.L (A7)+,D0-D1
00001C5A                          1070              
00001C5A  4E73                    1071              RTE
00001C5C                          1072              
00001C5C                          1073  ; ------------------------------------------------------------------------------
00001C5C                          1074  SCRTIM
00001C5C                          1075  ; TIMED INTERRUPT SERVICE ROUTINE
00001C5C                          1076  ; INPUT    : NONE
00001C5C                          1077  ; OUTPUT   : NONE
00001C5C                          1078  ; MODIFIES : NONE
00001C5C                          1079  ; ------------------------------------------------------------------------------
00001C5C  5239 00002676           1080              ADDQ.B  #1,(SCRINTCT)
00001C62  5239 00002677           1081              ADDQ.B  #1,(SCRCYCCT)
00001C68  4E73                    1082              RTE
00001C6A                          1083              
00001C6A                          1084  ;------------------------------------------------------------------------------            
00001C6A                          1085  KBDINIT
00001C6A                          1086  ; INIT THE KEYBOARD
00001C6A                          1087  ; INPUT    : NONE
00001C6A                          1088  ; OUTPUT   : NONE
00001C6A                          1089  ; MODIFIES : NONE
00001C6A                          1090  ; ------------------------------------------------------------------------------
00001C6A                          1091  
00001C6A  4239 00002674           1092              CLR.B   (KBDVAL)
00001C70  4239 00002675           1093              CLR.B   (KBDEDGE)
00001C76                          1094  
00001C76  4E75                    1095              RTS
00001C78                          1096  
00001C78                          1097  ;------------------------------------------------------------------------------            
00001C78                          1098  KBDUPD
00001C78                          1099  ; UPDATES KEYBOARD INFO
00001C78                          1100  ; 3 -> DOWN     (HEX: 8)
00001C78                          1101  ; 2 -> RIGHT    (HEX: 4)
00001C78                          1102  ; 1 -> UP       (HEX: 2)
00001C78                          1103  ; 0 -> LEFT     (HEX: 1)
00001C78                          1104  ; ------------------------------------------------------------------------------
00001C78                          1105              
00001C78  48E7 F800               1106              MOVEM.L D0-D4,-(A7)
00001C7C                          1107              
00001C7C                          1108              ; READ FIRST PART
00001C7C  103C 0013               1109              MOVE.B  #19,D0
00001C80  223C 50104D20           1110              MOVE.L  #KBDPAUSE<<24|KBDFIRE3<<16|KBDFIRE2<<8|KBDFIRE1,D1
00001C86  4E4F                    1111              TRAP    #15
00001C88                          1112  
00001C88                          1113              ; CONVERT TO DESIRED FORMAT
00001C88  4EB9 00001CC0           1114              JSR     .CONVERT
00001C8E                          1115  
00001C8E                          1116              ; READ SECOND PART
00001C8E  223C 28272625           1117              MOVE.L  #KBDDOWN<<24|KBDRIGHT<<16|KBDUP<<8|KBDLEFT,D1
00001C94  4E4F                    1118              TRAP    #15
00001C96                          1119              
00001C96                          1120              ;CONVERT TO DESIRED FORMAT
00001C96  4EB9 00001CC0           1121              JSR .CONVERT
00001C9C                          1122  
00001C9C                          1123              ;GET KBDEDGE (IF SOME KEY HAVE CHANGED THE VALUE)
00001C9C  1039 00002674           1124              MOVE.B  (KBDVAL),D0             ;D0 -> LAST KBDVAL
00001CA2  4600                    1125              NOT.B   D0                      ;D2 -> ACTUAL KBDVAL
00001CA4  C002                    1126              AND.B   D2,D0
00001CA6  13C0 00002675           1127              MOVE.B  D0,(KBDEDGE)
00001CAC                          1128              
00001CAC                          1129         
00001CAC  B03C 0000               1130              CMP.B   #0,D0
00001CB0  6700 0008               1131              BEQ     .NOACT          
00001CB4                          1132              
00001CB4                          1133              ;STORE NEW KBDVAL
00001CB4  13C2 00002674           1134              MOVE.B  D2,(KBDVAL)
00001CBA                          1135  .NOACT
00001CBA                          1136              
00001CBA  4CDF 001F               1137              MOVEM.L (A7)+,D0-D4
00001CBE                          1138              
00001CBE  4E73                    1139              RTE    
00001CC0                          1140              
00001CC0                          1141  .CONVERT 
00001CC0  363C 0003               1142              MOVE.W  #3,D3
00001CC4                          1143              
00001CC4  E189                    1144  .LOOP       LSL.L   #8,D1
00001CC6  E312                    1145              ROXL.B  #1,D2
00001CC8  51CB FFFA               1146              DBRA.W  D3,.LOOP
00001CCC  4E75                    1147              RTS
00001CCE                          1148             
00001CCE                          1149  
00001CCE                          1150  ;------------------------------------------------------------------------------            
00001CCE                          1151  COLWALLRIGHT
00001CCE                          1152  ; COLLISION PAC-MAN WITH WALL
00001CCE                          1153  ; INPUT    : NONE
00001CCE                          1154  ; OUTPUT   : NONE
00001CCE                          1155  ; MODIFIES : NONE
00001CCE                          1156  ; ------------------------------------------------------------------------------
00001CCE                          1157  
00001CCE  48E7 F800               1158              MOVEM.L D0-D4,-(A7)
00001CD2                          1159  
00001CD2  3039 00017A6A           1160              MOVE.W  (PMPOSX),D0
00001CD8  5140                    1161              SUB.W   #8,D0
00001CDA  3239 00017A6C           1162              MOVE.W  (PMPOSY),D1
00001CE0  5041                    1163              ADD.W   #8,D1
00001CE2                          1164              
00001CE2  81FC 0010               1165              DIVS.W  #16,D0
00001CE6  83FC 0010               1166              DIVS.W  #16,D1
00001CEA                          1167              
00001CEA  5940                    1168              SUB.W   #4,D0                   ;LI RESTAM 4 PERQUE LA MATRIU ESTA A UNA DISTANCIA DE 64 PIXELS DE LA PANTALLA
00001CEC  5941                    1169              SUB.W   #4,D1
00001CEE                          1170              
00001CEE  41F9 00002678           1171              LEA.L   MAPVAR,A0
00001CF4                          1172              
00001CF4  5240                    1173              ADD.W   #1,D0
00001CF6  5341                    1174              SUB.W   #1,D1
00001CF8  C2FC 0020               1175              MULU.W  #32,D1
00001CFC  D041                    1176              ADD.W   D1,D0
00001CFE                          1177              
00001CFE  3240                    1178              MOVE.W  D0,A1
00001D00  13C0 00002A78           1179              MOVE.B  D0,POSCON
00001D06                          1180  
00001D06  1A29 2678               1181              MOVE.B  MAPVAR(A1),D5
00001D0A                          1182              
00001D0A  4CDF 001F               1183              MOVEM.L (A7)+,D0-D4
00001D0E                          1184              
00001D0E  4E75                    1185              RTS
00001D10                          1186  
00001D10                          1187  
00001D10                          1188  ;------------------------------------------------------------------------------            
00001D10                          1189  COLWALLLEFT
00001D10                          1190  ; COLLISION PAC-MAN WITH WALL
00001D10                          1191  ; INPUT    : NONE
00001D10                          1192  ; OUTPUT   : NONE
00001D10                          1193  ; MODIFIES : NONE
00001D10                          1194  ; ------------------------------------------------------------------------------
00001D10                          1195  
00001D10  48E7 F800               1196              MOVEM.L D0-D4,-(A7)
00001D14                          1197  
00001D14  3039 00017A6A           1198              MOVE.W  (PMPOSX),D0
00001D1A  5C40                    1199              ADD.W   #6,D0
00001D1C  3239 00017A6C           1200              MOVE.W  (PMPOSY),D1
00001D22  5041                    1201              ADD.W   #8,D1
00001D24                          1202              
00001D24  81FC 0010               1203              DIVS.W  #16,D0
00001D28  83FC 0010               1204              DIVS.W  #16,D1
00001D2C                          1205              
00001D2C  5940                    1206              SUB.W   #4,D0                   ;LI RESTAM 4 PERQUE LA MATRIU ESTA A UNA DISTANCIA DE 64 PIXELS DE LA PANTALLA
00001D2E  5941                    1207              SUB.W   #4,D1
00001D30                          1208              
00001D30  41F9 00002678           1209              LEA.L   MAPVAR,A0
00001D36                          1210              
00001D36  5340                    1211              SUB.W   #1,D0
00001D38  5341                    1212              SUB.W   #1,D1
00001D3A  C2FC 0020               1213              MULU.W  #32,D1
00001D3E  D041                    1214              ADD.W   D1,D0
00001D40                          1215  
00001D40  3240                    1216              MOVE.W  D0,A1
00001D42  13C0 00002A78           1217              MOVE.B  D0,POSCON
00001D48                          1218  
00001D48  1A29 2678               1219              MOVE.B  MAPVAR(A1),D5               
00001D4C                          1220  
00001D4C                          1221              
00001D4C  4CDF 001F               1222              MOVEM.L (A7)+,D0-D4
00001D50                          1223              
00001D50  4E75                    1224              RTS
00001D52                          1225  
00001D52                          1226  ;------------------------------------------------------------------------------            
00001D52                          1227  COLWALLDOWN
00001D52                          1228  ; COLLISION PAC-MAN WITH WALL
00001D52                          1229  ; INPUT    : NONE
00001D52                          1230  ; OUTPUT   : NONE
00001D52                          1231  ; MODIFIES : NONE
00001D52                          1232  ; ------------------------------------------------------------------------------
00001D52                          1233  
00001D52  48E7 F800               1234              MOVEM.L D0-D4,-(A7)
00001D56                          1235  
00001D56  3039 00017A6A           1236              MOVE.W  (PMPOSX),D0
00001D5C                          1237              ;ADD.W   #8,D0
00001D5C  3239 00017A6C           1238              MOVE.W  (PMPOSY),D1
00001D62  5041                    1239              ADD.W   #8,D1
00001D64                          1240              
00001D64  81FC 0010               1241              DIVS.W  #16,D0
00001D68  83FC 0010               1242              DIVS.W  #16,D1
00001D6C                          1243              
00001D6C  5940                    1244              SUB.W   #4,D0                   ;LI RESTAM 4 PERQUE LA MATRIU ESTA A UNA DISTANCIA DE 64 PIXELS DE LA PANTALLA
00001D6E  5941                    1245              SUB.W   #4,D1
00001D70                          1246              
00001D70  41F9 00002678           1247              LEA.L   MAPVAR,A0
00001D76                          1248              
00001D76  C2FC 0020               1249              MULU.W  #32,D1
00001D7A  D041                    1250              ADD.W   D1,D0
00001D7C                          1251  
00001D7C  3240                    1252              MOVE.W  D0,A1
00001D7E  13C0 00002A78           1253              MOVE.B  D0,POSCON
00001D84                          1254  
00001D84  1A29 2678               1255              MOVE.B  MAPVAR(A1),D5 
00001D88                          1256  
00001D88                          1257              
00001D88  4CDF 001F               1258              MOVEM.L (A7)+,D0-D4
00001D8C                          1259              
00001D8C  4E75                    1260              RTS
00001D8E                          1261  
00001D8E                          1262  
00001D8E                          1263  ;------------------------------------------------------------------------------            
00001D8E                          1264  COLWALLUP
00001D8E                          1265  ; COLLISION PAC-MAN WITH WALL
00001D8E                          1266  ; INPUT    : NONE
00001D8E                          1267  ; OUTPUT   : NONE
00001D8E                          1268  ; MODIFIES : NONE
00001D8E                          1269  ; ------------------------------------------------------------------------------
00001D8E                          1270  
00001D8E  48E7 F800               1271              MOVEM.L D0-D4,-(A7)
00001D92                          1272  
00001D92  3039 00017A6A           1273              MOVE.W  (PMPOSX),D0
00001D98                          1274              ;SUB.W   #8,D0
00001D98  3239 00017A6C           1275              MOVE.W  (PMPOSY),D1
00001D9E  5C41                    1276              ADD.W   #6,D1
00001DA0                          1277              
00001DA0                          1278              
00001DA0  81FC 0010               1279              DIVS.W  #16,D0
00001DA4  83FC 0010               1280              DIVS.W  #16,D1
00001DA8                          1281              
00001DA8  5940                    1282              SUB.W   #4,D0                   ;LI RESTAM 4 PERQUE LA MATRIU ESTA A UNA DISTANCIA DE 64 PIXELS DE LA PANTALLA
00001DAA  5941                    1283              SUB.W   #4,D1
00001DAC                          1284              
00001DAC  41F9 00002678           1285              LEA.L   MAPVAR,A0
00001DB2                          1286              
00001DB2  5341                    1287              SUB.W   #1,D1
00001DB4                          1288              ;CMP     #1,D1
00001DB4                          1289              ;BLO     BUCLE4
00001DB4  C2FC 0020               1290              MULU.W  #32,D1
00001DB8  D041                    1291              ADD.W   D1,D0
00001DBA                          1292  
00001DBA                          1293  ;BUCLE4            
00001DBA  3240                    1294              MOVE.W  D0,A1
00001DBC  13C0 00002A78           1295              MOVE.B  D0,POSCON
00001DC2                          1296  
00001DC2  1A29 2678               1297              MOVE.B  MAPVAR(A1),D5 
00001DC6                          1298  
00001DC6                          1299              ;MOVE.B  #0,D5
00001DC6                          1300              
00001DC6  4CDF 001F               1301              MOVEM.L (A7)+,D0-D4
00001DCA                          1302              
00001DCA  4E75                    1303              RTS
00001DCC                          1304  
00001DCC                          1305  ;------------------------------------------------------------------------------            
00001DCC                          1306  GSTCOLWALLRIGHT
00001DCC                          1307  ; COLLISION PAC-MAN WITH WALL
00001DCC                          1308  ; INPUT    : NONE
00001DCC                          1309  ; OUTPUT   : NONE
00001DCC                          1310  ; MODIFIES : NONE
00001DCC                          1311  ; ------------------------------------------------------------------------------
00001DCC                          1312  
00001DCC  48E7 F800               1313              MOVEM.L D0-D4,-(A7)
00001DD0                          1314  
00001DD0  3039 00017A74           1315              MOVE.W  (GSTPOSX),D0
00001DD6  5140                    1316              SUB.W   #8,D0
00001DD8  3239 00017A76           1317              MOVE.W  (GSTPOSY),D1
00001DDE  5041                    1318              ADD.W   #8,D1
00001DE0                          1319              
00001DE0  81FC 0010               1320              DIVS.W  #16,D0
00001DE4  83FC 0010               1321              DIVS.W  #16,D1
00001DE8                          1322              
00001DE8  5940                    1323              SUB.W   #4,D0                   ;LI RESTAM 4 PERQUE LA MATRIU ESTA A UNA DISTANCIA DE 64 PIXELS DE LA PANTALLA
00001DEA  5941                    1324              SUB.W   #4,D1
00001DEC                          1325              
00001DEC  41F9 00002678           1326              LEA.L   MAPVAR,A0
00001DF2                          1327              
00001DF2  5240                    1328              ADD.W   #1,D0
00001DF4  5341                    1329              SUB.W   #1,D1
00001DF6  C2FC 0020               1330              MULU.W  #32,D1
00001DFA  D041                    1331              ADD.W   D1,D0
00001DFC                          1332              
00001DFC  3240                    1333              MOVE.W  D0,A1
00001DFE                          1334  
00001DFE  1A29 2678               1335              MOVE.B  MAPVAR(A1),D5
00001E02                          1336              
00001E02  4CDF 001F               1337              MOVEM.L (A7)+,D0-D4
00001E06                          1338              
00001E06  4E75                    1339              RTS
00001E08                          1340  
00001E08                          1341  
00001E08                          1342  ;------------------------------------------------------------------------------            
00001E08                          1343  GSTCOLWALLLEFT
00001E08                          1344  ; COLLISION PAC-MAN WITH WALL
00001E08                          1345  ; INPUT    : NONE
00001E08                          1346  ; OUTPUT   : NONE
00001E08                          1347  ; MODIFIES : NONE
00001E08                          1348  ; ------------------------------------------------------------------------------
00001E08                          1349  
00001E08  48E7 F800               1350              MOVEM.L D0-D4,-(A7)
00001E0C                          1351  
00001E0C  3039 00017A74           1352              MOVE.W  (GSTPOSX),D0
00001E12  5C40                    1353              ADD.W   #6,D0
00001E14  3239 00017A76           1354              MOVE.W  (GSTPOSY),D1
00001E1A  5041                    1355              ADD.W   #8,D1
00001E1C                          1356              
00001E1C  81FC 0010               1357              DIVS.W  #16,D0
00001E20  83FC 0010               1358              DIVS.W  #16,D1
00001E24                          1359              
00001E24  5940                    1360              SUB.W   #4,D0                   ;LI RESTAM 4 PERQUE LA MATRIU ESTA A UNA DISTANCIA DE 64 PIXELS DE LA PANTALLA
00001E26  5941                    1361              SUB.W   #4,D1
00001E28                          1362              
00001E28  41F9 00002678           1363              LEA.L   MAPVAR,A0
00001E2E                          1364              
00001E2E  5340                    1365              SUB.W   #1,D0
00001E30  5341                    1366              SUB.W   #1,D1
00001E32  C2FC 0020               1367              MULU.W  #32,D1
00001E36  D041                    1368              ADD.W   D1,D0
00001E38                          1369  
00001E38  3240                    1370              MOVE.W  D0,A1
00001E3A  1A29 2678               1371              MOVE.B  MAPVAR(A1),D5               
00001E3E                          1372  
00001E3E                          1373              
00001E3E  4CDF 001F               1374              MOVEM.L (A7)+,D0-D4
00001E42                          1375              
00001E42  4E75                    1376              RTS
00001E44                          1377  
00001E44                          1378  ;------------------------------------------------------------------------------            
00001E44                          1379  GSTCOLWALLDOWN
00001E44                          1380  ; COLLISION PAC-MAN WITH WALL
00001E44                          1381  ; INPUT    : NONE
00001E44                          1382  ; OUTPUT   : NONE
00001E44                          1383  ; MODIFIES : NONE
00001E44                          1384  ; ------------------------------------------------------------------------------
00001E44                          1385  
00001E44  48E7 F800               1386              MOVEM.L D0-D4,-(A7)
00001E48                          1387  
00001E48  3039 00017A74           1388              MOVE.W  (GSTPOSX),D0
00001E4E                          1389              ;ADD.W   #8,D0
00001E4E  3239 00017A76           1390              MOVE.W  (GSTPOSY),D1
00001E54  5041                    1391              ADD.W   #8,D1
00001E56                          1392              
00001E56  81FC 0010               1393              DIVS.W  #16,D0
00001E5A  83FC 0010               1394              DIVS.W  #16,D1
00001E5E                          1395              
00001E5E  5940                    1396              SUB.W   #4,D0                   ;LI RESTAM 4 PERQUE LA MATRIU ESTA A UNA DISTANCIA DE 64 PIXELS DE LA PANTALLA
00001E60  5941                    1397              SUB.W   #4,D1
00001E62                          1398              
00001E62  41F9 00002678           1399              LEA.L   MAPVAR,A0
00001E68                          1400              
00001E68  C2FC 0020               1401              MULU.W  #32,D1
00001E6C  D041                    1402              ADD.W   D1,D0
00001E6E                          1403  
00001E6E  3240                    1404              MOVE.W  D0,A1
00001E70  1A29 2678               1405              MOVE.B  MAPVAR(A1),D5 
00001E74                          1406  
00001E74                          1407              
00001E74  4CDF 001F               1408              MOVEM.L (A7)+,D0-D4
00001E78                          1409              
00001E78  4E75                    1410              RTS
00001E7A                          1411  
00001E7A                          1412  
00001E7A                          1413  ;------------------------------------------------------------------------------            
00001E7A                          1414  GSTCOLWALLUP
00001E7A                          1415  ; COLLISION PAC-MAN WITH WALL
00001E7A                          1416  ; INPUT    : NONE
00001E7A                          1417  ; OUTPUT   : NONE
00001E7A                          1418  ; MODIFIES : NONE
00001E7A                          1419  ; ------------------------------------------------------------------------------
00001E7A                          1420  
00001E7A  48E7 F800               1421              MOVEM.L D0-D4,-(A7)
00001E7E                          1422  
00001E7E  3039 00017A74           1423              MOVE.W  (GSTPOSX),D0
00001E84                          1424              ;SUB.W   #8,D0
00001E84  3239 00017A76           1425              MOVE.W  (GSTPOSY),D1
00001E8A  5C41                    1426              ADD.W   #6,D1
00001E8C                          1427              
00001E8C                          1428              
00001E8C  81FC 0010               1429              DIVS.W  #16,D0
00001E90  83FC 0010               1430              DIVS.W  #16,D1
00001E94                          1431              
00001E94  5940                    1432              SUB.W   #4,D0                   ;LI RESTAM 4 PERQUE LA MATRIU ESTA A UNA DISTANCIA DE 64 PIXELS DE LA PANTALLA
00001E96  5941                    1433              SUB.W   #4,D1
00001E98                          1434              
00001E98  41F9 00002678           1435              LEA.L   MAPVAR,A0
00001E9E                          1436              
00001E9E  5341                    1437              SUB.W   #1,D1
00001EA0                          1438  
00001EA0  C2FC 0020               1439              MULU.W  #32,D1
00001EA4  D041                    1440              ADD.W   D1,D0
00001EA6                          1441  
00001EA6  3240                    1442              MOVE.W  D0,A1
00001EA8                          1443  
00001EA8  1A29 2678               1444              MOVE.B  MAPVAR(A1),D5 
00001EAC                          1445  
00001EAC                          1446              ;MOVE.B  #0,D5
00001EAC                          1447              
00001EAC  4CDF 001F               1448              MOVEM.L (A7)+,D0-D4
00001EB0                          1449              
00001EB0  4E75                    1450              RTS
00001EB2                          1451  ;------------------------------------------------------------------------------            
00001EB2                          1452  GETPOINTS
00001EB2                          1453  ; COLLISION PAC-MAN WITH WALL
00001EB2                          1454  ; INPUT    : NONE
00001EB2                          1455  ; OUTPUT   : NONE
00001EB2                          1456  ; MODIFIES : NONE
00001EB2                          1457  ; ------------------------------------------------------------------------------
00001EB2                          1458  
00001EB2  48E7 F800               1459              MOVEM.L D0-D4,-(A7)
00001EB6                          1460  
00001EB6  3039 00017A6A           1461              MOVE.W  (PMPOSX),D0
00001EBC                          1462              ;SUB.W   #8,D0
00001EBC  3239 00017A6C           1463              MOVE.W  (PMPOSY),D1
00001EC2  0641 0010               1464              ADD.W   #16,D1
00001EC6                          1465              
00001EC6                          1466              
00001EC6  81FC 0010               1467              DIVS.W  #16,D0
00001ECA  83FC 0010               1468              DIVS.W  #16,D1
00001ECE                          1469              
00001ECE  5940                    1470              SUB.W   #4,D0                   ;LI RESTAM 4 PERQUE LA MATRIU ESTA A UNA DISTANCIA DE 64 PIXELS DE LA PANTALLA
00001ED0  5941                    1471              SUB.W   #4,D1
00001ED2                          1472                          
00001ED2  5341                    1473              SUB.W   #1,D1
00001ED4  C2FC 0020               1474              MULU.W  #32,D1
00001ED8  D041                    1475              ADD.W   D1,D0
00001EDA                          1476  
00001EDA  3240                    1477              MOVE.W  D0,A1
00001EDC  1A29 2678               1478              MOVE.B  MAPVAR(A1),D5
00001EE0                          1479              
00001EE0  BA7C 0000               1480              CMP     #0,D5
00001EE4  6700 003A               1481              BEQ     .DONE
00001EE8  BA7C 0002               1482              CMP     #2,D5
00001EEC  6700 0020               1483              BEQ     .POINT
00001EF0  BA7C 0003               1484              CMP     #3,D5
00001EF4  6700 0006               1485              BEQ     .BPOINT
00001EF8  6600 0026               1486              BNE     .DONE
00001EFC                          1487  .BPOINT
00001EFC  137C 0000 2678          1488              MOVE.B  #0,MAPVAR(A1)
00001F02  0679 0032 00017A84      1489              ADD.W   #50,(SCOPOINTS)
00001F0A  6600 0014               1490              BNE     .DONE
00001F0E                          1491  .POINT
00001F0E  137C 0000 2678          1492              MOVE.B  #0,MAPVAR(A1)
00001F14  0679 000A 00017A84      1493              ADD.W   #10,(SCOPOINTS)
00001F1C  6600 0002               1494              BNE     .DONE            
00001F20                          1495  .DONE                        
00001F20  4CDF 001F               1496              MOVEM.L (A7)+,D0-D4
00001F24                          1497              
00001F24  4E75                    1498              RTS
00001F26                          1499  
00001F26                          1500  
00001F26                          1501  
00001F26                          1502  
00001F26                          1503  
00001F26                          1504  
00001F26                          1505  -------------------- end include --------------------
00001F26                          1506              INCLUDE "MAP.X68"
00001F26                          1507  
00001F26                          1508  ; ------------------------------------------------------------------------------
00001F26                          1509  MAPINIT
00001F26                          1510  ; INIT MAP
00001F26                          1511  ; INPUT    : NONE
00001F26                          1512  ; OUTPUT   : NONE
00001F26                          1513  ; MODIFIES : NONE
00001F26                          1514  ; ------------------------------------------------------------------------------            
00001F26                          1515              
00001F26                          1516              ;MOVE.L  #DIBFIGWALL,($80+2*4)          ;INSTALL SUBRUTINE TO TRAP #2
00001F26                          1517              ;MOVE.L  #DIBFIGPOINT,($80+3*4)          ;INSTALL SUBRUTINE TO TRAP #3
00001F26                          1518              ;MOVE.L  #DIBFIGBPOINT,($80+4*4)          ;INSTALL SUBRUTINE TO TRAP #4
00001F26                          1519              
00001F26  48E7 FE00               1520              MOVEM.L D0-D6,-(A7)
00001F2A  48E7 00C0               1521              MOVEM.L A0-A1,-(A7)
00001F2E                          1522              
00001F2E  41F8 1008               1523              LEA.L   MAPMAT,A0
00001F32  43F9 00002678           1524              LEA.L   MAPVAR,A1
00001F38  3C3C 0030               1525              MOVE.W  #48,D6
00001F3C  343C 001F               1526              MOVE.W  #31,D2
00001F40                          1527  BUCLE_FILA
00001F40  3A3C 0030               1528              MOVE.W  #48,D5
00001F44  323C 001F               1529              MOVE.W  #31,D1
00001F48  0646 0010               1530              ADD.W   #16,D6
00001F4C                          1531  
00001F4C                          1532  BUCLE_COLUMNA
00001F4C  0645 0010               1533              ADD.W   #16,D5
00001F50                          1534  
00001F50  1018                    1535              MOVE.B  (A0)+,D0
00001F52  12C0                    1536              MOVE.B  D0,(A1)+
00001F54                          1537               
00001F54  B07C 0000               1538              CMP     #0,D0
00001F58  6700 0034               1539              BEQ     ZERO
00001F5C  B07C 0004               1540              CMP     #4,D0
00001F60  6700 002C               1541              BEQ     ZERO
00001F64  B07C 0001               1542              CMP     #1,D0
00001F68  6600 0008               1543              BNE     NOTWALL
00001F6C  4EB9 00002014           1544              JSR     DIBFIGWALL
00001F72                          1545  NOTWALL
00001F72  B07C 0002               1546              CMP     #2,D0
00001F76  6600 0008               1547              BNE     NOTPOINT
00001F7A  4EB9 0000204C           1548              JSR     DIBFIGPOINT
00001F80                          1549  NOTPOINT
00001F80  B07C 0003               1550              CMP     #3,D0
00001F84  6600 0008               1551              BNE     ZERO
00001F88  4EB9 00002088           1552              JSR     DIBFIGBPOINT
00001F8E                          1553           
00001F8E                          1554  ZERO
00001F8E  51C9 FFBC               1555              DBRA    D1,BUCLE_COLUMNA  
00001F92  51CA FFAC               1556              DBRA    D2,BUCLE_FILA
00001F96                          1557              
00001F96  4CDF 0300               1558              MOVEM.L (A7)+,A0-A1
00001F9A  4CDF 007F               1559              MOVEM.L (A7)+,D0-D6
00001F9E                          1560  
00001F9E                          1561  
00001F9E                          1562              
00001F9E  4E75                    1563              RTS            
00001FA0                          1564  
00001FA0                          1565  ; ------------------------------------------------------------------------------
00001FA0                          1566  MAPPLOT
00001FA0                          1567  ; INIT MAP
00001FA0                          1568  ; INPUT    : NONE
00001FA0                          1569  ; OUTPUT   : NONE
00001FA0                          1570  ; MODIFIES : NONE
00001FA0                          1571  ; ------------------------------------------------------------------------------            
00001FA0                          1572  
00001FA0  48E7 FE00               1573              MOVEM.L D0-D6,-(A7)
00001FA4  48E7 0080               1574              MOVEM.L A0,-(A7)
00001FA8                          1575  
00001FA8  41F9 00002678           1576              LEA.L   MAPVAR,A0
00001FAE  3C3C 0030               1577              MOVE.W  #48,D6
00001FB2  343C 001F               1578              MOVE.W  #31,D2
00001FB6                          1579  BUCLE_FILA2
00001FB6  3A3C 0030               1580              MOVE.W  #48,D5
00001FBA  323C 001F               1581              MOVE.W  #31,D1
00001FBE  0646 0010               1582              ADD.W   #16,D6
00001FC2                          1583  
00001FC2                          1584  BUCLE_COLUMNA2
00001FC2  0645 0010               1585              ADD.W   #16,D5       
00001FC6                          1586  
00001FC6  1018                    1587              MOVE.B  (A0)+,D0
00001FC8                          1588  
00001FC8  B07C 0000               1589              CMP     #0,D0
00001FCC  6700 0034               1590              BEQ     ZERO2
00001FD0  B07C 0004               1591              CMP     #4,D0
00001FD4  6700 002C               1592              BEQ     ZERO2
00001FD8  B07C 0001               1593              CMP     #1,D0
00001FDC  6600 0008               1594              BNE     NOTWALL2
00001FE0  4EB9 00002014           1595              JSR     DIBFIGWALL
00001FE6                          1596  NOTWALL2
00001FE6  B07C 0002               1597              CMP     #2,D0
00001FEA  6600 0008               1598              BNE     NOTPOINT2
00001FEE  4EB9 0000204C           1599              JSR     DIBFIGPOINT
00001FF4                          1600  NOTPOINT2
00001FF4  B07C 0003               1601              CMP     #3,D0
00001FF8  6600 0008               1602              BNE     ZERO2
00001FFC  4EB9 00002088           1603              JSR     DIBFIGBPOINT
00002002                          1604  
00002002                          1605     
00002002                          1606  ZERO2
00002002  51C9 FFBE               1607              DBRA    D1,BUCLE_COLUMNA2
00002006                          1608              
00002006  51CA FFAE               1609              DBRA    D2,BUCLE_FILA2
0000200A                          1610              
0000200A  4CDF 0100               1611              MOVEM.L (A7)+,A0
0000200E  4CDF 007F               1612              MOVEM.L (A7)+,D0-D6
00002012                          1613              
00002012                          1614              
00002012  4E75                    1615              RTS 
00002014                          1616              
00002014                          1617  ; -----------------------------------------------------------------------------
00002014                          1618  DIBFIGWALL
00002014                          1619  ; SUBRUTINE DRAW MAP
00002014                          1620  ; INPUT    : D5=POSITION X, D6=POSITION Y
00002014                          1621  ; OUTPUT   : NONE
00002014                          1622  ; MODIFIES : NONE
00002014                          1623  ; -----------------------------------------------------------------------------
00002014  48E7 FE00               1624              MOVEM.L D0-D6,-(A7)
00002018                          1625              ; SET CONTOURN COLOR
00002018  103C 0050               1626              MOVE.B  #80,D0
0000201C  223C 00AA0000           1627              MOVE.L  #$00AA0000,D1
00002022  4E4F                    1628              TRAP    #15
00002024                          1629              
00002024                          1630              ; SET FILL COLOR
00002024  103C 0051               1631              MOVE.B  #81,D0
00002028  223C 00FF0000           1632              MOVE.L  #$00FF0000,D1
0000202E  4E4F                    1633              TRAP    #15
00002030                          1634              
00002030                          1635              ; DEFINE COORDINATES RECTANGLE
00002030  3205                    1636              MOVE.W  D5,D1
00002032  3406                    1637              MOVE.W  D6,D2
00002034  0645 0010               1638              ADD.W   #16,D5
00002038  0646 0010               1639              ADD.W   #16,D6
0000203C  3605                    1640              MOVE.W  D5,D3
0000203E  3806                    1641              MOVE.W  D6,D4
00002040                          1642              
00002040                          1643              ; DRAW RECTANGLE
00002040  103C 0057               1644              MOVE.B  #87,D0
00002044  4E4F                    1645              TRAP    #15
00002046                          1646              
00002046  4CDF 007F               1647              MOVEM.L (A7)+,D0-D6
0000204A                          1648  
0000204A  4E75                    1649              RTS
0000204C                          1650              
0000204C                          1651  ; -----------------------------------------------------------------------------
0000204C                          1652  DIBFIGPOINT
0000204C                          1653  ; SUBRUTINE DRAW MAP
0000204C                          1654  ; INPUT    : D5=POSITION X, D6=POSITION Y
0000204C                          1655  ; OUTPUT   : NONE
0000204C                          1656  ; MODIFIES : NONE
0000204C                          1657  ; -----------------------------------------------------------------------------
0000204C  48E7 FE00               1658              MOVEM.L D0-D6,-(A7)
00002050                          1659              ; SET CONTOURN COLOR
00002050  103C 0050               1660              MOVE.B  #80,D0
00002054  223C 0000AAAA           1661              MOVE.L  #$0000AAAA,D1
0000205A  4E4F                    1662              TRAP    #15
0000205C                          1663              
0000205C                          1664              ; SET FILL COLOR
0000205C  103C 0051               1665              MOVE.B  #81,D0
00002060  223C 0000FFFF           1666              MOVE.L  #$0000FFFF,D1
00002066  4E4F                    1667              TRAP    #15
00002068                          1668              
00002068                          1669              ; DEFINE COORDINATES RECTANGLE
00002068  3205                    1670              MOVE.W  D5,D1
0000206A  5041                    1671              ADD.W   #8,D1
0000206C  5541                    1672              SUB.W   #2,D1
0000206E  3406                    1673              MOVE.W  D6,D2
00002070  5042                    1674              ADD.W   #8,D2
00002072  5542                    1675              SUB.W   #2,D2
00002074                          1676              
00002074  3601                    1677              MOVE.W  D1,D3
00002076  5843                    1678              ADD.W   #2*2,D3
00002078  3802                    1679              MOVE.W  D2,D4
0000207A  5844                    1680              ADD.W   #2*2,D4
0000207C                          1681              
0000207C                          1682              ; DRAW POINT
0000207C  103C 0058               1683              MOVE.B  #88,D0
00002080  4E4F                    1684              TRAP    #15
00002082                          1685              
00002082  4CDF 007F               1686              MOVEM.L (A7)+,D0-D6
00002086                          1687              
00002086  4E75                    1688              RTS
00002088                          1689  
00002088                          1690  
00002088                          1691  ; -----------------------------------------------------------------------------
00002088                          1692  DIBFIGBPOINT
00002088                          1693  ; SUBRUTINE DRAW MAP
00002088                          1694  ; INPUT    : D5=POSITION X, D6=POSITION Y
00002088                          1695  ; OUTPUT   : NONE
00002088                          1696  ; MODIFIES : NONE
00002088                          1697  ; -----------------------------------------------------------------------------
00002088  48E7 FE00               1698              MOVEM.L D0-D6,-(A7)
0000208C                          1699              ; SET CONTOURN COLOR
0000208C  103C 0050               1700              MOVE.B  #80,D0
00002090  223C 0000AAAA           1701              MOVE.L  #$0000AAAA,D1
00002096  4E4F                    1702              TRAP    #15
00002098                          1703              
00002098                          1704              ; SET FILL COLOR
00002098  103C 0051               1705              MOVE.B  #81,D0
0000209C  223C 0000FFFF           1706              MOVE.L  #$0000FFFF,D1
000020A2  4E4F                    1707              TRAP    #15
000020A4                          1708              
000020A4                          1709              ; DEFINE COORDINATES RECTANGLE
000020A4  3205                    1710              MOVE.W  D5,D1
000020A6  5041                    1711              ADD.W   #8,D1
000020A8  5941                    1712              SUB.W   #4,D1
000020AA  3406                    1713              MOVE.W  D6,D2
000020AC  5042                    1714              ADD.W   #8,D2
000020AE  5942                    1715              SUB.W   #4,D2
000020B0                          1716              
000020B0  3601                    1717              MOVE.W  D1,D3
000020B2  5043                    1718              ADD.W   #4*2,D3
000020B4  3802                    1719              MOVE.W  D2,D4
000020B6  5044                    1720              ADD.W   #4*2,D4
000020B8                          1721              
000020B8                          1722              ; DRAW BIG POINT
000020B8  103C 0058               1723              MOVE.B  #88,D0
000020BC  4E4F                    1724              TRAP    #15
000020BE                          1725              
000020BE  4CDF 007F               1726              MOVEM.L (A7)+,D0-D6
000020C2                          1727              
000020C2  4E75                    1728              RTS
000020C4                          1729  
000020C4                          1730  
000020C4                          1731  
000020C4                          1732  
000020C4                          1733  
000020C4                          1734  
000020C4                          1735  
000020C4                          1736  
000020C4                          1737  
000020C4                          1738  
000020C4                          1739  
000020C4                          1740  
000020C4                          1741  -------------------- end include --------------------
000020C4                          1742              INCLUDE "LIB/UTLCONST.X68"
000020C4                          1743  ; ==============================================================================
000020C4                          1744  ; UTIL CONSTANTS
000020C4                          1745  ; ==============================================================================
000020C4                          1746  
000020C4  =00000008               1747  UTLCHRWD    EQU     8                       ; CHARACTER WIDTH IN PIXELS
000020C4                          1748  
000020C4                          1749  -------------------- end include --------------------
000020C4                          1750              INCLUDE "LIB/UTLCODE.X68"
000020C4                          1751  ; =============================================================================
000020C4                          1752  ; UTILITY CODE
000020C4                          1753  ; =============================================================================
000020C4                          1754  
000020C4                          1755  ; -----------------------------------------------------------------------------
000020C4                          1756  UTLINIT
000020C4                          1757  ; INITIALIZES UTILITY CODE
000020C4                          1758  ; INPUT    - NONE
000020C4                          1759  ; OUTPUT   - NONE
000020C4                          1760  ; MODIFIES - NONE
000020C4                          1761  ; -----------------------------------------------------------------------------
000020C4  48E7 C000               1762              MOVEM.L D0-D1,-(A7)
000020C8  103C 0008               1763              MOVE.B  #8,D0
000020CC  4E4F                    1764              TRAP    #15
000020CE  13C1 00017A8C           1765              MOVE.B  D1,(UTLRNDIX)
000020D4  4CDF 0003               1766              MOVEM.L (A7)+,D0-D1
000020D8  4E75                    1767              RTS
000020DA                          1768  
000020DA                          1769  ; -----------------------------------------------------------------------------
000020DA                          1770  UTLPRINT
000020DA                          1771  ; PRINT SCREEN CENTERED TEXT
000020DA                          1772  ; INPUT    : A0 POINTER TO ZERO-TERMINATED STRING
000020DA                          1773  ;            D0.B SCREEN ROW TO PRINT TEXT
000020DA                          1774  ; OUTPUT   : D0.B NEXT ROW
000020DA                          1775  ; MODIFIES : NONE (ASIDE OF OUTPUT)
000020DA                          1776  ; -----------------------------------------------------------------------------
000020DA  48E7 C0C0               1777              MOVEM.L D0-D1/A0-A1,-(A7)
000020DE  4201                    1778              CLR.B   D1
000020E0  2248                    1779              MOVE.L  A0,A1
000020E2  4A18                    1780  .LOOP       TST.B   (A0)+
000020E4  6700 0006               1781              BEQ     .ENDLOOP
000020E8  5201                    1782              ADDQ.B  #1,D1
000020EA  60F6                    1783              BRA     .LOOP
000020EC  E209                    1784  .ENDLOOP    LSR.B   #1,D1
000020EE  0401 0028               1785              SUB.B   #(SCRWIDTH/UTLCHRWD)/2,D1
000020F2  4401                    1786              NEG.B   D1
000020F4  E141                    1787              ASL.W   #8,D1
000020F6  8240                    1788              OR.W    D0,D1
000020F8  103C 000B               1789              MOVE.B  #11,D0
000020FC  4E4F                    1790              TRAP    #15
000020FE  103C 000D               1791              MOVE.B  #13,D0
00002102  4E4F                    1792              TRAP    #15
00002104  4CDF 0303               1793              MOVEM.L (A7)+,D0-D1/A0-A1
00002108  5200                    1794              ADDQ.B  #1,D0
0000210A  4E75                    1795              RTS
0000210C                          1796              
0000210C                          1797              
0000210C                          1798  
0000210C                          1799  
0000210C                          1800              ; (SCRWIDTH/UTLCHRWD)/2 - D1/2
0000210C                          1801  
0000210C                          1802  
0000210C                          1803  ; -----------------------------------------------------------------------------
0000210C                          1804  UTLRAND
0000210C                          1805  ; PROVIDES A PSEUDO-RANDOM BYTE
0000210C                          1806  ; INPUT    - NONE
0000210C                          1807  ; OUTPUT   - D0.L RANDOM VALUE (ONLY BYTE)
0000210C                          1808  ; MODIFIES - NONE (ASIDE OF OUTPUT)
0000210C                          1809  ; -----------------------------------------------------------------------------
0000210C  2F08                    1810              MOVE.L  A0,-(A7)
0000210E  41F9 0000212A           1811              LEA     .RANDVEC,A0
00002114  4280                    1812              CLR.L   D0
00002116  1039 00017A8C           1813              MOVE.B  (UTLRNDIX),D0
0000211C  1030 0800               1814              MOVE.B  (A0,D0.L),D0
00002120  5239 00017A8C           1815              ADDQ.B  #1,(UTLRNDIX)
00002126  205F                    1816              MOVE.L  (A7)+,A0
00002128  4E75                    1817              RTS
0000212A                          1818  
0000212A                          1819  
0000212A= A2 EE 9A 0C F5 24 ...   1820  .RANDVEC    DC.B    162, 238, 154, 12 , 245, 36 , 32 , 103
00002132= 2A A3 51 26 E0 AC ...   1821              DC.B    42 , 163, 81 , 38 , 224, 172, 19 , 69
0000213A= 75 51 CA FD 33 EB ...   1822              DC.B    117, 81 , 202, 253, 51 , 235, 108, 154
00002142= 60 CC E7 B8 9A EB ...   1823              DC.B    96 , 204, 231, 184, 154, 235, 34 , 203
0000214A= 1D 76 B5 95 B0 89 ...   1824              DC.B    29 , 118, 181, 149, 176, 137, 62 , 108
00002152= 39 15 48 C9 6E CA ...   1825              DC.B    57 , 21 , 72 , 201, 110, 202, 159, 41
0000215A= 43 E7 E2 7C 37 25 ...   1826              DC.B    67 , 231, 226, 124, 55 , 37 , 84 , 62
00002162= E9 94 CE E9 E4 52 ...   1827              DC.B    233, 148, 206, 233, 228, 82 , 243, 78
0000216A= 37 6D 9A 84 A2 28 ...   1828              DC.B    55 , 109, 154, 132, 162, 40 , 30 , 39
00002172= 19 E2 C6 77 80 D4 ...   1829              DC.B    25 , 226, 198, 119, 128, 212, 232, 225
0000217A= 0A 5A 32 67 33 C2 ...   1830              DC.B    10 , 90 , 50 , 103, 51 , 194, 222, 40
00002182= 59 80 DC 0E 57 FC ...   1831              DC.B    89 , 128, 220, 14 , 87 , 252, 243, 252
0000218A= 8A AB BC F7 07 4D ...   1832              DC.B    138, 171, 188, 247, 7  , 77 , 29 , 234
00002192= EF D5 77 6E 1E BB ...   1833              DC.B    239, 213, 119, 110, 30 , 187, 131, 23
0000219A= D6 E0 2A 8F BD 28 ...   1834              DC.B    214, 224, 42 , 143, 189, 40 , 212, 130
000021A2= 13 4F 66 EC 0A 64 ...   1835              DC.B    19 , 79 , 102, 236, 10 , 100, 122, 188
000021AA= 56 52 9A 16 9B 90 ...   1836              DC.B    86 , 82 , 154, 22 , 155, 144, 7  , 199
000021B2= 06 8A A4 F7 01 DA ...   1837              DC.B    6  , 138, 164, 247, 1  , 218, 166, 82
000021BA= F2 E7 77 28 B1 76 ...   1838              DC.B    242, 231, 119, 40 , 177, 118, 220, 102
000021C2= A4 42 E3 81 B1 67 ...   1839              DC.B    164, 66 , 227, 129, 177, 103, 165, 108
000021CA= BF CE FA 16 BF 38 ...   1840              DC.B    191, 206, 250, 22 , 191, 56 , 30 , 161
000021D2= D1 8B 50 0C 5F 49 ...   1841              DC.B    209, 139, 80 , 12 , 95 , 73 , 168, 56
000021DA= DE 4C 14 A2 40 DC ...   1842              DC.B    222, 76 , 20 , 162, 64 , 220, 93 , 12
000021E2= B6 9B 0A 38 5D AB ...   1843              DC.B    182, 155, 10 , 56 , 93 , 171, 89 , 6
000021EA= E2 1B DD 75 15 82 ...   1844              DC.B    226, 27 , 221, 117, 21 , 130, 101, 18
000021F2= 8A 26 51 30 9F 47 ...   1845              DC.B    138, 38 , 81 , 48 , 159, 71 , 57 , 21
000021FA= 1E 8A BB 71 C6 6E ...   1846              DC.B    30 , 138, 187, 113, 198, 110, 185, 152
00002202= 9F 47 E5 34 94 27 ...   1847              DC.B    159, 71 , 229, 52 , 148, 39 , 77 , 6
0000220A= 7D 06 D6 BA 30 0F ...   1848              DC.B    125, 6  , 214, 186, 48 , 15 , 212, 22
00002212= EC 7F 7E 03 CF 2D ...   1849              DC.B    236, 127, 126, 3  , 207, 45 , 193, 2
0000221A= 94 5B 23 F2 8B CD ...   1850              DC.B    148, 91 , 35 , 242, 139, 205, 248, 237
00002222= 74 33 EC B9 0F D5 ...   1851              DC.B    116, 51 , 236, 185, 15 , 213, 221, 6
0000222A                          1852  
0000222A                          1853  
0000222A                          1854  
0000222A                          1855  
0000222A                          1856  -------------------- end include --------------------
0000222A                          1857              INCLUDE "INTRO.X68"
0000222A                          1858  ; ==============================================================================
0000222A                          1859  ; INTRO SCREEN
0000222A                          1860  ; ==============================================================================
0000222A                          1861  
0000222A                          1862  ; ------------------------------------------------------------------------------
0000222A                          1863  ISCINIT
0000222A                          1864  ; INTRO SCREEN INIT
0000222A                          1865  ; INPUT    : NONE
0000222A                          1866  ; OUTPUT   : NONE
0000222A                          1867  ; MODIFIES : NONE
0000222A                          1868  ; ------------------------------------------------------------------------------
0000222A  4279 00017A86           1869              CLR.W   (ISCTIMER)
00002230  4EB9 000022A4           1870              JSR     OPENFILE
00002236  4E75                    1871              RTS
00002238                          1872  
00002238                          1873  ; ------------------------------------------------------------------------------
00002238                          1874  ISCUPD
00002238                          1875  ; INTRO SCREEN UPDATE
00002238                          1876  ; INPUT    : NONE
00002238                          1877  ; OUTPUT   : NONE
00002238                          1878  ; MODIFIES : NONE
00002238                          1879  ; ------------------------------------------------------------------------------
00002238  0839 0004 00002674      1880              BTST.B  #4,(KBDVAL)
00002240  6700 000A               1881              BEQ     .CONT
00002244  33FC 0001 00017A8A      1882              MOVE.W  #1,(STANEXT)
0000224C                          1883  .CONT       ;ADDQ.W  #1,(ISCTIMER)
0000224C                          1884  ;            CMP.W   #500,(ISCTIMER)
0000224C                          1885  ;            BLT     .DONE
0000224C                          1886  ;            MOVE.W  #1,(STANEXT)
0000224C  4E75                    1887  .DONE       RTS
0000224E                          1888  
0000224E                          1889  ; ------------------------------------------------------------------------------
0000224E                          1890  ISCPLOT
0000224E                          1891  ; INTRO SCREEN PLOT
0000224E                          1892  ; INPUT    : NONE
0000224E                          1893  ; OUTPUT   : NONE
0000224E                          1894  ; MODIFIES : NONE
0000224E                          1895  ; ------------------------------------------------------------------------------
0000224E  48E7 C080               1896              MOVEM.L D0-D1/A0,-(A7)
00002252                          1897              
00002252  4281                    1898              CLR.L   D1
00002254  103C 0051               1899              MOVE.B  #81,D0
00002258  4E4F                    1900              TRAP    #15
0000225A                          1901              
0000225A                          1902              ;JSR     IMGPLOT
0000225A                          1903              
0000225A  0839 0004 00002677      1904              BTST.B  #4,(SCRCYCCT)
00002262  6700 0010               1905              BEQ     .DONE
00002266                          1906              
00002266  41F9 00002288           1907              LEA     .TXT2,A0
0000226C  103C 0019               1908              MOVE.B  #25,D0
00002270  4EB8 20DA               1909              JSR     UTLPRINT
00002274                          1910              
00002274  4CDF 0103               1911  .DONE       MOVEM.L (A7)+,D0-D1/A0
00002278                          1912  
00002278  4E75                    1913              RTS
0000227A= 50 41 43 2D 4D 41 ...   1914  .TXT1       DC.B    'PAC-MAN 68000',0
00002288= 50 52 45 53 53 20 ...   1915  .TXT2       DC.B    'PRESS SPACE BUTTON TO START',0
000022A4                          1916              DS.W    0
000022A4                          1917              
000022A4                          1918  ;------------------------------------------------------------------------
000022A4                          1919              
000022A4                          1920  OPENFILE                 
000022A4                          1921              ;OPEN FILE
000022A4  43F8 1BCA               1922              LEA     FILENAME,A1
000022A8  303C 0033               1923              MOVE    #51,D0
000022AC  4E4F                    1924              TRAP    #15
000022AE                          1925              
000022AE                          1926              ;READ FILE
000022AE  243C 00014FF0           1927              MOVE.L  #FILESIZE,D2
000022B4  43F9 00002A7A           1928              LEA     BUFFER,A1
000022BA  303C 0035               1929              MOVE    #53,D0
000022BE  4E4F                    1930              TRAP    #15
000022C0                          1931              
000022C0                          1932      
000022C0                          1933              
000022C0  4E75                    1934              RTS
000022C2                          1935  ; ------------------------------------------------------------------------------
000022C2                          1936  IMGPLOT
000022C2                          1937  ; TITLE IMAGE PLOT
000022C2                          1938  ; INPUT    : NONE
000022C2                          1939  ; OUTPUT   : NONE
000022C2                          1940  ; MODIFIES : NONE
000022C2                          1941  ; ------------------------------------------------------------------------------
000022C2  48E7 FE00               1942              MOVEM.L D0-D6,-(A7)
000022C6  48E7 00C0               1943              MOVEM.L A0-A1,-(A7)
000022CA                          1944              
000022CA                          1945              ;PLOT
000022CA                          1946   
000022CA  41F9 00002A7A           1947              LEA.L   BUFFER,A0
000022D0  3C3C 00DC               1948              MOVE.W  #220,D6
000022D4  343C 001C               1949              MOVE.W  #28,D2
000022D8                          1950  BUCLE_FILA3
000022D8  3A3C 0064               1951              MOVE.W  #100,D5
000022DC  323C 0065               1952              MOVE.W  #101,D1
000022E0  5846                    1953              ADD.W   #4,D6
000022E2                          1954  
000022E2                          1955  BUCLE_COLUMNA3
000022E2  5845                    1956              ADD.W   #4,D5
000022E4                          1957  
000022E4  1018                    1958              MOVE.B  (A0)+,D0
000022E6                          1959               
000022E6  B07C 0001               1960              CMP     #1,D0
000022EA  6700 000C               1961              BEQ     ZERO3
000022EE  B07C 0000               1962              CMP     #0,D0
000022F2  4EB9 0000230A           1963              JSR     DRAW
000022F8                          1964  ZERO3
000022F8  51C9 FFE8               1965              DBRA    D1,BUCLE_COLUMNA3
000022FC  51CA FFDA               1966              DBRA    D2,BUCLE_FILA3
00002300                          1967              
00002300  4CDF 0300               1968              MOVEM.L (A7)+,A0-A1
00002304  4CDF 007F               1969              MOVEM.L (A7)+,D0-D6
00002308                          1970          
00002308                          1971  
00002308  4E75                    1972              RTS
0000230A                          1973  
0000230A                          1974  
0000230A                          1975  ; -----------------------------------------------------------------------------
0000230A                          1976  DRAW
0000230A                          1977  ; SUBRUTINE DRAW 
0000230A                          1978  ; INPUT    : D5=POSITION X, D6=POSITION Y
0000230A                          1979  ; OUTPUT   : NONE
0000230A                          1980  ; MODIFIES : NONE
0000230A                          1981  ; -----------------------------------------------------------------------------
0000230A  48E7 FE00               1982              MOVEM.L D0-D6,-(A7)
0000230E                          1983              ; SET CONTOURN COLOR
0000230E  103C 0050               1984              MOVE.B  #80,D0
00002312  223C 00AA0000           1985              MOVE.L  #$00AA0000,D1
00002318  4E4F                    1986              TRAP    #15
0000231A                          1987              
0000231A                          1988              ; SET FILL COLOR
0000231A  103C 0051               1989              MOVE.B  #81,D0
0000231E  223C 00FF0000           1990              MOVE.L  #$00FF0000,D1
00002324  4E4F                    1991              TRAP    #15
00002326                          1992              
00002326                          1993              ; DEFINE COORDINATES RECTANGLE
00002326  3205                    1994              MOVE.W  D5,D1
00002328  3406                    1995              MOVE.W  D6,D2
0000232A  5845                    1996              ADD.W   #4,D5
0000232C  5846                    1997              ADD.W   #4,D6
0000232E  3605                    1998              MOVE.W  D5,D3
00002330  3806                    1999              MOVE.W  D6,D4
00002332                          2000              
00002332                          2001              ; DRAW RECTANGLE
00002332  103C 0057               2002              MOVE.B  #87,D0
00002336  4E4F                    2003              TRAP    #15
00002338                          2004              
00002338  4CDF 007F               2005              MOVEM.L (A7)+,D0-D6
0000233C                          2006  
0000233C  4E75                    2007              RTS
0000233E                          2008  
0000233E                          2009  
0000233E                          2010  
0000233E                          2011  
0000233E                          2012  
0000233E                          2013  
0000233E                          2014  
0000233E                          2015  -------------------- end include --------------------
0000233E                          2016              INCLUDE "INSTRUCTIONS.X68"
0000233E                          2017  ; ==============================================================================
0000233E                          2018  ; INSTRUCTIONS SCREEN
0000233E                          2019  ; ==============================================================================
0000233E                          2020  
0000233E                          2021  ; ------------------------------------------------------------------------------
0000233E                          2022  INSINIT
0000233E                          2023  ; INSTRUCTIONS SCREEN INIT
0000233E                          2024  ; INPUT    : NONE
0000233E                          2025  ; OUTPUT   : NONE
0000233E                          2026  ; MODIFIES : NONE
0000233E                          2027  ; ------------------------------------------------------------------------------
0000233E  4E75                    2028              RTS
00002340                          2029  
00002340                          2030  ; ------------------------------------------------------------------------------
00002340                          2031  INSUPD
00002340                          2032  ; INSTRUCTIONS SCREEN UPDATE
00002340                          2033  ; INPUT    : NONE
00002340                          2034  ; OUTPUT   : NONE
00002340                          2035  ; MODIFIES : NONE
00002340                          2036  ; ------------------------------------------------------------------------------
00002340  4E75                    2037              RTS
00002342                          2038  
00002342                          2039  ; ------------------------------------------------------------------------------
00002342                          2040  INSPLOT
00002342                          2041  ; INSTRUCTIONS SCREEN PLOT
00002342                          2042  ; INPUT    : NONE
00002342                          2043  ; OUTPUT   : NONE
00002342                          2044  ; MODIFIES : NONE
00002342                          2045  ; ------------------------------------------------------------------------------
00002342                          2046  
00002342  48E7 C0C0               2047              MOVEM.L D0-D1/A0-A1,-(A7)
00002346  4281                    2048              CLR.L   D1
00002348  103C 0051               2049              MOVE.B  #81,D0
0000234C  4E4F                    2050              TRAP    #15
0000234E  103C 000B               2051              MOVE.B  #11,D0
00002352  43F9 000024B4           2052              LEA     .TXTLST,A1
00002358  2219                    2053  .LOOP       MOVE.L  (A1)+,D1
0000235A  6700 000A               2054              BEQ     .DONE
0000235E  2041                    2055              MOVE.L  D1,A0
00002360  4EB8 20DA               2056              JSR     UTLPRINT
00002364  60F2                    2057              BRA     .LOOP
00002366  4CDF 0303               2058  .DONE       MOVEM.L (A7)+,D0-D1/A0-A1
0000236A  4E75                    2059              RTS
0000236C= 57 45 4C 43 4F 4D ...   2060  .TXT1       DC.B    'WELCOME TO THE WORLD OF MULTI-PONG 68000!',0
00002396= 59 4F 55 52 20 47 ...   2061  .TXT2       DC.B    'YOUR GOAL IN THIS GAME IS TO AVOID MISSING THE BALLS',0
000023CB= 54 4F 20 54 48 49 ...   2062  .TXT3       DC.B    'TO THIS END, MOVE THE PAD USING THE KEYBOARD',0
000023F8= 48 4F 57 20 54 4F ...   2063  .TXT4       DC.B    'HOW TO DO IT? YOU MAY ASK.',0
00002413= 49 54 20 49 53 20 ...   2064  .TXT5       DC.B    'IT IS EASY: JUST USE THE UP KEY TO MOVE THE PAD...',0
00002446= 55 50 21 00             2065  .TXT6       DC.B    'UP!',0
0000244A= 41 4E 44 20 55 53 ...   2066  .TXT7       DC.B    'AND USE THE DOWN KEY TO MOVE THE PAD DOWN.',0
00002475= 57 48 41 54 20 41 ...   2067  .TXT8       DC.B    'WHAT ABOUT LEFT AND RIGHT?',0
00002490= 4E 4F 2E 20 54 48 ...   2068  .TXT9       DC.B    'NO. THESE ARE FORBIDDEN DIRECTIONS',0
000024B4                          2069              DS.W    0
000024B4= 0000236C 00002396 ...   2070  .TXTLST     DC.L    .TXT1,.TXT2,.TXT3,.TXT4,.TXT5,.TXT6,.TXT7,.TXT8,.TXT9,0
000024DC                          2071  
000024DC                          2072  
000024DC                          2073  -------------------- end include --------------------
000024DC                          2074              INCLUDE "WIN.X68"
000024DC                          2075  ; ==============================================================================
000024DC                          2076  ; VICTORY SCREEN
000024DC                          2077  ; ==============================================================================
000024DC                          2078  
000024DC                          2079  ; ------------------------------------------------------------------------------
000024DC                          2080  WININIT
000024DC                          2081  ; VICTORY SCREEN INIT
000024DC                          2082  ; INPUT    : NONE
000024DC                          2083  ; OUTPUT   : NONE
000024DC                          2084  ; MODIFIES : NONE
000024DC                          2085  ; ------------------------------------------------------------------------------
000024DC  4E75                    2086              RTS
000024DE                          2087  
000024DE                          2088  ; ------------------------------------------------------------------------------
000024DE                          2089  WINUPD
000024DE                          2090  ; VICTORY SCREEN UPDATE
000024DE                          2091  ; INPUT    : NONE
000024DE                          2092  ; OUTPUT   : NONE
000024DE                          2093  ; MODIFIES : NONE
000024DE                          2094  ; ------------------------------------------------------------------------------
000024DE  4E75                    2095              RTS
000024E0                          2096  
000024E0                          2097  ; ------------------------------------------------------------------------------
000024E0                          2098  WINPLOT
000024E0                          2099  ; VICTORY SCREEN PLOT
000024E0                          2100  ; INPUT    : NONE
000024E0                          2101  ; OUTPUT   : NONE
000024E0                          2102  ; MODIFIES : NONE
000024E0                          2103  ; ------------------------------------------------------------------------------
000024E0  48E7 C080               2104              MOVEM.L D0-D1/A0,-(A7)
000024E4                          2105              
000024E4  4281                    2106              CLR.L   D1
000024E6  103C 0051               2107              MOVE.B  #81,D0
000024EA  4E4F                    2108              TRAP    #15
000024EC                          2109              
000024EC  41F9 0000251A           2110              LEA     .TXT1,A0
000024F2  103C 000A               2111              MOVE.B  #10,D0
000024F6  4EB8 20DA               2112              JSR     UTLPRINT
000024FA                          2113              
000024FA  0839 0004 00002677      2114              BTST.B  #4,(SCRCYCCT)
00002502  6700 0010               2115              BEQ     .DONE
00002506                          2116              
00002506  41F9 00002523           2117              LEA     .TXT2,A0
0000250C  103C 0019               2118              MOVE.B  #25,D0
00002510  4EB8 20DA               2119              JSR     UTLPRINT
00002514                          2120              
00002514  4CDF 0103               2121  .DONE       MOVEM.L (A7)+,D0-D1/A0
00002518                          2122  
00002518  4E75                    2123              RTS
0000251A= 59 4F 55 20 57 4F ...   2124  .TXT1       DC.B    'YOU WON!',0
00002523= 50 52 45 53 53 20 ...   2125  .TXT2       DC.B    'PRESS FIRE1 TO CONTINUE',0
0000253C                          2126              DS.W    0
0000253C                          2127  
0000253C                          2128  
0000253C                          2129  
0000253C                          2130  -------------------- end include --------------------
0000253C                          2131              INCLUDE "GOVER.X68"
0000253C                          2132  ; ==============================================================================
0000253C                          2133  ; GAME OVER SCREEN
0000253C                          2134  ; ==============================================================================
0000253C                          2135  
0000253C                          2136  ; ------------------------------------------------------------------------------
0000253C                          2137  GOVINIT
0000253C                          2138  ; GAME OVER SCREEN INIT
0000253C                          2139  ; INPUT    : NONE
0000253C                          2140  ; OUTPUT   : NONE
0000253C                          2141  ; MODIFIES : NONE
0000253C                          2142  ; ------------------------------------------------------------------------------
0000253C  4E75                    2143              RTS
0000253E                          2144  
0000253E                          2145  ; ------------------------------------------------------------------------------
0000253E                          2146  GOVUPD
0000253E                          2147  ; GAME OVER SCREEN UPDATE
0000253E                          2148  ; INPUT    : NONE
0000253E                          2149  ; OUTPUT   : NONE
0000253E                          2150  ; MODIFIES : NONE
0000253E                          2151  ; ------------------------------------------------------------------------------
0000253E  4E75                    2152              RTS
00002540                          2153  
00002540                          2154  ; ------------------------------------------------------------------------------
00002540                          2155  GOVPLOT
00002540                          2156  ; GAME OVER SCREEN PLOT
00002540                          2157  ; INPUT    : NONE
00002540                          2158  ; OUTPUT   : NONE
00002540                          2159  ; MODIFIES : NONE
00002540                          2160  ; ------------------------------------------------------------------------------
00002540  48E7 C080               2161              MOVEM.L D0-D1/A0,-(A7)
00002544                          2162              
00002544  4281                    2163              CLR.L   D1
00002546  103C 0051               2164              MOVE.B  #81,D0
0000254A  4E4F                    2165              TRAP    #15
0000254C                          2166              
0000254C  41F9 0000257A           2167              LEA     .TXT1,A0
00002552  103C 000A               2168              MOVE.B  #10,D0
00002556  4EB8 20DA               2169              JSR     UTLPRINT
0000255A                          2170              
0000255A  0839 0004 00002677      2171              BTST.B  #4,(SCRCYCCT)
00002562  6700 0010               2172              BEQ     .DONE
00002566                          2173              
00002566  41F9 00002584           2174              LEA     .TXT2,A0
0000256C  103C 0019               2175              MOVE.B  #25,D0
00002570  4EB8 20DA               2176              JSR     UTLPRINT
00002574                          2177              
00002574  4CDF 0103               2178  .DONE       MOVEM.L (A7)+,D0-D1/A0
00002578                          2179  
00002578  4E75                    2180              RTS
0000257A= 47 41 4D 45 20 4F ...   2181  .TXT1       DC.B    'GAME OVER',0
00002584= 50 52 45 53 53 20 ...   2182  .TXT2       DC.B    'PRESS FIRE1 TO CONTINUE',0
0000259C                          2183              DS.W    0
0000259C                          2184  
0000259C                          2185  
0000259C                          2186  -------------------- end include --------------------
0000259C                          2187              INCLUDE "STATES.X68"
0000259C                          2188  ; =============================================================================
0000259C                          2189  ; GAME STATE MANAGEMENT
0000259C                          2190  ; =============================================================================
0000259C                          2191  
0000259C                          2192  ; -----------------------------------------------------------------------------
0000259C                          2193  STAINIT
0000259C                          2194  ; INITALIZES THE STATE MANAGER
0000259C                          2195  ; INPUT    - NONE
0000259C                          2196  ; OUTPUT   - NONE
0000259C                          2197  ; MODIFIES - NONE
0000259C                          2198  ; -----------------------------------------------------------------------------
0000259C  33FC FFFF 00017A88      2199              MOVE.W  #STANONE,(STACUR)
000025A4  4279 00017A8A           2200              CLR.W   (STANEXT)
000025AA  4E75                    2201              RTS
000025AC                          2202  
000025AC                          2203  ; -----------------------------------------------------------------------------
000025AC                          2204  STAUPD
000025AC                          2205  ; PERFORMS STATE UPDATE AND INIT IF NECESSARY
000025AC                          2206  ; INPUT    - NONE
000025AC                          2207  ; OUTPUT   - NONE
000025AC                          2208  ; MODIFIES - NONE
000025AC                          2209  ; -----------------------------------------------------------------------------
000025AC  48E7 8080               2210              MOVEM.L D0/A0,-(A7)
000025B0  4280                    2211              CLR.L   D0
000025B2  3039 00017A8A           2212              MOVE.W  (STANEXT),D0
000025B8  B079 00017A88           2213              CMP.W   (STACUR),D0
000025BE  6700 0012               2214              BEQ     .DOUPD
000025C2  33C0 00017A88           2215              MOVE.W  D0,(STACUR)             ; IF STATE CHANGED, DO INIT
000025C8  E588                    2216              LSL.L   #2,D0
000025CA  2040                    2217              MOVE.L  D0,A0
000025CC  2068 25EA               2218              MOVE.L  .INITBL(A0),A0
000025D0  4E90                    2219              JSR     (A0)
000025D2  4280                    2220  .DOUPD      CLR.L   D0                      ; IN ANY CASE, DO UPDATE
000025D4  3039 00017A88           2221              MOVE.W  (STACUR),D0
000025DA  E588                    2222              LSL.L   #2,D0
000025DC  2040                    2223              MOVE.L  D0,A0
000025DE  2068 25F2               2224              MOVE.L  .UPDTBL(A0),A0
000025E2  4E90                    2225              JSR     (A0)
000025E4  4CDF 0101               2226              MOVEM.L (A7)+,D0/A0
000025E8  4E75                    2227              RTS
000025EA= 0000222A                2228  .INITBL     DC.L    ISCINIT
000025EE= 00002620                2229              DC.L    GAMINIT
000025F2= 00002238                2230  .UPDTBL     DC.L    ISCUPD
000025F6= 00002630                2231              DC.L    GAMUPD
000025FA                          2232  
000025FA                          2233  ; -----------------------------------------------------------------------------
000025FA                          2234  STAPLOT
000025FA                          2235  ; PERFORMS STATE PLOT
000025FA                          2236  ; INPUT    - NONE
000025FA                          2237  ; OUTPUT   - NONE
000025FA                          2238  ; MODIFIES - NONE
000025FA                          2239  ; -----------------------------------------------------------------------------
000025FA  48E7 8080               2240              MOVEM.L D0/A0,-(A7)
000025FE  4280                    2241              CLR.L   D0
00002600  3039 00017A88           2242              MOVE.W  (STACUR),D0
00002606  E588                    2243              LSL.L   #2,D0
00002608  2040                    2244              MOVE.L  D0,A0
0000260A  2068 2616               2245              MOVE.L  .PLTTBL(A0),A0
0000260E  4E90                    2246              JSR     (A0)
00002610  4CDF 0101               2247              MOVEM.L (A7)+,D0/A0
00002614  4E75                    2248              RTS
00002616= 0000224E                2249  .PLTTBL     DC.L    ISCPLOT
0000261A= 00002638                2250              DC.L    GAMPLOT
0000261E                          2251  
0000261E                          2252  ; -----------------------------------------------------------------------------
0000261E                          2253  STAEMPTY
0000261E                          2254  ; EMPTY SUBROUTINE FOR CASES WITH NOTHING TO DO
0000261E                          2255  ; INPUT    - NONE
0000261E                          2256  ; OUTPUT   - NONE
0000261E                          2257  ; MODIFIES - NONE
0000261E                          2258  ; NOTE     - JUST A PLACEHOLDER. NOTHING TO DO.
0000261E                          2259  ; -----------------------------------------------------------------------------
0000261E  4E75                    2260              RTS
00002620                          2261  
00002620                          2262  
00002620                          2263  
00002620                          2264  
00002620                          2265  
00002620                          2266  
00002620                          2267  
00002620                          2268  
00002620                          2269  
00002620                          2270  
00002620                          2271  -------------------- end include --------------------
00002620                          2272              INCLUDE "GAME.X68"
00002620                          2273  ; ==============================================================================
00002620                          2274  ; GAME MANAGEMENT
00002620                          2275  ; ==============================================================================
00002620                          2276  
00002620                          2277  ; ------------------------------------------------------------------------------
00002620                          2278  GAMINIT
00002620                          2279  ; INITIALIZES GAME.
00002620                          2280  ; INPUT    : NONE
00002620                          2281  ; OUTPUT   : NONE
00002620                          2282  ; MODIFIES : NONE
00002620                          2283  ; ------------------------------------------------------------------------------
00002620  4EB8 1792               2284              JSR     PMINIT
00002624  4EB8 1F26               2285              JSR     MAPINIT
00002628  4EB8 1408               2286              JSR     GSTINIT
0000262C  6000 F52A               2287              BRA     SCOINIT
00002630                          2288  
00002630                          2289  ; ------------------------------------------------------------------------------
00002630                          2290  GAMUPD
00002630                          2291  ; UPDATES THE GAME
00002630                          2292  ; INPUT    : NONE
00002630                          2293  ; OUTPUT   : NONE
00002630                          2294  ; MODIFIES : NONE
00002630                          2295  ; ------------------------------------------------------------------------------
00002630                          2296              
00002630  4EB8 143A               2297              JSR     GSTUPD
00002634  6000 F190               2298              BRA     PMUPD
00002638                          2299              
00002638                          2300  ; ------------------------------------------------------------------------------
00002638                          2301  GAMPLOT
00002638                          2302  ; PLOTS THE GAME
00002638                          2303  ; INPUT    : NONE
00002638                          2304  ; OUTPUT   : NONE
00002638                          2305  ; MODIFIES : NONE
00002638                          2306  ; ------------------------------------------------------------------------------
00002638  4EB8 1FA0               2307              JSR     MAPPLOT
0000263C  4EB8 1B68               2308              JSR     SCOPLOT
00002640  4EB8 1932               2309              JSR     PMPLOT
00002644  6000 F0E2               2310              BRA     GSTPLOT
00002648                          2311  
00002648                          2312  
00002648                          2313  
00002648                          2314  
00002648                          2315  -------------------- end include --------------------
00002648                          2316        
00002648                          2317              
00002648                          2318      
00002648                          2319  START:
00002648                          2320  
00002648                          2321  ;--- INITIALIZATION -----------------------------------------------------------
00002648                          2322  
00002648  007C 0700               2323              ORI.W   #$0700,SR               ;DISABLE INTERRUPTIONS
0000264C                          2324  
0000264C  4EB8 1BD2               2325              JSR     SYSINIT
00002650  4EB8 259C               2326              JSR     STAINIT
00002654                          2327  
00002654                          2328  .LOOP
00002654                          2329  
00002654                          2330  ; --- UPDATE -------------------------------------------------------------------
00002654                          2331  
00002654                          2332  ; READ INPUT DEVICES
00002654                          2333  
00002654  4E41                    2334              TRAP    #1
00002656                          2335  
00002656                          2336  ; UPDATE GAME LOGIC
00002656                          2337  
00002656  4EB8 25AC               2338             JSR     STAUPD
0000265A                          2339  
0000265A                          2340  ; --- SYNC ---------------------------------------------------------------------
0000265A                          2341              ;WHILE THERES NO INTERRUPTS IN THE COUNTER THE PROGRAM WILL BE IN
0000265A                          2342              ;THE BUCLE
0000265A                          2343              
0000265A  4A39 00002676           2344  .WAITINIT   TST.B   (SCRINTCT)
00002660  67F8                    2345              BEQ     .WAITINIT
00002662  4239 00002676           2346              CLR.B   (SCRINTCT)
00002668                          2347  
00002668                          2348  ; --- PLOT ---------------------------------------------------------------------
00002668                          2349              
00002668  4EB8 25FA               2350              JSR     STAPLOT
0000266C                          2351              
0000266C                          2352              
0000266C  4E40                    2353              TRAP    #0                      ;CHANGE BUFFER
0000266E                          2354  
0000266E  60E4                    2355              BRA     .LOOP
00002670                          2356  
00002670  FFFF FFFF               2357              SIMHALT  
00002674                          2358             
00002674                          2359              INCLUDE "SYSVARS.X68"
00002674                          2360  ; ==============================================================================
00002674                          2361  ; SYSTEM VARIABLES
00002674                          2362  ; ==============================================================================
00002674                          2363   
00002674                          2364  ; --- KEYBOARD RELATED VARIABLES -----------------------------------------------
00002674                          2365  
00002674                          2366  KBDVAL      DS.B    1                       ; KEY STATE
00002675                          2367  KBDEDGE     DS.B    1                       ; KEY EDGE
00002676                          2368              DS.W    0 
00002676                          2369  
00002676                          2370  ; --- TIMED INTERRUPT RELATED VARIABLES ----------------------------------------
00002676                          2371  
00002676                          2372  SCRINTCT    DS.B    1                       ; INTERRUPT COUNTER
00002677                          2373  SCRCYCCT    DS.B    1                       ; CYCLE COUNTER
00002678                          2374              DS.W    0        
00002678                          2375              
00002678                          2376  ; --- MAP RELATED VARIABLE -----------------------------------------------------
00002678                          2377  
00002678                          2378  MAPVAR      DS.B    1024
00002A78                          2379  
00002A78                          2380              DS.B    0
00002A78                          2381  
00002A78                          2382  POSCON      DS.W    1
00002A7A                          2383  
00002A7A                          2384  ; --- TITLE RELATED VARIABLE -----------------------------------------------------
00002A7A                          2385  
00002A7A                          2386  BUFFER      DS.B    86000
00017A6A                          2387              DS.B    0
00017A6A                          2388              
00017A6A                          2389  
00017A6A                          2390  
00017A6A                          2391  
00017A6A                          2392  
00017A6A                          2393  
00017A6A                          2394  
00017A6A                          2395  
00017A6A                          2396  
00017A6A                          2397  -------------------- end include --------------------
00017A6A                          2398              INCLUDE "VARS.X68"
00017A6A                          2399  ; ==============================================================================
00017A6A                          2400  ; GAME VARIABLES
00017A6A                          2401  ; ==============================================================================
00017A6A                          2402  
00017A6A                          2403  ; --- PAC-MAN RELATED VARIABLES ------------------------------------------------
00017A6A                          2404  
00017A6A                          2405  PMPOSX      DS.W    1                       ; PM X COORDINATE
00017A6C                          2406  PMPOSY      DS.W    1                       ; PM Y COORDINATE
00017A6E                          2407  PMVELX      DS.W    1                       ; PM X VELOCITY
00017A70                          2408  PMVELY      DS.W    1                       ; PM Y VELOCITY
00017A72                          2409  PMEAT       DS.B    1                       ; PM BOOLEAN EAT GST
00017A73                          2410  PMLAMO      DS.B    1                       ; PM SAVE LAST MOVEMENT X O Y
00017A74                          2411              DS.B    0
00017A74                          2412  
00017A74                          2413  ; --- GHOST RELATED VARIABLES --------------------------------------------------
00017A74                          2414  
00017A74                          2415  GSTPOSX     DS.W    1                       ; GST X COORDINATE
00017A76                          2416  GSTPOSY     DS.W    1                       ; GST Y COORDINATE
00017A78                          2417  GSTVELX     DS.W    1                       ; GST X VELOCITY
00017A7A                          2418  GSTVELY     DS.W    1                       ; GST Y VELOCITY
00017A7C                          2419  GSTLAMO     DS.B    1                       ; GST LAST MOVEMENT (X OR Y)
00017A7D                          2420  GSTPOSMV    DS.B    1                       ; GST POSSIBLE MOVEMENTS (R,L,U,D)
00017A7E                          2421  GSTDEAD     DS.B    1                       ; GST BOOLEAN DEAD
00017A7F                          2422  GSTINRNG    DS.B    1                       ; GST IS IN RANGE
00017A80                          2423  GSTTARG     DS.B    1                       ; GST TARGET (0-PACMAN, 1-RANDOM)
00017A81                          2424  GSTCHDIR    DS.B    1                       ; GST HAS CHANGED DIR IN LAST FRAME
00017A82                          2425              DS.B    0
00017A82                          2426  
00017A82                          2427  ; --- SCOREBOARD RELATED VARIABLES ---------------------------------------------
00017A82                          2428  
00017A82                          2429  SCOLIFE     DS.W    1                       ; NUMBER OF LIFES
00017A84                          2430  SCOPOINTS   DS.W    1                       ; NUMBER OF POINTS
00017A86                          2431  
00017A86                          2432  ; --- INTRO STATE RELATED VARIABLES --------------------------------------------
00017A86                          2433  
00017A86                          2434  ISCTIMER    DS.W    1                       ; INTRO TIMER
00017A88                          2435  
00017A88                          2436  ; --- STATE RELATED VARIABLES --------------------------------------------------
00017A88                          2437  
00017A88                          2438  STACUR      DS.W    1                       ; CURRENT STATE
00017A8A                          2439  STANEXT     DS.W    1                       ; NEXT STATE
00017A8C                          2440  
00017A8C                          2441  
00017A8C                          2442  
00017A8C                          2443  
00017A8C                          2444  
00017A8C                          2445  
00017A8C                          2446  
00017A8C                          2447  
00017A8C                          2448  
00017A8C                          2449  
00017A8C                          2450  
00017A8C                          2451  -------------------- end include --------------------
00017A8C                          2452              INCLUDE "LIB/UTLVARS.X68"
00017A8C                          2453  ; =============================================================================
00017A8C                          2454  ; UTILITY VARIABLES
00017A8C                          2455  ; =============================================================================
00017A8C                          2456  
00017A8C                          2457  UTLRNDIX    DS.B    1                       ; NEXT INDEX TO RANDOM NUMBER
00017A8E                          2458              DS.W    0
00017A8E                          2459  -------------------- end include --------------------
00017A8E                          2460              
00017A8E                          2461              END    START        

No errors detected
No warnings generated


SYMBOL TABLE INFORMATION
Symbol-name         Value
-------------------------
BUCLE_COLUMNA       1F4C
BUCLE_COLUMNA2      1FC2
BUCLE_COLUMNA3      22E2
BUCLE_FILA          1F40
BUCLE_FILA2         1FB6
BUCLE_FILA3         22D8
BUFFER              2A7A
COLWALLDOWN         1D52
COLWALLLEFT         1D10
COLWALLRIGHT        1CCE
COLWALLUP           1D8E
DIBFIGBPOINT        2088
DIBFIGPOINT         204C
DIBFIGWALL          2014
DRAW                230A
FILENAME            1BCA
FILESIZE            14FF0
GAMINIT             2620
GAMPLOT             2638
GAMUPD              2630
GETPOINTS           1EB2
GETPOINTS:BPOINT    1EFC
GETPOINTS:DONE      1F20
GETPOINTS:POINT     1F0E
GOVINIT             253C
GOVPLOT             2540
GOVPLOT:DONE        2574
GOVPLOT:TXT1        257A
GOVPLOT:TXT2        2584
GOVUPD              253E
GST2DECISSIONS      16A8
GST2DECISSIONS:GST2DECEND  1722
GST2DECISSIONS:LAMODOWN  16F6
GST2DECISSIONS:LAMOLEFT  16E2
GST2DECISSIONS:LAMORIGHT  16CE
GST2DECISSIONS:LAMOUP  170A
GST2DECISSIONS:RETURN0  171E
GSTCHDIR            17A81
GSTCOL1             FF
GSTCOL2             FF0080
GSTCOL3             FFFF00
GSTCOL4             80FF
GSTCOL5             800000
GSTCOLWALLDOWN      1E44
GSTCOLWALLLEFT      1E08
GSTCOLWALLRIGHT     1DCC
GSTCOLWALLUP        1E7A
GSTDEAD             17A7E
GSTDECVEC           1000
GSTFCOL1            FFFFFF
GSTFCOL2            0
GSTFCOL3            0
GSTFCOL4            0
GSTFCOL5            0
GSTINIT             1408
GSTINRNG            17A7F
GSTINX1             2
GSTINX2             2
GSTINX3             1F
GSTINX4             1F
GSTINY1             2
GSTINY2             1F
GSTINY3             2
GSTINY4             1F
GSTLAMO             17A7C
GSTPLOT             1728
GSTPOSMV            17A7D
GSTPOSX             17A74
GSTPOSY             17A76
GSTRAD              8
GSTRNG              10
GSTSPEED            2
GSTSPEED2           5
GSTTARG             17A80
GSTUPD              143A
GSTUPD:2MLAMOX      1566
GSTUPD:2MLAMOY      1578
GSTUPD:GST2MOVES    153E
GSTUPD:GSTDECISSION  1506
GSTUPD:GSTDONE      16A2
GSTUPD:GSTDOWNMOVE  165A
GSTUPD:GSTINRNG     1464
GSTUPD:GSTLEFTMOVE  1626
GSTUPD:GSTMOVE      1470
GSTUPD:GSTMULT      149E
GSTUPD:GSTMULTDOWN  14DA
GSTUPD:GSTMULTLEFT  14C4
GSTUPD:GSTMULTRIGHT  14AE
GSTUPD:GSTMULTUP    14F0
GSTUPD:GSTNOTCOLISION  1604
GSTUPD:GSTNOTCOLISION2  1638
GSTUPD:GSTNOTCOLISION3  166C
GSTUPD:GSTNOTCOLISION4  1690
GSTUPD:GSTNOTINRNG  1450
GSTUPD:GSTNOTMULT   15CA
GSTUPD:GSTNOTTP     1614
GSTUPD:GSTNOTTP2    1648
GSTUPD:GSTRANDOWN   15AA
GSTUPD:GSTRANLEFT   159A
GSTUPD:GSTRANRIGHT  158A
GSTUPD:GSTRANUP     15BA
GSTUPD:GSTRIGHTMOVE  15F2
GSTUPD:GSTUPMOVE    167E
GSTVELX             17A78
GSTVELY             17A7A
IMGPLOT             22C2
INSINIT             233E
INSPLOT             2342
INSPLOT:DONE        2366
INSPLOT:LOOP        2358
INSPLOT:TXT1        236C
INSPLOT:TXT2        2396
INSPLOT:TXT3        23CB
INSPLOT:TXT4        23F8
INSPLOT:TXT5        2413
INSPLOT:TXT6        2446
INSPLOT:TXT7        244A
INSPLOT:TXT8        2475
INSPLOT:TXT9        2490
INSPLOT:TXTLST      24B4
INSUPD              2340
ISCINIT             222A
ISCPLOT             224E
ISCPLOT:DONE        2274
ISCPLOT:TXT1        227A
ISCPLOT:TXT2        2288
ISCTIMER            17A86
ISCUPD              2238
ISCUPD:CONT         224C
ISCUPD:DONE         224C
KBDDOWN             28
KBDEDGE             2675
KBDFIRE1            20
KBDFIRE2            4D
KBDFIRE3            10
KBDINIT             1C6A
KBDLEFT             25
KBDPAUSE            50
KBDRIGHT            27
KBDUP               26
KBDUPD              1C78
KBDUPD:CONVERT      1CC0
KBDUPD:LOOP         1CC4
KBDUPD:NOACT        1CBA
KBDVAL              2674
MAPINIT             1F26
MAPMAT              1008
MAPPLOT             1FA0
MAPVAR              2678
NOTPOINT            1F80
NOTPOINT2           1FF4
NOTWALL             1F72
NOTWALL2            1FE6
OPENFILE            22A4
PMEAT               17A72
PMFCOL              FFFF
PMINIT              1792
PMLAMO              17A73
PMPCOL              FFFF
PMPLOT              1932
PMPLOT:DDONE        19EE
PMPLOT:DDOWN        19C0
PMPLOT:DLEFT        19B6
PMPLOT:DOWNDRAW     1AAE
PMPLOT:DRAW_MOUTH1  19CA
PMPLOT:DRAW_MOUTH2  19D4
PMPLOT:DRAW_MOUTH3  19DE
PMPLOT:DRAW_MOUTH4  19E8
PMPLOT:DRIGHT       19A2
PMPLOT:DUP          19AC
PMPLOT:FULLDRAW     19F4
PMPLOT:LEFTDRAW     1A18
PMPLOT:MOUTHOPEN    1960
PMPLOT:NOTMOVE      1998
PMPLOT:RIGHTDRAW    1A4A
PMPLOT:SET_MOUTHDOWN  1B3A
PMPLOT:SET_MOUTHLEFT  1AE0
PMPLOT:SET_MOUTHRIGHT  1AFE
PMPLOT:SET_MOUTHUP  1B1C
PMPLOT:UPDRAW       1A7C
PMPOSX              17A6A
PMPOSY              17A6C
PMRAD               8
PMSPEED             2
PMUPD               17C6
PMUPD:ACTXLEFT      188C
PMUPD:ACTXRIGHT     1858
PMUPD:ACTYDOWN      18C0
PMUPD:ACTYUP        18E4
PMUPD:DONE          1920
PMUPD:NOTCOLISION   1872
PMUPD:NOTCOLISION2  18A6
PMUPD:NOTCOLISION3  18DA
PMUPD:NOTCOLISION4  18FE
PMUPD:NOTDOWN       1854
PMUPD:NOTLEFT       1812
PMUPD:NOTMULT       1908
PMUPD:NOTRIGHT      1828
PMUPD:NOTTP         1882
PMUPD:NOTTP2        18B6
PMUPD:NOTUP         183E
PMVELX              17A6E
PMVELY              17A70
POSCON              2A78
SCOFCOL             0
SCOINIT             1B58
SCOLIFE             17A82
SCOLINE1            101
SCOLINE2            102
SCOPLOT             1B68
SCOPLOT:TXT1        1BB6
SCOPLOT:TXT2        1BBF
SCOPOINTS           17A84
SCRCYCCT            2677
SCRHEIGH            280
SCRINIT             1BFE
SCRINTCT            2676
SCRTIM              1C5C
SCRUPD              1C42
SCRWIDTH            280
STACUR              17A88
STAEMPTY            261E
STAINIT             259C
STANEXT             17A8A
STANONE             FFFFFFFF
STAPLOT             25FA
STAPLOT:PLTTBL      2616
START               2648
START:LOOP          2654
START:WAITINIT      265A
STAUPD              25AC
STAUPD:DOUPD        25D2
STAUPD:INITBL       25EA
STAUPD:UPDTBL       25F2
SYSINIT             1BD2
UTLCHRWD            8
UTLINIT             20C4
UTLPRINT            20DA
UTLPRINT:ENDLOOP    20EC
UTLPRINT:LOOP       20E2
UTLRAND             210C
UTLRAND:RANDVEC     212A
UTLRNDIX            17A8C
WININIT             24DC
WINPLOT             24E0
WINPLOT:DONE        2514
WINPLOT:TXT1        251A
WINPLOT:TXT2        2523
WINUPD              24DE
ZERO                1F8E
ZERO2               2002
ZERO3               22F8
