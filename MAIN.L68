00001CBA Starting Address
Assembler used: EASy68K Editor/Assembler v5.16.01
Created On: 15/12/2022 23:45:34

00000000                             1  ; ==============================================================================
00000000                             2  ; TITLE       : PAC-MAN 68000
00000000                             3  ; DESCRIPTION : GAME IN MOTOROLA 68000 BASED ON PAC-MAN GAME
00000000                             4  ; AUTHOR      : JORDI FLORIT ENSENYAT
00000000                             5  ;               JOSEP GABRIEL FORNES REYNES
00000000                             6  ;               PAU GIRON RODRIGUEZ
00000000                             7  ; ==============================================================================
00001000                             8              ORG    $1000
00001000                             9  
00001000                            10              INCLUDE "CONST.X68"
00001000                            11  ; ==============================================================================
00001000                            12  ; GAME CONSTANTS
00001000                            13  ; ==============================================================================
00001000                            14  
00001000                            15  ; --- PAC-MAN RELATED CONTANTS ----------------------------------------------------
00001000                            16  
00001000  =0000FFFF                 17  PMPCOL      EQU     $0000FFFF               ; PAC-MAN CONTOUR COLOR
00001000  =0000FFFF                 18  PMFCOL      EQU     $0000FFFF               ; PAC-MAN FILL COLOR
00001000  =00000002                 19  PMSPEED     EQU     2                       ; MAGNITUDE OF THE X AND Y VEL.
00001000  =00000008                 20  PMRAD       EQU     8                       ; PAC-MAN RADIUS
00001000                            21  
00001000                            22  ; --- GHOST RELATED CONSTANTS ----------------------------------------------------
00001000                            23  
00001000  =00000007                 24  GSTSPEED    EQU     7                       ; MAGNITUDE OF THE NORMAL DISPLACEMENT
00001000  =00000005                 25  GSTSPEED2   EQU     5                       ; MAGNITUDE OF THE ATACKED DISPLACEMENT
00001000                            26  
00001000  =000000FF                 27  GSTCOL1     EQU     $000000FF               ; GHOST 1 CONTOUR COLOR RED
00001000  =00FFFFFF                 28  GSTFCOL1    EQU     $00FFFFFF               ; GHOST 1 FILL COLOR WHITE
00001000  =00000002                 29  GSTINX1     EQU     2                       ; GHOST 1 INITIAL X
00001000  =00000002                 30  GSTINY1     EQU     2                       ; GHOST 1 INITIAL Y
00001000                            31  
00001000  =00FF0080                 32  GSTCOL2     EQU     $00FF0080               ; GHOST 2 CONTOUR COLOR PINK
00001000  =00000000                 33  GSTFCOL2    EQU     $00000000               ; GHOST 1 FILL COLOR
00001000  =00000002                 34  GSTINX2     EQU     2                       ; GHOST 2 INITIAL X
00001000  =0000001F                 35  GSTINY2     EQU     31                      ; GHOST 2 INITIAL Y
00001000                            36  
00001000  =00FFFF00                 37  GSTCOL3     EQU     $00FFFF00               ; GHOST 3 CONTOUR COLOR CYAN
00001000  =00000000                 38  GSTFCOL3    EQU     $00000000               ; GHOST 3 FILL COLOR
00001000  =0000001F                 39  GSTINX3     EQU     31                      ; GHOST 3 INITIAL X
00001000  =00000002                 40  GSTINY3     EQU     2                       ; GHOST 3 INITIAL Y
00001000                            41  
00001000  =000080FF                 42  GSTCOL4     EQU     $000080FF               ; GHOST 4 CONTOUR COLOR ORANGE
00001000  =00000000                 43  GSTFCOL4    EQU     $00000000               ; GHOST 4 FILL COLOR
00001000  =0000001F                 44  GSTINX4     EQU     31                      ; GHOST 4 INITIAL X
00001000  =0000001F                 45  GSTINY4     EQU     31                      ; GHOST 4 INITIAL Y 
00001000                            46  
00001000  =00800000                 47  GSTCOL5     EQU     $00800000               ; CONTOUR COLOR OF ATACKED MODE
00001000  =00000000                 48  GSTFCOL5    EQU     $00000000               ; FILL COLOR OF ATACKED MODE
00001000                            49  
00001000  =00000008                 50  GSTRAD      EQU     8                       ; GHOST RADIUS
00001000  =00000010                 51  GSTRNG      EQU     16                      ; GHOST DETECTING RANGE
00001000                            52              
00001000                            53  ; --- SCOREBOARD RELATED CONSTANTS ---------------------------------------------
00001000                            54  ;MODIFICATE
00001000                            55  
00001000  =00000000                 56  SCOFCOL     EQU     $00000000               ; TEXT BACKGROUND COLOR
00001000  =00000101                 57  SCOLINE1    EQU     $0101                   ; FIRST TEXT LINE COORDINATES
00001000  =00000102                 58  SCOLINE2    EQU     $0102                   ; SECOND TEXT LINE COORDINATES
00001000                            59  
00001000                            60  ; --- MAP RELATED CONSTANTS ----------------------------------------------------
00001000                            61  
00001000= 01 01 01 01 01 01 ...     62  MAPMAT      DC.B    $1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
00001020= 01 02 02 02 02 02 ...     63              DC.B    $1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1
00001040= 01 02 01 01 01 01 ...     64              DC.B    $1,2,1,1,1,1,1,2,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,2,1,1,1,1,1,2,1
00001060= 01 03 01 01 01 01 ...     65              DC.B    $1,3,1,1,1,1,1,2,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,2,1,1,1,1,1,3,1
00001080= 01 02 02 02 02 02 ...     66              DC.B    $1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1
000010A0= 01 02 01 01 01 01 ...     67              DC.B    $1,2,1,1,1,1,1,2,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,2,1,1,1,1,1,2,1
000010C0= 01 02 01 01 01 01 ...     68              DC.B    $1,2,1,1,1,1,1,2,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,2,1,1,1,1,1,2,1
000010E0= 01 02 02 02 02 02 ...     69              DC.B    $1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1
00001100= 01 02 01 01 01 01 ...     70              DC.B    $1,2,1,1,1,1,1,2,1,1,1,2,1,1,1,1,1,1,1,1,2,1,1,1,2,1,1,1,1,1,2,1
00001120= 01 02 01 00 00 00 ...     71              DC.B    $1,2,1,0,0,0,1,2,1,0,1,2,1,1,1,1,1,1,1,1,2,1,0,1,2,1,0,0,0,1,2,1
00001140= 01 02 01 01 01 01 ...     72              DC.B    $1,2,1,1,1,1,1,2,1,0,1,2,2,2,2,1,1,2,2,2,2,1,0,1,2,1,1,1,1,1,2,1
00001160= 01 02 02 02 02 02 ...     73              DC.B    $1,2,2,2,2,2,2,2,1,0,1,1,1,1,2,1,1,2,1,1,1,1,0,1,2,2,2,2,2,2,2,1
00001180= 01 01 01 01 01 01 ...     74              DC.B    $1,1,1,1,1,1,1,2,1,0,1,1,1,1,2,1,1,2,1,1,1,1,0,1,2,1,1,1,1,1,1,1
000011A0= 01 00 00 00 00 00 ...     75              DC.B    $1,0,0,0,0,0,1,2,1,0,1,0,0,0,0,0,0,0,0,0,0,1,0,1,2,1,0,0,0,0,0,1
000011C0= 01 00 00 00 00 00 ...     76              DC.B    $1,0,0,0,0,0,1,2,1,0,1,0,1,1,1,0,0,1,1,1,0,1,0,1,2,1,0,0,0,0,0,1
000011E0= 01 01 01 01 01 01 ...     77              DC.B    $1,1,1,1,1,1,1,2,1,1,1,0,1,0,0,0,0,0,0,1,0,1,1,1,2,1,1,1,1,1,1,1
00001200= 04 00 00 00 00 00 ...     78              DC.B    $4,0,0,0,0,0,0,2,2,2,2,0,1,0,0,0,0,0,0,1,0,2,2,2,2,0,0,0,0,0,0,4
00001220= 01 01 01 01 01 01 ...     79              DC.B    $1,1,1,1,1,1,1,2,1,1,1,0,1,0,0,0,0,0,0,1,0,1,1,1,2,1,1,1,1,1,1,1
00001240= 01 00 00 00 00 00 ...     80              DC.B    $1,0,0,0,0,0,1,2,1,0,1,0,1,1,1,1,1,1,1,1,0,1,0,1,2,1,0,0,0,0,0,1
00001260= 01 00 00 00 00 00 ...     81              DC.B    $1,0,0,0,0,0,1,2,1,0,1,0,0,0,0,0,0,0,0,0,0,1,0,1,2,1,0,0,0,0,0,1
00001280= 01 01 01 01 01 01 ...     82              DC.B    $1,1,1,1,1,1,1,2,1,1,1,0,1,1,1,1,1,1,1,1,0,1,1,1,2,1,1,1,1,1,1,1
000012A0= 01 02 02 02 02 02 ...     83              DC.B    $1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1
000012C0= 01 02 01 01 01 01 ...     84              DC.B    $1,2,1,1,1,1,1,2,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,2,1,1,1,1,1,2,1
000012E0= 01 02 01 01 01 01 ...     85              DC.B    $1,2,1,1,1,1,1,2,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,2,1,1,1,1,1,2,1
00001300= 01 02 02 02 02 01 ...     86              DC.B    $1,2,2,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,2,2,2,1
00001320= 01 01 01 01 02 01 ...     87              DC.B    $1,1,1,1,2,1,1,2,1,1,1,2,1,1,1,1,1,1,1,1,2,1,1,1,2,1,1,2,1,1,1,1
00001340= 01 01 01 01 02 01 ...     88              DC.B    $1,1,1,1,2,1,1,2,1,0,1,2,1,1,1,1,1,1,1,1,2,1,0,1,2,1,1,2,1,1,1,1
00001360= 01 02 02 02 02 02 ...     89              DC.B    $1,2,2,2,2,2,2,2,1,0,1,2,2,2,2,1,1,2,2,2,2,1,0,1,2,2,2,2,2,2,2,1
00001380= 01 02 01 01 01 01 ...     90              DC.B    $1,2,1,1,1,1,1,1,1,0,1,1,1,1,2,1,1,2,1,1,1,1,0,1,1,1,1,1,1,1,2,1
000013A0= 01 03 01 01 01 01 ...     91              DC.B    $1,3,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,3,1
000013C0= 01 02 02 02 02 02 ...     92              DC.B    $1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1
000013E0= 01 01 01 01 01 01 ...     93              DC.B    $1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
00001400                            94  
00001400                            95  
00001400                            96  
00001400                            97  
00001400                            98  
00001400                            99  
00001400                           100  
00001400                           101  
00001400                           102  
00001400                           103  
00001400                           104  
00001400                           105  
00001400                           106  
00001400                           107  
00001400                           108  
00001400                           109  
00001400                           110  
00001400                           111  
00001400                           112  
00001400                           113  
00001400                           114  
00001400                           115  -------------------- end include --------------------
00001400                           116              INCLUDE "GHOST.X68"
00001400                           117  ; ==============================================================================
00001400                           118  ; GHOST MANAGEMENT
00001400                           119  ; ==============================================================================
00001400                           120              
00001400                           121  ; ------------------------------------------------------------------------------
00001400                           122  GSTINIT
00001400                           123  ; INITIALIZE GHOST.
00001400                           124  ; INPUT    : NONE 
00001400                           125  ; OUTPUT   : NONE
00001400                           126  ; MODIFIES : NONE
00001400                           127  ; ------------------------------------------------------------------------------
00001400  33FC 0058 0000210E       128              MOVE.W  #GSTINX1*16+64-8,(GSTPOSX)
00001408  33FC 0058 00002110       129              MOVE.W  #GSTINY1*16+64-8,(GSTPOSY)
00001410  33FC 0007 00002112       130              MOVE.W  #GSTSPEED,(GSTVELX)
00001418  33FC 0007 00002114       131              MOVE.W  #GSTSPEED,(GSTVELY)
00001420  4239 00002117            132              CLR.B   (GSTLAMO)
00001426  4E75                     133              RTS
00001428                           134              
00001428                           135  ; ------------------------------------------------------------------------------
00001428                           136  GSTUPD
00001428                           137  ; UPDATES THE GHOST.
00001428                           138  ; INPUT    : NONE 
00001428                           139  ; OUTPUT   : NONE
00001428                           140  ; MODIFIES : NONE
00001428                           141  ; ------------------------------------------------------------------------------
00001428  48E7 F800                142              MOVEM.L D0-D4,-(A7)
0000142C                           143              
0000142C  303C 0007                144              MOVE.W  #GSTSPEED,D0
00001430                           145              
00001430  3439 0000210E            146              MOVE.W  (GSTPOSX),D2
00001436  3639 00002110            147              MOVE.W  (GSTPOSY),D3
0000143C  5042                     148              ADDQ.W  #8,D2
0000143E  5043                     149              ADDQ.W  #8,D3
00001440                           150              
00001440  1839 00002117            151              MOVE.B  (GSTLAMO),D4
00001446                           152              
00001446                           153              ;MASK OF THE LAST NIBBLE
00001446  C47C 000F                154              AND.W   #$000F,D2
0000144A  C67C 000F                155              AND.W   #$000F,D3
0000144E                           156              
0000144E                           157              ;CHECK IF COORDS ARE MULTIPLES OF 16
0000144E  B47C 0000                158              CMP     #$0000,D2
00001452  6600 000A                159              BNE     .GSTNOTMULT
00001456  B67C 0000                160              CMP     #$0000,D3
0000145A  6600 0002                161              BNE     .GSTNOTMULT
0000145E                           162              
0000145E                           163  .GSTNOTMULT
0000145E                           164  
0000145E  4CDF 001F                165              MOVEM.L (A7)+,D0-D4
00001462                           166              
00001462  4E75                     167              RTS
00001464                           168              
00001464                           169  ; ------------------------------------------------------------------------------
00001464                           170  GSTPLOT
00001464                           171  ; PLOT THE GHOST.
00001464                           172  ; INPUT    : NONE 
00001464                           173  ; OUTPUT   : NONE
00001464                           174  ; MODIFIES : NONE
00001464                           175  ; ------------------------------------------------------------------------------
00001464  48E7 F800                176              MOVEM.L D0-D4,-(A7)
00001468                           177              
00001468                           178              ;SET PEN COLOR
00001468  303C 0050                179              MOVE.W  #80,D0
0000146C  223C 000000FF            180              MOVE.L  #GSTCOL1,D1
00001472  4E4F                     181              TRAP    #15
00001474                           182              
00001474                           183              ;SET FILL COLOR
00001474  303C 0051                184              MOVE.W  #81,D0
00001478  223C 00FFFFFF            185              MOVE.L  #GSTFCOL1,D1
0000147E  4E4F                     186              TRAP    #15
00001480                           187              
00001480                           188              ;SET COORDS
00001480  3239 0000210E            189              MOVE.W  (GSTPOSX),D1
00001486  5141                     190              SUB.W   #GSTRAD,D1
00001488  3439 00002110            191              MOVE.W  (GSTPOSY),D2
0000148E  5142                     192              SUB.W   #GSTRAD,D2
00001490                           193              
00001490  3601                     194              MOVE.W  D1,D3
00001492  0643 0010                195              ADD.W   #GSTRAD*2,D3
00001496  3802                     196              MOVE.W  D2,D4
00001498  0644 0010                197              ADD.W   #GSTRAD*2,D4
0000149C                           198              
0000149C                           199              ;DRAW GHOST
0000149C  303C 0058                200              MOVE.W  #88,D0
000014A0  4E4F                     201              TRAP    #15
000014A2                           202              
000014A2                           203              ;SET RANGE COORDS
000014A2  3239 0000210E            204              MOVE.W  (GSTPOSX),D1
000014A8  0441 0100                205              SUB.W   #GSTRNG*16,D1
000014AC  3439 00002110            206              MOVE.W  (GSTPOSY),D2
000014B2  0442 0100                207              SUB.W   #GSTRNG*16,D2
000014B6                           208              
000014B6  3601                     209              MOVE.W  D1,D3
000014B8  0643 0200                210              ADD.W   #GSTRNG*16*2,D3
000014BC  3802                     211              MOVE.W  D2,D4
000014BE  0644 0200                212              ADD.W   #GSTRNG*16*2,D4
000014C2                           213              
000014C2                           214              ;DRAW GHOST RANGE
000014C2  303C 005B                215              MOVE.W  #91,D0
000014C6  4E4F                     216              TRAP    #15
000014C8                           217              
000014C8  4CDF 001F                218              MOVEM.L (A7)+,D0-D4
000014CC                           219              
000014CC                           220  
000014CC  4E75                     221              RTS
000014CE                           222  
000014CE                           223  
000014CE                           224  
000014CE                           225  
000014CE                           226  
000014CE                           227  -------------------- end include --------------------
000014CE                           228              INCLUDE "PAC-MAN.X68"
000014CE                           229  ; ==============================================================================
000014CE                           230  ; PAC-MAN MANAGEMENT
000014CE                           231  ; ==============================================================================
000014CE                           232              
000014CE                           233  ; ------------------------------------------------------------------------------
000014CE                           234  PMINIT
000014CE                           235  ; INITIALIZE PAC-MAN.
000014CE                           236  ; INPUT    : NONE 
000014CE                           237  ; OUTPUT   : NONE
000014CE                           238  ; MODIFIES : NONE
000014CE                           239  ; ------------------------------------------------------------------------------
000014CE                           240  
000014CE  33FC 0140 00002104       241              MOVE.W  #SCRWIDTH/2,(PMPOSX)
000014D6  33FC 0140 00002106       242              MOVE.W  #SCRHEIGH/2,(PMPOSY)
000014DE  5079 00002104            243              ADDQ.W  #8,(PMPOSX)
000014E4  5079 00002106            244              ADDQ.W  #8,(PMPOSY)
000014EA  33FC 0002 00002108       245              MOVE.W  #PMSPEED,(PMVELX)
000014F2  33FC 0002 0000210A       246              MOVE.W  #PMSPEED,(PMVELY)
000014FA  4239 0000210D            247              CLR.B   (PMLAMO)
00001500                           248  
00001500  4E75                     249              RTS
00001502                           250              
00001502                           251  ; ------------------------------------------------------------------------------
00001502                           252  PMUPD
00001502                           253  ; UPDATES THE PAC-MAN.
00001502                           254  ; INPUT    : NONE 
00001502                           255  ; OUTPUT   : NONE
00001502                           256  ; MODIFIES : NONE
00001502                           257  ; ------------------------------------------------------------------------------
00001502                           258              
00001502  48E7 FE00                259              MOVEM.L D0-D6,-(A7)
00001506                           260              
00001506  303C 0002                261              MOVE.W  #PMSPEED,D0
0000150A                           262              
0000150A                           263              
0000150A  3439 00002104            264              MOVE.W  (PMPOSX),D2
00001510  3639 00002106            265              MOVE.W  (PMPOSY),D3
00001516                           266              
00001516  5042                     267              ADDQ.W  #8,D2              
00001518  5043                     268              ADDQ.W  #8,D3  
0000151A                           269              
0000151A  1839 0000210D            270              MOVE.B  (PMLAMO),D4
00001520                           271              
00001520                           272              ;MASK OF THE LAST NIBBLE        
00001520  C47C 000F                273              AND.W   #$000F,D2               ; COORDENADA X
00001524  C67C 000F                274              AND.W   #$000F,D3               ; COORDENADA Y
00001528                           275              
00001528                           276              ;CHECK IF COORDS ARE MULTIPLES OF 16
00001528  B47C 0000                277              CMP     #$0000,D2
0000152C  6600 00F6                278              BNE     .NOTMULT
00001530  B67C 0000                279              CMP     #$0000,D3
00001534  6600 00EE                280              BNE     .NOTMULT
00001538                           281              
00001538                           282              ;BRA     .ACTYUP
00001538                           283  
00001538                           284              ;CHECK THE DIRECTION
00001538  0839 0000 00001CFE       285              BTST.B  #0,(KBDVAL)             ;CHECK LEFT
00001540  6700 000C                286              BEQ     .NOTLEFT
00001544  4204                     287              CLR.B   D4
00001546  183C 0000                288              MOVE.B  #0,D4
0000154A  6000 0074                289              BRA     .ACTXLEFT
0000154E                           290  .NOTLEFT            
0000154E  0839 0002 00001CFE       291              BTST.B   #2,(KBDVAL)             ;CHECK RIGHT
00001556  6700 000C                292              BEQ     .NOTRIGHT
0000155A  4204                     293              CLR.B   D4
0000155C  183C 0001                294              MOVE.B   #1,D4
00001560  6000 0032                295              BRA     .ACTXRIGHT
00001564                           296  .NOTRIGHT            
00001564  0839 0001 00001CFE       297              BTST.B   #1,(KBDVAL)             ;CHECK UP
0000156C  6700 000C                298              BEQ     .NOTUP
00001570  4204                     299              CLR.B   D4
00001572  183C 0002                300              MOVE.B  #2,D4
00001576  6000 0090                301              BRA     .ACTYUP
0000157A                           302  .NOTUP            
0000157A  0839 0003 00001CFE       303              BTST.B   #3,(KBDVAL)             ;CHECK DOWN
00001582  6700 000C                304              BEQ     .NOTDOWN
00001586  4204                     305              CLR.B   D4
00001588  183C 0003                306              MOVE.B   #3,D4
0000158C  6000 005E                307              BRA     .ACTYDOWN
00001590                           308  .NOTDOWN
00001590  6000 00A8                309              BRA     .DONE
00001594                           310              
00001594                           311              
00001594                           312              ;UPDATE COORDS
00001594                           313              
00001594                           314  .ACTXRIGHT  
00001594  4EB9 000019AA            315              JSR     COLWALLRIGHT
0000159A  BA7C 0001                316              CMP     #1,D5
0000159E  6600 0006                317              BNE     .NOTCOLISION
000015A2  303C 0000                318              MOVE.W  #0,D0
000015A6                           319  .NOTCOLISION
000015A6  BA7C 0004                320              CMP     #4,D5
000015AA  6600 000A                321              BNE     .NOTTP
000015AE  0479 01E0 00002104       322              SUB.W   #30*16,(PMPOSX)
000015B6                           323  .NOTTP
000015B6  D179 00002104            324              ADD.W   D0,(PMPOSX)
000015BC  6000 007C                325              BRA     .DONE
000015C0                           326  .ACTXLEFT
000015C0  4EB9 000019EC            327              JSR     COLWALLLEFT
000015C6  BA7C 0001                328              CMP     #1,D5
000015CA  6600 0006                329              BNE     .NOTCOLISION2
000015CE  303C 0000                330              MOVE.W  #0,D0
000015D2                           331  .NOTCOLISION2
000015D2  BA7C 0004                332              CMP     #4,D5
000015D6  6600 000A                333              BNE     .NOTTP2
000015DA  0679 01E0 00002104       334              ADD.W   #30*16,(PMPOSX)
000015E2                           335  .NOTTP2
000015E2  9179 00002104            336              SUB.W   D0,(PMPOSX)
000015E8  6000 0050                337              BRA     .DONE
000015EC                           338      
000015EC                           339  .ACTYDOWN
000015EC  4EB9 00001A2E            340              JSR     COLWALLDOWN
000015F2  BA7C 0001                341              CMP     #1,D5
000015F6  6600 0006                342              BNE     .NOTCOLISION3
000015FA  303C 0000                343              MOVE.W  #0,D0
000015FE                           344  .NOTCOLISION3
000015FE  D179 00002106            345              ADD.W   D0,(PMPOSY)
00001604  6000 0034                346              BRA     .DONE
00001608                           347  .ACTYUP     
00001608  4EB9 00001A6A            348              JSR     COLWALLUP
0000160E  BA7C 0001                349              CMP     #1,D5
00001612  6600 0006                350              BNE     .NOTCOLISION4
00001616  303C 0000                351              MOVE.W  #0,D0
0000161A                           352  .NOTCOLISION4
0000161A  9179 00002106            353              SUB.W   D0,(PMPOSY)
00001620  6000 0018                354              BRA     .DONE
00001624                           355              
00001624                           356              
00001624                           357              ;IF NOT MULT DO
00001624                           358  .NOTMULT     
00001624  B83C 0000                359              CMP.B     #0,D4
00001628  6796                     360              BEQ     .ACTXLEFT
0000162A  B83C 0001                361              CMP.B     #1,D4
0000162E  6700 FF64                362              BEQ     .ACTXRIGHT
00001632  B83C 0002                363              CMP.B     #2,D4
00001636  67D0                     364              BEQ     .ACTYUP
00001638  60B2                     365              BRA     .ACTYDOWN
0000163A                           366  .DONE
0000163A                           367              ;RESTORE
0000163A  4EB9 00001AA8            368              JSR     GETPOINTS
00001640  13C4 0000210D            369              MOVE.B  D4,(PMLAMO)
00001646                           370              
00001646  4CDF 007F                371              MOVEM.L (A7)+,D0-D6
0000164A                           372              
0000164A  4E75                     373              RTS
0000164C                           374                          
0000164C                           375  ; ------------------------------------------------------------------------------
0000164C                           376  PMPLOT
0000164C                           377  ; PLOT THE BALL.
0000164C                           378  ; INPUT    : NONE 
0000164C                           379  ; OUTPUT   : NONE
0000164C                           380  ; MODIFIES : NONE
0000164C                           381  ; ------------------------------------------------------------------------------
0000164C                           382  
0000164C  48E7 F800                383              MOVEM.L D0-D4,-(A7)
00001650                           384  
00001650                           385              ;SET PEN COLOR
00001650  303C 0050                386              MOVE.W  #80,D0
00001654  7200                     387              MOVE.L  #$0000,D1
00001656  4E4F                     388              TRAP    #15
00001658                           389              
00001658                           390              ;SET FILL COLOR
00001658  303C 0051                391              MOVE.W  #81,D0
0000165C  223C 0000FFFF            392              MOVE.L  #PMFCOL,D1
00001662  4E4F                     393              TRAP    #15
00001664                           394              
00001664                           395              ;DRAW QUIET
00001664  4EB9 000016EC            396              JSR     .FULLDRAW
0000166A                           397              
0000166A                           398              ;CHECK KBDVAL
0000166A                           399              
0000166A  0839 0000 00001CFE       400              BTST.B  #0,(KBDVAL)             ;LEFT
00001672  6700 0026                401              BEQ     .DLEFT
00001676  0839 0001 00001CFE       402              BTST.B  #1,(KBDVAL)             :UP
0000167E  6700 0024                403              BEQ     .DUP
00001682  0839 0002 00001CFE       404              BTST.B  #2,(KBDVAL)             ;RIGHT
0000168A  6700 0022                405              BEQ     .DRIGHT
0000168E  0839 0003 00001CFE       406              BTST.B  #3,(KBDVAL)             ;DOWN
00001696  6700 0020                407              BEQ     .DDOWN
0000169A                           408              
0000169A                           409              ;DRAW MOVEMENT
0000169A                           410  .DLEFT
0000169A  4EB9 00001710            411              JSR     .LEFTDRAW
000016A0  6000 0020                412              BRA     .DRAW_MOUTH1
000016A4                           413  .DUP
000016A4  4EB9 00001774            414              JSR     .UPDRAW
000016AA  6000 0020                415              BRA     .DRAW_MOUTH2
000016AE                           416  
000016AE                           417  .DRIGHT
000016AE  4EB9 00001742            418              JSR     .RIGHTDRAW
000016B4  6000 0020                419              BRA     .DRAW_MOUTH3
000016B8                           420  
000016B8                           421  .DDOWN
000016B8  4EB9 000017A6            422              JSR     .DOWNDRAW
000016BE  6000 0020                423              BRA     .DRAW_MOUTH4
000016C2                           424              
000016C2                           425  .DRAW_MOUTH1            
000016C2  4EB9 000017D8            426              JSR     .SET_MOUTHLEFT
000016C8  6000 001C                427              BRA     .DDONE
000016CC                           428  .DRAW_MOUTH2            
000016CC  4EB9 00001814            429              JSR     .SET_MOUTHUP
000016D2  6000 0012                430              BRA     .DDONE
000016D6                           431  .DRAW_MOUTH3            
000016D6  4EB9 000017F6            432              JSR     .SET_MOUTHRIGHT
000016DC  6000 0008                433              BRA     .DDONE
000016E0                           434  .DRAW_MOUTH4            
000016E0  4EB9 00001832            435              JSR     .SET_MOUTHDOWN
000016E6                           436  .DDONE
000016E6  4CDF 001F                437              MOVEM.L (A7)+,D0-D4
000016EA                           438              
000016EA  4E75                     439              RTS
000016EC                           440  
000016EC                           441  
000016EC                           442  ;INTERNAL SUBRUTINES FOR PACMAN PLOT-------------------------------------------------------------
000016EC                           443  
000016EC                           444  .FULLDRAW
000016EC                           445              ;SET COORDS
000016EC  3239 00002104            446              MOVE.W  (PMPOSX),D1
000016F2  5141                     447              SUB.W   #PMRAD,D1
000016F4  3439 00002106            448              MOVE.W  (PMPOSY),D2
000016FA  5142                     449              SUB.W   #PMRAD,D2
000016FC                           450              
000016FC  3601                     451              MOVE.W  D1,D3
000016FE  0643 0010                452              ADD.W   #PMRAD*2,D3
00001702  3802                     453              MOVE.W  D2,D4
00001704  0644 0010                454              ADD.W   #PMRAD*2,D4
00001708                           455              
00001708                           456              ;DRAW PAC-MAN
00001708  303C 0058                457              MOVE.W  #88,D0
0000170C  4E4F                     458              TRAP    #15
0000170E                           459              
0000170E  4E75                     460              RTS
00001710                           461  .LEFTDRAW
00001710                           462              
00001710                           463              
00001710  303C 0054                464              MOVE.W  #84,D0
00001714  3239 00002104            465              MOVE.W  (PMPOSX),D1                   ;FINAL COORD OF THE FIRST LINE
0000171A  5141                     466              SUB.W   #PMRAD,D1
0000171C  3439 00002106            467              MOVE.W  (PMPOSY),D2
00001722  5142                     468              SUB.W   #PMRAD,D2
00001724                           469              
00001724  3639 00002104            470              MOVE.W  (PMPOSX),D3                   ;ORIGINAL COORD FIRST LINE
0000172A  3839 00002106            471              MOVE.W  (PMPOSY),D4
00001730                           472              
00001730  4E4F                     473              TRAP    #15
00001732                           474             
00001732  303C 0055                475              MOVE.W  #85,D0                        ;DRAW SECOND LINE
00001736                           476              
00001736  3203                     477              MOVE.W  D3,D1
00001738  3404                     478              MOVE.W  D4,D2
0000173A  5042                     479              ADD.W   #PMRAD,D2
0000173C  5141                     480              SUB.W   #PMRAD,D1
0000173E                           481              
0000173E  4E4F                     482              TRAP    #15
00001740                           483              
00001740                           484              
00001740  4E75                     485              RTS
00001742                           486              
00001742                           487  .RIGHTDRAW
00001742                           488              
00001742                           489              
00001742  303C 0054                490              MOVE.W  #84,D0
00001746  3239 00002104            491              MOVE.W  (PMPOSX),D1                   ;FINAL COORD OF THE FIRST LINE
0000174C  5041                     492              ADD.W   #PMRAD,D1
0000174E  3439 00002106            493              MOVE.W  (PMPOSY),D2
00001754  5042                     494              ADD.W   #PMRAD,D2
00001756                           495              
00001756  3639 00002104            496              MOVE.W  (PMPOSX),D3                   ;ORIGINAL COORD FIRST LINE
0000175C  3839 00002106            497              MOVE.W  (PMPOSY),D4
00001762                           498              
00001762  4E4F                     499              TRAP    #15
00001764                           500             
00001764  303C 0055                501              MOVE.W  #85,D0                        ;DRAW SECOND LINE
00001768                           502              
00001768  3203                     503              MOVE.W  D3,D1
0000176A  3404                     504              MOVE.W  D4,D2
0000176C  5042                     505              ADD.W   #PMRAD,D2
0000176E  5041                     506              ADD.W   #PMRAD,D1
00001770                           507              
00001770  4E4F                     508              TRAP    #15
00001772                           509              
00001772                           510              
00001772  4E75                     511              RTS
00001774                           512  .UPDRAW
00001774                           513              
00001774                           514              
00001774  303C 0054                515              MOVE.W  #84,D0
00001778  3239 00002104            516              MOVE.W  (PMPOSX),D1                   ;FINAL COORD OF THE FIRST LINE
0000177E  5141                     517              SUB.W   #PMRAD,D1
00001780  3439 00002106            518              MOVE.W  (PMPOSY),D2
00001786  5142                     519              SUB.W   #PMRAD,D2
00001788                           520              
00001788  3639 00002104            521              MOVE.W  (PMPOSX),D3                   ;ORIGINAL COORD FIRST LINE
0000178E  3839 00002106            522              MOVE.W  (PMPOSY),D4
00001794                           523              
00001794  4E4F                     524              TRAP    #15
00001796                           525             
00001796  303C 0055                526              MOVE.W  #85,D0                        ;DRAW SECOND LINE
0000179A                           527              
0000179A  3203                     528              MOVE.W  D3,D1
0000179C  3404                     529              MOVE.W  D4,D2
0000179E  5142                     530              SUB.W   #PMRAD,D2
000017A0  5041                     531              ADD.W   #PMRAD,D1
000017A2                           532              
000017A2  4E4F                     533              TRAP    #15
000017A4                           534              
000017A4                           535              
000017A4  4E75                     536              RTS
000017A6                           537              
000017A6                           538  .DOWNDRAW
000017A6                           539              
000017A6                           540              
000017A6  303C 0054                541              MOVE.W  #84,D0
000017AA  3239 00002104            542              MOVE.W  (PMPOSX),D1                   ;FINAL COORD OF THE FIRST LINE
000017B0  5141                     543              SUB.W   #PMRAD,D1
000017B2  3439 00002106            544              MOVE.W  (PMPOSY),D2
000017B8  5142                     545              SUB.W   #PMRAD,D2
000017BA                           546              
000017BA  3639 00002104            547              MOVE.W  (PMPOSX),D3                   ;ORIGINAL COORD FIRST LINE
000017C0  3839 00002106            548              MOVE.W  (PMPOSY),D4
000017C6                           549              
000017C6  4E4F                     550              TRAP    #15
000017C8                           551             
000017C8  303C 0055                552              MOVE.W  #85,D0                        ;DRAW SECOND LINE
000017CC                           553              
000017CC  3203                     554              MOVE.W  D3,D1
000017CE  3404                     555              MOVE.W  D4,D2
000017D0  5042                     556              ADD.W   #PMRAD,D2
000017D2  5041                     557              ADD.W   #PMRAD,D1
000017D4                           558              
000017D4  4E4F                     559              TRAP    #15
000017D6                           560              
000017D6                           561              
000017D6  4E75                     562              RTS
000017D8                           563  
000017D8                           564              
000017D8                           565  .SET_MOUTHLEFT
000017D8                           566              
000017D8  303C 0051                567              MOVE.W  #81,D0                         ;SET BLACK
000017DC  7200                     568              MOVE.L  #$0000,D1
000017DE  4E4F                     569              TRAP    #15
000017E0                           570              
000017E0  303C 0059                571              MOVE.W  #89,D0                         ;FILL
000017E4  3239 00002104            572              MOVE.W  (PMPOSX),D1
000017EA  5541                     573              SUBQ.W   #2,D1
000017EC  3439 00002106            574              MOVE.W  (PMPOSY),D2
000017F2  4E4F                     575              TRAP    #15
000017F4                           576  
000017F4  4E75                     577              RTS
000017F6                           578              
000017F6                           579  .SET_MOUTHRIGHT
000017F6                           580              
000017F6  303C 0051                581              MOVE.W  #81,D0                         ;SET BLACK
000017FA  7200                     582              MOVE.L  #$0000,D1
000017FC  4E4F                     583              TRAP    #15
000017FE                           584              
000017FE  303C 0059                585              MOVE.W  #89,D0                         ;FILL
00001802  3239 00002104            586              MOVE.W  (PMPOSX),D1
00001808  5441                     587              ADDQ.W   #2,D1
0000180A  3439 00002106            588              MOVE.W  (PMPOSY),D2
00001810  4E4F                     589              TRAP    #15
00001812                           590  
00001812  4E75                     591              RTS
00001814                           592  
00001814                           593  .SET_MOUTHUP
00001814                           594              
00001814  303C 0051                595              MOVE.W  #81,D0                         ;SET BLACK
00001818  7200                     596              MOVE.L  #$0000,D1
0000181A  4E4F                     597              TRAP    #15
0000181C                           598              
0000181C  303C 0059                599              MOVE.W  #89,D0                         ;FILL
00001820  3239 00002104            600              MOVE.W  (PMPOSX),D1
00001826  3439 00002106            601              MOVE.W  (PMPOSY),D2
0000182C  5542                     602              SUBQ.W   #2,D2
0000182E  4E4F                     603              TRAP    #15
00001830                           604  
00001830  4E75                     605              RTS
00001832                           606  
00001832                           607  .SET_MOUTHDOWN
00001832                           608              
00001832  303C 0051                609              MOVE.W  #81,D0                         ;SET BLACK
00001836  7200                     610              MOVE.L  #$0000,D1
00001838  4E4F                     611              TRAP    #15
0000183A                           612              
0000183A  303C 0059                613              MOVE.W  #89,D0                         ;FILL
0000183E  3239 00002104            614              MOVE.W  (PMPOSX),D1
00001844  3439 00002106            615              MOVE.W  (PMPOSY),D2
0000184A  5442                     616              ADDQ.W   #2,D2
0000184C  4E4F                     617              TRAP    #15
0000184E                           618  
0000184E  4E75                     619              RTS
00001850                           620  
00001850                           621  
00001850                           622  
00001850                           623  
00001850                           624  
00001850                           625  
00001850                           626  
00001850                           627  
00001850                           628  
00001850                           629  
00001850                           630  
00001850                           631  
00001850                           632  
00001850                           633  
00001850                           634  
00001850                           635  
00001850                           636  
00001850                           637  
00001850                           638  
00001850                           639  
00001850                           640  
00001850                           641  
00001850                           642  
00001850                           643  
00001850                           644  
00001850                           645  
00001850                           646  -------------------- end include --------------------
00001850                           647              INCLUDE "SCORE.X68"
00001850                           648  ; ==============================================================================
00001850                           649  ; SCOREBOARD MANAGEMENT
00001850                           650  ; ==============================================================================
00001850                           651              
00001850                           652  ; ------------------------------------------------------------------------------
00001850                           653  SCOINIT
00001850                           654  ; INITIALIZE SCOREBOARD
00001850                           655  ; INPUT    : NONE 
00001850                           656  ; OUTPUT   : NONE
00001850                           657  ; MODIFIES : NONE
00001850                           658  ; ------------------------------------------------------------------------------
00001850  4279 0000211A            659              CLR.W   (SCOPOINTS)
00001856  33FC 0003 00002118       660              MOVE.W  #3,(SCOLIFE)
0000185E  4E75                     661              RTS
00001860                           662              
00001860                           663  ; ------------------------------------------------------------------------------
00001860                           664  SCOPLOT
00001860                           665  ; PLOT THE SCOREBOARD
00001860                           666  ; INPUT    : NONE 
00001860                           667  ; OUTPUT   : NONE
00001860                           668  ; MODIFIES : NONE
00001860                           669  ; ------------------------------------------------------------------------------
00001860                           670              
00001860  48E7 C040                671               MOVEM.L D0-D1/A1,-(A7)
00001864                           672  
00001864                           673              ; SET BACKGROUND COLOR
00001864  103C 0051                674              MOVE.B  #81,D0
00001868  7200                     675              MOVE.L  #SCOFCOL,D1
0000186A  4E4F                     676              TRAP    #15
0000186C                           677              
0000186C                           678              ; SET FIRST LINE POSITION
0000186C  103C 000B                679              MOVE.B  #11,D0
00001870  323C 0101                680              MOVE.W  #SCOLINE1,D1
00001874  4E4F                     681              TRAP    #15
00001876                           682  
00001876                           683              ; PRINT FIRST LINE
00001876  43F9 000018AE            684              LEA     .TXT1,A1            ;PUT FIRST STRING IN A1
0000187C  4281                     685              CLR.L   D1
0000187E  3239 0000211A            686              MOVE.W  (SCOPOINTS),D1
00001884  103C 0011                687              MOVE.B  #17,D0
00001888  4E4F                     688              TRAP    #15
0000188A                           689  
0000188A                           690              ; SET SECOND LINE POSITION
0000188A  103C 000B                691              MOVE.B  #11,D0
0000188E  323C 0102                692              MOVE.W  #SCOLINE2,D1       
00001892  4E4F                     693              TRAP    #15
00001894                           694  
00001894                           695              ; PRINT SECOND LINE
00001894  43F9 000018B7            696              LEA     .TXT2,A1
0000189A  4281                     697              CLR.L   D1
0000189C  3239 00002118            698              MOVE.W  (SCOLIFE),D1
000018A2  103C 0011                699              MOVE.B  #17,D0
000018A6  4E4F                     700              TRAP    #15
000018A8                           701              
000018A8  4CDF 0203                702              MOVEM.L (A7)+,D0-D1/A1
000018AC                           703              
000018AC  4E75                     704              RTS
000018AE                           705  
000018AE= 50 4F 49 4E 54 53 ...    706  .TXT1       DC.B    'POINTS :',0      ;0 IS END OF STRING
000018B7= 4C 49 46 45 53 20 ...    707  .TXT2       DC.B    'LIFES  :',0
000018C0                           708  
000018C0                           709  
000018C0  4E75                     710              RTS
000018C2                           711  
000018C2                           712  
000018C2                           713  -------------------- end include --------------------
000018C2                           714              INCLUDE "SYSCONST.X68"
000018C2                           715  ; ==============================================================================
000018C2                           716  ; SYSTEM CONSTANTS
000018C2                           717  ; ==============================================================================
000018C2                           718  
000018C2                           719  ; --- SCREEN RELATED CONSTANTS -------------------------------------------------
000018C2                           720  
000018C2  =00000280                721  SCRWIDTH    EQU     640                     ; SCREEN WIDTH
000018C2  =00000280                722  SCRHEIGH    EQU     640                     ; SCREEN HEIGHT
000018C2                           723  
000018C2                           724  ;---KEYCODES--------------------------------------------------------------------
000018C2                           725  
000018C2  =00000025                726  KBDLEFT     EQU     $25
000018C2  =00000026                727  KBDUP       EQU     $26
000018C2  =00000027                728  KBDRIGHT    EQU     $27
000018C2  =00000028                729  KBDDOWN     EQU     $28
000018C2  =00000020                730  KBDFIRE1    EQU     ' '
000018C2  =0000004D                731  KBDFIRE2    EQU     'M'                         
000018C2  =00000010                732  KBDFIRE3    EQU     $10
000018C2  =00000050                733  KBDPAUSE    EQU     'P'
000018C2                           734  
000018C2                           735  
000018C2                           736  
000018C2                           737  
000018C2                           738  
000018C2                           739  
000018C2                           740  
000018C2                           741  
000018C2                           742  
000018C2                           743  -------------------- end include --------------------
000018C2                           744              INCLUDE "SYSTEM.X68"
000018C2                           745  ; ==============================================================================
000018C2                           746  ; SYSTEM
000018C2                           747  ; ==============================================================================
000018C2                           748              
000018C2                           749  ; ------------------------------------------------------------------------------
000018C2                           750  SYSINIT
000018C2                           751  ; INITIALIZE SYSTEM.
000018C2                           752  ; INPUT    : NONE
000018C2                           753  ; OUTPUT   : NONE
000018C2                           754  ; MODIFIES : NONE
000018C2                           755  ; ------------------------------------------------------------------------------
000018C2                           756              
000018C2  21FC 00001932 0080       757              MOVE.L  #SCRUPD,($80+0*4)          ;INSTALL SUBRUTINE TO TRAP #0
000018CA  21FC 00001962 0084       758              MOVE.L  #KBDUPD,($80+1*4)          ;INSTALL SUBRUTINE TO TRAP #1
000018D2                           759              
000018D2                           760              
000018D2  21FC 0000194C 0064       761              MOVE.L  #SCRTIM,($60+1*4)          ;INSTALL INTERRUPT #1
000018DA                           762              
000018DA  4EB9 000018EE            763              JSR     SCRINIT
000018E0  4EB9 00001954            764              JSR     KBDINIT
000018E6                           765              
000018E6                           766              
000018E6  40E7                     767              MOVE.W  SR,-(A7)
000018E8  0257 D8FF                768              ANDI.W  #$D8FF,(A7)                ;BIT SUPERVISOR TO O AND INTERRPUT MASK 000 (FOR REACTIVATE INTERRUPTIONS)             
000018EC  4E73                     769              RTE
000018EE                           770     
000018EE                           771  ; ------------------------------------------------------------------------------
000018EE                           772  SCRINIT
000018EE                           773  ; INIT SCREEN. SET SCREEN RESOLUTION, SET WINDOWED MODE, CLEAR SCREEN, ENABLE BUFFER
000018EE                           774  ; ENABLE TIMED INTERRUPTION
000018EE                           775  ; INPUT    : NONE
000018EE                           776  ; OUTPUT   : NONE
000018EE                           777  ; MODIFIES : NONE
000018EE                           778  ; ------------------------------------------------------------------------------
000018EE                           779  
000018EE  48E7 C000                780              MOVEM.L D0-D1,-(A7)                 ;SAFE REGISTERS IN STACK
000018F2                           781  
000018F2                           782              ; SET SCREEN RESOLUTION
000018F2  103C 0021                783              MOVE.B  #33,D0
000018F6  223C 02800280            784              MOVE.L  #SCRWIDTH<<16|SCRHEIGH,D1
000018FC  4E4F                     785              TRAP    #15
000018FE                           786              
000018FE                           787              ; SET WINDOWED MODE
000018FE  7201                     788              MOVE.L  #1,D1
00001900  4E4F                     789              TRAP    #15
00001902                           790              
00001902                           791              ; ENABLE DOUBLE BUFFER
00001902  103C 005C                792              MOVE.B  #92,D0
00001906  123C 0011                793              MOVE.B  #17,D1
0000190A  4E4F                     794              TRAP    #15
0000190C                           795              
0000190C                           796              ; CLEAR SCREEN
0000190C  103C 000B                797              MOVE.B  #11,D0
00001910  323C FF00                798              MOVE.W  #$FF00,D1
00001914  4E4F                     799              TRAP    #15
00001916                           800              
00001916                           801              ;ENABLE TIMED INTERRPUT
00001916  303C 0020                802              MOVE.W  #32,D0
0000191A  123C 0006                803              MOVE.B  #6,D1
0000191E  143C 0081                804              MOVE.B  #$81,D2                   ;INDICATE THAT INTERRUPT 1 IS ACTIVATED PERIODICALLY
00001922  7614                     805              MOVE.L  #20,D3                    ;INDICATE THE MILISECONDS FOR THAT PERIOD (20 ms == 50 FPS)
00001924  4E4F                     806              TRAP    #15
00001926                           807              
00001926                           808              ;CLEAR INTERRUPT COUNTER
00001926  4239 00001D00            809              CLR.B   (SCRINTCT)
0000192C                           810              
0000192C  4CDF 0003                811              MOVEM.L (A7)+,D0-D1               ;RESTORE REGISTERS FROM STACK
00001930                           812              
00001930  4E75                     813              RTS
00001932                           814  
00001932                           815  
00001932                           816              
00001932                           817  ;------------------------------------------------------------------------------            
00001932                           818  SCRUPD
00001932                           819  ; UPDATES DOUBLE BUFFER
00001932                           820  ; INPUT    : NONE
00001932                           821  ; OUTPUT   : NONE
00001932                           822  ; MODIFIES : NONE
00001932                           823  ; ------------------------------------------------------------------------------
00001932                           824  
00001932  48E7 C000                825              MOVEM.L D0-D1,-(A7)
00001936                           826              
00001936                           827              ;SWITCH BUFFERS
00001936  103C 005E                828              MOVE.B #94,D0
0000193A  4E4F                     829              TRAP #15
0000193C                           830              
0000193C                           831              ;CLEAR HIDDEN BUFFER
0000193C  103C 000B                832              MOVE.B  #11,D0
00001940  323C FF00                833              MOVE.W  #$FF00,D1
00001944  4E4F                     834              TRAP    #15
00001946                           835              
00001946  4CDF 0003                836              MOVEM.L (A7)+,D0-D1
0000194A                           837              
0000194A  4E73                     838              RTE
0000194C                           839              
0000194C                           840  ;------------------------------------------------------------------------------            
0000194C                           841  SCRTIM
0000194C                           842  ; TIME INTERRPUT SERVICE ROUTINE FOR SYNC
0000194C                           843  ; INPUT    : NONE
0000194C                           844  ; OUTPUT   : NONE
0000194C                           845  ; MODIFIES : NONE
0000194C                           846  ; ------------------------------------------------------------------------------
0000194C                           847  
0000194C  5239 00001D00            848              ADDQ.B  #1,(SCRINTCT)
00001952  4E73                     849              RTE
00001954                           850              
00001954                           851  ;------------------------------------------------------------------------------            
00001954                           852  KBDINIT
00001954                           853  ; INIT THE KEYBOARD
00001954                           854  ; INPUT    : NONE
00001954                           855  ; OUTPUT   : NONE
00001954                           856  ; MODIFIES : NONE
00001954                           857  ; ------------------------------------------------------------------------------
00001954                           858  
00001954  4239 00001CFE            859              CLR.B   (KBDVAL)
0000195A  4239 00001CFF            860              CLR.B   (KBDEDGE)
00001960                           861  
00001960  4E75                     862              RTS
00001962                           863  
00001962                           864  ;------------------------------------------------------------------------------            
00001962                           865  KBDUPD
00001962                           866  ; UPDATES KEYBOARD INFO
00001962                           867  ; 3 -> DOWN
00001962                           868  ; 2 -> RIGHT
00001962                           869  ; 1 -> UP
00001962                           870  ; 0 -> LEFT
00001962                           871  ; ------------------------------------------------------------------------------
00001962                           872              
00001962  48E7 F800                873              MOVEM.L D0-D4,-(A7)
00001966                           874              
00001966  303C 0013                875              MOVE.W  #19,D0
0000196A                           876              ;GET INFO OF THE KEYS
0000196A  223C 28272625            877              MOVE.L  #KBDDOWN<<24|KBDRIGHT<<16|KBDUP<<8|KBDLEFT,D1
00001970  4E4F                     878              TRAP    #15
00001972                           879              
00001972                           880              ;CONVERT TO DESIRED FORMAT
00001972  4EB9 0000199C            881              JSR .CONVERT
00001978                           882  
00001978                           883              ;GET KBDEDGE (IF SOME KEY HAVE CHANGED THE VALUE)
00001978  1039 00001CFE            884              MOVE.B  (KBDVAL),D0             ;D0 -> LAST KBDVAL
0000197E  4600                     885              NOT.B   D0                      ;D2 -> ACTUAL KBDVAL
00001980  C002                     886              AND.B   D2,D0
00001982  13C0 00001CFF            887              MOVE.B  D0,(KBDEDGE)
00001988                           888              
00001988                           889         
00001988  B03C 0000                890              CMP.B   #0,D0
0000198C  6700 0008                891              BEQ     .NOACT          
00001990                           892              
00001990                           893              ;STORE NEW KBDVAL
00001990  13C2 00001CFE            894              MOVE.B  D2,(KBDVAL)
00001996                           895  .NOACT
00001996                           896              
00001996  4CDF 001F                897              MOVEM.L (A7)+,D0-D4
0000199A                           898              
0000199A  4E73                     899              RTE    
0000199C                           900              
0000199C                           901  .CONVERT 
0000199C  363C 0003                902              MOVE.W  #3,D3
000019A0                           903              
000019A0  E189                     904  .LOOP       LSL.L   #8,D1
000019A2  E312                     905              ROXL.B  #1,D2
000019A4  51CB FFFA                906              DBRA.W  D3,.LOOP
000019A8  4E75                     907              RTS
000019AA                           908             
000019AA                           909  
000019AA                           910  ;------------------------------------------------------------------------------            
000019AA                           911  COLWALLRIGHT
000019AA                           912  ; COLLISION PAC-MAN WITH WALL
000019AA                           913  ; INPUT    : NONE
000019AA                           914  ; OUTPUT   : NONE
000019AA                           915  ; MODIFIES : NONE
000019AA                           916  ; ------------------------------------------------------------------------------
000019AA                           917  
000019AA  48E7 F800                918              MOVEM.L D0-D4,-(A7)
000019AE                           919  
000019AE  3039 00002104            920              MOVE.W  (PMPOSX),D0
000019B4  5140                     921              SUB.W   #8,D0
000019B6  3239 00002106            922              MOVE.W  (PMPOSY),D1
000019BC  5041                     923              ADD.W   #8,D1
000019BE                           924              
000019BE  81FC 0010                925              DIVS.W  #16,D0
000019C2  83FC 0010                926              DIVS.W  #16,D1
000019C6                           927              
000019C6  5940                     928              SUB.W   #4,D0                   ;LI RESTAM 4 PERQUE LA MATRIU ESTA A UNA DISTANCIA DE 64 PIXELS DE LA PANTALLA
000019C8  5941                     929              SUB.W   #4,D1
000019CA                           930              
000019CA  41F9 00001D01            931              LEA.L   MAPVAR,A0
000019D0                           932              
000019D0  5240                     933              ADD.W   #1,D0
000019D2  5341                     934              SUB.W   #1,D1
000019D4  C2FC 0020                935              MULU.W  #32,D1
000019D8  D041                     936              ADD.W   D1,D0
000019DA                           937              
000019DA  3240                     938              MOVE.W  D0,A1
000019DC  13C0 00002102            939              MOVE.B  D0,POSCON
000019E2                           940  
000019E2  1A29 1D01                941              MOVE.B  MAPVAR(A1),D5
000019E6                           942              
000019E6  4CDF 001F                943              MOVEM.L (A7)+,D0-D4
000019EA                           944              
000019EA  4E75                     945              RTS
000019EC                           946  
000019EC                           947  
000019EC                           948  ;------------------------------------------------------------------------------            
000019EC                           949  COLWALLLEFT
000019EC                           950  ; COLLISION PAC-MAN WITH WALL
000019EC                           951  ; INPUT    : NONE
000019EC                           952  ; OUTPUT   : NONE
000019EC                           953  ; MODIFIES : NONE
000019EC                           954  ; ------------------------------------------------------------------------------
000019EC                           955  
000019EC  48E7 F800                956              MOVEM.L D0-D4,-(A7)
000019F0                           957  
000019F0  3039 00002104            958              MOVE.W  (PMPOSX),D0
000019F6  5C40                     959              ADD.W   #6,D0
000019F8  3239 00002106            960              MOVE.W  (PMPOSY),D1
000019FE  5041                     961              ADD.W   #8,D1
00001A00                           962              
00001A00  81FC 0010                963              DIVS.W  #16,D0
00001A04  83FC 0010                964              DIVS.W  #16,D1
00001A08                           965              
00001A08  5940                     966              SUB.W   #4,D0                   ;LI RESTAM 4 PERQUE LA MATRIU ESTA A UNA DISTANCIA DE 64 PIXELS DE LA PANTALLA
00001A0A  5941                     967              SUB.W   #4,D1
00001A0C                           968              
00001A0C  41F9 00001D01            969              LEA.L   MAPVAR,A0
00001A12                           970              
00001A12  5340                     971              SUB.W   #1,D0
00001A14  5341                     972              SUB.W   #1,D1
00001A16  C2FC 0020                973              MULU.W  #32,D1
00001A1A  D041                     974              ADD.W   D1,D0
00001A1C                           975  
00001A1C  3240                     976              MOVE.W  D0,A1
00001A1E  13C0 00002102            977              MOVE.B  D0,POSCON
00001A24                           978  
00001A24  1A29 1D01                979              MOVE.B  MAPVAR(A1),D5               
00001A28                           980  
00001A28                           981              
00001A28  4CDF 001F                982              MOVEM.L (A7)+,D0-D4
00001A2C                           983              
00001A2C  4E75                     984              RTS
00001A2E                           985  
00001A2E                           986  ;------------------------------------------------------------------------------            
00001A2E                           987  COLWALLDOWN
00001A2E                           988  ; COLLISION PAC-MAN WITH WALL
00001A2E                           989  ; INPUT    : NONE
00001A2E                           990  ; OUTPUT   : NONE
00001A2E                           991  ; MODIFIES : NONE
00001A2E                           992  ; ------------------------------------------------------------------------------
00001A2E                           993  
00001A2E  48E7 F800                994              MOVEM.L D0-D4,-(A7)
00001A32                           995  
00001A32  3039 00002104            996              MOVE.W  (PMPOSX),D0
00001A38                           997              ;ADD.W   #8,D0
00001A38  3239 00002106            998              MOVE.W  (PMPOSY),D1
00001A3E  5041                     999              ADD.W   #8,D1
00001A40                          1000              
00001A40  81FC 0010               1001              DIVS.W  #16,D0
00001A44  83FC 0010               1002              DIVS.W  #16,D1
00001A48                          1003              
00001A48  5940                    1004              SUB.W   #4,D0                   ;LI RESTAM 4 PERQUE LA MATRIU ESTA A UNA DISTANCIA DE 64 PIXELS DE LA PANTALLA
00001A4A  5941                    1005              SUB.W   #4,D1
00001A4C                          1006              
00001A4C  41F9 00001D01           1007              LEA.L   MAPVAR,A0
00001A52                          1008              
00001A52  C2FC 0020               1009              MULU.W  #32,D1
00001A56  D041                    1010              ADD.W   D1,D0
00001A58                          1011  
00001A58  3240                    1012              MOVE.W  D0,A1
00001A5A  13C0 00002102           1013              MOVE.B  D0,POSCON
00001A60                          1014  
00001A60  1A29 1D01               1015              MOVE.B  MAPVAR(A1),D5 
00001A64                          1016  
00001A64                          1017              
00001A64  4CDF 001F               1018              MOVEM.L (A7)+,D0-D4
00001A68                          1019              
00001A68  4E75                    1020              RTS
00001A6A                          1021  
00001A6A                          1022  
00001A6A                          1023  ;------------------------------------------------------------------------------            
00001A6A                          1024  COLWALLUP
00001A6A                          1025  ; COLLISION PAC-MAN WITH WALL
00001A6A                          1026  ; INPUT    : NONE
00001A6A                          1027  ; OUTPUT   : NONE
00001A6A                          1028  ; MODIFIES : NONE
00001A6A                          1029  ; ------------------------------------------------------------------------------
00001A6A                          1030  
00001A6A  48E7 F800               1031              MOVEM.L D0-D4,-(A7)
00001A6E                          1032  
00001A6E  3039 00002104           1033              MOVE.W  (PMPOSX),D0
00001A74                          1034              ;SUB.W   #8,D0
00001A74  3239 00002106           1035              MOVE.W  (PMPOSY),D1
00001A7A  5C41                    1036              ADD.W   #6,D1
00001A7C                          1037              
00001A7C                          1038              
00001A7C  81FC 0010               1039              DIVS.W  #16,D0
00001A80  83FC 0010               1040              DIVS.W  #16,D1
00001A84                          1041              
00001A84  5940                    1042              SUB.W   #4,D0                   ;LI RESTAM 4 PERQUE LA MATRIU ESTA A UNA DISTANCIA DE 64 PIXELS DE LA PANTALLA
00001A86  5941                    1043              SUB.W   #4,D1
00001A88                          1044              
00001A88  41F9 00001D01           1045              LEA.L   MAPVAR,A0
00001A8E                          1046              
00001A8E  5341                    1047              SUB.W   #1,D1
00001A90                          1048              ;CMP     #1,D1
00001A90                          1049              ;BLO     BUCLE4
00001A90  C2FC 0020               1050              MULU.W  #32,D1
00001A94  D041                    1051              ADD.W   D1,D0
00001A96                          1052  
00001A96                          1053  ;BUCLE4            
00001A96  3240                    1054              MOVE.W  D0,A1
00001A98  13C0 00002102           1055              MOVE.B  D0,POSCON
00001A9E                          1056  
00001A9E  1A29 1D01               1057              MOVE.B  MAPVAR(A1),D5 
00001AA2                          1058  
00001AA2                          1059              ;MOVE.B  #0,D5
00001AA2                          1060              
00001AA2  4CDF 001F               1061              MOVEM.L (A7)+,D0-D4
00001AA6                          1062              
00001AA6  4E75                    1063              RTS
00001AA8                          1064  
00001AA8                          1065  
00001AA8                          1066  ;------------------------------------------------------------------------------            
00001AA8                          1067  GETPOINTS
00001AA8                          1068  ; COLLISION PAC-MAN WITH WALL
00001AA8                          1069  ; INPUT    : NONE
00001AA8                          1070  ; OUTPUT   : NONE
00001AA8                          1071  ; MODIFIES : NONE
00001AA8                          1072  ; ------------------------------------------------------------------------------
00001AA8                          1073  
00001AA8  48E7 F800               1074              MOVEM.L D0-D4,-(A7)
00001AAC                          1075  
00001AAC  3039 00002104           1076              MOVE.W  (PMPOSX),D0
00001AB2                          1077              ;SUB.W   #8,D0
00001AB2  3239 00002106           1078              MOVE.W  (PMPOSY),D1
00001AB8  0641 0010               1079              ADD.W   #16,D1
00001ABC                          1080              
00001ABC                          1081              
00001ABC  81FC 0010               1082              DIVS.W  #16,D0
00001AC0  83FC 0010               1083              DIVS.W  #16,D1
00001AC4                          1084              
00001AC4  5940                    1085              SUB.W   #4,D0                   ;LI RESTAM 4 PERQUE LA MATRIU ESTA A UNA DISTANCIA DE 64 PIXELS DE LA PANTALLA
00001AC6  5941                    1086              SUB.W   #4,D1
00001AC8                          1087                          
00001AC8  5341                    1088              SUB.W   #1,D1
00001ACA  C2FC 0020               1089              MULU.W  #32,D1
00001ACE  D041                    1090              ADD.W   D1,D0
00001AD0                          1091  
00001AD0  3240                    1092              MOVE.W  D0,A1
00001AD2  1A29 1D01               1093              MOVE.B  MAPVAR(A1),D5
00001AD6                          1094              
00001AD6  BA7C 0000               1095              CMP     #0,D5
00001ADA  6700 003A               1096              BEQ     .DONE
00001ADE  BA7C 0002               1097              CMP     #2,D5
00001AE2  6700 0020               1098              BEQ     .POINT
00001AE6  BA7C 0003               1099              CMP     #3,D5
00001AEA  6700 0006               1100              BEQ     .BPOINT
00001AEE  6600 0026               1101              BNE     .DONE
00001AF2                          1102  .BPOINT
00001AF2  137C 0000 1D01          1103              MOVE.B  #0,MAPVAR(A1)
00001AF8  0679 0032 0000211A      1104              ADD.W   #50,(SCOPOINTS)
00001B00  6600 0014               1105              BNE     .DONE
00001B04                          1106  .POINT
00001B04  137C 0000 1D01          1107              MOVE.B  #0,MAPVAR(A1)
00001B0A  0679 000A 0000211A      1108              ADD.W   #10,(SCOPOINTS)
00001B12  6600 0002               1109              BNE     .DONE            
00001B16                          1110  .DONE                        
00001B16  4CDF 001F               1111              MOVEM.L (A7)+,D0-D4
00001B1A                          1112              
00001B1A  4E75                    1113              RTS
00001B1C                          1114  
00001B1C                          1115  
00001B1C                          1116  
00001B1C                          1117  -------------------- end include --------------------
00001B1C                          1118              INCLUDE "MAP.X68"
00001B1C                          1119  
00001B1C                          1120  ; ------------------------------------------------------------------------------
00001B1C                          1121  MAPINIT
00001B1C                          1122  ; INIT MAP
00001B1C                          1123  ; INPUT    : NONE
00001B1C                          1124  ; OUTPUT   : NONE
00001B1C                          1125  ; MODIFIES : NONE
00001B1C                          1126  ; ------------------------------------------------------------------------------            
00001B1C                          1127              
00001B1C                          1128              ;MOVE.L  #DIBFIGWALL,($80+2*4)          ;INSTALL SUBRUTINE TO TRAP #2
00001B1C                          1129              ;MOVE.L  #DIBFIGPOINT,($80+3*4)          ;INSTALL SUBRUTINE TO TRAP #3
00001B1C                          1130              ;MOVE.L  #DIBFIGBPOINT,($80+4*4)          ;INSTALL SUBRUTINE TO TRAP #4
00001B1C                          1131              
00001B1C  48E7 FE00               1132              MOVEM.L D0-D6,-(A7)
00001B20  48E7 00C0               1133              MOVEM.L A0-A1,-(A7)
00001B24                          1134              
00001B24  41F8 1000               1135              LEA.L   MAPMAT,A0
00001B28  43F9 00001D01           1136              LEA.L   MAPVAR,A1
00001B2E  3C3C 0030               1137              MOVE.W  #48,D6
00001B32  343C 001F               1138              MOVE.W  #31,D2
00001B36                          1139  BUCLE_FILA
00001B36  3A3C 0030               1140              MOVE.W  #48,D5
00001B3A  323C 001F               1141              MOVE.W  #31,D1
00001B3E  0646 0010               1142              ADD.W   #16,D6
00001B42                          1143  
00001B42                          1144  BUCLE_COLUMNA
00001B42  0645 0010               1145              ADD.W   #16,D5
00001B46                          1146  
00001B46  1018                    1147              MOVE.B  (A0)+,D0
00001B48  12C0                    1148              MOVE.B  D0,(A1)+
00001B4A                          1149               
00001B4A  B07C 0000               1150              CMP     #0,D0
00001B4E  6700 0034               1151              BEQ     ZERO
00001B52  B07C 0004               1152              CMP     #4,D0
00001B56  6700 002C               1153              BEQ     ZERO
00001B5A  B07C 0001               1154              CMP     #1,D0
00001B5E  6600 0008               1155              BNE     NOTWALL
00001B62  4EB9 00001C0A           1156              JSR     DIBFIGWALL
00001B68                          1157  NOTWALL
00001B68  B07C 0002               1158              CMP     #2,D0
00001B6C  6600 0008               1159              BNE     NOTPOINT
00001B70  4EB9 00001C42           1160              JSR     DIBFIGPOINT
00001B76                          1161  NOTPOINT
00001B76  B07C 0003               1162              CMP     #3,D0
00001B7A  6600 0008               1163              BNE     ZERO
00001B7E  4EB9 00001C7E           1164              JSR     DIBFIGBPOINT
00001B84                          1165           
00001B84                          1166  ZERO
00001B84  51C9 FFBC               1167              DBRA    D1,BUCLE_COLUMNA  
00001B88  51CA FFAC               1168              DBRA    D2,BUCLE_FILA
00001B8C                          1169              
00001B8C  4CDF 0300               1170              MOVEM.L (A7)+,A0-A1
00001B90  4CDF 007F               1171              MOVEM.L (A7)+,D0-D6
00001B94                          1172  
00001B94                          1173  
00001B94                          1174              
00001B94  4E75                    1175              RTS            
00001B96                          1176  
00001B96                          1177  ; ------------------------------------------------------------------------------
00001B96                          1178  MAPPLOT
00001B96                          1179  ; INIT MAP
00001B96                          1180  ; INPUT    : NONE
00001B96                          1181  ; OUTPUT   : NONE
00001B96                          1182  ; MODIFIES : NONE
00001B96                          1183  ; ------------------------------------------------------------------------------            
00001B96                          1184  
00001B96  48E7 FE00               1185              MOVEM.L D0-D6,-(A7)
00001B9A  48E7 0080               1186              MOVEM.L A0,-(A7)
00001B9E                          1187  
00001B9E  41F9 00001D01           1188              LEA.L   MAPVAR,A0
00001BA4  3C3C 0030               1189              MOVE.W  #48,D6
00001BA8  343C 001F               1190              MOVE.W  #31,D2
00001BAC                          1191  BUCLE_FILA2
00001BAC  3A3C 0030               1192              MOVE.W  #48,D5
00001BB0  323C 001F               1193              MOVE.W  #31,D1
00001BB4  0646 0010               1194              ADD.W   #16,D6
00001BB8                          1195  
00001BB8                          1196  BUCLE_COLUMNA2
00001BB8  0645 0010               1197              ADD.W   #16,D5       
00001BBC                          1198  
00001BBC  1018                    1199              MOVE.B  (A0)+,D0
00001BBE                          1200  
00001BBE  B07C 0000               1201              CMP     #0,D0
00001BC2  6700 0034               1202              BEQ     ZERO2
00001BC6  B07C 0004               1203              CMP     #4,D0
00001BCA  6700 002C               1204              BEQ     ZERO2
00001BCE  B07C 0001               1205              CMP     #1,D0
00001BD2  6600 0008               1206              BNE     NOTWALL2
00001BD6  4EB9 00001C0A           1207              JSR     DIBFIGWALL
00001BDC                          1208  NOTWALL2
00001BDC  B07C 0002               1209              CMP     #2,D0
00001BE0  6600 0008               1210              BNE     NOTPOINT2
00001BE4  4EB9 00001C42           1211              JSR     DIBFIGPOINT
00001BEA                          1212  NOTPOINT2
00001BEA  B07C 0003               1213              CMP     #3,D0
00001BEE  6600 0008               1214              BNE     ZERO2
00001BF2  4EB9 00001C7E           1215              JSR     DIBFIGBPOINT
00001BF8                          1216  
00001BF8                          1217     
00001BF8                          1218  ZERO2
00001BF8  51C9 FFBE               1219              DBRA    D1,BUCLE_COLUMNA2
00001BFC                          1220              
00001BFC  51CA FFAE               1221              DBRA    D2,BUCLE_FILA2
00001C00                          1222              
00001C00  4CDF 0100               1223              MOVEM.L (A7)+,A0
00001C04  4CDF 007F               1224              MOVEM.L (A7)+,D0-D6
00001C08                          1225              
00001C08                          1226              
00001C08  4E75                    1227              RTS 
00001C0A                          1228              
00001C0A                          1229  ; -----------------------------------------------------------------------------
00001C0A                          1230  DIBFIGWALL
00001C0A                          1231  ; SUBRUTINE DRAW MAP
00001C0A                          1232  ; INPUT    : D5=POSITION X, D6=POSITION Y
00001C0A                          1233  ; OUTPUT   : NONE
00001C0A                          1234  ; MODIFIES : NONE
00001C0A                          1235  ; -----------------------------------------------------------------------------
00001C0A  48E7 FE00               1236              MOVEM.L D0-D6,-(A7)
00001C0E                          1237              ; SET CONTOURN COLOR
00001C0E  103C 0050               1238              MOVE.B  #80,D0
00001C12  223C 00AA0000           1239              MOVE.L  #$00AA0000,D1
00001C18  4E4F                    1240              TRAP    #15
00001C1A                          1241              
00001C1A                          1242              ; SET FILL COLOR
00001C1A  103C 0051               1243              MOVE.B  #81,D0
00001C1E  223C 00FF0000           1244              MOVE.L  #$00FF0000,D1
00001C24  4E4F                    1245              TRAP    #15
00001C26                          1246              
00001C26                          1247              ; DEFINE COORDINATES RECTANGLE
00001C26  3205                    1248              MOVE.W  D5,D1
00001C28  3406                    1249              MOVE.W  D6,D2
00001C2A  0645 0010               1250              ADD.W   #16,D5
00001C2E  0646 0010               1251              ADD.W   #16,D6
00001C32  3605                    1252              MOVE.W  D5,D3
00001C34  3806                    1253              MOVE.W  D6,D4
00001C36                          1254              
00001C36                          1255              ; DRAW RECTANGLE
00001C36  103C 0057               1256              MOVE.B  #87,D0
00001C3A  4E4F                    1257              TRAP    #15
00001C3C                          1258              
00001C3C  4CDF 007F               1259              MOVEM.L (A7)+,D0-D6
00001C40                          1260  
00001C40  4E75                    1261              RTS
00001C42                          1262              
00001C42                          1263  ; -----------------------------------------------------------------------------
00001C42                          1264  DIBFIGPOINT
00001C42                          1265  ; SUBRUTINE DRAW MAP
00001C42                          1266  ; INPUT    : D5=POSITION X, D6=POSITION Y
00001C42                          1267  ; OUTPUT   : NONE
00001C42                          1268  ; MODIFIES : NONE
00001C42                          1269  ; -----------------------------------------------------------------------------
00001C42  48E7 FE00               1270              MOVEM.L D0-D6,-(A7)
00001C46                          1271              ; SET CONTOURN COLOR
00001C46  103C 0050               1272              MOVE.B  #80,D0
00001C4A  223C 0000AAAA           1273              MOVE.L  #$0000AAAA,D1
00001C50  4E4F                    1274              TRAP    #15
00001C52                          1275              
00001C52                          1276              ; SET FILL COLOR
00001C52  103C 0051               1277              MOVE.B  #81,D0
00001C56  223C 0000FFFF           1278              MOVE.L  #$0000FFFF,D1
00001C5C  4E4F                    1279              TRAP    #15
00001C5E                          1280              
00001C5E                          1281              ; DEFINE COORDINATES RECTANGLE
00001C5E  3205                    1282              MOVE.W  D5,D1
00001C60  5041                    1283              ADD.W   #8,D1
00001C62  5541                    1284              SUB.W   #2,D1
00001C64  3406                    1285              MOVE.W  D6,D2
00001C66  5042                    1286              ADD.W   #8,D2
00001C68  5542                    1287              SUB.W   #2,D2
00001C6A                          1288              
00001C6A  3601                    1289              MOVE.W  D1,D3
00001C6C  5843                    1290              ADD.W   #2*2,D3
00001C6E  3802                    1291              MOVE.W  D2,D4
00001C70  5844                    1292              ADD.W   #2*2,D4
00001C72                          1293              
00001C72                          1294              ; DRAW POINT
00001C72  103C 0058               1295              MOVE.B  #88,D0
00001C76  4E4F                    1296              TRAP    #15
00001C78                          1297              
00001C78  4CDF 007F               1298              MOVEM.L (A7)+,D0-D6
00001C7C                          1299              
00001C7C  4E75                    1300              RTS
00001C7E                          1301  
00001C7E                          1302  
00001C7E                          1303  ; -----------------------------------------------------------------------------
00001C7E                          1304  DIBFIGBPOINT
00001C7E                          1305  ; SUBRUTINE DRAW MAP
00001C7E                          1306  ; INPUT    : D5=POSITION X, D6=POSITION Y
00001C7E                          1307  ; OUTPUT   : NONE
00001C7E                          1308  ; MODIFIES : NONE
00001C7E                          1309  ; -----------------------------------------------------------------------------
00001C7E  48E7 FE00               1310              MOVEM.L D0-D6,-(A7)
00001C82                          1311              ; SET CONTOURN COLOR
00001C82  103C 0050               1312              MOVE.B  #80,D0
00001C86  223C 0000AAAA           1313              MOVE.L  #$0000AAAA,D1
00001C8C  4E4F                    1314              TRAP    #15
00001C8E                          1315              
00001C8E                          1316              ; SET FILL COLOR
00001C8E  103C 0051               1317              MOVE.B  #81,D0
00001C92  223C 0000FFFF           1318              MOVE.L  #$0000FFFF,D1
00001C98  4E4F                    1319              TRAP    #15
00001C9A                          1320              
00001C9A                          1321              ; DEFINE COORDINATES RECTANGLE
00001C9A  3205                    1322              MOVE.W  D5,D1
00001C9C  5041                    1323              ADD.W   #8,D1
00001C9E  5941                    1324              SUB.W   #4,D1
00001CA0  3406                    1325              MOVE.W  D6,D2
00001CA2  5042                    1326              ADD.W   #8,D2
00001CA4  5942                    1327              SUB.W   #4,D2
00001CA6                          1328              
00001CA6  3601                    1329              MOVE.W  D1,D3
00001CA8  5043                    1330              ADD.W   #4*2,D3
00001CAA  3802                    1331              MOVE.W  D2,D4
00001CAC  5044                    1332              ADD.W   #4*2,D4
00001CAE                          1333              
00001CAE                          1334              ; DRAW BIG POINT
00001CAE  103C 0058               1335              MOVE.B  #88,D0
00001CB2  4E4F                    1336              TRAP    #15
00001CB4                          1337              
00001CB4  4CDF 007F               1338              MOVEM.L (A7)+,D0-D6
00001CB8                          1339              
00001CB8  4E75                    1340              RTS
00001CBA                          1341  
00001CBA                          1342  
00001CBA                          1343  
00001CBA                          1344  
00001CBA                          1345  
00001CBA                          1346  
00001CBA                          1347  
00001CBA                          1348  
00001CBA                          1349  
00001CBA                          1350  
00001CBA                          1351  
00001CBA                          1352  
00001CBA                          1353  -------------------- end include --------------------
00001CBA                          1354              
00001CBA                          1355      
00001CBA                          1356  START:
00001CBA                          1357  
00001CBA                          1358  ;--- INITIALIZATION -----------------------------------------------------------
00001CBA                          1359  
00001CBA  007C 0700               1360              ORI.W   #$0700,SR               ;DISABLE INTERRUPTIONS
00001CBE                          1361  
00001CBE  4EB8 18C2               1362              JSR     SYSINIT
00001CC2  4EB8 14CE               1363              JSR     PMINIT
00001CC6  4EB8 1B1C               1364              JSR     MAPINIT
00001CCA  4EB8 1400               1365              JSR     GSTINIT
00001CCE  4EB8 1850               1366              JSR     SCOINIT
00001CD2                          1367  
00001CD2                          1368  .LOOP
00001CD2                          1369  
00001CD2                          1370  ; --- UPDATE -------------------------------------------------------------------
00001CD2                          1371  
00001CD2                          1372  ; READ INPUT DEVICES
00001CD2                          1373  
00001CD2  4E41                    1374              TRAP    #1
00001CD4                          1375  
00001CD4                          1376  ; UPDATE GAME LOGIC
00001CD4                          1377  
00001CD4  4EB8 1502               1378              JSR     PMUPD
00001CD8                          1379             ;JSR     GSTUPD
00001CD8                          1380  
00001CD8                          1381  ; --- SYNC ---------------------------------------------------------------------
00001CD8                          1382              ;WHILE THERES NO INTERRUPTS IN THE COUNTER THE PROGRAM WILL BE IN
00001CD8                          1383              ;THE BUCLE
00001CD8                          1384              
00001CD8  4A39 00001D00           1385  .WAITINIT   TST.B   (SCRINTCT)
00001CDE  67F8                    1386              BEQ     .WAITINIT
00001CE0  4239 00001D00           1387              CLR.B   (SCRINTCT)
00001CE6                          1388  
00001CE6                          1389  ; --- PLOT ---------------------------------------------------------------------
00001CE6                          1390              
00001CE6  4EB8 1B96               1391              JSR     MAPPLOT
00001CEA  4EB8 1860               1392              JSR     SCOPLOT
00001CEE  4EB8 164C               1393              JSR     PMPLOT
00001CF2  4EB8 1464               1394              JSR     GSTPLOT
00001CF6                          1395              
00001CF6                          1396              
00001CF6                          1397              
00001CF6  4E40                    1398              TRAP    #0                      ;CHANGE BUFFER
00001CF8                          1399  
00001CF8  60D8                    1400              BRA     .LOOP
00001CFA                          1401  
00001CFA  FFFF FFFF               1402              SIMHALT  
00001CFE                          1403             
00001CFE                          1404              INCLUDE "SYSVARS.X68"
00001CFE                          1405  ; ==============================================================================
00001CFE                          1406  ; SYSTEM VARIABLES
00001CFE                          1407  ; ==============================================================================
00001CFE                          1408   
00001CFE                          1409  ; --- KEYBOARD RELATED VARIABLES -----------------------------------------------
00001CFE                          1410  
00001CFE                          1411  KBDVAL      DS.B    1                       ; KEY STATE
00001CFF                          1412  KBDEDGE     DS.B    1                       ; KEY EDGE
00001D00                          1413  
00001D00                          1414  ; --- TIMED INTERRUPT RELATED VARIABLES ----------------------------------------
00001D00                          1415  
00001D00                          1416  SCRINTCT    DS.B    1                       ; INTERRUPT COUNTER
00001D01                          1417              DS.B    0           
00001D01                          1418              
00001D01                          1419  ; --- MAP RELATED VARIABLE -----------------------------------------------------
00001D01                          1420  
00001D01                          1421  MAPVAR      DS.B    1024
00002101                          1422  
00002101                          1423              DS.B    0
00002101                          1424  
00002102                          1425  POSCON      DS.W    1
00002104                          1426  
00002104                          1427  
00002104                          1428  
00002104                          1429  
00002104                          1430  
00002104                          1431  -------------------- end include --------------------
00002104                          1432              INCLUDE "VARS.X68"
00002104                          1433  ; ==============================================================================
00002104                          1434  ; GAME VARIABLES
00002104                          1435  ; ==============================================================================
00002104                          1436  
00002104                          1437  ; --- PAC-MAN RELATED VARIABLES ------------------------------------------------
00002104                          1438  
00002104                          1439  PMPOSX      DS.W    1                       ; PM X COORDINATE
00002106                          1440  PMPOSY      DS.W    1                       ; PM Y COORDINATE
00002108                          1441  PMVELX      DS.W    1                       ; PM X VELOCITY
0000210A                          1442  PMVELY      DS.W    1                       ; PM Y VELOCITY
0000210C                          1443  PMEAT       DS.B    1                       ; PM BOOLEAN EAT GST
0000210D                          1444  PMLAMO      DS.B    1                       ; PM SAVE LAST MOVEMENT X O Y
0000210E                          1445              DS.B    0
0000210E                          1446  
0000210E                          1447  ; --- GHOST RELATED VARIABLES --------------------------------------------------
0000210E                          1448  
0000210E                          1449  GSTPOSX     DS.W    1                       ; GST X COORDINATE
00002110                          1450  GSTPOSY     DS.W    1                       ; GST Y COORDINATE
00002112                          1451  GSTVELX     DS.W    1                       ; GST X VELOCITY
00002114                          1452  GSTVELY     DS.W    1                       ; GST Y VELOCITY
00002116                          1453  GSTDEAD     DS.B    1                       ; GST BOOLEAN DEAD
00002117                          1454  GSTLAMO     DS.B    1                       ; GST LAST MOVEMENT (X OR Y)
00002118                          1455              DS.B    0
00002118                          1456  
00002118                          1457  ; --- SCOREBOARD RELATED VARIABLES ---------------------------------------------
00002118                          1458  
00002118                          1459  SCOLIFE     DS.W    1                       ; NUMBER OF LIFES
0000211A                          1460  SCOPOINTS   DS.W    1                       ; NUMBER OF POINTS
0000211C                          1461  
0000211C                          1462  
0000211C                          1463  
0000211C                          1464  
0000211C                          1465  
0000211C                          1466  
0000211C                          1467  
0000211C                          1468  -------------------- end include --------------------
0000211C                          1469              
0000211C                          1470              END    START        

No errors detected
No warnings generated


SYMBOL TABLE INFORMATION
Symbol-name         Value
-------------------------
BUCLE_COLUMNA       1B42
BUCLE_COLUMNA2      1BB8
BUCLE_FILA          1B36
BUCLE_FILA2         1BAC
COLWALLDOWN         1A2E
COLWALLLEFT         19EC
COLWALLRIGHT        19AA
COLWALLUP           1A6A
DIBFIGBPOINT        1C7E
DIBFIGPOINT         1C42
DIBFIGWALL          1C0A
GETPOINTS           1AA8
GETPOINTS:BPOINT    1AF2
GETPOINTS:DONE      1B16
GETPOINTS:POINT     1B04
GSTCOL1             FF
GSTCOL2             FF0080
GSTCOL3             FFFF00
GSTCOL4             80FF
GSTCOL5             800000
GSTDEAD             2116
GSTFCOL1            FFFFFF
GSTFCOL2            0
GSTFCOL3            0
GSTFCOL4            0
GSTFCOL5            0
GSTINIT             1400
GSTINX1             2
GSTINX2             2
GSTINX3             1F
GSTINX4             1F
GSTINY1             2
GSTINY2             1F
GSTINY3             2
GSTINY4             1F
GSTLAMO             2117
GSTPLOT             1464
GSTPOSX             210E
GSTPOSY             2110
GSTRAD              8
GSTRNG              10
GSTSPEED            7
GSTSPEED2           5
GSTUPD              1428
GSTUPD:GSTNOTMULT   145E
GSTVELX             2112
GSTVELY             2114
KBDDOWN             28
KBDEDGE             1CFF
KBDFIRE1            20
KBDFIRE2            4D
KBDFIRE3            10
KBDINIT             1954
KBDLEFT             25
KBDPAUSE            50
KBDRIGHT            27
KBDUP               26
KBDUPD              1962
KBDUPD:CONVERT      199C
KBDUPD:LOOP         19A0
KBDUPD:NOACT        1996
KBDVAL              1CFE
MAPINIT             1B1C
MAPMAT              1000
MAPPLOT             1B96
MAPVAR              1D01
NOTPOINT            1B76
NOTPOINT2           1BEA
NOTWALL             1B68
NOTWALL2            1BDC
PMEAT               210C
PMFCOL              FFFF
PMINIT              14CE
PMLAMO              210D
PMPCOL              FFFF
PMPLOT              164C
PMPLOT:DDONE        16E6
PMPLOT:DDOWN        16B8
PMPLOT:DLEFT        169A
PMPLOT:DOWNDRAW     17A6
PMPLOT:DRAW_MOUTH1  16C2
PMPLOT:DRAW_MOUTH2  16CC
PMPLOT:DRAW_MOUTH3  16D6
PMPLOT:DRAW_MOUTH4  16E0
PMPLOT:DRIGHT       16AE
PMPLOT:DUP          16A4
PMPLOT:FULLDRAW     16EC
PMPLOT:LEFTDRAW     1710
PMPLOT:RIGHTDRAW    1742
PMPLOT:SET_MOUTHDOWN  1832
PMPLOT:SET_MOUTHLEFT  17D8
PMPLOT:SET_MOUTHRIGHT  17F6
PMPLOT:SET_MOUTHUP  1814
PMPLOT:UPDRAW       1774
PMPOSX              2104
PMPOSY              2106
PMRAD               8
PMSPEED             2
PMUPD               1502
PMUPD:ACTXLEFT      15C0
PMUPD:ACTXRIGHT     1594
PMUPD:ACTYDOWN      15EC
PMUPD:ACTYUP        1608
PMUPD:DONE          163A
PMUPD:NOTCOLISION   15A6
PMUPD:NOTCOLISION2  15D2
PMUPD:NOTCOLISION3  15FE
PMUPD:NOTCOLISION4  161A
PMUPD:NOTDOWN       1590
PMUPD:NOTLEFT       154E
PMUPD:NOTMULT       1624
PMUPD:NOTRIGHT      1564
PMUPD:NOTTP         15B6
PMUPD:NOTTP2        15E2
PMUPD:NOTUP         157A
PMVELX              2108
PMVELY              210A
POSCON              2102
SCOFCOL             0
SCOINIT             1850
SCOLIFE             2118
SCOLINE1            101
SCOLINE2            102
SCOPLOT             1860
SCOPLOT:TXT1        18AE
SCOPLOT:TXT2        18B7
SCOPOINTS           211A
SCRHEIGH            280
SCRINIT             18EE
SCRINTCT            1D00
SCRTIM              194C
SCRUPD              1932
SCRWIDTH            280
START               1CBA
START:LOOP          1CD2
START:WAITINIT      1CD8
SYSINIT             18C2
ZERO                1B84
ZERO2               1BF8
